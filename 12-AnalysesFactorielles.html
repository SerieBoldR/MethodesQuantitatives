<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Méthodes quantitatives en sciences sociales : un grand bol d’R - 12&nbsp; Méthodes factorielles</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./13-MethodeClassification.html" rel="next">
<link href="./11-GAM.html" rel="prev">
<link href="./images/introduction/Couverture.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer"
  }
}</script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="css/quizlib.min.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-AnalysesFactorielles.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Méthodes factorielles</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Recherche" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/SerieBoldR/MethodesQuantitatives" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Préface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-auteurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">À propos des auteurs</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 1. Découverte de R</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-priseenmainR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prise en main de R</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 2. Analyses univariées et représentations graphiques</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-univarie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistiques descriptives univariées</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-magiedesgraphiques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Magie des graphiques</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 3. Analyses bivariées</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-bivarieeQuantiQuanti.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Relation linéaire entre deux variables quantitatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-bivarieeQualiQuali.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Relation entre deux variables qualitatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-bivarieeQualiQuanti.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Relation entre une variable qualitative et une variable quantitative</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 4. Modèles de régression</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-regressionlineaire.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Régression linéaire multiple</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-GLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Régressions linéaires généralisées (GLM)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-GLMM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Régressions à effets mixtes (GLMM)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Multiniveau.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Régressions multiniveaux</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-GAM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modèles généralisés additifs</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 5. Analyses exploratoires multivariées</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-AnalysesFactorielles.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Méthodes factorielles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-MethodeClassification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Méthodes de classification non supervisée</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 6. Annexes et bibliographie</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-Annexes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Annexes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliographie</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table des matières</h2>
   
  <ul>
<li>
<a href="#sec-121" id="toc-sec-121" class="nav-link active" data-scroll-target="#sec-121"><span class="header-section-number">12.1</span> Aperçu des méthodes factorielles</a>
  <ul class="collapse">
<li><a href="#sec-1211" id="toc-sec-1211" class="nav-link" data-scroll-target="#sec-1211"><span class="header-section-number">12.1.1</span> Méthodes factorielles et types de données</a></li>
  <li><a href="#sec-1212" id="toc-sec-1212" class="nav-link" data-scroll-target="#sec-1212"><span class="header-section-number">12.1.2</span> Bref historique des méthodes factorielles</a></li>
  </ul>
</li>
  <li>
<a href="#sec-122" id="toc-sec-122" class="nav-link" data-scroll-target="#sec-122"><span class="header-section-number">12.2</span> Analyses en composantes principales (ACP)</a>
  <ul class="collapse">
<li><a href="#sec-1221" id="toc-sec-1221" class="nav-link" data-scroll-target="#sec-1221"><span class="header-section-number">12.2.1</span> Recherche d’une simplification</a></li>
  <li><a href="#sec-1222" id="toc-sec-1222" class="nav-link" data-scroll-target="#sec-1222"><span class="header-section-number">12.2.2</span> Aides à l’interprétation</a></li>
  <li><a href="#sec-1223" id="toc-sec-1223" class="nav-link" data-scroll-target="#sec-1223"><span class="header-section-number">12.2.3</span> Mise en œuvre dans R</a></li>
  </ul>
</li>
  <li>
<a href="#sec-123" id="toc-sec-123" class="nav-link" data-scroll-target="#sec-123"><span class="header-section-number">12.3</span> Analyse factorielle des correspondances (AFC)</a>
  <ul class="collapse">
<li><a href="#sec-1231" id="toc-sec-1231" class="nav-link" data-scroll-target="#sec-1231"><span class="header-section-number">12.3.1</span> Recherche d’une simplification basée sur la distance du khi-deux</a></li>
  <li><a href="#sec-1232" id="toc-sec-1232" class="nav-link" data-scroll-target="#sec-1232"><span class="header-section-number">12.3.2</span> Aides à l’interprétation</a></li>
  <li><a href="#sec-1233" id="toc-sec-1233" class="nav-link" data-scroll-target="#sec-1233"><span class="header-section-number">12.3.3</span> Mise en œuvre dans R</a></li>
  </ul>
</li>
  <li>
<a href="#sec-124" id="toc-sec-124" class="nav-link" data-scroll-target="#sec-124"><span class="header-section-number">12.4</span> Analyse de correspondances multiples (ACM)</a>
  <ul class="collapse">
<li><a href="#sec-1241" id="toc-sec-1241" class="nav-link" data-scroll-target="#sec-1241"><span class="header-section-number">12.4.1</span> Aides à l’interprétation</a></li>
  <li><a href="#sec-1242" id="toc-sec-1242" class="nav-link" data-scroll-target="#sec-1242"><span class="header-section-number">12.4.2</span> Mise en œuvre dans R</a></li>
  </ul>
</li>
  <li><a href="#sec-125" id="toc-sec-125" class="nav-link" data-scroll-target="#sec-125"><span class="header-section-number">12.5</span> Quiz de révision du chapitre</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/SerieBoldR/MethodesQuantitatives/issues/new" class="toc-action">Signaler un problème ou<br>formuler une suggestion</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-chap12" class="quarto-section-identifier"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Méthodes factorielles</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Dans le cadre de ce chapitre, nous présentons les trois méthodes factorielles les plus utilisées en sciences sociales&nbsp;: l’analyse en composantes principales (ACP, <a href="#sec-122">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-122</span></a>), l’analyse factorielle des correspondances (AFC, <a href="#sec-123">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-123</span></a>) et l’analyse factorielle des correspondances multiples (ACM, <a href="#sec-124">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-124</span></a>). Ces méthodes, qui permettent d’explorer et de synthétiser l’information de différents tableaux de données, relèvent de la statistique exploratoire multidimensionnelle.</p>
<div class="bloc_package">
<div class="bloc_package-header">
<div class="bloc_package-icon">

</div>
<p><strong>Liste des <em>packages</em> utilisés dans ce chapitre</strong></p>
</div>
<div class="bloc_package-body">
<ul>
<li>Pour créer des graphiques&nbsp;:
<ul>
<li>
<code>ggplot2</code>, le seul, l’unique!</li>
<li>
<code>ggpubr</code> pour combiner des graphiques.</li>
</ul>
</li>
<li>Pour les analyses factorielles&nbsp;:
<ul>
<li>
<code>FactoMineR</code> pour réaliser une ACP, une AFC et une ACM.</li>
<li>
<code>factoextra</code> pour réaliser des graphiques à partir des résultats d’une analyse factorielle.</li>
<li>
<code>explor</code> pour les résultats d’une ACP, d’une AFC ou d’une ACM avec une interface Web interactive.</li>
</ul>
</li>
<li>Autres <em>packages</em>&nbsp;:
<ul>
<li>
<code>geocmeans</code> pour un jeu de données utilisé pour calculer une ACP.</li>
<li>
<code>ggplot2</code>, <code>ggpubr</code>, <code>stringr</code> et <code>corrplot</code> pour réaliser des graphiques personnalisés sur les résultats d’une analyse factorielle.</li>
<li>
<code>tmap</code> et <code>RColorBrewer</code> pour cartographier les coordonnées factorielles.</li>
<li>
<code>Hmisc</code> pour l’obtention d’une matrice de corrélation.</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="bloc_objectif">
<div class="bloc_objectif-header">
<div class="bloc_objectif-icon">

</div>
<p><strong>Réduction de données et identification de variables latentes</strong></p>
</div>
<div class="bloc_objectif-body">
<p>Les méthodes factorielles sont souvent dénommées des <strong>méthodes de réduction de données</strong>, en raison de leur objectif principal&nbsp;: résumer l’information d’un tableau en quelques nouvelles variables synthétiques (<a href="#fig-AnalysesFactoriellesFig">figure&nbsp;<span class="quarto-unresolved-ref">fig-AnalysesFactoriellesFig</span></a>). Ainsi, elles permettent de réduire l’information d’un tableau volumineux —&nbsp;comprenant par exemple 1000&nbsp;observations et 100&nbsp;variables&nbsp;— en <em>p</em> nouvelles variables (par exemple cinq avec toujours 1000&nbsp;observations) résumant <em>X</em> % de l’information contenue dans le tableau initial. Lebart et al. <span class="citation" data-cites="lebart1995statistique">(<a href="#ref-lebart1995statistique" role="doc-biblioref">1995, 13</a>)</span> proposent une formulation plus mathématique&nbsp;: ils signalent qu’avec les méthodes factorielles, «&nbsp;on cherche à réduire les dimensions du tableau de données en représentant les associations entre individus et entre variables dans des espaces de faibles dimensions&nbsp;».</p>
<div id="fig-AnalysesFactoriellesFig" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap12/AnalysesFactorielles.png" class="img-fluid figure-img" style="width:40.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.1: Principe de base des analyses factorielles</figcaption></figure>
</div>
<p>Ces nouvelles variables synthétiques peuvent être considérées comme des <strong>variables latentes</strong> puisqu’elles ne sont pas directement observées; elles sont plutôt produites par la méthode factorielle utilisée afin de résumer les relations/associations entre plusieurs variables mesurées initialement.</p>
</div>
</div>
<section id="sec-121" class="level2" data-number="12.1"><h2 data-number="12.1" class="anchored" data-anchor-id="sec-121">
<span class="header-section-number">12.1</span> Aperçu des méthodes factorielles</h2>
<section id="sec-1211" class="level3" data-number="12.1.1"><h3 data-number="12.1.1" class="anchored" data-anchor-id="sec-1211">
<span class="header-section-number">12.1.1</span> Méthodes factorielles et types de données</h3>
<p>En analyse factorielle, la nature même des données du tableau à traiter détermine la méthode à employer&nbsp;: l’analyse en composantes principales (ACP) est adaptée aux tableaux avec des variables continues (idéalement normalement distribuées), l’analyse factorielle des correspondances (AFC) s’applique à des tableaux de contingence tandis que l’analyse des correspondances multiples (ACM) permet de résumer des tableaux avec des données qualitatives (issues d’un sondage par exemple) (<a href="#tbl-typesanalysesfactorielles">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-typesanalysesfactorielles</span></a>). Sachez toutefois qu’il existe d’autres méthodes factorielles qui ne sont pas abordées dans ce chapitre, notamment&nbsp;: l’analyse factorielle de données mixtes (AFDM) permettant d’explorer des tableaux avec à la fois des variables continues et des variables qualitatives et l’analyse factorielle multiple hiérarchique (AFMH) permettant de traiter des tableaux avec une structure hiérarchique. Pour s’initier à ces deux autres méthodes factorielles plus récentes, consultez notamment l’excellent ouvrage de Jérôme Pagès <span class="citation" data-cites="pages2013analyse">(<a href="#ref-pages2013analyse" role="doc-biblioref">2013</a>)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-typesanalysesfactorielles" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.1: Trois principales méthodes factorielles</caption>
<colgroup>
<col style="width: 50%">
<col style="width: 5%">
<col style="width: 23%">
<col style="width: 21%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Méthode factorielle</th>
<th style="text-align: left;">Abr.</th>
<th style="text-align: left;">Type de données</th>
<th style="text-align: left;">Type de distance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Analyse en composantes principales</td>
<td style="text-align: left;">ACP</td>
<td style="text-align: left;">Variables continues</td>
<td style="text-align: left;">Distance euclidienne</td>
</tr>
<tr class="even">
<td style="text-align: left;">Analyse factorielle des correspondances</td>
<td style="text-align: left;">AFC</td>
<td style="text-align: left;">Tableau de contingence</td>
<td style="text-align: left;">Distance du khi-deux</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Analyse factorielle des correspondances multiples</td>
<td style="text-align: left;">ACM</td>
<td style="text-align: left;">Variables qualitatives</td>
<td style="text-align: left;">Distance du khi-deux</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="sec-1212" class="level3" data-number="12.1.2"><h3 data-number="12.1.2" class="anchored" data-anchor-id="sec-1212">
<span class="header-section-number">12.1.2</span> Bref historique des méthodes factorielles</h3>
<p>Il existe une longue tradition de l’utilisation des méthodes factorielles dans le monde universitaire francophone puisque plusieurs d’entre elles ont été proposées par des statisticiens et des statisticiennes francophones à partir des années 1960. L’analyse en composantes principales (ACP) a été proposée dès les années 1930 par le statisticien américain Harold Hotelling <span class="citation" data-cites="hotelling1933analysis">(<a href="#ref-hotelling1933analysis" role="doc-biblioref">1933</a>)</span>. En revanche, l’analyse des correspondances (AFC) et son extension, l’analyse des correspondances multiples (ACM), ont été proposées par le statisticien français Jean-Paul Benzécri <span class="citation" data-cites="benzecri1973analyse">(<a href="#ref-benzecri1973analyse" role="doc-biblioref">1973</a>)</span>, tandis que l’analyse factorielle de données mixtes (AFDM) a été proposée par Brigitte Escofier et Jérôme Pagès <span class="citation" data-cites="escofier1979traitement pages2002analyse">(<a href="#ref-escofier1979traitement" role="doc-biblioref">Escofier 1979</a>; <a href="#ref-pages2002analyse" role="doc-biblioref">Pagès 2002</a>)</span>.</p>
<p>Ainsi, plusieurs ouvrages de statistique sur les méthodes factorielles, désormais classiques, ont été publiés en français <span class="citation" data-cites="benzecri1973analyse escofier1998analyses lebart1995statistique pages2013analyse">(<a href="#ref-benzecri1973analyse" role="doc-biblioref">Benzécri 1973</a>; <a href="#ref-escofier1998analyses" role="doc-biblioref">Escofier et Pagès 1998</a>; <a href="#ref-lebart1995statistique" role="doc-biblioref">Lebart, Morineau et Piron 1995</a>; <a href="#ref-pages2013analyse" role="doc-biblioref">Pagès 2013</a>)</span>. Ils méritent grandement d’être consultés, notamment pour mieux comprendre les formulations mathématiques (matricielles et géométriques) de ces méthodes. À cela s’ajoutent plusieurs ouvrages visant à «&nbsp;vulgariser ces méthodes&nbsp;» en sciences sociales; c’est notamment le cas de l’excellent ouvrage de Léna Sanders <span class="citation" data-cites="sanders1989analyse">(<a href="#ref-sanders1989analyse" role="doc-biblioref">1989</a>)</span> en géographie.</p>
</section></section><section id="sec-122" class="level2" data-number="12.2"><h2 data-number="12.2" class="anchored" data-anchor-id="sec-122">
<span class="header-section-number">12.2</span> Analyses en composantes principales (ACP)</h2>
<p>D’emblée, notez qu’il existe deux types d’analyse en composantes principales (ACP) (<em>Principal Component Analysis, PCA</em> en anglais)&nbsp;:</p>
<ul>
<li><p><strong>l’ACP non normée</strong> dans laquelle les variables quantitatives du tableau sont uniquement centrées (moyenne&nbsp;=&nbsp;0).</p></li>
<li><p><strong>l’ACP normée</strong> dans laquelle les variables quantitatives du tableau sont préalablement centrées réduites (moyenne&nbsp;=&nbsp;0 et variance&nbsp;=&nbsp;1; <a href="#sec-02552">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-02552</span></a>).</p></li>
</ul>
<p>Puisque les variables d’un tableau sont souvent exprimées dans des unités de mesure différentes ou avec des ordres de grandeur différents (intervalles et écarts-types bien différents), l’utilisation de l’ACP normée est bien plus courante. Elle est d’ailleurs l’option par défaut dans les fonctions R permettant de calculer une ACP. Par conséquent, nous détaillons dans cette section uniquement l’ACP normée.</p>
<p>Autrement dit, le recours à une ACP non normée est plus rare et s’applique uniquement à la situation suivante&nbsp;: toutes les variables du tableau sont mesurées dans la même unité (par exemple, en pourcentage); il pourrait être ainsi judicieux de conserver leurs variances respectives.</p>
<section id="sec-1221" class="level3" data-number="12.2.1"><h3 data-number="12.2.1" class="anchored" data-anchor-id="sec-1221">
<span class="header-section-number">12.2.1</span> Recherche d’une simplification</h3>
<p>L’ACP permet d’explorer et de résumer un tableau constitué uniquement de variables quantitatives (<a href="#fig-AnalysesFactoriellesTabACPFig">figure&nbsp;<span class="quarto-unresolved-ref">fig-AnalysesFactoriellesTabACPFig</span></a>), et ce, de trois façons&nbsp;: 1) en montrant les ressemblances entre les individus (observations), 2) en révélant les liaisons entre les variables quantitatives et 3) en résumant l’ensemble des variables du tableau par des variables synthétiques nommées composantes principales.</p>
<div id="fig-AnalysesFactoriellesTabACPFig" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap12/AnalysesFactoriellesTabACP.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.2: Tableau pour une ACP</figcaption></figure>
</div>
<p><strong>Ressemblance entre les individus</strong>. Concrètement, deux individus se ressemblent si leurs valeurs respectives pour les <em>p</em> variables du tableau sont similaires. Cette proximité/ressemblance est évaluée à partir de la distance euclidienne (<a href="#eq-ACPdistEuc">équation&nbsp;<span class="quarto-unresolved-ref">eq-ACPdistEuc</span></a>). La notion de distance fait l’objet d’une section à part entière (<a href="#sec-1321">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-1321</span></a>) que vous pouvez consulter dès à présent si elle ne vous est pas familière.</p>
<p><span id="eq-ACPdistEuc"><span class="math display">\[
d^2(a,b) = \sum_{j=1}^p(x_{aj}-x_{bj})^2
\tag{12.1}\]</span></span></p>
<p>Prenons un exemple fictif avec trois individus (<em>i</em>, <em>j</em> et <em>k</em>) ayant des valeurs pour trois variables préalablement centrées réduites (V1 à V3) (<a href="#tbl-distanceACPindi">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-distanceACPindi</span></a>). La proximité entre les paires de points est évaluée comme suit&nbsp;:</p>
<p><span class="math display">\[d^2(i,j)=(-\mbox{1,15}-\mbox{0,49})^2+(-\mbox{1,15}-\mbox{0,58})^2+(\mbox{0,83}+\mbox{1,11})^2=\mbox{9,44}\]</span> <span class="math display">\[d^2(i,k)=(-\mbox{1,15}+\mbox{0,66})^2+(-\mbox{1,15}-\mbox{0,58})^2+(\mbox{0,83}-\mbox{0,28})^2=\mbox{5,98}\]</span></p>
<p><span class="math display">\[d^2(j,k)= (\mbox{0,49}+\mbox{0,66})^2+(\mbox{0,58}-\mbox{0,58})^2+(-\mbox{1,11}-\mbox{0,28})^2=\mbox{1,97}\]</span></p>
<p>Nous pouvons en conclure que <em>i</em> est plus proche de <em>k</em> que de <em>j</em>, mais aussi que la paire de points les plus proches est (<em>i</em>,<em>k</em>). En d’autres termes, les deux observations <em>i</em> et <em>k</em> sont les plus similaires du jeu de données selon la distance euclidienne.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-distanceACPindi" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.2: Données fictives</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Variables centrées réduites
</div></th>
</tr>
<tr class="odd">
<th style="text-align: center;" data-quarto-table-cell-role="th">Individu</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">V1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">V2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">i</td>
<td style="text-align: center;">-1,15</td>
<td style="text-align: center;">-1,15</td>
<td style="text-align: center;">0,83</td>
</tr>
<tr class="even">
<td style="text-align: center;">j</td>
<td style="text-align: center;">0,49</td>
<td style="text-align: center;">0,58</td>
<td style="text-align: center;">-1,11</td>
</tr>
<tr class="odd">
<td style="text-align: center;">k</td>
<td style="text-align: center;">0,66</td>
<td style="text-align: center;">0,58</td>
<td style="text-align: center;">0,28</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p><strong>Liaisons entre les variables</strong>. Dans une ACP normée, les liaisons entre les variables deux à deux sont évaluées avec le coefficient de corrélation (<a href="#sec-0431">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-0431</span></a>), soit la moyenne du produit des deux variables centrées réduites (<a href="#eq-ACPcor">équation&nbsp;<span class="quarto-unresolved-ref">eq-ACPcor</span></a>). Notez que dans une ACP non normée, plus rarement utilisée, les liaisons sont évaluées avec la covariance puisque les variables sont uniquement centrées (<a href="#eq-ACPcov">équation&nbsp;<span class="quarto-unresolved-ref">eq-ACPcov</span></a>).</p>
<p><span id="eq-ACPcor"><span class="math display">\[
r_{xy} = \frac{\sum_{i=1}^n (x_{i}-\bar{x})(y_{i}-\bar{y})}{n\sqrt{\sum_{i=1}^n(x_i - \bar{x})^2(y_i - \bar{y})^2}}=\sum_{i=1}^n\frac{Zx_iZy_i}{n}
\tag{12.2}\]</span></span></p>
<p><span id="eq-ACPcov"><span class="math display">\[
cov(x,y) = \frac{\sum_{i=1}^n (x_{i}-\bar{x})(y_{i}-\bar{y})}{n}
\tag{12.3}\]</span></span></p>
<p><strong>Composantes principales</strong>. Au <a href="#sec-chap04">chapitre&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-chap04</span></a>, nous avons abordé deux méthodes pour identifier des relations linéaires entre des variables continues normalement distribuées&nbsp;:</p>
<ul>
<li><p>la corrélation de Pearson (<a href="#sec-043">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-043</span></a>), qu’il est possible d’illustrer graphiquement à partir d’un nuage de points;</p></li>
<li><p>la régression linéaire simple (<a href="#sec-044">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-044</span></a>), permettant de résumer la relation linéaire entre deux variables avec une droite de régression de type <span class="math inline">\(Y=a+bX\)</span>.</p></li>
</ul>
<p>Brièvement, plus deux variables sont corrélées (positivement ou négativement), plus le nuage de points qu’elles forment est allongé et plus les points sont proches de la droite de régression (<a href="#fig-liaisons2Vars">figure&nbsp;<span class="quarto-unresolved-ref">fig-liaisons2Vars</span></a>, partie&nbsp;<strong>a</strong>). À l’inverse, plus la liaison entre les deux variables normalement distribuées est faible, plus le nuage prend la forme d’un cercle et plus les points du nuage sont éloignés de la droite de régression (<a href="#fig-liaisons2Vars">figure&nbsp;<span class="quarto-unresolved-ref">fig-liaisons2Vars</span></a>, partie&nbsp;<strong>b</strong>). Puisqu’en ACP normée, les variables sont centrées réduites, le centre de gravité du nuage de points est (<em>x</em>&nbsp;=&nbsp;0,&nbsp;<em>y</em>&nbsp;=&nbsp;0) et il est toujours traversé par la droite de régression. Finalement, nous avons vu que la méthode des moindres carrés ordinaires (MCO) permet de déterminer cette droite en minimisant les distances entre les valeurs observées et celles projetées orthogonalement sur cette droite (valeurs prédites). Dans le cas de deux variables uniquement, l’axe factoriel principal/la composante principale est donc la droite qui résume le mieux la liaison entre les deux variables (en rouge). L’axe&nbsp;2 représente la seconde plus importante composante (axe, dimension) et il est orthogonal (perpendiculaire) au premier axe (en bleu).</p>
<div id="fig-liaisons2Vars" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap12/bivariePlanFacto.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.3: Corrélation, allongement du nuage de points et axes factoriels</figcaption></figure>
</div>
<p>Imaginez maintenant trois variables pour lesquelles vous désirez identifier un axe, une droite qui résume le mieux les liaisons entre elles. Visuellement, vous passez d’un nuage de points en deux dimensions (2D) à un nuage en dimensions (3D). Si les corrélations entre les trois variables sont très faibles, alors le nuage prend la forme d’un ballon de soccer (football en Europe). Par contre, plus ces liaisons sont fortes, plus la forme est allongée comme un ballon de rugby et plus les points sont proches de l’axe traversant le ballon.</p>
<p>Ajouter une autre variable revient alors à ajouter une quatrième dimension qu’il est impossible de visualiser, même pour les plus fervents adaptes de science-fiction. Pourtant, le problème reste le même&nbsp;: identifier, dans un plan en <em>p</em> dimensions (variables), les axes factoriels –&nbsp;les composantes principales&nbsp;– qui concourent le plus à résumer les liaisons entre les variables continues préalablement centrées réduites, et ce, en utilisant la méthode des moindres carrés ordinaires.</p>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Composantes principales et axes factoriels</strong></p>
</div>
<div class="bloc_attention-body">
<p>Les termes <strong>composantes principales</strong> et <strong>axes factoriels</strong> sont des synonymes employés pour référer aux nouvelles variables synthétiques produites par l’ACP et résumant l’information du tableau initial.</p>
</div>
</div>
</section><section id="sec-1222" class="level3" data-number="12.2.2"><h3 data-number="12.2.2" class="anchored" data-anchor-id="sec-1222">
<span class="header-section-number">12.2.2</span> Aides à l’interprétation</h3>
<p>Pour illustrer les aides à l’interprétation de l’ACP, nous utilisons un jeu de données spatiales tiré d’un article sur l’agglomération lyonnaise en France <span class="citation" data-cites="2021_4">(<a href="#ref-2021_4" role="doc-biblioref">Gelb et Apparicio 2021</a>)</span>. Ce jeu de données comprend dix variables, dont quatre environnementales (EN) et six socioéconomiques (SE), pour les îlots regroupés pour l’information statistique (IRIS) de l’agglomération lyonnaise (<a href="#tbl-dataacp">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dataacp</span></a> et <a href="#fig-datacartoacp">figure&nbsp;<span class="quarto-unresolved-ref">fig-datacartoacp</span></a>). Sur ces dix variables, nous calculons une <strong>ACP normée</strong>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-dataacp" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.3: Statistiques descriptives pour le jeu de données utilisé pour l’ACP</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 34%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Nom</th>
<th style="text-align: left;">Intitulé</th>
<th style="text-align: center;">Type</th>
<th style="text-align: right;">Moy.</th>
<th style="text-align: right;">E.-T.</th>
<th style="text-align: right;">Min.</th>
<th style="text-align: right;">Max.</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lden</td>
<td style="text-align: left;">Lden</td>
<td style="text-align: left;">Bruit routier (Lden dB(A))</td>
<td style="text-align: center;">EN</td>
<td style="text-align: right;">55,6</td>
<td style="text-align: right;">4,9</td>
<td style="text-align: right;">33,9</td>
<td style="text-align: right;">71,7</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO2</td>
<td style="text-align: left;">NO2</td>
<td style="text-align: left;">Dioxyde d’azote (ug/m<sup>3</sup>)</td>
<td style="text-align: center;">EN</td>
<td style="text-align: right;">28,7</td>
<td style="text-align: right;">7,9</td>
<td style="text-align: right;">12,0</td>
<td style="text-align: right;">60,2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PM25</td>
<td style="text-align: left;">PM25</td>
<td style="text-align: left;">Particules fines (PM<span class="math inline">\(_{2,5}\)</span>)</td>
<td style="text-align: center;">EN</td>
<td style="text-align: right;">16,8</td>
<td style="text-align: right;">2,1</td>
<td style="text-align: right;">11,3</td>
<td style="text-align: right;">21,9</td>
</tr>
<tr class="even">
<td style="text-align: left;">VegHautPrt</td>
<td style="text-align: left;">VegHautPrt</td>
<td style="text-align: left;">Canopée (%)</td>
<td style="text-align: center;">EN</td>
<td style="text-align: right;">18,7</td>
<td style="text-align: right;">10,1</td>
<td style="text-align: right;">1,7</td>
<td style="text-align: right;">53,8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct0_14</td>
<td style="text-align: left;">Pct0_14</td>
<td style="text-align: left;">Moins de 15 ans (%)</td>
<td style="text-align: center;">SE</td>
<td style="text-align: right;">18,5</td>
<td style="text-align: right;">5,7</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">54,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_65</td>
<td style="text-align: left;">Pct_65</td>
<td style="text-align: left;">65 ans et plus (%)</td>
<td style="text-align: center;">SE</td>
<td style="text-align: right;">16,2</td>
<td style="text-align: right;">5,9</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">45,1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_Img</td>
<td style="text-align: left;">Pct_Img</td>
<td style="text-align: left;">Immigrants (%)</td>
<td style="text-align: center;">SE</td>
<td style="text-align: right;">14,5</td>
<td style="text-align: right;">9,1</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">59,8</td>
</tr>
<tr class="even">
<td style="text-align: left;">TxChom1564</td>
<td style="text-align: left;">TxChom1564</td>
<td style="text-align: left;">Taux de chômage</td>
<td style="text-align: center;">SE</td>
<td style="text-align: right;">14,8</td>
<td style="text-align: right;">8,1</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">98,8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_brevet</td>
<td style="text-align: left;">Pct_brevet</td>
<td style="text-align: left;">Personnes à faible scolarité (%)</td>
<td style="text-align: center;">SE</td>
<td style="text-align: right;">23,5</td>
<td style="text-align: right;">12,6</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">100,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NivVieMed</td>
<td style="text-align: left;">NivVieMed</td>
<td style="text-align: left;">Médiane du niveau de vie (Euros)</td>
<td style="text-align: center;">SE</td>
<td style="text-align: right;">21 804,5</td>
<td style="text-align: right;">4 922,5</td>
<td style="text-align: right;">11 324,0</td>
<td style="text-align: right;">38 707,0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="fig-datacartoacp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap12/Figure3Data.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.4: Cartographie des dix variables utilisées pour l’ACP</figcaption></figure>
</div>
<div class="bloc_objectif">
<div class="bloc_objectif-header">
<div class="bloc_objectif-icon">

</div>
<p><strong>Trois étapes pour bien analyser une ACP et comprendre la signification des axes factoriels</strong></p>
</div>
<div class="bloc_objectif-body">
<ol type="1">
<li><p>Interprétation des résultats des valeurs propres pour identifier le nombre d’axes (de composantes principales) à retenir. L’enjeu est de garder un nombre d’axes limité qui résume le mieux le tableau initial (réduction des données).</p></li>
<li><p>Analyse des résultats pour les variables (coordonnées factorielles, cosinus carrés et contributions sur les axes retenus).</p></li>
<li><p>Analyse des résultats pour les individus (coordonnées factorielles, cosinus carrés et contributions sur les axes retenus).</p></li>
</ol>
<p>Les deux dernières étapes permettent de comprendre la signification des axes retenus et de les qualifier. Cette étape d’interprétation est essentielle en sciences sociales. En effet, nous avons vu dans l’introduction du chapitre que les méthodes factorielles permettent de résumer l’information d’un tableau en quelques nouvelles variables synthétiques, souvent considérées comme des variables latentes dans le jeu de données. Il convient alors de bien comprendre ces variables synthétiques (latentes), si nous souhaitons les utiliser dans une autre analyse subséquente (par exemple, les introduire dans une régression).</p>
</div>
</div>
<section id="sec-12221" class="level4" data-number="12.2.2.1"><h4 data-number="12.2.2.1" class="anchored" data-anchor-id="sec-12221">
<span class="header-section-number">12.2.2.1</span> Résultats de l’ACP pour les valeurs propres</h4>
<p>À titre de rappel, une ACP normée est réalisée sur des variables préalablement centrées réduites (<a href="#eq-scorezacpnormee">équation&nbsp;<span class="quarto-unresolved-ref">eq-scorezacpnormee</span></a>), ce qui signifie que pour chaque variable&nbsp;:</p>
<ul>
<li>Nous soustrayons à chaque valeur la moyenne de la variable correspondante (centrage); la moyenne est donc égale à&nbsp;0.</li>
<li>Nous divisons cette différence par l’écart-type de la variable correspondante (réduction); la variance est égale à&nbsp;1.</li>
</ul>
<p><span id="eq-scorezacpnormee"><span class="math display">\[
z= \frac{x_i-\mu}{\sigma}
\tag{12.4}\]</span></span></p>
<p>Par conséquent, la variance totale (ou inertie totale) d’un tableau sur lequel est calculée une ACP normée est égale au nombre de variables qu’il comprend. Puisque nous l’appliquons ici à dix variables, la variance totale du tableau à réduire – c’est-à-dire à résumer en <em>K</em> nouvelles variables synthétiques, composantes principales, axes factoriels – est donc égale à 10. Trois mesures reportées au <a href="#tbl-dataacpValeurPropres">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dataacpValeurPropres</span></a> permettent d’analyser les valeurs propres&nbsp;:</p>
<ul>
<li><p><span class="math inline">\(\mbox{VP}_k\)</span>, la valeur propre (<em>eigenvalue</em> en anglais) de l’axe <em>k</em>, c’est-à-dire la quantité de variance du tableau initial résumé par l’axe.</p></li>
<li><p><span class="math inline">\(\mbox{VP}_k / \mbox{P}\)</span> avec <em>P</em> étant le nombre de variables que comprend le tableau initial. Cette mesure représente ainsi le pourcentage de la variance totale du tableau résumé par l’axe <em>k</em>; autrement dit, la quantité d’informations du tableau initial résumée par l’axe, la composante principale <em>k</em>. Cela nous permet ainsi d’évaluer le pouvoir explicatif de l’axe.</p></li>
<li><p>Le pourcentage cumulé pour les axes.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-dataacpValeurPropres" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.4: Résultats de l’ACP pour les valeurs propres</caption>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Composante</th>
<th style="text-align: right;">Valeur propre</th>
<th style="text-align: right;">Pourcentage</th>
<th style="text-align: right;">Pourc. cumulé</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">comp 1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3,543</td>
<td style="text-align: right;">35,425</td>
<td style="text-align: right;">35,425</td>
</tr>
<tr class="even">
<td style="text-align: left;">comp 2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2,760</td>
<td style="text-align: right;">27,596</td>
<td style="text-align: right;">63,021</td>
</tr>
<tr class="odd">
<td style="text-align: left;">comp 3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1,042</td>
<td style="text-align: right;">10,422</td>
<td style="text-align: right;">73,443</td>
</tr>
<tr class="even">
<td style="text-align: left;">comp 4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0,751</td>
<td style="text-align: right;">7,511</td>
<td style="text-align: right;">80,954</td>
</tr>
<tr class="odd">
<td style="text-align: left;">comp 5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0,606</td>
<td style="text-align: right;">6,059</td>
<td style="text-align: right;">87,013</td>
</tr>
<tr class="even">
<td style="text-align: left;">comp 6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0,388</td>
<td style="text-align: right;">3,880</td>
<td style="text-align: right;">90,893</td>
</tr>
<tr class="odd">
<td style="text-align: left;">comp 7</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0,379</td>
<td style="text-align: right;">3,788</td>
<td style="text-align: right;">94,681</td>
</tr>
<tr class="even">
<td style="text-align: left;">comp 8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0,244</td>
<td style="text-align: right;">2,441</td>
<td style="text-align: right;">97,122</td>
</tr>
<tr class="odd">
<td style="text-align: left;">comp 9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0,217</td>
<td style="text-align: right;">2,167</td>
<td style="text-align: right;">99,289</td>
</tr>
<tr class="even">
<td style="text-align: left;">comp 10</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0,071</td>
<td style="text-align: right;">0,711</td>
<td style="text-align: right;">100,000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Avant d’analyser en détail le <a href="#tbl-dataacpValeurPropres">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dataacpValeurPropres</span></a>, notez que la somme des valeurs propres de toutes les composantes de l’ACP est toujours égale au nombre de variables du tableau initial. Aussi, la quantité de variance expliquée (les valeurs propres) décroît de la composante&nbsp;1 à la composante&nbsp;<em>K</em>.</p>
<p><strong>Combien d’axes d’une ACP faut-il retenir?</strong> Pour répondre à cette question, deux approches sont possibles&nbsp;:</p>
<ul>
<li><p><strong>Approche statistique</strong> (avec le critère de Kaiser <span class="citation" data-cites="kaiser1960application">(<a href="#ref-kaiser1960application" role="doc-biblioref">1960</a>)</span>). Nous retenons uniquement les composantes qui présentent une valeur propre supérieure à&nbsp;1. Rappelez-vous qu’en ACP normée, les variables sont préalablement centrées réduites, et donc que leur variance respective est égale à&nbsp;1. Par conséquent, une composante ayant une valeur propre inférieure à&nbsp;1 a un pouvoir explicatif inférieur à celui d’une variable. À la lecture du tableau, nous retenons les trois premières composantes si nous appliquons ce critère.</p></li>
<li><p><strong>Approche empirique</strong> basée sur la lecture des pourcentages et des pourcentages cumulés. Nous pouvons retenir uniquement les deux premières composantes. En effet, ces deux premiers facteurs résument près des deux tiers de la variance totale du tableau (63,02&nbsp;%). Cela démontre bien que l’ACP, comme les autres méthodes factorielles, est bien une méthode de réduction de données puisque nous résumons dix variables avec deux nouvelles variables synthétiques (axes, composantes principales). Pour faciliter le choix du nombre d’axes, il est fortement conseillé de construire des histogrammes à partir des valeurs propres, des pourcentages et des pourcentages cumulés (<a href="#fig-acpgraphvp">figure&nbsp;<span class="quarto-unresolved-ref">fig-acpgraphvp</span></a>). Or, à la lecture de ces graphiques, nous constatons que la variance expliquée chute drastiquement après les deux premières composantes. Par conséquent, nous pouvons retenir uniquement les deux premiers axes.</p></li>
</ul>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>Lecture du diagramme des valeurs propres</strong></p>
</div>
<div class="bloc_astuce-body">
<p>Plus les variables incluses dans l’ACP sont corrélées entre elles, plus l’ACP est intéressante&nbsp;: plus les valeurs propres des premiers axes sont fortes et plus il y a des sauts importants dans le diagramme des valeurs propres. À l’inverse, lorsque les variables incluses dans l’ACP sont peu corrélées entre elles, il n’y a pas de sauts importants dans l’histogramme, autrement dit les valeurs propres sont uniformément décroissantes.</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-acpgraphvp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-acpgraphvp-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.5: Graphiques personnalisés pour les valeurs propres pour l’ACP</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-12222" class="level4" data-number="12.2.2.2"><h4 data-number="12.2.2.2" class="anchored" data-anchor-id="sec-12222">
<span class="header-section-number">12.2.2.2</span> Résultats de l’ACP pour les variables</h4>
<p>Pour qualifier les axes, quatre mesures sont disponibles pour les variables&nbsp;:</p>
<ul>
<li><p><strong>Les coordonnées factorielles des variables</strong> sont simplement les coefficients de corrélation de Pearson des variables sur l’axe <em>k</em> et varient ainsi de -1 à 1 (relire au besoin la <a href="#sec-043">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-043</span></a>). Pour qualifier un axe, il convient alors de repérer les variables les plus corrélées positivement et négativement sur l’axe, autrement dit, de repérer les variables situées aux extrémités l’axe.</p></li>
<li><p><strong>Les cosinus carrés des variables</strong> (Cos<sup>2</sup>) (appelés aussi les qualités de représentation des variables sur un axe) permettent de repérer le ou les axes qui concourent le plus à donner un sens à la variable. Ils sont en fait les coordonnées des variables mises au carré. La somme des cosinus carrés d’une variable sur tous les axes de l’ACP est donc égale à&nbsp;1 (sommation en ligne).</p></li>
<li><p><strong>La qualité de représentation d’une variable sur les <em>n</em> premiers axes</strong> est simplement la somme des cosinus carrés d’une variable sur les axes retenus. Par exemple, pour la variable <code>Lden</code>, la qualité de représentation de la variable sur le premier axe est égale&nbsp;: <span class="math inline">\(\mbox{0,42}^2=\mbox{0,17}\)</span>. Pour cette même variable, la qualité de la <code>Lden</code> sur les trois premiers axes est égale à&nbsp;: <span class="math inline">\(\mbox{0,17}+\mbox{0,32}+\mbox{0,26}=\mbox{0,75}\)</span>.</p></li>
<li><p><strong>Les contributions des variables</strong> permettent de repérer celles qui participent le plus à la formation d’un axe. Elles s’obtiennent en divisant les cosinus carrés par la valeur propre de l’axe multiplié par 100. La somme des contributions des variables pour un axe donné est donc égale à 100 (sommation en colonne). Par exemple, pour la variable <code>Lden</code>, la contribution sur le premier axe est égale&nbsp;: <span class="math inline">\(\mbox{0,174} / \mbox{3,543} \times \mbox{100}= \mbox{4,920 }%\)</span>.</p></li>
</ul>
<p>Les résultats de l’ACP pour les variables sont présentés au <a href="#tbl-dataacpCoordVars">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dataacpCoordVars</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-dataacpCoordVars" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.5: Résultats de l’ACP pour les variables</caption>
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Coordonnées
</div></th>
<th colspan="4" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cosinus carrés
</div></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Contributions
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Qualité</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lden</td>
<td style="text-align: right;">0,42</td>
<td style="text-align: right;">0,57</td>
<td style="text-align: right;">0,51</td>
<td style="text-align: right;">0,17</td>
<td style="text-align: right;">0,32</td>
<td style="text-align: right;">0,26</td>
<td style="text-align: right;">0,75</td>
<td style="text-align: right;">4,92</td>
<td style="text-align: right;">11,64</td>
<td style="text-align: right;">24,80</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO2</td>
<td style="text-align: right;">0,15</td>
<td style="text-align: right;">0,93</td>
<td style="text-align: right;">0,19</td>
<td style="text-align: right;">0,02</td>
<td style="text-align: right;">0,86</td>
<td style="text-align: right;">0,04</td>
<td style="text-align: right;">0,92</td>
<td style="text-align: right;">0,66</td>
<td style="text-align: right;">31,07</td>
<td style="text-align: right;">3,54</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PM25</td>
<td style="text-align: right;">0,19</td>
<td style="text-align: right;">0,92</td>
<td style="text-align: right;">0,03</td>
<td style="text-align: right;">0,04</td>
<td style="text-align: right;">0,84</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,87</td>
<td style="text-align: right;">1,01</td>
<td style="text-align: right;">30,36</td>
<td style="text-align: right;">0,12</td>
</tr>
<tr class="even">
<td style="text-align: left;">VegHautPrt</td>
<td style="text-align: right;">-0,40</td>
<td style="text-align: right;">-0,42</td>
<td style="text-align: right;">0,40</td>
<td style="text-align: right;">0,16</td>
<td style="text-align: right;">0,18</td>
<td style="text-align: right;">0,16</td>
<td style="text-align: right;">0,50</td>
<td style="text-align: right;">4,63</td>
<td style="text-align: right;">6,35</td>
<td style="text-align: right;">15,46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct0_14</td>
<td style="text-align: right;">0,55</td>
<td style="text-align: right;">-0,53</td>
<td style="text-align: right;">0,08</td>
<td style="text-align: right;">0,30</td>
<td style="text-align: right;">0,28</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,59</td>
<td style="text-align: right;">8,61</td>
<td style="text-align: right;">10,28</td>
<td style="text-align: right;">0,55</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_65</td>
<td style="text-align: right;">-0,41</td>
<td style="text-align: right;">-0,27</td>
<td style="text-align: right;">0,72</td>
<td style="text-align: right;">0,17</td>
<td style="text-align: right;">0,07</td>
<td style="text-align: right;">0,51</td>
<td style="text-align: right;">0,75</td>
<td style="text-align: right;">4,73</td>
<td style="text-align: right;">2,66</td>
<td style="text-align: right;">49,26</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_Img</td>
<td style="text-align: right;">0,87</td>
<td style="text-align: right;">-0,09</td>
<td style="text-align: right;">0,11</td>
<td style="text-align: right;">0,76</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,78</td>
<td style="text-align: right;">21,56</td>
<td style="text-align: right;">0,29</td>
<td style="text-align: right;">1,08</td>
</tr>
<tr class="even">
<td style="text-align: left;">TxChom1564</td>
<td style="text-align: right;">0,77</td>
<td style="text-align: right;">-0,09</td>
<td style="text-align: right;">-0,07</td>
<td style="text-align: right;">0,60</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,61</td>
<td style="text-align: right;">16,89</td>
<td style="text-align: right;">0,27</td>
<td style="text-align: right;">0,45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_brevet</td>
<td style="text-align: right;">0,73</td>
<td style="text-align: right;">-0,43</td>
<td style="text-align: right;">0,22</td>
<td style="text-align: right;">0,53</td>
<td style="text-align: right;">0,19</td>
<td style="text-align: right;">0,05</td>
<td style="text-align: right;">0,77</td>
<td style="text-align: right;">14,94</td>
<td style="text-align: right;">6,81</td>
<td style="text-align: right;">4,61</td>
</tr>
<tr class="even">
<td style="text-align: left;">NivVieMed</td>
<td style="text-align: right;">-0,88</td>
<td style="text-align: right;">0,09</td>
<td style="text-align: right;">0,04</td>
<td style="text-align: right;">0,78</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,79</td>
<td style="text-align: right;">22,06</td>
<td style="text-align: right;">0,28</td>
<td style="text-align: right;">0,14</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p><strong>Analyse de la première composante principale (valeur propre de 3,54, 35,43&nbsp;%)</strong></p>
<ul>
<li><p>À la lecture des contributions, il est clair que quatre variables contribuent grandement à la formation de l’axe&nbsp;1&nbsp;: <code>NivVieMed</code> (22,06&nbsp;%), <code>Pct_Img</code> (21,56&nbsp;%), <code>TxChom1564</code> (16,89&nbsp;%) et <code>Pct_brevet</code> (14,94&nbsp;%). Il convient alors d’analyser en détail leurs coordonnées factorielles et leurs cosinus carrés.</p></li>
<li><p>À la lecture des coordonnées factorielles, nous constatons que trois variables socioéconomiques sont fortement corrélées positivement avec l’axe&nbsp;1, soit le <em>pourcentage d’immigrants</em> (0,87), le <em>taux de chômage</em> (0,77) et le <em>pourcentage de personnes avec une faible scolarité</em> (0,73). À l’autre extrémité, la <em>médiane du niveau de vie</em> (en euros) est négativement corrélée avec l’axe&nbsp;1. Comment interpréter ce résultat? Premièrement, cela signifie que plus la valeur de l’axe 1 est positive et élevée, plus celles des trois variables (<code>Pct_Img</code>,<code>TxChom1564</code> et <code>Pct_brevet</code>) sont aussi élevées (corrélations positives) et plus la valeur de <code>NivVieMed</code> est faible (corrélation négative). Inversement, plus la valeur de l’axe&nbsp;1 est négative et faible, les valeurs de <code>Pct_Img</code>, <code>TxChom1564</code> et <code>Pct_brevet</code> sont faibles et plus celle de <code>NivVieMed</code> est forte. Deuxièmement, cela signifie que les trois variables (<code>Pct_Img</code>,<code>TxChom1564</code> et <code>Pct_brevet</code>) sont fortement corrélées positivement entre elles puisqu’elles se situent sur la même extrémité de l’axe et qu’elles sont toutes trois négativement corrélées avec la variable <code>NivVieMed</code>. Cela peut être rapidement confirmé avec la matrice de corrélation entre les dix variables (<a href="#tbl-dataacpMatriceCorr">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dataacpMatriceCorr</span></a>).</p></li>
<li><p>À la lecture des cosinus carrés de l’axe&nbsp;1, nous constatons que plus des trois quarts de la dispersion/de l’information des variables <code>NivVieMed</code> (0,78) et <code>Pct_Img</code> (0,76) est concentrée sur l’axe&nbsp;1.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-dataacpMatriceCorr" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.6: Matrice de corrélation de Pearson entre les variables utilisées pour l’ACP</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">A</th>
<th style="text-align: right;">B</th>
<th style="text-align: right;">C</th>
<th style="text-align: right;">D</th>
<th style="text-align: right;">E</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">G</th>
<th style="text-align: right;">H</th>
<th style="text-align: right;">I</th>
<th style="text-align: right;">J</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lden</td>
<td style="text-align: left;">A. Lden</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0,62</td>
<td style="text-align: right;">0,49</td>
<td style="text-align: right;">-0,23</td>
<td style="text-align: right;">0,04</td>
<td style="text-align: right;">-0,09</td>
<td style="text-align: right;">0,28</td>
<td style="text-align: right;">0,19</td>
<td style="text-align: right;">0,14</td>
<td style="text-align: right;">-0,26</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO2</td>
<td style="text-align: left;">B. NO2</td>
<td style="text-align: right;">0,62</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0,90</td>
<td style="text-align: right;">-0,28</td>
<td style="text-align: right;">-0,34</td>
<td style="text-align: right;">-0,21</td>
<td style="text-align: right;">0,07</td>
<td style="text-align: right;">0,04</td>
<td style="text-align: right;">-0,25</td>
<td style="text-align: right;">-0,04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PM25</td>
<td style="text-align: left;">C. PM25</td>
<td style="text-align: right;">0,49</td>
<td style="text-align: right;">0,90</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">-0,39</td>
<td style="text-align: right;">-0,34</td>
<td style="text-align: right;">-0,26</td>
<td style="text-align: right;">0,12</td>
<td style="text-align: right;">0,07</td>
<td style="text-align: right;">-0,25</td>
<td style="text-align: right;">-0,10</td>
</tr>
<tr class="even">
<td style="text-align: left;">VegHautPrt</td>
<td style="text-align: left;">D. VegHautPrt</td>
<td style="text-align: right;">-0,23</td>
<td style="text-align: right;">-0,28</td>
<td style="text-align: right;">-0,39</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0,04</td>
<td style="text-align: right;">0,32</td>
<td style="text-align: right;">-0,22</td>
<td style="text-align: right;">-0,18</td>
<td style="text-align: right;">-0,14</td>
<td style="text-align: right;">0,32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct0_14</td>
<td style="text-align: left;">E. Pct0_14</td>
<td style="text-align: right;">0,04</td>
<td style="text-align: right;">-0,34</td>
<td style="text-align: right;">-0,34</td>
<td style="text-align: right;">0,04</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">-0,12</td>
<td style="text-align: right;">0,46</td>
<td style="text-align: right;">0,36</td>
<td style="text-align: right;">0,54</td>
<td style="text-align: right;">-0,45</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_65</td>
<td style="text-align: left;">F. Pct_65</td>
<td style="text-align: right;">-0,09</td>
<td style="text-align: right;">-0,21</td>
<td style="text-align: right;">-0,26</td>
<td style="text-align: right;">0,32</td>
<td style="text-align: right;">-0,12</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">-0,24</td>
<td style="text-align: right;">-0,30</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_Img</td>
<td style="text-align: left;">G. Pct_Img</td>
<td style="text-align: right;">0,28</td>
<td style="text-align: right;">0,07</td>
<td style="text-align: right;">0,12</td>
<td style="text-align: right;">-0,22</td>
<td style="text-align: right;">0,46</td>
<td style="text-align: right;">-0,24</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0,66</td>
<td style="text-align: right;">0,64</td>
<td style="text-align: right;">-0,73</td>
</tr>
<tr class="even">
<td style="text-align: left;">TxChom1564</td>
<td style="text-align: left;">H. TxChom1564</td>
<td style="text-align: right;">0,19</td>
<td style="text-align: right;">0,04</td>
<td style="text-align: right;">0,07</td>
<td style="text-align: right;">-0,18</td>
<td style="text-align: right;">0,36</td>
<td style="text-align: right;">-0,30</td>
<td style="text-align: right;">0,66</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0,47</td>
<td style="text-align: right;">-0,62</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_brevet</td>
<td style="text-align: left;">I. Pct_brevet</td>
<td style="text-align: right;">0,14</td>
<td style="text-align: right;">-0,25</td>
<td style="text-align: right;">-0,25</td>
<td style="text-align: right;">-0,14</td>
<td style="text-align: right;">0,54</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,64</td>
<td style="text-align: right;">0,47</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">-0,67</td>
</tr>
<tr class="even">
<td style="text-align: left;">NivVieMed</td>
<td style="text-align: left;">J. NivVieMed</td>
<td style="text-align: right;">-0,26</td>
<td style="text-align: right;">-0,04</td>
<td style="text-align: right;">-0,10</td>
<td style="text-align: right;">0,32</td>
<td style="text-align: right;">-0,45</td>
<td style="text-align: right;">0,32</td>
<td style="text-align: right;">-0,73</td>
<td style="text-align: right;">-0,62</td>
<td style="text-align: right;">-0,67</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><strong>Analyse de la deuxième composante principale (valeur propre de 2,76, 27,60&nbsp;%)</strong></p>
<ul>
<li><p>À la lecture des contributions, trois variables environnementales contribuent à la formation de l’axe&nbsp;2&nbsp;: principalement, celles sur la pollution de l’air (<code>NO2</code>&nbsp;=&nbsp;31,07&nbsp;% et <code>PM25</code>&nbsp;=&nbsp;30,36&nbsp;%) et secondairement, celle sur le bruit routier (<code>Lden</code>&nbsp;=&nbsp;11,64&nbsp;%).</p></li>
<li><p>À la lecture des coordonnées factorielles, ces trois variables sont fortement corrélées positivement avec l’axe 2&nbsp;: <code>NO2</code> (0,93), <code>PM25</code> (0,92) et <code>Lden</code> (0,57). À l’autre extrémité de l’axe, la variable <code>Pct0_14</code> est négativement, mais pas fortement, corrélée (-0,53). La lecture de la matrice de corrélation au <a href="#tbl-dataacpMatriceCorr">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dataacpMatriceCorr</span></a> confirme que ces trois variables environnementales sont fortement corrélées positivement entre elles (par exemple, un coefficient de corrélation de Pearson de 0,90 entre <code>NO2</code> et <code>PM25</code>).</p></li>
<li><p>À la lecture des cosinus carrés de l’axe&nbsp;2, nous constatons que près de 90&nbsp;% de la dispersion/de l’information des variables <code>NO2</code> (0,86) et <code>PM25</code> (0,84) est concentrée sur l’axe&nbsp;2.</p></li>
</ul>
<p><strong>Analyse de la troisième composante principale (valeur propre de 1,042, 10,42&nbsp;%)</strong></p>
<ul>
<li>Le <em>pourcentage de personnes âgées</em> (<code>Pct_65</code>) contribue principalement à la formation de l’axe&nbsp;3 avec lequel il est corrélé positivement (contribution de 49,26&nbsp;% et coordonnée factorielle de 0,72). S’en suit la variable <code>Lden</code>, qui joue un rôle beaucoup moins important (contribution de 24,80&nbsp;% et coordonnée factorielle de 0,51).</li>
</ul>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>Lien entre la valeur propre d’un axe et le nombre de variables contribuant à sa formation</strong></p>
</div>
<div class="bloc_astuce-body">
<p>Vous auvez compris que plus la valeur propre d’un axe est forte, plus il y a potentiellement de variables qui concourent à sa formation. Cela explique que pour la troisième composante, qui a une faible valeur propre (1,042), seule une variable contribue significativement à sa formation.</p>
</div>
</div>
<p><strong>Analyse de la qualité de représentation des variables sur les premiers axes de l’ACP</strong></p>
<p>À titre de rappel, la qualité est simplement la somme des cosinus carrés d’une variable sur les axes retenus. Si nous retenons trois axes, les six variables qui sont le mieux résumées –&nbsp;et qui ont donc le plus d’influence sur les résultats de l’ACP&nbsp;– sont &nbsp;: <code>NO2</code> (0,92), <code>PM25</code> (0,87), <code>NivVieMed</code> (0,79), <code>Pct_Img</code> (0,78), <code>Pct_brevet</code> (0,77) et <code>Lden</code> (0,75).</p>
<p><strong>Qualification, dénomination d’axes factoriels</strong></p>
<p>L’analyse des coordonnées, des contributions et des cosinus carrés doit vous permettre de formuler un intitulé pour chacun des axes retenus. Nous vous proposons les intitulés suivants&nbsp;:</p>
<ul>
<li><p><em>Niveau de défavorisation socioéconomique</em> (axe&nbsp;1). Plus la valeur de l’axe est élevée, plus le niveau de défavorisation de l’entité spatiale (IRIS) est élevé.</p></li>
<li><p><em>Qualité environnementale</em> (axe&nbsp;2). Plus la valeur de l’axe est forte, plus les niveaux de pollution atmosphérique (dioxyde d’azote et particules fines) et de bruit (Lden) sont élevés.</p></li>
</ul>
<p><strong>Recours à des graphiques pour analyser les résultats de l’ACP pour des variables</strong></p>
<p>Plus le nombre de variables utilisées pour calculer l’ACP est important, plus l’analyse des coordonnées factorielles, des cosinus carrés et des contributions reportés dans un tableau devient fastidieuse. Puisque l’ACP a été calculée sur dix variables, l’analyse des valeurs du <a href="#tbl-dataacpCoordVars">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dataacpCoordVars</span></a> a été assez facile et rapide. Imaginez maintenant que nous réalisons une ACP sur une centaine de variables, la taille du tableau des résultats pour les variables sera considérable… Par conséquent, il est recommandé de construire plusieurs graphiques qui facilitent l’analyse des résultats pour les variables.</p>
<p>Par exemple, à la <a href="#fig-acpgraphvarscoords">figure&nbsp;<span class="quarto-unresolved-ref">fig-acpgraphvarscoords</span></a>, nous avons construit des graphiques avec les coordonnées factorielles sur les trois premiers axes de l’ACP. En un coup d’œil, il est facile de repérer les variables les plus corrélées positivement ou négativement avec chacun d’entre eux. Aussi, il est fréquent de construire un nuage de points avec les coordonnées des variables sur les deux premiers axes factoriels, soit un graphique communément appelé <strong>nuage de points des variables sur le premier plan factoriel</strong> sur lequel est représenté le cercle des corrélations (<a href="#fig-acp1erplanfactVars">figure&nbsp;<span class="quarto-unresolved-ref">fig-acp1erplanfactVars</span></a>). Bien entendu, cet exercice peut être fait avec d’autres axes factoriels (les axes 3 et 4 par exemple).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-acpgraphvarscoords" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-acpgraphvarscoords-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.6: Coordonnées factorielles des variables</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-quietly="true">
<div class="cell-output-display">
<div id="fig-acp1erplanfactVars" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-acp1erplanfactVars-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.7: Premier plan factoriel de l’ACP pour les variables</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-12223" class="level4" data-number="12.2.2.3"><h4 data-number="12.2.2.3" class="anchored" data-anchor-id="sec-12223">
<span class="header-section-number">12.2.2.3</span> Résultats de l’ACP pour les individus</h4>
<p>Comme pour les variables, nous retrouvons les mêmes mesures pour les individus&nbsp;: les coordonnées factorielles, les cosinus carrés et les contributions. Les coordonnées factorielles des individus sont les projections orthogonales des observations sur l’axe. Puisqu’en ACP normée, les variables utilisées pour l’ACP sont centrées réduites, la moyenne des coordonnées factorielles des individus pour un axe est toujours égale à zéro. En revanche, contrairement aux coordonnées factorielles pour les variables, les coordonnées pour les individus ne varient pas de -1 à 1! Les cosinus carrés quantifient à quel point chaque axe représente chaque individu. Enfin, les contributions quantifient l’apport de chaque individu à la formation d’un axe.</p>
<p>Si le jeu de données comprend peu d’observations, il est toujours possible de créer un <strong>nuage de points des individus sur le premier plan factoriel</strong> sur lequel vous pouvez ajouter les étiquettes permettant d’identifier les observations (<a href="#fig-acp1erplanfactIndiv">figure&nbsp;<span class="quarto-unresolved-ref">fig-acp1erplanfactIndiv</span></a>). Ce graphique est rapidement illisible lorsque le nombre d’observations est important. Il peut rester utile si certaines des observations du jeu de données doivent faire l’objet d’une analyse spécifique.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-acp1erplanfactIndiv" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-acp1erplanfactIndiv-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.8: Premier plan factoriel pour les individus</figcaption></figure>
</div>
</div>
</div>
<p>Lorsque les observations sont des unités spatiales, il est très intéressant de cartographier les coordonnées factorielles des individus (<a href="#fig-acp1erplanfactIndiv">figure&nbsp;<span class="quarto-unresolved-ref">fig-acp1erplanfactIndiv</span></a>). À la lecture de la carte choroplèthe de gauche (axe 1), nous pouvons constater que le niveau de défavorisation socioéconomique est élevé dans l’est (IRIS en vert), et inversement, très faible à l’ouest de l’agglomération (IRIS en rouge). À la lecture de la carte de droite (axe 2), sans surprise, la partie centrale de l’agglomération est caractérisée par des niveaux de pollution atmosphérique et de bruit routier bien plus élevés qu’en périphérie.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-acpcartoindiv" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-acpcartoindiv-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.9: Cartographie des coordonnées factorielles des individus</figcaption></figure>
</div>
</div>
</div>
<div class="bloc_aller_loin">
<div class="bloc_aller_loin-header">
<div class="bloc_aller_loin-icon">

</div>
<p><strong>Autres éléments intéressants de l’ACP</strong></p>
</div>
<div class="bloc_aller_loin-body">
<p><strong>Ajout de variables ou d’individus supplémentaires</strong></p>
<p>Premièrement, il est possible d’ajouter des variables continues ou des individus supplémentaires qui n’ont pas été pris en compte dans le calcul de l’ACP (<a href="#fig-acpvarindcorrsuppl">figure&nbsp;<span class="quarto-unresolved-ref">fig-acpvarindcorrsuppl</span></a>). Concernant les variables continues supplémentaires, il s’agit simplement de calculer leurs corrélations avec les axes retenus de l’ACP. Concernant les individus, il s’agit de les projeter sur les axes factoriels. Pour plus d’informations sur le sujet, consultez les excellents ouvrages de Ludovic Lebart, Alain Morineau et Marie Piron <span class="citation" data-cites="lebart1995statistique">(<a href="#ref-lebart1995statistique" role="doc-biblioref">1995, 42‑45</a>)</span> ou encore de Jérôme Pagès <span class="citation" data-cites="pages2013analyse">(<a href="#ref-pages2013analyse" role="doc-biblioref">2013, 22‑24</a>)</span>.</p>
<div id="fig-acpvarindcorrsuppl" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap12/AcpIndVarSuppl.png" class="img-fluid figure-img" style="width:28.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.10: Variables et individus supplémentaires pour l’ACP</figcaption></figure>
</div>
<p><strong>Pondération des individus et des variables</strong></p>
<p>Deuxièmement, il est possible de pondérer à la fois les individus et, plus rarement, les variables lors du calcul de l’ACP.</p>
<p><strong>Analyse en composantes principales non paramétrique</strong></p>
<p>Troisièmement, il est possible de calculer une ACP sur des variables préalablement transformées en rang (<a href="#sec-02552">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-02552</span></a>). Cela peut être justifié lorsque les variables sont très anormalement distribuées en raison de valeurs extrêmes. Les coordonnées factorielles pour les variables sont alors le coefficient de Spearman (<a href="#sec-0433">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-0433</span></a>) et non de Pearson. Aussi, les variables sont centrées non pas sur leurs moyennes respectives, mais sur leurs médianes. Pour plus d’informations sur cette approche, consultez de nouveau Lebart et al. <span class="citation" data-cites="lebart1995statistique">(<a href="#ref-lebart1995statistique" role="doc-biblioref">1995, 51‑52</a>)</span>.</p>
<p><strong>Analyse en composantes principales robuste</strong></p>
<p>Finalement, d’autres méthodes plus avancées qu’une ACP non paramétrique peuvent être utilisées afin d’obtenir des composantes principales qui ne sont pas influencées par des valeurs extrêmes&nbsp;: les ACP robustes <span class="citation" data-cites="rivest1988analyse hubert2005robpca">(<a href="#ref-rivest1988analyse" role="doc-biblioref">Rivest et Plante 1988</a>; <a href="#ref-hubert2005robpca" role="doc-biblioref">Hubert, Rousseeuw et Vanden Branden 2005</a>)</span> qui peuvent être mises en œuvre, entre autres avec le <em>package</em> <code>roscpca</code>.</p>
</div>
</div>
</section></section><section id="sec-1223" class="level3" data-number="12.2.3"><h3 data-number="12.2.3" class="anchored" data-anchor-id="sec-1223">
<span class="header-section-number">12.2.3</span> Mise en œuvre dans R</h3>
<p>Plusieurs <em>packages</em> permettent de calculer une ACP dans R, notamment <code>psych</code> avec la fonction <code>principal</code>, <code>ade4</code> avec la fonction <code>dudi.pca</code> et <code>FactoMineR</code><span class="citation" data-cites="FactoMineR">(<a href="#ref-FactoMineR" role="doc-biblioref">Lê, Josse et Husson 2008</a>)</span> avec la fonction <code>PCA</code>. Ce dernier est certainement le plus abouti. De plus, il permet également de calculer une analyse des correspondances (AFC), une analyse des correspondances multiples (ACM) et une analyse factorielle de données mixtes (AFDM). Nous utilisons donc <code>FactoMineR</code> pour mettre en œuvre les trois types de méthodes factorielles abordées dans ce chapitre (ACP, AFC et ACM). Pour l’ACP, nous exploitons un jeu de données issu du <em>package</em> <code>geocmeans</code> qu’il faut préalablement charger à l’aide des lignes de code suivantes.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JeremyGelb/geocmeans">geocmeans</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">)</span></span>
<span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu">st_drop_geometry</span><span class="op">(</span><span class="va">LyonIris</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CODE_IRIS"</span> , <span class="st">"Lden"</span> , <span class="st">"NO2"</span> , <span class="st">"PM25"</span> , <span class="st">"VegHautPrt"</span>,</span>
<span>                        <span class="st">"Pct0_14"</span> , <span class="st">"Pct_65"</span> , <span class="st">"Pct_Img"</span>,</span>
<span>                        <span class="st">"TxChom1564"</span> , <span class="st">"Pct_brevet"</span> , <span class="st">"NivVieMed"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sec-12231" class="level4" data-number="12.2.3.1"><h4 data-number="12.2.3.1" class="anchored" data-anchor-id="sec-12231">
<span class="header-section-number">12.2.3.1</span> Calcul et exploration d’une ACP avec <code>FactoMineR</code>
</h4>
<p>Pour calculer l’ACP, il suffit d’utiliser la fonction <code>PCA</code> de <code>FactoMineR</code>, puis la fonction <code>summary(MonACP)</code> qui renvoie les résultats de l’ACP pour&nbsp;:</p>
<ul>
<li><p>Les valeurs propres (section <code>Eigenvalues</code>) pour les composantes principales (<code>Dim.1</code> à <code>Dim.n</code>) avec leur variance expliquée brute (<code>Variance</code>) en pourcentage (<code>% of var.</code>) et en pourcentage cumulé (<code>Cumulative % of var.</code>).</p></li>
<li><p>Les dix premières observations (section <code>Individuals</code>) avec les coordonnées factorielles (<code>Dim.1</code> à <code>Dim.n</code>), les contributions (<code>ctr</code>) et les cosinus carrés (<code>cos2</code>). Pour accéder aux résultats pour toutes les observations, utilisez les fonctions <code>res.acp$ind</code> ou encore <code>res.acp$ind$coord</code> (uniquement les coordonnées factorielles), <code>res.acp$ind$contrib</code> (uniquement les contributions) et <code>res.acp$ind$cos2</code> (uniquement les cosinus carrés).</p></li>
<li><p>Les variables (section <code>Variables</code>) avec les coordonnées factorielles (<code>Dim.1</code> à <code>Dim.n</code>), les contributions (<code>ctr</code>) et les cosinus carrés (<code>cos2</code>).</p></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op">)</span></span>
<span><span class="co"># Version classique avec FactoMineR</span></span>
<span><span class="co"># Construction d'une ACP sur les colonnes 2 à 11 du DataFrame Data</span></span>
<span><span class="va">res.acp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, scale.unit <span class="op">=</span> <span class="cn">TRUE</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Affichage des résultats de la fonction PCA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">res.acp</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>**Results for the Principal Component Analysis (PCA)**
The analysis was performed on 506 individuals, described by 10 variables
*The results are available in the following objects:

   name               description                          
1  "$eig"             "eigenvalues"                        
2  "$var"             "results for the variables"          
3  "$var$coord"       "coord. for the variables"           
4  "$var$cor"         "correlations variables - dimensions"
5  "$var$cos2"        "cos2 for the variables"             
6  "$var$contrib"     "contributions of the variables"     
7  "$ind"             "results for the individuals"        
8  "$ind$coord"       "coord. for the individuals"         
9  "$ind$cos2"        "cos2 for the individuals"           
10 "$ind$contrib"     "contributions of the individuals"   
11 "$call"            "summary statistics"                 
12 "$call$centre"     "mean of the variables"              
13 "$call$ecart.type" "standard error of the variables"    
14 "$call$row.w"      "weights for the individuals"        
15 "$call$col.w"      "weights for the variables"          </code></pre>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Résumé des résultats (valeurs propres, individus, variables)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res.acp</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
PCA(X = Data[, 2:11], scale.unit = TRUE, graph = FALSE) 


Eigenvalues
                       Dim.1   Dim.2   Dim.3   Dim.4   Dim.5   Dim.6   Dim.7
Variance               3.543   2.760   1.042   0.751   0.606   0.388   0.379
% of var.             35.425  27.596  10.422   7.511   6.059   3.880   3.788
Cumulative % of var.  35.425  63.021  73.443  80.954  87.013  90.893  94.681
                       Dim.8   Dim.9  Dim.10
Variance               0.244   0.217   0.071
% of var.              2.441   2.167   0.711
Cumulative % of var.  97.122  99.289 100.000

Individuals (the 10 first)
               Dist    Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3
1          |  3.054 |  1.315  0.096  0.185 | -2.515  0.453  0.678 |  0.221
2          |  1.882 |  0.193  0.002  0.011 | -1.744  0.218  0.859 |  0.082
3          |  2.820 |  2.338  0.305  0.687 | -0.860  0.053  0.093 | -0.765
4          |  2.816 | -0.740  0.031  0.069 |  2.265  0.367  0.647 |  1.293
5          |  3.210 | -2.208  0.272  0.473 | -1.597  0.183  0.248 |  1.471
6          |  3.016 |  2.287  0.292  0.575 | -1.515  0.164  0.252 |  0.390
7          |  3.022 | -1.540  0.132  0.260 | -1.803  0.233  0.356 |  0.465
8          |  3.122 | -1.536  0.132  0.242 | -2.038  0.298  0.426 | -0.120
9          |  4.743 | -3.930  0.862  0.687 | -1.806  0.234  0.145 |  0.993
10         |  3.055 |  2.713  0.411  0.789 |  0.368  0.010  0.014 | -0.391
              ctr   cos2  
1           0.009  0.005 |
2           0.001  0.002 |
3           0.111  0.074 |
4           0.317  0.211 |
5           0.411  0.210 |
6           0.029  0.017 |
7           0.041  0.024 |
8           0.003  0.001 |
9           0.187  0.044 |
10          0.029  0.016 |

Variables
              Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3    ctr   cos2
Lden       |  0.417  4.920  0.174 |  0.567 11.640  0.321 |  0.508 24.799  0.258
NO2        |  0.153  0.657  0.023 |  0.926 31.068  0.857 |  0.192  3.540  0.037
PM25       |  0.189  1.007  0.036 |  0.915 30.355  0.838 |  0.035  0.117  0.001
VegHautPrt | -0.405  4.630  0.164 | -0.419  6.353  0.175 |  0.401 15.459  0.161
Pct0_14    |  0.552  8.605  0.305 | -0.533 10.281  0.284 |  0.076  0.553  0.006
Pct_65     | -0.409  4.730  0.168 | -0.271  2.658  0.073 |  0.716 49.258  0.513
Pct_Img    |  0.874 21.559  0.764 | -0.089  0.288  0.008 |  0.106  1.077  0.011
TxChom1564 |  0.774 16.893  0.598 | -0.086  0.267  0.007 | -0.068  0.450  0.005
Pct_brevet |  0.727 14.936  0.529 | -0.434  6.813  0.188 |  0.219  4.612  0.048
NivVieMed  | -0.884 22.062  0.782 |  0.088  0.278  0.008 |  0.038  0.136  0.001
            
Lden       |
NO2        |
PM25       |
VegHautPrt |
Pct0_14    |
Pct_65     |
Pct_Img    |
TxChom1564 |
Pct_brevet |
NivVieMed  |</code></pre>
</div>
</div>
<p>Avec les fonctions de base <code>barplot</code> et <code>plot</code>, il est possible de construire rapidement des graphiques pour explorer les résultats de l’ACP pour les valeurs propres, les variables et les individus.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Graphiques pour les valeurs propres</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">res.acp</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, main<span class="op">=</span><span class="st">"Valeurs propres"</span>, names.arg<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">res.acp</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12-AnalysesFactorielles_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">res.acp</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, main<span class="op">=</span><span class="st">"Variance expliquée (%)"</span>, names.arg<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">res.acp</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12-AnalysesFactorielles_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">res.acp</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, main<span class="op">=</span><span class="st">"Variance expliquée cumulée (%)"</span>,</span>
<span>        names.arg<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">res.acp</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12-AnalysesFactorielles_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Nuage du points du premier plan factoriel pour les variables et les individus</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">res.acp</span>, graph.type <span class="op">=</span> <span class="st">"classic"</span>, choix <span class="op">=</span> <span class="st">"var"</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, </span>
<span>     title <span class="op">=</span> <span class="st">"Premier plan factoriel (variables)"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12-AnalysesFactorielles_files/figure-html/unnamed-chunk-15-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">res.acp</span>, graph.type <span class="op">=</span> <span class="st">"classic"</span>, choix <span class="op">=</span> <span class="st">"ind"</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, </span>
<span>     title <span class="op">=</span> <span class="st">"Premier plan factoriel (individus)"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="12-AnalysesFactorielles_files/figure-html/unnamed-chunk-15-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="bloc_aller_loin">
<div class="bloc_aller_loin-header">
<div class="bloc_aller_loin-icon">

</div>
<p><strong>Pondérations pour les individus et les variables</strong></p>
</div>
<div class="bloc_aller_loin-body">
<p>Nous avons vu, dans un encadré ci-dessus, qu’il est possible d’ajouter des variables et des individus supplémentaires dans une ACP, ce que permet la fonction <code>PCA</code> de <code>FactoMineR</code> avec les paramètres <code>ind.sup</code> et <code>quanti.sup</code>. Aussi, pour ajouter des pondérations aux individus ou aux variables, utilisez les paramètres <code>row.w</code> et <code>col.w</code>. Pour plus d’informations sur ces paramètres, consulter l’aide de la fonction en tapant <code><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">?PCA</a></code> dans la console de RStudio.</p>
</div>
</div>
</section><section id="sec-12232" class="level4" data-number="12.2.3.2"><h4 data-number="12.2.3.2" class="anchored" data-anchor-id="sec-12232">
<span class="header-section-number">12.2.3.2</span> Exploration graphique des résultats de l’ACP avec <code>factoextra</code>
</h4>
<p>Visuellement, vous avez pu constater que les graphiques ci-dessus (pour les valeurs propres et pour le premier plan factoriel pour les variables et les individus), réalisés avec les fonctions de base <code>barplot</code> et <code>plot</code>, sont peu attrayants. Avec le <em>package</em> <code>factoextra</code>, quelques lignes de code suffissent pour construire des graphiques bien plus esthétiques.</p>
<p>Premièrement, la syntaxe ci-dessous renvoie deux graphiques pour analyser les résultats des valeurs propres (<a href="#fig-factoextra1">figure&nbsp;<span class="quarto-unresolved-ref">fig-factoextra1</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Graphiques pour les variables propres avec factoextra</span></span>
<span><span class="va">G1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eigenvalue.html">fviz_screeplot</a></span><span class="op">(</span><span class="va">res.acp</span>, choice <span class="op">=</span><span class="st">"eigenvalue"</span>, addlabels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     x <span class="op">=</span> <span class="st">"Composantes"</span>,</span>
<span>                     y <span class="op">=</span> <span class="st">"Valeur propre"</span>,</span>
<span>                    title <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">G2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eigenvalue.html">fviz_screeplot</a></span><span class="op">(</span><span class="va">res.acp</span>, choice <span class="op">=</span><span class="st">"variance"</span>, addlabels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     x <span class="op">=</span> <span class="st">"Composantes"</span>,</span>
<span>                     y <span class="op">=</span> <span class="st">"Pourcentage de la variance expliquée"</span>,</span>
<span>                     title <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">G1</span>, <span class="va">G2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-factoextra1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-factoextra1-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.11: Graphiques pour les valeurs propres de l’ACP avec factoextra</figcaption></figure>
</div>
</div>
</div>
<p>Deuxièmement, la syntaxe ci-dessous renvoie trois graphiques pour analyser les contributions de chaque variable aux deux premiers axes de l’ACP (figures <a href="#fig-factoextra2"><span class="quarto-unresolved-ref ref-noprefix">fig-factoextra2</span></a> et <a href="#fig-factoextra3"><span class="quarto-unresolved-ref ref-noprefix">fig-factoextra3</span></a>) et la qualité de représentation des variables sur les trois premiers axes (<a href="#fig-factoextra4">figure&nbsp;<span class="quarto-unresolved-ref">fig-factoextra4</span></a>), c’est-à-dire la somme des cosinus carrés sur les trois axes retenus.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Contributions des variables aux deux premières composantes avec factoextra</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_contrib.html">fviz_contrib</a></span><span class="op">(</span><span class="va">res.acp</span>, choice <span class="op">=</span> <span class="st">"var"</span>, axes <span class="op">=</span> <span class="fl">1</span>, top <span class="op">=</span> <span class="fl">10</span>,</span>
<span>             title <span class="op">=</span> <span class="st">"Contributions des variables à la première composante"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_contrib.html">fviz_contrib</a></span><span class="op">(</span><span class="va">res.acp</span>, choice <span class="op">=</span> <span class="st">"var"</span>, axes <span class="op">=</span> <span class="fl">2</span>, top <span class="op">=</span> <span class="fl">10</span>,</span>
<span>             title <span class="op">=</span> <span class="st">"Contributions des variables à la première composante"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cos2.html">fviz_cos2</a></span><span class="op">(</span><span class="va">res.acp</span>, choice <span class="op">=</span> <span class="st">"var"</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Somme des cosinus carrés sur les 3 axes retenus"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Qualité de représentation des variables sur les axes retenus de l'ACP"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-factoextra2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-factoextra2-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.12: Contributions des variables à la première composante avec factoextra</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-factoextra3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-factoextra3-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.13: Contributions des variables à la deuxième composante avec factoextra</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-factoextra4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-factoextra4-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.14: Qualité des variables sur les trois premières composantes avec factoextra</figcaption></figure>
</div>
</div>
</div>
<p>Troisièmement, le code ci-dessous renvoie un nuage de points pour le premier plan factoriel de l’ACP (axes 1 et 2) pour les variables (<a href="#fig-factoextra5">figure&nbsp;<span class="quarto-unresolved-ref">fig-factoextra5</span></a>) et les individus (<a href="#fig-factoextra6">figure&nbsp;<span class="quarto-unresolved-ref">fig-factoextra6</span></a>).</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Premier plan factoriel pour les variables avec factoextra</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.acp</span>, col.var<span class="op">=</span><span class="st">"contrib"</span>,</span>
<span>             title <span class="op">=</span> <span class="st">"Premier plan factoriel pour les variables"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_color_gradient2</a></span><span class="op">(</span>low<span class="op">=</span><span class="st">"#313695"</span>, mid<span class="op">=</span><span class="st">"#ffffbf"</span>, high<span class="op">=</span><span class="st">"#a50026"</span>,</span>
<span>                        midpoint<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">res.acp</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">contrib</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Premier plan factoriel pour les individus avec factoextra</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.acp</span>, label <span class="op">=</span> <span class="st">"none"</span>, title <span class="op">=</span> <span class="st">"ACP. Individus"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.acp</span>, col.ind<span class="op">=</span><span class="st">"cos2"</span>, title <span class="op">=</span> <span class="st">"ACP. Individus"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_color_gradient2</a></span><span class="op">(</span>low<span class="op">=</span><span class="st">"blue"</span>, mid<span class="op">=</span><span class="st">"white"</span>, high<span class="op">=</span><span class="st">"red"</span>, midpoint<span class="op">=</span><span class="fl">0.50</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-factoextra5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-factoextra5-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.15: Premier plan factoriel de l’ACP pour les variables avec factoextra</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-factoextra6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-factoextra6-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.16: Premier plan factoriel de l’ACP pour les individus avec factoextra</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-12233" class="level4" data-number="12.2.3.3"><h4 data-number="12.2.3.3" class="anchored" data-anchor-id="sec-12233">
<span class="header-section-number">12.2.3.3</span> Personnalisation des graphiques avec les résultats de l’ACP</h4>
<p>Avec un peu plus de lignes de code et l’utilisation d’autres <em>packages</em> (<code>ggplot2</code>, <code>ggpubr</code>, <code>stringr</code>, <code>corrplot</code>), vous pouvez aussi construire des graphiques personnalisés.</p>
<p>Premièrement, la syntaxe ci-dessous permet de réaliser trois graphiques pour analyser les valeurs propres (<a href="#fig-acpmesgraphs1">figure&nbsp;<span class="quarto-unresolved-ref">fig-acpmesgraphs1</span></a>). Notez que, d’un coup d’œil, nous pouvons identifier les composantes principales avec une valeur propre égale ou supérieure à 1.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot">corrplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcul de l'ACP</span></span>
<span><span class="va">res.acp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, ncp<span class="op">=</span><span class="fl">5</span>, scale.unit <span class="op">=</span> <span class="cn">TRUE</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">res.acp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Construction d'un DataFrame pour les valeurs propres</span></span>
<span><span class="va">dfACPvp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">res.acp</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dfACPvp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"VP"</span> , <span class="st">"VP_pct"</span> , <span class="st">"VP_cumupct"</span><span class="op">)</span></span>
<span><span class="va">dfACPvp</span><span class="op">$</span><span class="va">Composante</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dfACPvp</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dfACPvp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">couleursAxes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"steelblue"</span> , <span class="st">"skyblue2"</span><span class="op">)</span></span>
<span><span class="va">vpsup1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dfACPvp</span>, <span class="va">VP</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">VP</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">vpsup1cumul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dfACPvp</span>, <span class="va">VP</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">VP_pct</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plotVP1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfACPvp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">VP</span>, y <span class="op">=</span> <span class="va">Composante</span>, fill <span class="op">=</span> <span class="va">VP</span><span class="op">&lt;</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">.6</span>, alpha <span class="op">=</span> <span class="fl">.8</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"azure4"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Valeur\npropre"</span> , values <span class="op">=</span> <span class="va">couleursAxes</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"&gt;= 1"</span> , <span class="st">"&lt; 1"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Valeur propre"</span>, y <span class="op">=</span> <span class="st">"Composante principale"</span><span class="op">)</span></span>
<span><span class="va">plotVP2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfACPvp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">VP_pct</span>, y <span class="op">=</span> <span class="va">Composante</span>, fill <span class="op">=</span> <span class="va">VP</span><span class="op">&lt;</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">.6</span>, alpha <span class="op">=</span> <span class="fl">.8</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Valeur\npropre"</span> , values <span class="op">=</span> <span class="va">couleursAxes</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"&gt;= 1"</span> , <span class="st">"&lt; 1"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Pourcentage de la variance expliquée"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">plotVP3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfACPvp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">VP_cumupct</span>, y <span class="op">=</span> <span class="va">Composante</span>, fill <span class="op">=</span> <span class="va">VP</span><span class="op">&lt;</span><span class="fl">1</span>, group<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">.6</span>, alpha <span class="op">=</span> <span class="fl">.8</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Valeur\npropre"</span> , values <span class="op">=</span> <span class="va">couleursAxes</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"&gt;= 1"</span> , <span class="st">"&lt; 1"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"brown"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, size<span class="op">=</span><span class="fl">.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span>, shape<span class="op">=</span><span class="fl">21</span>, color <span class="op">=</span> <span class="st">"brown"</span>, fill <span class="op">=</span> <span class="st">"brown"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Pourcentage cumulé de la variance expliquée"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span><span class="va">text1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Somme des valeurs propres supérieures à 1 : "</span>,</span>
<span>                <span class="va">vpsup1</span>,</span>
<span>                <span class="st">".\nPourcentage cumulé des valeurs propres supérieures à 1 : "</span>,</span>
<span>                <span class="va">vpsup1cumul</span>, <span class="st">"%."</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/annotate_figure.html">annotate_figure</a></span><span class="op">(</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">plotVP1</span>, <span class="va">plotVP2</span>, <span class="va">plotVP3</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/text_grob.html">text_grob</a></span><span class="op">(</span><span class="st">"Analyse des valeurs propres"</span>, </span>
<span>                         color <span class="op">=</span> <span class="st">"black"</span>, face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                bottom <span class="op">=</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/text_grob.html">text_grob</a></span><span class="op">(</span><span class="va">text1</span>,</span>
<span>                           color <span class="op">=</span> <span class="st">"black"</span>, hjust <span class="op">=</span> <span class="fl">1</span>, x <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-acpmesgraphs1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-acpmesgraphs1-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.17: Graphiques personnalisés pour les valeurs propres</figcaption></figure>
</div>
</div>
</div>
<p>Deuxièmement, la syntaxe ci-dessous permet de&nbsp;:</p>
<ul>
<li><p>Construire un <em>DataFrame</em> avec les résultats des variables.</p></li>
<li><p>Construire des histogrammes avec les coordonnées des variables sur les axes factoriels (<a href="#fig-acpmesgraphs2">figure&nbsp;<span class="quarto-unresolved-ref">fig-acpmesgraphs2</span></a>). Notez que les coordonnées négatives sont indiquées avec des barres bleues et celles positives, avec des barres de couleur saumon.</p></li>
<li><p>Un graphique avec les contributions des variables sur les axes retenus (<a href="#fig-acpmesgraphs3">figure&nbsp;<span class="quarto-unresolved-ref">fig-acpmesgraphs3</span></a>).</p></li>
<li><p>Un graphique avec les cosinus carrés des variables sur les axes retenus (<a href="#fig-acpmesgraphs4">figure&nbsp;<span class="quarto-unresolved-ref">fig-acpmesgraphs4</span></a>).</p></li>
<li><p>Un histogramme avec la qualité des variables sur les axes retenus (<a href="#fig-acpmesgraphs5">figure&nbsp;<span class="quarto-unresolved-ref">fig-acpmesgraphs5</span></a>), soit la sommation de leurs cosinus carrés sur les axes retenus.</p></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Analyse des résultats de L'ACP pour les variables</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot">corrplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Indiquer le nombre d'axes à conserver suite à l'analyse des valeurs propres</span></span>
<span><span class="va">nComp</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="co"># Variance expliquée par les axes retenus</span></span>
<span><span class="va">vppct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">dfACPvp</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">nComp</span>,<span class="st">"VP_pct"</span><span class="op">]</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Dataframe des résultats pour les variables</span></span>
<span><span class="va">CoordsVar</span> <span class="op">&lt;-</span> <span class="va">res.acp</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">coord</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nComp</span><span class="op">]</span></span>
<span><span class="va">Cos2Var</span>   <span class="op">&lt;-</span> <span class="va">res.acp</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">cos2</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nComp</span><span class="op">]</span></span>
<span><span class="va">CtrVar</span>   <span class="op">&lt;-</span> <span class="va">res.acp</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">contrib</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nComp</span><span class="op">]</span></span>
<span><span class="va">dfACPVars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Variable <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">res.acp</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">coord</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nComp</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                        Coord <span class="op">=</span> <span class="va">CoordsVar</span>,</span>
<span>                        Cos2 <span class="op">=</span> <span class="va">Cos2Var</span>,</span>
<span>                        Qualite <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">Cos2Var</span><span class="op">)</span>,</span>
<span>                        Ctr <span class="op">=</span> <span class="va">CtrVar</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">dfACPVars</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dfACPVars</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dfACPVars</span><span class="op">)</span>, <span class="st">".Dim."</span>, <span class="st">"Comp"</span><span class="op">)</span></span>
<span><span class="va">dfACPVars</span></span>
<span></span>
<span><span class="co"># Histogrammes pour les coordonnées</span></span>
<span><span class="va">couleursCoords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lightsalmon"</span> , <span class="st">"steelblue"</span><span class="op">)</span></span>
<span><span class="va">plotCoordF1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfACPVars</span>,</span>
<span>                      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">Variable</span>, <span class="va">CoordComp1</span><span class="op">)</span>,</span>
<span>                          x <span class="op">=</span> <span class="va">CoordComp1</span>, fill <span class="op">=</span> <span class="va">CoordComp1</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">.6</span>, alpha <span class="op">=</span> <span class="fl">.8</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Coordonnée"</span> , values <span class="op">=</span> <span class="va">couleursCoords</span>,</span>
<span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Positive"</span> , <span class="st">"Négative"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Axe 1 ("</span>, <span class="va">vppct</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="st">"%)"</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Variable"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">plotCoordF2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfACPVars</span>,</span>
<span>                      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">Variable</span>, <span class="va">CoordComp2</span><span class="op">)</span>,</span>
<span>                          x <span class="op">=</span> <span class="va">CoordComp2</span>, fill <span class="op">=</span> <span class="va">CoordComp2</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">.6</span>, alpha <span class="op">=</span> <span class="fl">.8</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Coordonnée"</span> , values <span class="op">=</span> <span class="va">couleursCoords</span>,</span>
<span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Positive"</span> , <span class="st">"Négative"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Axe 2 ("</span>, <span class="va">vppct</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="st">"%)"</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Variable"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">plotCoordF3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfACPVars</span>,</span>
<span>                      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">Variable</span>, <span class="va">CoordComp3</span><span class="op">)</span>,</span>
<span>                          x <span class="op">=</span> <span class="va">CoordComp3</span>, fill <span class="op">=</span> <span class="va">CoordComp3</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">.6</span>, alpha <span class="op">=</span> <span class="fl">.8</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Coordonnée"</span>, values <span class="op">=</span> <span class="va">couleursCoords</span>,</span>
<span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Positive"</span> , <span class="st">"Négative"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Axe 3 ("</span>, <span class="va">vppct</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="st">"%)"</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Variable"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/annotate_figure.html">annotate_figure</a></span><span class="op">(</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">plotCoordF1</span>, <span class="va">plotCoordF2</span>, <span class="va">plotCoordF3</span>, nrow <span class="op">=</span> <span class="va">nComp</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/text_grob.html">text_grob</a></span><span class="op">(</span><span class="st">"Coordonnées des variables sur les axes factoriels"</span>,</span>
<span>                          color <span class="op">=</span> <span class="st">"black"</span>, face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Contributions des variables à la formation des axes</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">CtrVar</span>, is.corr <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span><span class="st">"square"</span>,</span>
<span>         addCoef.col <span class="op">=</span> <span class="fl">1</span>, cl.pos <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># La qualité des variables sur les composantes retenues : cosinus carrés</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">Cos2Var</span>, is.corr <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span><span class="st">"square"</span>,</span>
<span>         addCoef.col <span class="op">=</span> <span class="fl">1</span>, cl.pos <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfACPVars</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">Variable</span>, <span class="va">Qualite</span><span class="op">)</span>, x<span class="op">=</span><span class="va">Qualite</span><span class="op">)</span>,</span>
<span>            stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">.6</span>, alpha <span class="op">=</span> <span class="fl">.8</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Somme des cosinus carrés sur les axes retenus"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Qualité de représentation des variables sur les axes retenus de l'ACP"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Variance expliquée par les "</span>, <span class="va">nComp</span>, </span>
<span>                         <span class="st">" composantes : "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">vppct</span><span class="op">)</span>, <span class="st">"%"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-acpmesgraphs2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-acpmesgraphs2-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.18: Histogrammes personnalisés avec les coordonnées factorielles pour les variables</figcaption></figure>
</div>
</div>
</div>
<div id="fig-acpmesgraphs3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap12/corrplotacpmesgraph3.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.19: Graphiques personnalisés avec les contributions des variables</figcaption></figure>
</div>
<div id="fig-acpmesgraphs4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap12/corrplotacpmesgraph4.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.20: Graphiques personnalisés avec les cosinus carrés des variables</figcaption></figure>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-acpmesgraphs5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-acpmesgraphs5-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.21: Graphique personnalisé avec la qualité des variables sur les axes retenus de l’ACP</figcaption></figure>
</div>
</div>
</div>
<p>Troisièmement, lorsque les observations sont des unités spatiales, il convient de cartographier les coordonnées factorielles des individus. Dans le jeu de données utilisé, les observations sont des polygones délimitant les îlots regroupés pour l’information statistique (IRIS) pour l’agglomération de Lyon (France). Nous utilisons les <em>packages</em> <code>tmap</code> et <code>RColorBrewer</code> pour réaliser des cartes choroplèthes avec les coordonnées des deux premières composantes (<a href="#fig-acpmesgraphs6">figure&nbsp;<span class="quarto-unresolved-ref">fig-acpmesgraphs6</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://r-tmap.github.io/tmap/">"tmap"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"RColorBrewer"</span><span class="op">)</span></span>
<span><span class="co"># Analyse des résultats de l'ACP pour les individus</span></span>
<span><span class="co"># Dataframe des résultats pour les individus</span></span>
<span><span class="va">CoordsInd</span> <span class="op">&lt;-</span> <span class="va">res.acp</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nComp</span><span class="op">]</span></span>
<span><span class="va">Cos2Ind</span>   <span class="op">&lt;-</span> <span class="va">res.acp</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">cos2</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nComp</span><span class="op">]</span></span>
<span><span class="va">CtrInd</span>    <span class="op">&lt;-</span> <span class="va">res.acp</span><span class="op">$</span><span class="va">ind</span><span class="op">$</span><span class="va">contrib</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nComp</span><span class="op">]</span></span>
<span><span class="va">dfACPInd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Coord <span class="op">=</span> <span class="va">CoordsInd</span>, Cos2 <span class="op">=</span> <span class="va">Cos2Ind</span>, Ctr <span class="op">=</span> <span class="va">CtrInd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dfACPInd</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dfACPInd</span><span class="op">)</span>, <span class="st">".Dim."</span>, <span class="st">"Comp"</span><span class="op">)</span></span>
<span><span class="co"># Fusion du tableau original avec les résultats de l'ACP pour les individus</span></span>
<span><span class="va">CartoACP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">LyonIris</span>, <span class="va">dfACPInd</span><span class="op">)</span></span>
<span><span class="co"># Cartographie des coordonnées factorielles pour les individus pour les</span></span>
<span><span class="co"># deux premières composantes</span></span>
<span><span class="va">Carte1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">CartoACP</span><span class="op">)</span> <span class="op">+</span></span>
<span>          <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"CoordComp1"</span>, style <span class="op">=</span> <span class="st">"cont"</span>,</span>
<span>                      midpoint <span class="op">=</span> <span class="fl">0</span>, title <span class="op">=</span> <span class="st">"Coordonnées"</span><span class="op">)</span><span class="op">+</span></span>
<span>          <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_layout.html">tm_layout</a></span><span class="op">(</span>main.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Axe 1 ("</span>, <span class="va">vppct</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="st">"%)"</span><span class="op">)</span>,</span>
<span>             attr.outside <span class="op">=</span> <span class="cn">TRUE</span>, frame <span class="op">=</span> <span class="cn">FALSE</span>, main.title.size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Carte2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">CartoACP</span><span class="op">)</span> <span class="op">+</span></span>
<span>          <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"CoordComp2"</span>, style <span class="op">=</span> <span class="st">"cont"</span>,</span>
<span>                      midpoint <span class="op">=</span> <span class="fl">0</span>, title <span class="op">=</span> <span class="st">"Coordonnées"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_layout.html">tm_layout</a></span><span class="op">(</span>main.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Axe 2 ("</span>, <span class="va">vppct</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="st">"%)"</span><span class="op">)</span>,</span>
<span>             attr.outside <span class="op">=</span> <span class="cn">TRUE</span>, frame <span class="op">=</span> <span class="cn">FALSE</span>, main.title.size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tmap_arrange.html">tmap_arrange</a></span><span class="op">(</span><span class="va">Carte1</span>, <span class="va">Carte2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-acpmesgraphs6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-acpmesgraphs6-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.22: Cartographie des coordonnées factorielles des individus</figcaption></figure>
</div>
</div>
</div>
<div class="bloc_aller_loin">
<div class="bloc_aller_loin-header">
<div class="bloc_aller_loin-icon">

</div>
<p><strong>Exploration interactive des résultats d’une ACP avec le <em>package</em> <code>explor</code></strong>.</p>
</div>
<div class="bloc_aller_loin-body">
<p>Vous avez compris qu’il ne suffit pas de calculer une ACP, il faut retenir les <em>n</em> premiers axes de l’ACP qui nous semblent les plus pertinents, puis les interpréter à la lecture des coordonnées factorielles, des cosinus carrés et des contributions des variables et des individus sur les axes. Il faut donc bien explorer les résultats à l’aide de tableaux et de graphiques! Cela explique que nous avons mobilisé de nombreux graphiques dans les deux sections précédentes (<a href="#sec-12232"><span class="quarto-unresolved-ref ref-noprefix">sec-12232</span></a> et <a href="#sec-12233"><span class="quarto-unresolved-ref ref-noprefix">sec-12233</span></a>). L’exploration des données d’une ACP peut aussi être réalisée avec des graphiques interactifs. Or, un superbe <em>package</em> dénommé <a href="https://juba.github.io/explor/"><code>explor</code></a>, reposant sur <a href="https://shiny.rstudio.com/"><code>Shiny</code></a>, permet d’explorer de manière interactive les résultats de plusieurs méthodes factorielles calculés avec <code>FactorMinerR</code>. Pour cela, il vous suffit de lancer les deux lignes de code suivantes&nbsp;:</p>
<p><code><a href="https://juba.github.io/explor/">library(explor)</a></code></p>
<p><code>explor(res.acp)</code></p>
<p>Finalement, <code>explor</code> permet également d’explorer les résultats d’une analyse des correspondances (AFC) et d’une analyse des correspondances multiples (ACM).</p>
</div>
</div>
</section></section></section><section id="sec-123" class="level2" data-number="12.3"><h2 data-number="12.3" class="anchored" data-anchor-id="sec-123">
<span class="header-section-number">12.3</span> Analyse factorielle des correspondances (AFC)</h2>
<div class="bloc_notes">
<div class="bloc_notes-header">
<div class="bloc_notes-icon">

</div>
<p><strong>AFC et tableau de contingence</strong></p>
</div>
<div class="bloc_notes-body">
<p>Pour bien comprendre l’AFC, il est essentiel de bien maîtriser les notions de tableau de contingence (marges du tableau, fréquences observées et théoriques, pourcentages en ligne et en colonne, contributions au khi-deux) et de distance du khi-deux. Si ce n’est pas le cas, il est conseillé de (re)lire le <a href="#sec-chap05">chapitre&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-chap05</span></a>.</p>
</div>
</div>
<p>Dans le <a href="#sec-chap05">chapitre&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-chap05</span></a>, nous avons vu comment construire un tableau de contingence (<a href="#fig-AnalysesFactoriellesTabAFCFig">figure&nbsp;<span class="quarto-unresolved-ref">fig-AnalysesFactoriellesTabAFCFig</span></a>) à partir de deux variables qualitatives comprenant plusieurs modalités, puis comment vérifier s’il y a dépendance entre les deux variables qualitatives avec le test du khi-deux. Or, s’il y a bien dépendance, il est peut-être judicieux de résumer l’information que contient le tableau de contingence en quelques nouvelles variables synthétiques, objectif auquel répond l’analyse factorielle des correspondances (AFC).</p>
<div id="fig-AnalysesFactoriellesTabAFCFig" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap12/AnalysesFactoriellesTabAFC.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.23: Tableau de contingence pour une AFC</figcaption></figure>
</div>
<p>À titre de rappel (<a href="#sec-1212">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-1212</span></a>), l’AFC a été développée par le statisticien français Jean-Paul Benzécri <span class="citation" data-cites="benzecri1973analyse">(<a href="#ref-benzecri1973analyse" role="doc-biblioref">1973</a>)</span>. Cela explique qu’elle est souvent enseignée et utilisée en sciences sociales dans les universités francophones, mais plus rarement dans les universités anglophones. Pourtant, les applications de l’AFC sont nombreuses dans différentes disciplines des sciences sociales comme illustrées avec les exemples suivants&nbsp;:</p>
<ul>
<li><p>En géographie, les modalités de la première variable du tableau de contingence sont souvent des entités spatiales (régions, municipalités, quartiers, etc.) croisées avec les modalités d’une autre variable qualitative (catégories socioprofessionnelles, modes de transport, tranches de revenu des ménages ou des individus, etc.).</p></li>
<li><p>En économie régionale, nous pourrions vouloir explorer un tableau de contingence croisant des entités spatiales (par exemple, MRC au Québec, départements en France) et les effectifs d’emplois pour différents secteurs d’activité.</p></li>
<li><p>En sciences politiques, le recours à l’AFC peut être intéressant pour explorer les résultats d’une élection. Les deux variables qualitatives pourraient être les <em>circonscriptions électorales</em> et les <em>partis politiques</em>. Le croisement des lignes et des colonnes du tableau de contingence représenterait le nombre de votes obtenus par un parti politique <em>j</em> dans la circonscription électorale <em>i</em>. Appliquer une AFC sur un tel tableau de contingence permettrait de révéler les ressemblances entre les différents partis politiques et celles entre les circonscriptions électorales.</p></li>
</ul>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Appliquer une ACP sur un tableau de contingence&nbsp;: un bien mauvais calcul…</strong></p>
</div>
<div class="bloc_attention-body">
<p>Il pourrait être tentant de transformer le tableau de contingence initial (<a href="#tbl-encadreAFCACP1">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-encadreAFCACP1</span></a>) en un tableau avec les pourcentages en ligne (<a href="#tbl-encadreAFCACP2">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-encadreAFCACP2</span></a>) afin de lui appliquer une analyse en composantes principales. Une telle démarche a deux inconvénients majeurs&nbsp;: chacune des modalités de la première variable qualitative (<em>I</em>) aurait alors le même poids; chacune des modalités de la deuxième variable (<em>J</em>) aurait aussi le même poids. Or, à la lecture des marges en ligne et en colonne au <a href="#tbl-encadreAFCACP1">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-encadreAFCACP1</span></a>), il est clair que les modalités <code>j1</code> et <code>i1</code> comprennent bien plus d’individus que les autres modalités respectives.</p>
<p>Si nous reprenons le dernier exemple applicatif, cela signifierait que le même poids est accordé à chaque parti puisque les variables sont centrées réduites en ACP (moyenne&nbsp;=&nbsp;0 et variance&nbsp;=&nbsp;1). Autrement dit, les grands partis traditionnels seraient ainsi sur le pied d’égalité que les autres partis. Aussi, chaque circonscription électorale aurait le même poids bien que certaines comprennent bien plus d’électeurs et d’électrices que d’autres.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-encadreAFCACP1" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.7: Exemple de tableau de contingence pour l’AFC</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 20%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">j1</th>
<th style="text-align: right;">j2</th>
<th style="text-align: right;">j3</th>
<th style="text-align: right;">j4</th>
<th style="text-align: right;">j5</th>
<th style="text-align: right;">Marge (ligne)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">i1</td>
<td style="text-align: right;">357 060</td>
<td style="text-align: right;">22 010</td>
<td style="text-align: right;">276 625</td>
<td style="text-align: right;">65 000</td>
<td style="text-align: right;">29 415</td>
<td style="text-align: right;">750 110</td>
</tr>
<tr class="even">
<td style="text-align: left;">i2</td>
<td style="text-align: right;">427 530</td>
<td style="text-align: right;">26 400</td>
<td style="text-align: right;">295 860</td>
<td style="text-align: right;">69 410</td>
<td style="text-align: right;">30 645</td>
<td style="text-align: right;">849 845</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i3</td>
<td style="text-align: right;">147 500</td>
<td style="text-align: right;">6 545</td>
<td style="text-align: right;">34 545</td>
<td style="text-align: right;">4 415</td>
<td style="text-align: right;">1 040</td>
<td style="text-align: right;">194 045</td>
</tr>
<tr class="even">
<td style="text-align: left;">i4</td>
<td style="text-align: right;">128 520</td>
<td style="text-align: right;">6 405</td>
<td style="text-align: right;">42 925</td>
<td style="text-align: right;">6 565</td>
<td style="text-align: right;">2 670</td>
<td style="text-align: right;">187 085</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marge (colonne)</td>
<td style="text-align: right;">1 060 610</td>
<td style="text-align: right;">61 360</td>
<td style="text-align: right;">649 955</td>
<td style="text-align: right;">145 390</td>
<td style="text-align: right;">63 770</td>
<td style="text-align: right;">1 981 085</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-encadreAFCACP2" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.8: Exemple d’un tableau de contingence transformé (pourcentage en ligne) pour l’ACP</caption>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">V1</th>
<th style="text-align: right;">V2</th>
<th style="text-align: right;">V3</th>
<th style="text-align: right;">V4</th>
<th style="text-align: right;">V5</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">i1</td>
<td style="text-align: right;">47,6</td>
<td style="text-align: right;">2,9</td>
<td style="text-align: right;">36,9</td>
<td style="text-align: right;">8,7</td>
<td style="text-align: right;">3,9</td>
</tr>
<tr class="even">
<td style="text-align: left;">i2</td>
<td style="text-align: right;">50,3</td>
<td style="text-align: right;">3,1</td>
<td style="text-align: right;">34,8</td>
<td style="text-align: right;">8,2</td>
<td style="text-align: right;">3,6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i3</td>
<td style="text-align: right;">76,0</td>
<td style="text-align: right;">3,4</td>
<td style="text-align: right;">17,8</td>
<td style="text-align: right;">2,3</td>
<td style="text-align: right;">0,5</td>
</tr>
<tr class="even">
<td style="text-align: left;">i4</td>
<td style="text-align: right;">68,7</td>
<td style="text-align: right;">3,4</td>
<td style="text-align: right;">22,9</td>
<td style="text-align: right;">3,5</td>
<td style="text-align: right;">1,4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<section id="sec-1231" class="level3" data-number="12.3.1"><h3 data-number="12.3.1" class="anchored" data-anchor-id="sec-1231">
<span class="header-section-number">12.3.1</span> Recherche d’une simplification basée sur la distance du khi-deux</h3>
<p>Sur le plan mathématique et des objectifs visés, l’AFC est similaire à l’ACP puisqu’elle permet d’explorer un tableau de trois façons&nbsp;: 1) en montrant les ressemblances entre un ensemble d’individus (<em>I</em>), 2) en révélant les liaisons entre les variables (<em>J</em>) et 3) en résumant le tout avec des variables synthétiques. Toutefois, avec l’AFC, les ensembles <em>I</em> et <em>J</em> sont les modalités de deux variables qualitatives (dont le croisement forme un tableau de contingence) et elle est basée sur la distance du khi-deux (et non sur la distance euclidienne comme en ACP).</p>
<p>Ainsi, avec la distance du khi-deux, la proximité (ressemblance) entre deux lignes (<em>i</em> et <em>l</em>) et deux colonnes (<em>j</em> et <em>k</em>) est mesurée comme suit&nbsp;:</p>
<p><span id="eq-khideuxlignes"><span class="math display">\[
d_{\chi_{il}^2} = \sum_j \frac{1}{f_{.j}}(\frac{f_{ij}}{f_{i.}}-\frac{f_{lj}}{f_{l.}})^2
\tag{12.5}\]</span></span></p>
<p><span id="eq-khideuxcolonnes"><span class="math display">\[
d_{\chi_{jk}^2} = \sum_i \frac{1}{f_{i.}}(\frac{f_{ij}}{f_{.j}}-\frac{f_{ik}}{f_{.k}})^2
\tag{12.6}\]</span></span></p>
<p>Prenons un exemple fictif pour calculer ces deux distances. Le <a href="#tbl-afcdataex1">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-afcdataex1</span></a> comprend trois modalités en ligne (<em>I</em>) et trois autres en colonne (<em>J</em>). Le total des effectifs de ce tableau de contingence est égal à 1&nbsp;665.</p>
<p>À partir des données brutes, il est facile de construire deux tableaux&nbsp;: le profil des lignes et le profil des colonnes (<a href="#tbl-afcProfilsLignesCols">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-afcProfilsLignesCols</span></a>, c’est-à-dire les proportions en ligne et en colonne.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-afcdataex1" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.9: Données brutes du tableau de contingence</caption>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">j1</th>
<th style="text-align: center;">j2</th>
<th style="text-align: center;">j3</th>
<th style="text-align: center;">Total (ligne)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">i1</td>
<td style="text-align: center;">360</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">275</td>
<td style="text-align: center;">700</td>
</tr>
<tr class="even">
<td style="text-align: left;">i2</td>
<td style="text-align: center;">420</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">290</td>
<td style="text-align: center;">780</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i3</td>
<td style="text-align: center;">145</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;">185</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total (colonne)</td>
<td style="text-align: center;">925</td>
<td style="text-align: center;">140</td>
<td style="text-align: center;">600</td>
<td style="text-align: center;">1 665</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-afcProfilsLignesCols" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.10: Profils des lignes et des colonnes</caption>
<thead><tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">j1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">j2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">j3</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Total</th>
</tr></thead>
<tbody>
<tr class="odd" data-grouplength="3">
<td colspan="5" style="border-bottom: 1px solid"><strong>Profil des lignes</strong></td>
</tr>
<tr class="even">
<td style="text-align: center; padding-left: 2em;" data-indentlevel="1">i1</td>
<td style="text-align: center;">0,514</td>
<td style="text-align: center;">0,093</td>
<td style="text-align: center;">0,393</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center; padding-left: 2em;" data-indentlevel="1">i2</td>
<td style="text-align: center;">0,538</td>
<td style="text-align: center;">0,090</td>
<td style="text-align: center;">0,372</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center; padding-left: 2em;" data-indentlevel="1">i3</td>
<td style="text-align: center;">0,784</td>
<td style="text-align: center;">0,027</td>
<td style="text-align: center;">0,189</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd" data-grouplength="4">
<td colspan="5" style="border-bottom: 1px solid"><strong>Profils des colonnes</strong></td>
</tr>
<tr class="even">
<td style="text-align: center; padding-left: 2em;" data-indentlevel="1">i1</td>
<td style="text-align: center;">0,389</td>
<td style="text-align: center;">0,464</td>
<td style="text-align: center;">0,458</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center; padding-left: 2em;" data-indentlevel="1">i2</td>
<td style="text-align: center;">0,454</td>
<td style="text-align: center;">0,500</td>
<td style="text-align: center;">0,483</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center; padding-left: 2em;" data-indentlevel="1">i3</td>
<td style="text-align: center;">0,157</td>
<td style="text-align: center;">0,036</td>
<td style="text-align: center;">0,058</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center; padding-left: 2em;" data-indentlevel="1">Total</td>
<td style="text-align: center;">1,000</td>
<td style="text-align: center;">1,000</td>
<td style="text-align: center;">1,000</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>En divisant les valeurs du <a href="#tbl-afcdataex1">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-afcdataex1</span></a> par le grand total (1&nbsp;665), nous obtenons tous les termes utilisés dans les équations <a href="#eq-khideuxlignes"><span class="quarto-unresolved-ref ref-noprefix">eq-khideuxlignes</span></a> et <a href="#eq-khideuxcolonnes"><span class="quarto-unresolved-ref ref-noprefix">eq-khideuxcolonnes</span></a> au <a href="#tbl-afcdataex2">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-afcdataex2</span></a>&nbsp;:</p>
<ul>
<li>Les fréquences relatives dénommées <span class="math inline">\(f_{ij}\)</span>.</li>
<li>La marge <span class="math inline">\(fi.\)</span> est égale à la somme des fréquences relatives en ligne.</li>
<li>La marge <span class="math inline">\(f.j\)</span> est égale à la somme des fréquences relatives en colonne.</li>
<li>La somme de toutes les fréquences relatives est donc égale à 1, soit <span class="math inline">\(\sum{f_{i.}}\)</span> ou <span class="math inline">\(\sum{f_{.j}}\)</span>.</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-afcdataex2" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.11: Données relatives du tableau de contingence (fij)</caption>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">j1</th>
<th style="text-align: right;">j2</th>
<th style="text-align: right;">j3</th>
<th style="text-align: right;">Total (fi.)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">i1</td>
<td style="text-align: right;">0,216</td>
<td style="text-align: right;">0,039</td>
<td style="text-align: right;">0,165</td>
<td style="text-align: right;">0,420</td>
</tr>
<tr class="even">
<td style="text-align: left;">i2</td>
<td style="text-align: right;">0,252</td>
<td style="text-align: right;">0,042</td>
<td style="text-align: right;">0,174</td>
<td style="text-align: right;">0,468</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i3</td>
<td style="text-align: right;">0,087</td>
<td style="text-align: right;">0,003</td>
<td style="text-align: right;">0,021</td>
<td style="text-align: right;">0,111</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total (f.j)</td>
<td style="text-align: right;">0,556</td>
<td style="text-align: right;">0,084</td>
<td style="text-align: right;">0,360</td>
<td style="text-align: right;">1,000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Il est possible de calculer les distances entre les différentes modalités de <em>I</em> en appliquant l’<a href="#eq-khideuxlignes">équation&nbsp;<span class="quarto-unresolved-ref">eq-khideuxlignes</span></a>; par exemple, la distance entre les observations <code>i1</code> et <code>i2</code> est égale à&nbsp;:</p>
<p><span class="math display">\[d_{(i1,i2)}=\frac{\mbox{1}}{\mbox{0,556}}(\mbox{0,216}-\mbox{0,252})^2+\frac{\mbox{1}}{\mbox{0,084}}(\mbox{0,039}-\mbox{0,042})^2+
\frac{\mbox{1}}{\mbox{0,360}}(\mbox{0,165}-\mbox{0,174})^2=\mbox{0,003}\]</span></p>
<p>Avec l’<a href="#eq-khideuxcolonnes">équation&nbsp;<span class="quarto-unresolved-ref">eq-khideuxcolonnes</span></a>, la distance entre les modalités <code>j1</code> et <code>j2</code> de <em>J</em> est égale à&nbsp;:</p>
<p><span class="math display">\[d_{(j1,j2)}=\frac{\mbox{1}}{\mbox{0,420}}(\mbox{0,216}-\mbox{0,039})^2+ \frac{\mbox{1}}{\mbox{0,468}}(\mbox{0,252}-\mbox{0,042})^2 + \frac{\mbox{1}}{\mbox{0,111}}(\mbox{0,087}-\mbox{0,003})^2=\mbox{0,233}\]</span></p>
<p>À la lecture du <a href="#tbl-MatriceDistKhi">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-MatriceDistKhi</span></a>, les modalités les plus semblables sont <code>i1</code> et <code>i2</code> (0,003) pour <em>I</em> et <code>j1</code> et <code>j3</code> (0,058) pour <em>J</em>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-MatriceDistKhi" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.12: Distances du khi-deux entre les modalités I et les modalités J</caption>
<thead><tr class="header">
<th style="text-align: center;">Ind.</th>
<th style="text-align: center;">i1</th>
<th style="text-align: center;">i2</th>
<th style="text-align: center;">i3</th>
<th style="text-align: center;">Col.</th>
<th style="text-align: center;">j1</th>
<th style="text-align: center;">j2</th>
<th style="text-align: center;">j3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">i1</td>
<td style="text-align: center;">0,000</td>
<td style="text-align: center;">0,003</td>
<td style="text-align: center;">0,103</td>
<td style="text-align: center;">j1</td>
<td style="text-align: center;">0,000</td>
<td style="text-align: center;">0,233</td>
<td style="text-align: center;">0,058</td>
</tr>
<tr class="even">
<td style="text-align: center;">i2</td>
<td style="text-align: center;">0,003</td>
<td style="text-align: center;">0,000</td>
<td style="text-align: center;">0,132</td>
<td style="text-align: center;">j2</td>
<td style="text-align: center;">0,233</td>
<td style="text-align: center;">0,000</td>
<td style="text-align: center;">0,078</td>
</tr>
<tr class="odd">
<td style="text-align: center;">i3</td>
<td style="text-align: center;">0,103</td>
<td style="text-align: center;">0,132</td>
<td style="text-align: center;">0,000</td>
<td style="text-align: center;">j3</td>
<td style="text-align: center;">0,058</td>
<td style="text-align: center;">0,078</td>
<td style="text-align: center;">0,000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Finalement, l’approche pour déterminer les axes factoriels de l’AFC est similaire à celle de l’ACP&nbsp;: les axes factoriels sont les droites orthogonales qui minimisent les distances aux points du profil des lignes, excepté que la métrique pour mesurer ces distances est celle du khi-deux (et non celle la distance euclidienne comme pour l’ACP). Pour plus détails sur le calcul de ces axes (notamment les formulations matricielles), consultez notamment Benzécri <span class="citation" data-cites="benzecri1973analyse">(<a href="#ref-benzecri1973analyse" role="doc-biblioref">1973</a>)</span>, Escofier et Pagès <span class="citation" data-cites="escofier1998analyses">(<a href="#ref-escofier1998analyses" role="doc-biblioref">1998</a>)</span> et Lebart et al. <span class="citation" data-cites="lebart1995statistique">(<a href="#ref-lebart1995statistique" role="doc-biblioref">1995</a>)</span>.</p>
</section><section id="sec-1232" class="level3" data-number="12.3.2"><h3 data-number="12.3.2" class="anchored" data-anchor-id="sec-1232">
<span class="header-section-number">12.3.2</span> Aides à l’interprétation</h3>
<p>Pour illustrer les aides à l’interprétation de l’AFC, nous utilisons un jeu de données spatiales extrait du <a href="https://www12.statcan.gc.ca/census-recensement/2016/dp-pd/prof/index.cfm?Lang=F" target="_blank">profil du recensement de 2016 de Statistique Canada</a> pour les secteurs de recensement de l’île de Montréal. La liste des modalités des variables qu’il comprend est reportée au <a href="#tbl-dataAfc">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dataAfc</span></a>. L’AFC est calculée sur un tableau de contingence croisant les secteurs de recensement (lignes) et les modalités d’une variable relative au mode de transport utilisé pour les déplacements domicile-travail (colonnes). Ces modalités sont cartographiées à la <a href="#fig-cartovarAFC">figure&nbsp;<span class="quarto-unresolved-ref">fig-cartovarAFC</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-dataAfc" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.13: Jeu de données utilisé pour l’analyse factorielle des correspondances</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Nom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Intitulé</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Somme</th>
</tr></thead>
<tbody>
<tr class="odd" data-grouplength="6">
<td colspan="4" style="border-bottom: 1px solid"><strong>Modalités de la variable utilisée dans l'AFC (mode de transport)</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">VehCond</td>
<td style="text-align: left;">VehCond</td>
<td style="text-align: left;">Véhicule motorisé (conducteur·trice)</td>
<td style="text-align: right;">427 560</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">VehPass</td>
<td style="text-align: left;">VehPass</td>
<td style="text-align: left;">Véhicule motorisé (passager·ère)</td>
<td style="text-align: right;">26 490</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">TranspC</td>
<td style="text-align: left;">TranspC</td>
<td style="text-align: left;">Transport en commun</td>
<td style="text-align: right;">295 800</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Apied</td>
<td style="text-align: left;">Apied</td>
<td style="text-align: left;">À pied</td>
<td style="text-align: right;">69 330</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Velo</td>
<td style="text-align: left;">Velo</td>
<td style="text-align: left;">Bicyclette</td>
<td style="text-align: right;">30 615</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">AutreMoyen</td>
<td style="text-align: left;">AutreMoyen</td>
<td style="text-align: left;">Autre moyen</td>
<td style="text-align: right;">7 750</td>
</tr>
<tr class="even" data-grouplength="5">
<td colspan="4" style="border-bottom: 1px solid"><strong>Modalités de la variable supplémentaire (durée du trajet)</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">T15min</td>
<td style="text-align: left;">T15min</td>
<td style="text-align: left;">Moins de 15 minutes</td>
<td style="text-align: right;">130 435</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">T1529min</td>
<td style="text-align: left;">T1529min</td>
<td style="text-align: left;">15 à 29 minutes</td>
<td style="text-align: right;">287 500</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">T3044min</td>
<td style="text-align: left;">T3044min</td>
<td style="text-align: left;">30 à 44 minutes</td>
<td style="text-align: right;">244 425</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">T4559min</td>
<td style="text-align: left;">T4559min</td>
<td style="text-align: left;">45 à 59 minutes</td>
<td style="text-align: right;">107 065</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">T60plus</td>
<td style="text-align: left;">T60plus</td>
<td style="text-align: left;">60 minutes et plus</td>
<td style="text-align: right;">88 050</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-cartovarAFC" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-cartovarAFC-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.24: Cartographie des modalités de la variable mode de transport utilisée pour l’AFC</figcaption></figure>
</div>
</div>
</div>
<section id="sec-12321" class="level4" data-number="12.3.2.1"><h4 data-number="12.3.2.1" class="anchored" data-anchor-id="sec-12321">
<span class="header-section-number">12.3.2.1</span> Résultats de l’AFC pour les valeurs propres</h4>
<p>Avant de calculer l’AFC, il convient de vérifier s’il y a bien une dépendance entre les modalités des deux variables qualitatives. En effet, si les deux variables sont indépendantes, il n’est pas nécessaire de résumer le tableau de contingence avec une AFC. Pour ce faire, nous utilisons le test du khi-deux largement décrit à la <a href="#sec-052">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-052</span></a>. Les résultats de ce test signalent qu’il existe des associations entre les modalités des deux variables (<span class="math inline">\(\chi\)</span>&nbsp;=&nbsp;203&nbsp;971, <em>p</em>&nbsp;&lt;&nbsp;0,001, <a href="#tbl-dataafckhi2">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dataafckhi2</span></a>). Nous pouvons donc appliquer une AFC sur ce tableau de contingence.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-dataafckhi2" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.14: Résultats du test du khi-deux sur le tableau de contingence</caption>
<thead><tr class="header">
<th style="text-align: left;">Mesure</th>
<th style="text-align: right;">Valeur</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Modalités <em>I</em> (secteurs de recensement)</td>
<td style="text-align: right;">521,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Modalités <em>J</em> (variable mode de transport)</td>
<td style="text-align: right;">6,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Somme des données brutes (<span class="math inline">\(n_{ij}\)</span>)</td>
<td style="text-align: right;">857 545,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Khi-deux (<span class="math inline">\(\chi^2\)</span>)</td>
<td style="text-align: right;">207 129,27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Degrés de liberté, soit <span class="math inline">\((c-1)\times(l-1)\)</span>
</td>
<td style="text-align: right;">2 600,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Valeur de <em>p</em>
</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Coefficient Phi au carré (<span class="math inline">\(\phi^2=\chi^2 / n_{ij})\)</span>
</td>
<td style="text-align: right;">0,24</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Nous avons vu qu’en ACP normée (<a href="#sec-12221">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-12221</span></a>), la somme des valeurs propres est égale au nombre de variables puisqu’elles sont centrées réduites. Par contre, en AFC, cette somme est égale à l’inertie totale du tableau de contingence, c’est-à-dire à la valeur du khi-deux divisée par le nombre total des effectifs bruts (soit le coefficient phi au carré, <span class="math inline">\(\phi^2\)</span>) (<a href="#sec-052">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-052</span></a>). Le <a href="#tbl-dataafcValeurPropres">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dataafcValeurPropres</span></a> permet de vérifier que la somme des valeurs propres est bien égale au coefficient phi au carré&nbsp;:</p>
<p><span class="math display">\[\mbox{0,156}+\mbox{0,046}+\mbox{0,031}+\mbox{0,004}+\mbox{0,004} = \mbox{0,24}\]</span></p>
<p><span class="math display">\[\phi^2 = \chi^2 / n_{ij}=\mbox{203 971}/ \mbox{849 795} = \mbox{0,24}\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-dataafcValeurPropres" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.15: Résultats de l’AFC pour les valeurs propres</caption>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Axe factoriel</th>
<th style="text-align: right;">Valeur propre</th>
<th style="text-align: right;">Pourcentage</th>
<th style="text-align: right;">Pourc. cumulé</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dim 1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0,156</td>
<td style="text-align: right;">64,590</td>
<td style="text-align: right;">64,590</td>
</tr>
<tr class="even">
<td style="text-align: left;">dim 2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0,046</td>
<td style="text-align: right;">19,250</td>
<td style="text-align: right;">83,840</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dim 3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0,031</td>
<td style="text-align: right;">12,995</td>
<td style="text-align: right;">96,835</td>
</tr>
<tr class="even">
<td style="text-align: left;">dim 4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0,004</td>
<td style="text-align: right;">1,683</td>
<td style="text-align: right;">98,518</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dim 5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0,004</td>
<td style="text-align: right;">1,482</td>
<td style="text-align: right;">100,000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><strong>Combien d’axes d’une AFC faut-il retenir?</strong></p>
<ul>
<li><p><strong>Approche statistique</strong>. Mike Bendixen <span class="citation" data-cites="bendixen1995compositional">(<a href="#ref-bendixen1995compositional" role="doc-biblioref">1995</a>)</span>, cité dans l’excellent site <a href="http://www.sthda.com/" target="_blank">STHDA</a>, propose deux critères pour sélectionner les premiers axes d’une AFC&nbsp;: <span class="math inline">\(c_1= 1 / (l-1) \times 100\)</span> et <span class="math inline">\(c_2= 1 / (c-1) \times 100\)</span> avec <em>l</em> et <em>c</em> étant respectivement les nombres de modalités en ligne et en colonne. Autrement dit, lorsque les données sont distribuées aléatoirement, la valeur propre en pourcentage devrait être égale à <span class="math inline">\(c_1\)</span> et celle de l’axe factoriel moyen à <span class="math inline">\(c_2\)</span>. Par conséquent, nous pourrions retenir uniquement les axes dont les valeurs propres en pourcentage excèdent&nbsp;: <span class="math inline">\(c_1 = \mbox{1}/(\mbox{521}-\mbox{1})\times \mbox{100}=\mbox{0,19 }%\)</span> et <span class="math inline">\(c_2=\mbox{1}/(\mbox{6}-\mbox{1})\times \mbox{100}=\mbox{20 }%\)</span>. En appliquant ces deux critères, seul le premier axe factoriel qui résume 65,6&nbsp;% mérite d’être retenu.</p></li>
<li><p><strong>Approche empirique</strong> basée sur la lecture des pourcentages et des pourcentages cumulés. Nous retenons uniquement les deux premières composantes qui résument 85&nbsp;% de la variance totale. Pour faciliter le choix du nombre d’axes avec cette approche empirique, il est fortement conseillé de construire un histogramme à partir des valeurs propres, soit brutes, soit en pourcentage, soit en pourcentage cumulé (<a href="#fig-afcGraphVP">figure&nbsp;<span class="quarto-unresolved-ref">fig-afcGraphVP</span></a>).</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-afcGraphVP" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-afcGraphVP-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.25: Histogramme des valeurs propres de l’AFC</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-12322" class="level4" data-number="12.3.2.2"><h4 data-number="12.3.2.2" class="anchored" data-anchor-id="sec-12322">
<span class="header-section-number">12.3.2.2</span> Résultats de l’AFC pour les variables et les individus</h4>
<p>Comme pour l’ACP, nous retrouvons les trois mêmes mesures pour les variables et les individus&nbsp;: 1)&nbsp;les coordonnées factorielles, 2)&nbsp;les contributions et 3)&nbsp;les cosinus carrés.</p>
<div class="bloc_objectif">
<div class="bloc_objectif-header">
<div class="bloc_objectif-icon">

</div>
<p><strong>Compréhension des axes factoriels de l’AFC&nbsp;: une étape essentielle, incontournable…</strong></p>
</div>
<div class="bloc_objectif-body">
<p>Comme en ACP, l’analyse des trois mesures (coordonnées, contributions et cosinus carrés) pour les variables et les individus doit vous permettre de comprendre la signification des axes factoriels retenus de l’AFC. Cette étape d’interprétation est essentielle afin de qualifier les variables latentes (axes factoriels, variables synthétiques) produites par l’AFC.</p>
</div>
</div>
<ul>
<li>
<strong>Les coordonnées factorielles</strong> sont simplement les projections des points-lignes et des points-colonnes sur les axes de l’AFC. Tant pour les lignes que pour les colonnes, ces coordonnées bénéficient de deux propriétés intéressantes. Premièrement, pour chaque axe factoriel <em>k</em>, la somme du produit des marges des variables (<span class="math inline">\(f.j\)</span>, colonnes) ou des individus (<span class="math inline">\(fi.\)</span>, lignes) avec leurs coordonnées respectives (<span class="math inline">\(C^k_j\)</span> et <span class="math inline">\(C^k_i\)</span>) est égale à 0 (<a href="#eq-CoordPropr1">équation&nbsp;<span class="quarto-unresolved-ref">eq-CoordPropr1</span></a>). Deuxièmement, pour chaque axe factoriel <em>k</em>, la somme des produits entre les marges (en ligne et en colonne) et les coordonnées au carré (en ligne et en colonne) est égale à la valeur propre de l’axe (<a href="#eq-CoordPropr2">équation&nbsp;<span class="quarto-unresolved-ref">eq-CoordPropr2</span></a>).</li>
</ul>
<p><span id="eq-CoordPropr1"><span class="math display">\[
\sum{f.j (C^k_j)}= 0 \text{ et} \sum{fi. (C^k_i)}= 0
\tag{12.7}\]</span></span></p>
<p><span id="eq-CoordPropr2"><span class="math display">\[
\sum{fi. (C^k_i)^2}= \mu_k \text{ et} \sum{f.j (C^k_j)^2}= \mu_k
\tag{12.8}\]</span></span></p>
<p>En guise d’exemple, le <a href="#tbl-dataafcCoordVars2">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dataafcCoordVars2</span></a> permet de vérifier les deux propriétés des coordonnées pour les variables. Les sommes de <span class="math inline">\({f.j (C^k_j)}\)</span> pour les axes&nbsp;1 et&nbsp;2 sont bien égales à 0; et les sommes de <span class="math inline">\({f.j (C^k_j)^2}\)</span> pour les axes&nbsp;1 et&nbsp;2 sont bien égales aux valeurs propres de ces deux axes, soit 0,156 et 0,046 (comparez ces valeurs avec celles reportées au <a href="#tbl-dataafcValeurPropres">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dataafcValeurPropres</span></a> plus haut).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-dataafcCoordVars2" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.16: Vérification des deux propriétés des coordonnées factorielles pour les variables</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Coord.
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
f.j x Coord.
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
f.j x Coord2
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Modalité</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">f.j</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">VehCond</td>
<td style="text-align: right;">0,499</td>
<td style="text-align: right;">-0,329</td>
<td style="text-align: right;">0,077</td>
<td style="text-align: right;">-0,164</td>
<td style="text-align: right;">0,038</td>
<td style="text-align: right;">0,054</td>
<td style="text-align: right;">0,003</td>
</tr>
<tr class="even">
<td style="text-align: left;">VehPass</td>
<td style="text-align: right;">0,031</td>
<td style="text-align: right;">-0,255</td>
<td style="text-align: right;">0,081</td>
<td style="text-align: right;">-0,008</td>
<td style="text-align: right;">0,003</td>
<td style="text-align: right;">0,002</td>
<td style="text-align: right;">0,000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TranspC</td>
<td style="text-align: right;">0,345</td>
<td style="text-align: right;">0,208</td>
<td style="text-align: right;">-0,229</td>
<td style="text-align: right;">0,072</td>
<td style="text-align: right;">-0,079</td>
<td style="text-align: right;">0,015</td>
<td style="text-align: right;">0,018</td>
</tr>
<tr class="even">
<td style="text-align: left;">Apied</td>
<td style="text-align: right;">0,081</td>
<td style="text-align: right;">0,813</td>
<td style="text-align: right;">0,545</td>
<td style="text-align: right;">0,066</td>
<td style="text-align: right;">0,044</td>
<td style="text-align: right;">0,053</td>
<td style="text-align: right;">0,024</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Velo</td>
<td style="text-align: right;">0,036</td>
<td style="text-align: right;">0,938</td>
<td style="text-align: right;">-0,187</td>
<td style="text-align: right;">0,033</td>
<td style="text-align: right;">-0,007</td>
<td style="text-align: right;">0,031</td>
<td style="text-align: right;">0,001</td>
</tr>
<tr class="even">
<td style="text-align: left;">AutreMoyen</td>
<td style="text-align: right;">0,009</td>
<td style="text-align: right;">0,142</td>
<td style="text-align: right;">0,078</td>
<td style="text-align: right;">0,001</td>
<td style="text-align: right;">0,001</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Somme</td>
<td style="text-align: right;">1,000</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,156</td>
<td style="text-align: right;">0,046</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Particularité de l’AFC</strong></p>
</div>
<div class="bloc_attention-body">
<p>Contrairement à l’ACP, les coordonnées factorielles pour les variables en AFC ne sont pas les coefficients de corrélation de Pearson des variables sur les axes!</p>
</div>
</div>
<ul>
<li>
<strong>Les contributions</strong> des colonnes ou des lignes en AFC permettent de repérer celles qui contribuent le plus à la formation des axes factoriels (de manière analogue à l’ACP). Pour un axe donné, leur sommation est égale à&nbsp;100&nbsp;%. Elles s’obtiennent en multipliant la coordonnée au carré avec la marge et en divisant le tout par la valeur propre de l’axe (équations&nbsp;<a href="#eq-CtrAFCVar"><span class="quarto-unresolved-ref ref-noprefix">eq-CtrAFCVar</span></a> et&nbsp;<a href="#eq-CtrAFCInd"><span class="quarto-unresolved-ref ref-noprefix">eq-CtrAFCInd</span></a>).</li>
</ul>
<p><span id="eq-CtrAFCVar"><span class="math display">\[
\mbox{Ctr}_j^k =\frac{f.j(C^k_j)^2}{\mu_{k}}\times 100
\tag{12.9}\]</span></span></p>
<p><span id="eq-CtrAFCInd"><span class="math display">\[
\mbox{Ctr}_i^k =\frac{fi.(C^k_i)^2}{\mu_{k}}\times 100
\tag{12.10}\]</span></span></p>
<ul>
<li>
<strong>Les cosinus carrés</strong> (Cos<sup>2</sup>) (appelés aussi les qualités de représentation sur un axe) permettent de repérer le ou les axes qui concourent le plus à donner un sens aux colonnes (variables) et aux lignes (individus), de manière analogue à l’ACP. Pour une variable ou un individu, la sommation des Cos<sup>2</sup> pour tous les axes de l’AFC est aussi égale à 1.</li>
</ul>
<p><strong>Interprétation des résultats pour les colonnes (variables)</strong></p>
<p>Maintenant, analysons ces trois statistiques pour les variables pour les deux premiers axes de l’AFC (<a href="#tbl-dataafcCoordVars">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dataafcCoordVars</span></a> et <a href="#fig-afc1erplanfactVars">figure&nbsp;<span class="quarto-unresolved-ref">fig-afc1erplanfactVars</span></a>).</p>
<p>Pour l’axe&nbsp;1, résumant 65&nbsp;% de la variance, trois modalités concourent à sa formation&nbsp;: <code>VehCond</code> (34,69&nbsp;%), <code>Apied</code> (34,25&nbsp;%) et <code>Velo</code> (20,13&nbsp;%). À la lecture des coordonnées factorielles sur cet axe, les modes de transport relatifs aux véhicules motorisés (<code>VehCond</code>&nbsp;=&nbsp;-0,33 et <code>VehPass</code>&nbsp;=&nbsp;-0,25) s’opposent clairement aux modes actifs (<code>Apied</code>&nbsp;=&nbsp;0,81 et <code>Velo</code>&nbsp;=&nbsp;0,94), constat qu’il est possible de confirmer visuellement avec la <a href="#fig-afc1erplanfactVars">figure&nbsp;<span class="quarto-unresolved-ref">fig-afc1erplanfactVars</span></a>. La modalité <code>VehCond</code> a d’ailleurs la plus forte valeur de Cos<sup>2</sup> sur cet axe (0,92), ce qui signale, sans l’ombre d’un doute, que l’axe&nbsp;1 est celui qui donne le plus de sens à cette modalité.</p>
<p>Puisque l’axe&nbsp;2 résume une partie beaucoup plus limitée de la variance du tableau (19,25&nbsp;%), il n’est pas étonnant qu’un nombre plus limité de modalités concourent à sa formation&nbsp;: seules les contributions de la modalité <code>Apied</code> (51,68&nbsp;%) et secondairement de <code>TranspC</code> (38,81&nbsp;%) sont importantes. Leurs coordonnées factorielles s’opposent d’ailleurs sur cet axe (respectivement 0,81 et 0,21).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-dataafcCoordVars" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.17: Résultats de l’AFC pour les variables</caption>
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Coordonnées
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cosinus carrés
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Contributions (%)
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Modalité</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">VehCond</td>
<td style="text-align: right;">-0,33</td>
<td style="text-align: right;">0,08</td>
<td style="text-align: right;">0,92</td>
<td style="text-align: right;">0,05</td>
<td style="text-align: right;">34,69</td>
<td style="text-align: right;">6,33</td>
</tr>
<tr class="even">
<td style="text-align: left;">VehPass</td>
<td style="text-align: right;">-0,25</td>
<td style="text-align: right;">0,08</td>
<td style="text-align: right;">0,34</td>
<td style="text-align: right;">0,03</td>
<td style="text-align: right;">1,28</td>
<td style="text-align: right;">0,44</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TranspC</td>
<td style="text-align: right;">0,21</td>
<td style="text-align: right;">-0,23</td>
<td style="text-align: right;">0,39</td>
<td style="text-align: right;">0,47</td>
<td style="text-align: right;">9,53</td>
<td style="text-align: right;">38,81</td>
</tr>
<tr class="even">
<td style="text-align: left;">Apied</td>
<td style="text-align: right;">0,81</td>
<td style="text-align: right;">0,54</td>
<td style="text-align: right;">0,67</td>
<td style="text-align: right;">0,30</td>
<td style="text-align: right;">34,25</td>
<td style="text-align: right;">51,61</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Velo</td>
<td style="text-align: right;">0,94</td>
<td style="text-align: right;">-0,19</td>
<td style="text-align: right;">0,56</td>
<td style="text-align: right;">0,02</td>
<td style="text-align: right;">20,13</td>
<td style="text-align: right;">2,69</td>
</tr>
<tr class="even">
<td style="text-align: left;">AutreMoyen</td>
<td style="text-align: right;">0,14</td>
<td style="text-align: right;">0,08</td>
<td style="text-align: right;">0,05</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,12</td>
<td style="text-align: right;">0,12</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-afc1erplanfactVars" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-afc1erplanfactVars-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.26: Premier plan factoriel de l’AFC pour les variables</figcaption></figure>
</div>
</div>
</div>
<p><strong>Interprétation des résultats pour les individus</strong></p>
<div class="bloc_notes">
<div class="bloc_notes-header">
<div class="bloc_notes-icon">

</div>
<p><strong>Premier plan factoriel pour les variables et les individus</strong></p>
</div>
<div class="bloc_notes-body">
<p>Lorsque le jeu de données comprend à la fois peu de modalités en ligne et en colonne, il est judicieux de les représenter simultanément sur le premier plan factoriel (axes&nbsp;1 et&nbsp;2). Pour ce faire, vous pouvez utiliser la fonction <code>fviz_ca_biplot</code> du <em>package</em> <code>factoextra</code>.</p>
</div>
</div>
<p>Étant donné que notre jeu de données comprend 521&nbsp;secteurs de recensement, nous proposons ici de cartographier les coordonnées factorielles des individus pour les deux premiers axes de l’AFC (<a href="#fig-afc1erplanfactInds2">figure&nbsp;<span class="quarto-unresolved-ref">fig-afc1erplanfactInds2</span></a>). Pour l’axe&nbsp;1, les secteurs de recensement à l’est et l’ouest de l’île de Montréal présentent les coordonnées les plus fortement négatives (en rouge); dans ces zones, l’usage des véhicules motorisés pour des déplacements domicile-travail est certainement surreprésenté, comparativement aux modes actifs. À l’inverse, dans les secteurs de recensement du centre de l’île présentant de fortes valeurs positives (en rouge), le recours aux modes de transports actifs (marche et vélo) est bien plus important, toutes proportions gardées. Quant à la cartographie des coordonnées pour l’axe&nbsp;2, elle permet surtout de repérer quelques secteurs de recensement autour du centre-ville (très fortes valeurs positives en vert foncé) où les déplacements domicile-travail à pied sont plus fréquents, toutes proportions gardées.</p>
<p>En résumé, suite à l’analyse des coordonnées factorielles des variables et des individus, nous pouvons conclure que le premier axe est certainement le plus intéressant puisqu’il permet d’opposer l’usage des modes de transports motorisés versus les modes de transports actifs pour les déplacements domicile-travail sur l’île de Montréal. Cette nouvelle variable synthétique (variable latente) pourrait ainsi être introduite dans des analyses subséquentes (par exemple, dans un modèle de régression). Cela démontre qu’au même titre que l’ACP, l’AFC est une méthode de réduction de données puisque nous sommes passés d’un tableau comprenant 512 secteurs de recensement et six modalités à un tableau comprenant une seule variable synthétique (axe&nbsp;1).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-afc1erplanfactInds2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-afc1erplanfactInds2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.27: Cartographie de coordonnées factorielles des individus pour l’AFC</figcaption></figure>
</div>
</div>
</div>
<div class="bloc_aller_loin">
<div class="bloc_aller_loin-header">
<div class="bloc_aller_loin-icon">

</div>
<p><strong>Ajout de modalités supplémentaires dans une analyse des correspondances (AFC)</strong></p>
</div>
<div class="bloc_aller_loin-body">
<p>Comme pour l’ACP, il est possible d’ajouter des variables et des individus supplémentaires une fois l’AFC calculée. En guise d’illustration, nous avons ajouté à l’AFC précédemment analysée des modalités relatives à la durée des temps de déplacements&nbsp;: moins de 15 minutes, 15 à 29, 30 à 44, 45 à 59, 60 minutes et plus. Sans surprise, sur le premier plan factoriel à la <a href="#fig-afc1erplanfactInds2">figure&nbsp;<span class="quarto-unresolved-ref">fig-afc1erplanfactInds2</span></a>, cette dernière modalité, représentant les trajets les plus longs, est la plus proche des modalités relatives à l’usage des véhicules motorisés (<code>VehCond</code> et <code>VehPass</code>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-afcAjoutModalites" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-afcAjoutModalites-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.28: Ajout de modalités supplémentaires sur le premier plan factoriel de l’AFC</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="sec-1233" class="level3" data-number="12.3.3"><h3 data-number="12.3.3" class="anchored" data-anchor-id="sec-1233">
<span class="header-section-number">12.3.3</span> Mise en œuvre dans R</h3>
<section id="sec-12331" class="level4" data-number="12.3.3.1"><h4 data-number="12.3.3.1" class="anchored" data-anchor-id="sec-12331">
<span class="header-section-number">12.3.3.1</span> Calcul d’une AFC avec <code>FactoMineR</code>
</h4>
<p>Plusieurs <em>packages</em> permettent de calculer une AFC dans R, notamment <code>ca</code> (fonction <code>ca</code>), <code>MASS</code> (fonction <code>corresp</code>), <code>ade4</code> (fonction <code>dudi.coa</code>) et <code>FactoMineR</code> (fonction <code>CA</code>). De nouveau, nous utilisons <code>FactoMineR</code> couplé au <em>package</em> <code>factoextra</code> pour réaliser rapidement des graphiques avec les résultats pour les variables et les coordonnées.</p>
<p>Pour calculer l’AFC, il suffit d’utiliser la fonction <code>CA</code> de <code>FactoMineR</code>, puis la fonction <code>summary(res.afc)</code>, qui renvoie les résultats de l’AFC pour&nbsp;:</p>
<ul>
<li><p>Les valeurs propres (section <code>Eigenvalues</code>) pour les axes factoriels (<code>Dim.1</code> à <code>Dim.n</code>) avec leur variance expliquée brute (<code>Variance</code>), en pourcentage (<code>% of var.</code>) et en pourcentage cumulé (<code>Cumulative % of var.</code>).</p></li>
<li><p>Les dix premières observations (section <code>Rows</code>) avec les coordonnées factorielles (<code>Dim.1</code> à <code>Dim.n</code>), les contributions (<code>ctr</code>) et les cosinus carrés (<code>cos2</code>). Pour accéder aux résultats pour toutes les observations, utilisez les fonctions <code>res.afc$row</code> ou encore <code>res.afc$row$coord</code> (uniquement les coordonnées factorielles), <code>res.afc$row$contrib</code> (uniquement les contributions) et <code>res.afc$row$cos2</code> (uniquement les cosinus carrés).</p></li>
<li><p>Les colonnes (section <code>Columns</code>) avec les coordonnées factorielles (D<code>im.1</code> à <code>Dim.n</code>), les contributions (<code>ctr</code>) et les cosinus carrés (<code>cos2</code>).</p></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Chargement des packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span>
<span><span class="co"># Chargement des données</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/analysesfactorielles/DonneesAFC.Rdata"</span><span class="op">)</span></span>
<span><span class="co"># Avant de calculer l'AFC, il convient de vérifier si les deux variables</span></span>
<span><span class="co"># qualitatives sont dépendantes avec le test du khi-deux</span></span>
<span><span class="va">khideux</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">dfDonneesAFC</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">khideux</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  dfDonneesAFC[, 1:6]
X-squared = 207129, df = 2600, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="va">khideux</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&lt;=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"La valeur de p &lt; 0,05. Les variables sont dépendantes. Calculez l'AFC."</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"La valeur de p &gt; 0,05. Les variables sont indépendantes. Inutile de calculer l'AFC"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>La valeur de p &lt; 0,05. Les variables sont dépendantes. Calculez l'AFC.</code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcul de l'analyse des correspondances sur les six premières variables</span></span>
<span><span class="va">res.afc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/CA.html">CA</a></span><span class="op">(</span><span class="va">dfDonneesAFC</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Affichage des résultats de la fonction CA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">res.afc</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>**Results of the Correspondence Analysis (CA)**
The row variable has  521  categories; the column variable has 6 categories
The chi square of independence between the two variables is equal to 207129.3 (p-value =  0 ).
*The results are available in the following objects:

   name              description                   
1  "$eig"            "eigenvalues"                 
2  "$col"            "results for the columns"     
3  "$col$coord"      "coord. for the columns"      
4  "$col$cos2"       "cos2 for the columns"        
5  "$col$contrib"    "contributions of the columns"
6  "$row"            "results for the rows"        
7  "$row$coord"      "coord. for the rows"         
8  "$row$cos2"       "cos2 for the rows"           
9  "$row$contrib"    "contributions of the rows"   
10 "$call"           "summary called parameters"   
11 "$call$marge.col" "weights of the columns"      
12 "$call$marge.row" "weights of the rows"         </code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualisation des marges en colonne</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">res.afc</span><span class="op">$</span><span class="va">call</span><span class="op">$</span><span class="va">marge.col</span>,<span class="fl">4</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   VehCond    VehPass    TranspC      Apied       Velo AutreMoyen 
    0.4986     0.0309     0.3449     0.0808     0.0357     0.0090 </code></pre>
</div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualisation des marges en ligne. Étant donné que nous avons 521 individus, </span></span>
<span><span class="co"># la ligne ci-dessous est en commentaire</span></span>
<span><span class="co"># round(res.afc$call$marge.row,4)</span></span>
<span></span>
<span><span class="co"># Sommaire des résultats de l'AFC</span></span>
<span><span class="co"># Remarquez que la première ligne de ce sommaire est le résultat du khi-deux</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res.afc</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
CA(X = dfDonneesAFC[, 1:6], graph = FALSE) 

The chi square of independence between the two variables is equal to 207129.3 (p-value =  0 ).

Eigenvalues
                       Dim.1   Dim.2   Dim.3   Dim.4   Dim.5
Variance               0.156   0.046   0.031   0.004   0.004
% of var.             64.590  19.250  12.995   1.683   1.482
Cumulative % of var.  64.590  83.840  96.835  98.518 100.000

Rows (the 10 first)
             Iner*1000    Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3
1          |     0.155 | -0.304  0.095  0.961 | -0.023  0.002  0.006 |  0.048
2          |     0.123 | -0.232  0.067  0.850 |  0.028  0.003  0.012 | -0.021
3          |     0.268 | -0.246  0.127  0.737 | -0.002  0.000  0.000 | -0.046
4          |     0.102 | -0.168  0.034  0.513 | -0.111  0.049  0.222 | -0.117
5          |     0.118 | -0.251  0.067  0.883 |  0.004  0.000  0.000 | -0.007
6          |     0.120 | -0.130  0.024  0.313 | -0.103  0.051  0.196 | -0.144
7          |     0.124 | -0.029  0.002  0.022 | -0.158  0.167  0.626 | -0.079
8          |     0.073 | -0.157  0.028  0.598 | -0.090  0.031  0.195 | -0.006
9          |     0.014 | -0.060  0.005  0.506 | -0.033  0.005  0.150 | -0.018
10         |     0.040 |  0.004  0.000  0.000 | -0.204  0.073  0.838 |  0.053
              ctr   cos2  
1           0.012  0.024 |
2           0.003  0.007 |
3           0.022  0.026 |
4           0.080  0.246 |
5           0.000  0.001 |
6           0.146  0.380 |
7           0.061  0.155 |
8           0.000  0.001 |
9           0.002  0.048 |
10          0.007  0.056 |

Columns
             Iner*1000    Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3
VehCond    |    58.559 | -0.329 34.687  0.924 |  0.077  6.331  0.050 |  0.051
VehPass    |     5.923 | -0.255  1.283  0.338 |  0.081  0.440  0.035 |  0.001
TranspC    |    38.261 |  0.208  9.534  0.389 | -0.229 38.812  0.472 | -0.124
Apied      |    79.193 |  0.813 34.252  0.675 |  0.545 51.610  0.303 | -0.147
Velo       |    55.633 |  0.938 20.126  0.564 | -0.187  2.688  0.022 |  0.802
AutreMoyen |     3.969 |  0.142  0.117  0.046 |  0.078  0.119  0.014 |  0.070
              ctr   cos2  
VehCond     4.141  0.022 |
VehPass     0.000  0.000 |
TranspC    16.995  0.139 |
Apied       5.543  0.022 |
Velo       73.180  0.413 |
AutreMoyen  0.140  0.011 |</code></pre>
</div>
</div>
</section><section id="sec-12332" class="level4" data-number="12.3.3.2"><h4 data-number="12.3.3.2" class="anchored" data-anchor-id="sec-12332">
<span class="header-section-number">12.3.3.2</span> Exploration graphique des résultats de l’AFC avec <code>factoextra</code>
</h4>
<p>Comme pour l’ACP, <code>factoextra</code> dispose de plusieurs fonctions très intéressantes pour construire rapidement des graphiques avec les résultats de l’AFC. Premièrement, la syntaxe ci-dessous (avec la fonction <code>fviz_screeplot</code>) renvoie deux graphiques pour analyser les résultats des valeurs propres de l’AFC (<a href="#fig-factoextraAFC1">figure&nbsp;<span class="quarto-unresolved-ref">fig-factoextraAFC1</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Nombre de modalités en ligne et en colonne</span></span>
<span><span class="va">ModalitesLig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dfDonneesAFC</span><span class="op">)</span></span>
<span><span class="va">ModalitesCol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">dfDonneesAFC</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># Critère statistique du profil moyen</span></span>
<span><span class="va">critere2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">ModalitesCol</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">texte</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Critère pour le profil moyen : "</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">critere2</span><span class="op">)</span>, <span class="st">" %"</span><span class="op">)</span></span>
<span><span class="co"># Graphique avec les valeurs propres</span></span>
<span><span class="va">G1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eigenvalue.html">fviz_screeplot</a></span><span class="op">(</span><span class="va">res.afc</span>, choice <span class="op">=</span> <span class="st">"eigenvalue"</span>,</span>
<span>               ylab <span class="op">=</span> <span class="st">"Valeurs propres"</span>,</span>
<span>               xlab <span class="op">=</span> <span class="st">"Axes factoriels"</span>,</span>
<span>               main<span class="op">=</span><span class="st">"Valeurs propres"</span><span class="op">)</span></span>
<span><span class="va">G2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eigenvalue.html">fviz_screeplot</a></span><span class="op">(</span><span class="va">res.afc</span>, choice <span class="op">=</span> <span class="st">"variance"</span>, addlabels <span class="op">=</span> <span class="cn">TRUE</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">70</span><span class="op">)</span>,</span>
<span>                     ylab <span class="op">=</span> <span class="st">"Variance expliquée (%)"</span>,</span>
<span>                     xlab <span class="op">=</span> <span class="st">"Axes factoriels"</span>,</span>
<span>                     main<span class="op">=</span><span class="st">"Valeurs propres (%)"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="va">c2</span>, linetype<span class="op">=</span><span class="fl">1</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="va">ModalitesCol</span><span class="op">-</span><span class="fl">.5</span>,</span>
<span>          y <span class="op">=</span> <span class="va">critere2</span><span class="op">+</span><span class="fl">3</span>, label<span class="op">=</span><span class="va">texte</span>, </span>
<span>          color <span class="op">=</span> <span class="st">"red"</span>, hjust<span class="op">=</span><span class="fl">1</span>, linewidth <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in annotate(geom = "text", x = ModalitesCol - 0.5, y = critere2 + :
Ignoring unknown parameters: `linewidth`</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">G1</span>, <span class="va">G2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-factoextraAFC1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-factoextraAFC1-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.29: Graphiques pour les valeurs propres de l’AFC avec factoextra</figcaption></figure>
</div>
</div>
</div>
<p>Avec les fonctions <code>fviz_contrib</code> et <code>fviz_cos2</code>, il est très facile de réaliser des histogrammes pour les contributions et les cosinus carrés pour les variables (colonnes) ou les individus (lignes), et ce, avec le paramètre <code>choice = c("row", "col")</code> (<a href="#fig-acp1erplanfactVars2a">figure&nbsp;<span class="quarto-unresolved-ref">fig-acp1erplanfactVars2a</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span><span class="va">VP1pct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">res.afc</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">VP2pct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">res.afc</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">G1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_contrib.html">fviz_contrib</a></span> <span class="op">(</span><span class="va">res.afc</span>, choice <span class="op">=</span> <span class="st">"col"</span>, axes <span class="op">=</span> <span class="fl">1</span>, title <span class="op">=</span> <span class="st">"Axe 1"</span><span class="op">)</span></span>
<span><span class="va">G2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_contrib.html">fviz_contrib</a></span> <span class="op">(</span><span class="va">res.afc</span>, choice <span class="op">=</span> <span class="st">"col"</span>, axes <span class="op">=</span> <span class="fl">2</span>, title <span class="op">=</span> <span class="st">"Axe 2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">G1</span>, <span class="va">G2</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-acp1erplanfactVars2a" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-acp1erplanfactVars2a-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.30: Contributions des variables avec factoextra</figcaption></figure>
</div>
</div>
</div>
<p>Quant aux fonctions <code>fviz_ca_col</code> et <code>fviz_ca_row</code>, elles permettent rapidement de construire le premier plan factoriel pour les colonnes (variables) et les lignes (individus) (<a href="#fig-afc1erplanfactVars2b">figure&nbsp;<span class="quarto-unresolved-ref">fig-afc1erplanfactVars2b</span></a>). Aussi, la fonction <code>fviz_ca_biplot</code> permet de construire un plan factoriel, mais avec les lignes et les colonnes simultanément.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">G3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_ca.html">fviz_ca_col</a></span><span class="op">(</span><span class="va">res.afc</span>,</span>
<span>            repel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            geom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"text"</span> , <span class="st">"point"</span><span class="op">)</span>,</span>
<span>            col.col <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>            title <span class="op">=</span> <span class="st">"Mode de transport"</span>,</span>
<span>            xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Axe 1 ("</span>, <span class="va">VP1pct</span>, <span class="st">" %)"</span><span class="op">)</span>,</span>
<span>            ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Axe 2 ("</span>, <span class="va">VP2pct</span>, <span class="st">" %)"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_ca.html">fviz_ca_row</a></span><span class="op">(</span><span class="va">res.afc</span>,</span>
<span>            repel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            geom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"point"</span><span class="op">)</span>,</span>
<span>            col.row <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>            title <span class="op">=</span> <span class="st">"Secteurs de recensement"</span>,</span>
<span>            xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Axe 1 ("</span>, <span class="va">VP1pct</span>, <span class="st">" %)"</span><span class="op">)</span>,</span>
<span>            ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Axe 2 ("</span>, <span class="va">VP2pct</span>, <span class="st">" %)"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">G3</span>, <span class="va">G4</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-afc1erplanfactVars2b" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-afc1erplanfactVars2b-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.31: Premier plan factoriel de l’AFC pour les variables et les individus avec factoextra</figcaption></figure>
</div>
</div>
</div>
<p>La syntaxe ci-dessous permet d’ajouter des modalités supplémentaires dans l’AFC et de constuire le graphique du premier plan factoriel (<a href="#fig-afcAjoutModalites2">figure&nbsp;<span class="quarto-unresolved-ref">fig-afcAjoutModalites2</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Les colonnes 7 à 11 sont mises comme des variables supplémentaires dans l'AFC</span></span>
<span><span class="va">res.afc2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/CA.html">CA</a></span><span class="op">(</span><span class="va">dfDonneesAFC</span>, col.sup <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">11</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">VP1pct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">res.afc2</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">VP2pct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">res.afc2</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_ca.html">fviz_ca_col</a></span><span class="op">(</span><span class="va">res.afc2</span>,</span>
<span>            repel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            geom<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"text"</span> , <span class="st">"point"</span><span class="op">)</span>,</span>
<span>            col.col <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>            title <span class="op">=</span> <span class="st">""</span>,</span>
<span>            xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Axe 1 ("</span>, <span class="va">VP1pct</span>, <span class="st">" %)"</span><span class="op">)</span>,</span>
<span>            ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Axe 2 ("</span>, <span class="va">VP2pct</span>, <span class="st">" %)"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-afcAjoutModalites2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-afcAjoutModalites2-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.32: Ajout de modalités supplémentaires sur le premier plan factoriel l’AFC avec factoextra</figcaption></figure>
</div>
</div>
</div>
<p>Finalement, la syntaxe ci-dessous permet de cartographier les coordonnées factorielles des individus de l’AFC avec le <em>package</em> <code>tmap</code> (<a href="#fig-afc1erplanfactInds2B">figure&nbsp;<span class="quarto-unresolved-ref">fig-afc1erplanfactInds2B</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-tmap.github.io/tmap/">tmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="va">dfAFCInd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Coord <span class="op">=</span> <span class="va">res.afc</span><span class="op">$</span><span class="va">row</span><span class="op">$</span><span class="va">coord</span>, </span>
<span>                       Cos2 <span class="op">=</span> <span class="va">res.afc</span><span class="op">$</span><span class="va">row</span><span class="op">$</span><span class="va">cos2</span>, </span>
<span>                       Ctr <span class="op">=</span> <span class="va">res.afc</span><span class="op">$</span><span class="va">row</span><span class="op">$</span><span class="va">contrib</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dfAFCInd</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dfAFCInd</span><span class="op">)</span>, <span class="st">".Dim."</span>, <span class="st">"Comp"</span><span class="op">)</span></span>
<span><span class="va">CartoAFC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">sfDonneesAFC</span>, <span class="va">dfAFCInd</span><span class="op">)</span></span>
<span><span class="va">VP1pct</span> <span class="op">&lt;-</span> <span class="fu">tofr</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">res.afc</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">VP2pct</span> <span class="op">&lt;-</span> <span class="fu">tofr</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">res.afc</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Carte1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">CartoAFC</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_polygons.html">tm_fill</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"CoordComp1"</span>, style <span class="op">=</span> <span class="st">"cont"</span>, midpoint <span class="op">=</span> <span class="fl">0</span>, title <span class="op">=</span> <span class="st">"Coordonnées"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_layout.html">tm_layout</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Axe 1 ("</span>, <span class="va">VP1pct</span>,<span class="st">"%)"</span><span class="op">)</span>, attr.outside <span class="op">=</span> <span class="cn">TRUE</span>, frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Carte2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">CartoAFC</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_polygons.html">tm_fill</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"CoordComp2"</span>, style <span class="op">=</span> <span class="st">"cont"</span>, midpoint <span class="op">=</span> <span class="fl">0</span>, title <span class="op">=</span> <span class="st">"Coordonnées"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_layout.html">tm_layout</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Axe 2 ("</span>, <span class="va">VP2pct</span>,<span class="st">"%)"</span><span class="op">)</span>, attr.outside <span class="op">=</span> <span class="cn">TRUE</span>, frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tmap_arrange.html">tmap_arrange</a></span><span class="op">(</span><span class="va">Carte1</span>, <span class="va">Carte2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-afc1erplanfactInds2B" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-afc1erplanfactInds2B-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.33: Cartographie de coordonnées factorielles des individus pour l’AFC</figcaption></figure>
</div>
</div>
</div>
</section></section></section><section id="sec-124" class="level2" data-number="12.4"><h2 data-number="12.4" class="anchored" data-anchor-id="sec-124">
<span class="header-section-number">12.4</span> Analyse de correspondances multiples (ACM)</h2>
<p>L’analyse des correspondances multiples (ACM) est particulièrement adaptée à l’exploration de données issues d’une enquête par sondage, puisqu’elle permet de résumer/synthétiser l’information d’un tableau comprenant uniquement des variables qualitatives (<a href="#fig-AnalysesFactoriellesTabACM">figure&nbsp;<span class="quarto-unresolved-ref">fig-AnalysesFactoriellesTabACM</span></a>).</p>
<div id="fig-AnalysesFactoriellesTabACM" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap12/AnalysesFactoriellesTabACM.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.34: Lieu de pèlerinage de R</figcaption></figure>
</div>
<p>Par exemple, une enquête sur la mobilité d’une population donnée pourrait comprendre plusieurs variables qualitatives, dont celles reportées au <a href="#tbl-ACM1">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-ACM1</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-ACM1" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.18: Exemple de variables qualitatives issues d’une enquête</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Modalités des variables</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Codage</th>
</tr></thead>
<tbody>
<tr class="odd" data-grouplength="2">
<td colspan="2" style="border-bottom: 1px solid"><strong>Sexe</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Homme</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Femme</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even" data-grouplength="4">
<td colspan="2" style="border-bottom: 1px solid"><strong>Groupe d'âge</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Moins de 20 ans</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">20 à 39 ans</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">40 à 59 ans</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">60 ans et plus</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="odd" data-grouplength="4">
<td colspan="2" style="border-bottom: 1px solid"><strong>Mode de transport</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Automobile</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Transport en commun</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Marche</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Vélo</td>
<td style="text-align: center;">4</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Pour analyser de telles données, il suffit de transformer le tableau condensé (de données brutes) en un tableau disjonctif complet dans lequel chaque modalité des variables qualitatives devient une variable binaire prenant les valeurs de&nbsp;0 ou&nbsp;1 (tableaux <a href="#tbl-ACM2"><span class="quarto-unresolved-ref ref-noprefix">tbl-ACM2</span></a> et <a href="#tbl-ACM3"><span class="quarto-unresolved-ref ref-noprefix">tbl-ACM3</span></a>). Notez que la somme de chaque ligne est alors égale au nombre de variables qualitatives.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-ACM2" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.19: Tableau condensé (données brutes)</caption>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">Sexe</th>
<th style="text-align: center;">Groupe d’âge</th>
<th style="text-align: center;">Mode de transport</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ind. 1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ind. 2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ind. 3</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ind. 4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ind. 5</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ind. 6</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-ACM3" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.20: Tableau disjonctif complet</caption>
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Sexe
</div></th>
<th colspan="4" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Groupe d'âge
</div></th>
<th colspan="4" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Mode de transport
</div></th>
</tr>
<tr class="odd">
<th style="text-align: center;" data-quarto-table-cell-role="th">Individu</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Homme</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Femme</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Moins de 20 ans</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">20 à 39 ans</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">40 à 59 ans</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">60 ans et plus</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Auto.</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">T.C.</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Marche</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Vélo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Ind. 1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">Ind. 2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Ind. 3</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">Ind. 4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Ind. 5</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">Ind. 6</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>ACM versus AFC</strong></p>
</div>
<div class="bloc_astuce-body">
<p>Nous avons vu que l’AFC permet d’analyser un tableau de contingence avec deux variables qualitatives. En ACM, les colonnes sont les différentes modalités des variables qualitatives et les lignes sont les observations (par exemple, les individus ayant répondu à une enquête). En résumé, l’analyse des correspondances multiples (ACM) est simplement <strong>une analyse des correspondances (AFC) appliquée sur un tableau disjonctif complet</strong>.</p>
<p>L’ACM permet ainsi de révéler les ressemblances entre les différentes modalités des variables qualitatives et les ressemblances entre les différents individus. Par conséquent, elle produit également des variables synthétiques (axes factoriels) résumant l’information contenue dans le tableau initial. L’évaluation de ces ressemblances et la détermination des axes factoriels sont aussi basées sur la <strong>distance du khi-deux</strong>.</p>
</div>
</div>
<section id="sec-1241" class="level3" data-number="12.4.1"><h3 data-number="12.4.1" class="anchored" data-anchor-id="sec-1241">
<span class="header-section-number">12.4.1</span> Aides à l’interprétation</h3>
<p>Puisque l’ACM est une extension de l’AFC, nous retrouvons les mêmes aides à l’interprétation&nbsp;: les valeurs propres pour les axes, les coordonnées factorielles, les contributions et les cosinus carrés pour les variables et les individus.</p>
<p>Pour présenter l’ACM, nous utilisons des données ouvertes de la Ville de Montréal et, plus particulièrement, celles d’un <a href="https://www.donneesquebec.ca/recherche/dataset/vmtl-agriculture-urbaine-sondage" target="_blank">sondage auprès de la population de l’île de Montréal sur l’agriculture urbaine</a>. Pour ce faire, nous avons conservé uniquement les personnes pratiquant l’agriculture urbaine (n&nbsp;=&nbsp;352). Les variables qualitatives extraites pour l’ACM sont reportées au <a href="#tbl-dataACM">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dataACM</span></a>) avec la description des questions, leurs modalités respectives avec les effectifs bruts et en pourcentage. Au final, l’ACM est calculée de la manière suivante&nbsp;:</p>
<ul>
<li><p>Neuf variables qualitatives relatives à la pratique de l’agriculture urbaine sont retenues (<code>q3</code>, <code>q4</code>, <code>q5</code>, <code>q8</code>, <code>q9</code>, <code>q10</code>, <code>q11</code>, <code>q12</code> et <code>q13</code>).</p></li>
<li><p>Quatre variables relatives au profil socioéconomique des personnes répondantes sont introduites comme variables supplémentaires (<code>q15</code>, <code>q16</code>, <code>q17</code> et <code>q21</code>).</p></li>
<li><p>Chaque ligne est pondérée avec la variable <code>pond</code>.</p></li>
</ul>
<p>L’objectif de cette ACM est double&nbsp;:</p>
<ol type="1">
<li><p>Montrer les ressemblances entre les différentes modalités relatives à la pratique de l’agriculture urbaine. L’analyse des axes factoriels devrait nous permettre d’identifier différents profils des personnes pratiquant l’agriculture urbaine.</p></li>
<li><p>Projeter les modalités des variables socioéconomiques afin de vérifier si elles sont ou non associées aux axes factoriels, c’est-à-dire aux différents profils révélés par les axes.</p></li>
</ol>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Bloc attention</strong></p>
</div>
<div class="bloc_attention-body">
<p>L’analyse du sondage sur l’agriculture urbaine réalisée ici est purement exploratoire&nbsp;: elle vise uniquement à démontrer que l’ACM est un outil particulièrement intéressant pour analyser les données d’un sondage. Par contre, cette analyse n’a aucune prétention scientifique puisque nous ne sommes pas des spécialistes de l’agriculture urbaine. Dans ce champ de recherche très fertile qu’est l’agriculture urbaine (surement pas la meilleure blague du livre…), vous pourrez consulter plusieurs études montréalaises <span class="citation" data-cites="mcclintock2018urban audate2021motivations bhatt2016cultivating">(<a href="#ref-mcclintock2018urban" role="doc-biblioref">McClintock 2018</a>; <a href="#ref-audate2021motivations" role="doc-biblioref">Audate, Cloutier et Lebel 2021</a>; <a href="#ref-bhatt2016cultivating" role="doc-biblioref">Bhatt et Farah 2016</a>)</span>.</p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-dataACM" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.21: Variables qualitatives extraites du sondage sur l’agriculture urbaine de la Ville de Montréal</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Modalité</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">%</th>
</tr></thead>
<tbody>
<tr class="odd" data-grouplength="4">
<td colspan="3" style="border-bottom: 1px solid"><strong>Q3. Depuis combien de temps cultivez-vous des fruits, des fines herbes ou des légumes?</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q3. Moins de 1 an</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">9,9</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q3. De 1 à 4 ans</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">28,7</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q3. De 5 à 9 ans</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">18,8</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q3. 10 ans ou plus</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">42,6</td>
</tr>
<tr class="even" data-grouplength="4">
<td colspan="3" style="border-bottom: 1px solid"><strong>Q4. Selon vous, quelle proportion des fruits, des fines herbes et des légumes que vous consommez durant l'été provient de votre propre production?</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q4. Moins de 10%</td>
<td style="text-align: right;">192</td>
<td style="text-align: right;">54,5</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q4. 10 à 25%</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">19,9</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q4. 26 à 50%</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">13,4</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q4. Plus de 50%</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">12,2</td>
</tr>
<tr class="odd" data-grouplength="2">
<td colspan="3" style="border-bottom: 1px solid"><strong>Q5. Utilisez-vous du compost provenant de vos déchets verts ou alimentaires pour faire pousser des fruits, des fines herbes ou des légumes?</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q5. Oui</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">25,6</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q5. Non</td>
<td style="text-align: right;">262</td>
<td style="text-align: right;">74,4</td>
</tr>
<tr class="even" data-grouplength="2">
<td colspan="3" style="border-bottom: 1px solid"><strong>Q8. Récupérez-vous l'eau de pluie pour irriguer vos cultures de fruits, de fines herbes ou des légumes ou encore votre jardin?</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q8. Oui</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">20,5</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q8. Non</td>
<td style="text-align: right;">280</td>
<td style="text-align: right;">79,5</td>
</tr>
<tr class="odd" data-grouplength="4">
<td colspan="3" style="border-bottom: 1px solid"><strong>Q9. Combien de sortes de fruits, de fines herbes ou de légumes cultivez-vous?</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q9. Moins de 5 sortes</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">48,3</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q9. 5 à 9 sortes</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">35,2</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q9. 10 à 14 sortes</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">11,9</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q9. 15 sortes ou plus</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">4,5</td>
</tr>
<tr class="even" data-grouplength="2">
<td colspan="3" style="border-bottom: 1px solid"><strong>Q10. Cultivez-vous suffisamment de fruits, de fines herbes ou de légumes pour partager avec d'autres personnes?</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q10. Oui</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">40,6</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q10. Non</td>
<td style="text-align: right;">209</td>
<td style="text-align: right;">59,4</td>
</tr>
<tr class="odd" data-grouplength="2">
<td colspan="3" style="border-bottom: 1px solid"><strong>Q11. Échangez-vous vos semis ou vos récoltes de fruits, de fines herbes ou de légumes avec d'autres personnes?</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q11. Oui</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">25,6</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q11. Non</td>
<td style="text-align: right;">262</td>
<td style="text-align: right;">74,4</td>
</tr>
<tr class="even" data-grouplength="3">
<td colspan="3" style="border-bottom: 1px solid"><strong>Q12. Selon vous, l'agriculture urbaine contribue-t-elle à améliorer les rapports entre les gens?</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q12. Oui</td>
<td style="text-align: right;">283</td>
<td style="text-align: right;">80,4</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q12. Non</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">13,1</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q12. NSP/NRP</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">6,5</td>
</tr>
<tr class="even" data-grouplength="2">
<td colspan="3" style="border-bottom: 1px solid"><strong>Q13. Saviez-vous que la Ville de Montréal encourage et soutient l'agriculture urbaine sur l'île de Montréal?</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q13. Oui</td>
<td style="text-align: right;">203</td>
<td style="text-align: right;">57,7</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q13. Non</td>
<td style="text-align: right;">149</td>
<td style="text-align: right;">42,3</td>
</tr>
<tr class="odd" data-grouplength="4">
<td colspan="3" style="border-bottom: 1px solid"><strong>Q15. À quel groupe d'âge appartenez-vous?</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q15. 18 à 34 ans</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">15,3</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q15. 35 à 49 ans</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">31,2</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q15. 50 à 64 ans</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">28,7</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q15. 65 ans et plus</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">24,7</td>
</tr>
<tr class="even" data-grouplength="6">
<td colspan="3" style="border-bottom: 1px solid"><strong>Q16. Quelle est votre occupation principale?</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q16. Travail temps plein</td>
<td style="text-align: right;">177</td>
<td style="text-align: right;">50,3</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q16. Travail. temps partiel</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">7,4</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q16. Étudiant</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">4,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q16. Retraité</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">28,7</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q16. Sans emploi</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2,8</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q16. À la maison</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">6,8</td>
</tr>
<tr class="odd" data-grouplength="4">
<td colspan="3" style="border-bottom: 1px solid"><strong>Q17. Quel est le plus haut niveau de scolarité que vous avez complété?</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q17. Aucun certificat ou dipl.</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">7,1</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q17. Dipl. secondaires</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">22,7</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q17. Dipl. collégiales</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">21,3</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q17. Études universitaires</td>
<td style="text-align: right;">172</td>
<td style="text-align: right;">48,9</td>
</tr>
<tr class="even" data-grouplength="2">
<td colspan="3" style="border-bottom: 1px solid"><strong>Q21. Êtes-vous propriétaire ou locataire de votre résidence ?</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q21. Propriétaire</td>
<td style="text-align: right;">250</td>
<td style="text-align: right;">71,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q22. Locataire</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">29,0</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<section id="sec-12411" class="level4" data-number="12.4.1.1"><h4 data-number="12.4.1.1" class="anchored" data-anchor-id="sec-12411">
<span class="header-section-number">12.4.1.1</span> Résultats de l’ACM pour les valeurs propres</h4>
<p>Les résultats pour les valeurs propres sont reportés au <a href="#tbl-ACMValeursPropresTab">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-ACMValeursPropresTab</span></a> et à la <a href="#fig-ACMValeursPropresFig">figure&nbsp;<span class="quarto-unresolved-ref">fig-ACMValeursPropresFig</span></a>. En ACM, l’inertie totale du tableau des variables qualitatives est égale au nombre moyen de modalités par variable moins un, soit <span class="math inline">\(\frac{K}{J}-1\)</span> avec <em>K</em> et <em>J</em> étant respectivement les nombres de modalités et de variables. Aussi, le nombre d’axes produits par l’ACM est égal à <span class="math inline">\(K - J\)</span>. Pour notre tableau, l’inertie est donc égale à <span class="math inline">\(\mbox{25} / \mbox{9} = \mbox{1,77}\)</span> avec <span class="math inline">\(\mbox{25}-\mbox{9} = \mbox{16}\)</span> axes. Le nombre d’axes à retenir est souvent plus difficile à déterminer puisque, tel que signalé judicieusement par Jérôme Pagès <span class="citation" data-cites="pages2002analyse">(<a href="#ref-pages2002analyse" role="doc-biblioref">2002, 53</a>)</span> : «&nbsp;en pratique, comparée à l’ACP, l’ACM conduit, dans l’ensemble à&nbsp;: des pourcentages d’inertie plus petits; une décroissance de ces pourcentages plus douce&nbsp;».</p>
<p>L’histogramme des valeurs propres (<a href="#fig-ACMValeursPropresFig">figure&nbsp;<span class="quarto-unresolved-ref">fig-ACMValeursPropresFig</span></a>) révèle plusieurs sauts importants dans les valeurs propres qui pourraient justifier le choix du nombre d’axes factoriels, soit aux axes&nbsp;1, 2, 3 et&nbsp;6. Pour l’exercice, nous retenons les trois premiers axes qui résument 30&nbsp;% de l’inertie du tableau initial.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-ACMValeursPropresTab" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.22: Résultats de l’ACM pour les valeurs propres</caption>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Axe factoriel</th>
<th style="text-align: right;">Valeur propre</th>
<th style="text-align: right;">Pourcentage</th>
<th style="text-align: right;">Pourc. cumulé</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dim 1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0,248</td>
<td style="text-align: right;">13,940</td>
<td style="text-align: right;">13,940</td>
</tr>
<tr class="even">
<td style="text-align: left;">dim 2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0,156</td>
<td style="text-align: right;">8,792</td>
<td style="text-align: right;">22,732</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dim 3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0,135</td>
<td style="text-align: right;">7,620</td>
<td style="text-align: right;">30,352</td>
</tr>
<tr class="even">
<td style="text-align: left;">dim 4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0,127</td>
<td style="text-align: right;">7,161</td>
<td style="text-align: right;">37,513</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dim 5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0,126</td>
<td style="text-align: right;">7,065</td>
<td style="text-align: right;">44,579</td>
</tr>
<tr class="even">
<td style="text-align: left;">dim 6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0,123</td>
<td style="text-align: right;">6,916</td>
<td style="text-align: right;">51,494</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dim 7</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0,114</td>
<td style="text-align: right;">6,385</td>
<td style="text-align: right;">57,879</td>
</tr>
<tr class="even">
<td style="text-align: left;">dim 8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0,107</td>
<td style="text-align: right;">6,003</td>
<td style="text-align: right;">63,882</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dim 9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0,101</td>
<td style="text-align: right;">5,671</td>
<td style="text-align: right;">69,553</td>
</tr>
<tr class="even">
<td style="text-align: left;">dim 10</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0,095</td>
<td style="text-align: right;">5,327</td>
<td style="text-align: right;">74,880</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dim 11</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0,093</td>
<td style="text-align: right;">5,234</td>
<td style="text-align: right;">80,115</td>
</tr>
<tr class="even">
<td style="text-align: left;">dim 12</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0,086</td>
<td style="text-align: right;">4,822</td>
<td style="text-align: right;">84,937</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dim 13</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0,077</td>
<td style="text-align: right;">4,340</td>
<td style="text-align: right;">89,277</td>
</tr>
<tr class="even">
<td style="text-align: left;">dim 14</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0,071</td>
<td style="text-align: right;">4,011</td>
<td style="text-align: right;">93,288</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dim 15</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0,064</td>
<td style="text-align: right;">3,619</td>
<td style="text-align: right;">96,906</td>
</tr>
<tr class="even">
<td style="text-align: left;">dim 16</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0,055</td>
<td style="text-align: right;">3,094</td>
<td style="text-align: right;">100,000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-ACMValeursPropresFig" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMValeursPropresFig-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.35: Graphiques pour les valeurs propres pour l’ACM</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-12412" class="level4" data-number="12.4.1.2"><h4 data-number="12.4.1.2" class="anchored" data-anchor-id="sec-12412">
<span class="header-section-number">12.4.1.2</span> Résultats de l’ACM pour les modalités des variables</h4>
<p>À titre de rappel, comme pour l’ACP et l’AFC, nous retrouvons les trois mêmes mesures pour les variables et les individus (coordonnées factorielles, contributions et cosinus carrés). Plus les variables qualitatives du jeu de données comprennent de modalités, plus la taille du tableau des résultats des modalités est importante et plus il est fastidieux de l’analyser. Il est donc recommandé de construire des histogrammes avec les coordonnées factorielles et les contributions des modalités, mais aussi un nuage de points avec les coordonnées des modalités des variables qualitatives sur le premier, voire le deuxième plan factoriel.</p>
<div class="bloc_objectif">
<div class="bloc_objectif-header">
<div class="bloc_objectif-icon">

</div>
<p><strong>Compréhension des axes factoriels de l’ACM&nbsp;: une étape essentielle, incontournable…</strong></p>
</div>
<div class="bloc_objectif-body">
<p>Comme en ACP et en AFC, l’analyse des trois mesures (coordonnées, contributions et cosinus carrés) pour les variables et les individus doit vous permettre de comprendre la signification des axes factoriels retenus de l’ACM. Prenez le temps de bien réaliser cette étape d’interprétation souvent plus fastidieuse qu’en ACP et ACM, en raison du nombre élevé de modalités. Cette étape est en effet essentielle afin de qualifier les variables latentes (axes factoriels, variables synthétiques) produites par l’ACM.</p>
</div>
</div>
<p>Les résultats pour les variables sont reportés 1) au <a href="#tbl-ACMValeursCoordTab">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-ACMValeursCoordTab</span></a>, 2) aux figures&nbsp;<a href="#fig-ACMValeursCoordFig1"><span class="quarto-unresolved-ref ref-noprefix">fig-ACMValeursCoordFig1</span></a>, <a href="#fig-ACMValeursCoordFig2"><span class="quarto-unresolved-ref ref-noprefix">fig-ACMValeursCoordFig2</span></a> et <a href="#fig-ACMValeursCoordFig3"><span class="quarto-unresolved-ref ref-noprefix">fig-ACMValeursCoordFig3</span></a> pour les coordonnées et les contributions et à la <a href="#fig-ACMValeursPlanFacto1"><span class="quarto-unresolved-ref ref-noprefix">fig-ACMValeursPlanFacto1</span></a> pour le premier plan factoriel.</p>
<p><strong>Interprétation des résultats de l’axe&nbsp;1 pour les variables</strong></p>
<p>Sept modalités concourent le plus à la formation de l’axe&nbsp;1 résumant 13,9&nbsp;% de la variance&nbsp;: <code>Q9. 10 à 14 sortes</code> (10,35&nbsp;%), <code>Q10. Oui</code> (9,99&nbsp;%), <code>Q9. Moins de 5 sortes</code> (9,71&nbsp;%), <code>Q5. Oui</code> (9,19&nbsp;%), <code>Q11. Oui</code> (8,20&nbsp;%), <code>Q4. Moins de 10%</code> (7,87&nbsp;%) et <code>Q10. Non</code> (7,10&nbsp;%). Aussi, les modalités suivantes sont aux deux extrémités de cet axe&nbsp;:</p>
<ul>
<li>
<strong>Coordonnées négatives</strong>&nbsp;: <code>Q12. Non</code> (-0,84), <code>Q3. Moins de 1 an</code> (-0,73), <code>Q9. Moins de 5 sortes</code> (-0,67), <code>Q4. Moins de 10%</code> (-0,56), <code>Q10. Non</code> (-0,521). Cela signifie que lorsque les coordonnées des individus sont fortement négatives sur cet axe, les personnes pratiquant l’agriculture urbaine&nbsp;:
<ul>
<li>
<em>ne pensent pas que l’agriculture urbaine contribue à améliorer les rapports entre les gens</em> (<code>Q12</code>);</li>
<li>
<em>cultivent des fruits, des fines herbes ou de légumes depuis moins d’un an</em> (<code>Q3</code>);</li>
<li>
<em>cultivent moins de cinq sortes de fruits, de fines herbes ou de légumes</em> (<code>Q9</code>);</li>
<li>
<em>moins de 10&nbsp;% de la proportion des fruits, des fines herbes et des légumes consommés durant l’été provient de leur propre production </em>(<code>Q4</code>);</li>
<li>
<em>ne cultivent pas suffisamment pour partager avec d’autres personnes</em> (<code>Q10</code>).</li>
</ul>
</li>
<li>
<strong>Coordonnées positives</strong>&nbsp;: <code>Q9. 15 sortes ou plus</code> (1,36), <code>Q9. 10 à 14 sortes</code> (1,28), <code>Q5. Oui</code> (0,95) et <code>Q11. Oui</code> (0,85). Cela signifie que lorsque les coordonnées des individus sont fortement positives sur cet axe, les personnes pratiquant l’agriculture urbaine&nbsp;:
<ul>
<li>
<em>cultivent plus de dix sortes de fruits, de fines herbes ou de légumes</em> (<code>Q9</code>);</li>
<li>
<em>utilisent du compost provenant de leurs déchets verts ou de leurs déchets alimentaires pour faire pousser des fruits, des fines herbes ou de légumes</em> (<code>Q5</code>);</li>
<li>
<em>échangent leurs semis ou leurs récoltes de fruits, de fines herbes ou des légumes avec d’autres personnes</em> (<code>Q11</code>).</li>
</ul>
</li>
</ul>
<p>En résumé, l’axe&nbsp;1 oppose clairement les <strong>néophytes en agriculture</strong> versus les <strong>personnes expérimentées</strong> cultivant des fruits et de légumes variés avec leur propre compost et échangeant leurs semis ou leurs récoltes.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-ACMValeursCoordTab" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.23: Résultats de l’ACM pour les modalités des variables</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Coordonnées
</div></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cosinus carrés
</div></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Contributions (%)
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Modalité</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Q3. Moins de 1 an</td>
<td style="text-align: right;">-0,73</td>
<td style="text-align: right;">0,68</td>
<td style="text-align: right;">0,63</td>
<td style="text-align: right;">2,70</td>
<td style="text-align: right;">3,68</td>
<td style="text-align: right;">3,64</td>
<td style="text-align: right;">0,07</td>
<td style="text-align: right;">0,06</td>
<td style="text-align: right;">0,05</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q3. De 1 à 4 ans</td>
<td style="text-align: right;">-0,29</td>
<td style="text-align: right;">-0,79</td>
<td style="text-align: right;">0,39</td>
<td style="text-align: right;">1,26</td>
<td style="text-align: right;">15,30</td>
<td style="text-align: right;">4,30</td>
<td style="text-align: right;">0,04</td>
<td style="text-align: right;">0,33</td>
<td style="text-align: right;">0,08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q3. De 5 à 9 ans</td>
<td style="text-align: right;">0,12</td>
<td style="text-align: right;">0,38</td>
<td style="text-align: right;">-1,11</td>
<td style="text-align: right;">0,12</td>
<td style="text-align: right;">2,02</td>
<td style="text-align: right;">19,43</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,04</td>
<td style="text-align: right;">0,29</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q3. 10 ans ou plus</td>
<td style="text-align: right;">0,45</td>
<td style="text-align: right;">0,35</td>
<td style="text-align: right;">0,02</td>
<td style="text-align: right;">3,19</td>
<td style="text-align: right;">3,01</td>
<td style="text-align: right;">0,02</td>
<td style="text-align: right;">0,11</td>
<td style="text-align: right;">0,07</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q4. Moins de 10%</td>
<td style="text-align: right;">-0,56</td>
<td style="text-align: right;">0,03</td>
<td style="text-align: right;">0,07</td>
<td style="text-align: right;">7,87</td>
<td style="text-align: right;">0,04</td>
<td style="text-align: right;">0,22</td>
<td style="text-align: right;">0,40</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q4. 10 à 25%</td>
<td style="text-align: right;">0,74</td>
<td style="text-align: right;">-0,76</td>
<td style="text-align: right;">-0,11</td>
<td style="text-align: right;">4,92</td>
<td style="text-align: right;">8,22</td>
<td style="text-align: right;">0,19</td>
<td style="text-align: right;">0,14</td>
<td style="text-align: right;">0,14</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q4. 26 à 50%</td>
<td style="text-align: right;">0,78</td>
<td style="text-align: right;">0,64</td>
<td style="text-align: right;">0,15</td>
<td style="text-align: right;">3,82</td>
<td style="text-align: right;">4,18</td>
<td style="text-align: right;">0,28</td>
<td style="text-align: right;">0,10</td>
<td style="text-align: right;">0,07</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q4. Plus de 50%</td>
<td style="text-align: right;">0,53</td>
<td style="text-align: right;">0,40</td>
<td style="text-align: right;">-0,37</td>
<td style="text-align: right;">1,31</td>
<td style="text-align: right;">1,17</td>
<td style="text-align: right;">1,19</td>
<td style="text-align: right;">0,03</td>
<td style="text-align: right;">0,02</td>
<td style="text-align: right;">0,02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q5. Oui</td>
<td style="text-align: right;">0,95</td>
<td style="text-align: right;">0,56</td>
<td style="text-align: right;">-0,13</td>
<td style="text-align: right;">9,19</td>
<td style="text-align: right;">5,01</td>
<td style="text-align: right;">0,29</td>
<td style="text-align: right;">0,27</td>
<td style="text-align: right;">0,09</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q5. Non</td>
<td style="text-align: right;">-0,28</td>
<td style="text-align: right;">-0,16</td>
<td style="text-align: right;">0,04</td>
<td style="text-align: right;">2,70</td>
<td style="text-align: right;">1,47</td>
<td style="text-align: right;">0,09</td>
<td style="text-align: right;">0,27</td>
<td style="text-align: right;">0,09</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q8. Oui</td>
<td style="text-align: right;">0,55</td>
<td style="text-align: right;">0,37</td>
<td style="text-align: right;">1,21</td>
<td style="text-align: right;">2,58</td>
<td style="text-align: right;">1,86</td>
<td style="text-align: right;">23,31</td>
<td style="text-align: right;">0,07</td>
<td style="text-align: right;">0,03</td>
<td style="text-align: right;">0,35</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q8. Non</td>
<td style="text-align: right;">-0,13</td>
<td style="text-align: right;">-0,09</td>
<td style="text-align: right;">-0,29</td>
<td style="text-align: right;">0,62</td>
<td style="text-align: right;">0,45</td>
<td style="text-align: right;">5,60</td>
<td style="text-align: right;">0,07</td>
<td style="text-align: right;">0,03</td>
<td style="text-align: right;">0,35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q9. Moins de 5 sortes</td>
<td style="text-align: right;">-0,67</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,47</td>
<td style="text-align: right;">9,71</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">8,83</td>
<td style="text-align: right;">0,42</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,21</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q9. 5 à 9 sortes</td>
<td style="text-align: right;">0,24</td>
<td style="text-align: right;">0,11</td>
<td style="text-align: right;">-0,79</td>
<td style="text-align: right;">0,89</td>
<td style="text-align: right;">0,30</td>
<td style="text-align: right;">17,31</td>
<td style="text-align: right;">0,03</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q9. 10 à 14 sortes</td>
<td style="text-align: right;">1,28</td>
<td style="text-align: right;">-0,97</td>
<td style="text-align: right;">0,07</td>
<td style="text-align: right;">10,35</td>
<td style="text-align: right;">9,42</td>
<td style="text-align: right;">0,06</td>
<td style="text-align: right;">0,27</td>
<td style="text-align: right;">0,15</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q9. 15 sortes ou plus</td>
<td style="text-align: right;">1,36</td>
<td style="text-align: right;">2,15</td>
<td style="text-align: right;">0,65</td>
<td style="text-align: right;">3,62</td>
<td style="text-align: right;">14,42</td>
<td style="text-align: right;">1,50</td>
<td style="text-align: right;">0,08</td>
<td style="text-align: right;">0,21</td>
<td style="text-align: right;">0,02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q10. Oui</td>
<td style="text-align: right;">0,73</td>
<td style="text-align: right;">-0,15</td>
<td style="text-align: right;">0,07</td>
<td style="text-align: right;">9,99</td>
<td style="text-align: right;">0,63</td>
<td style="text-align: right;">0,18</td>
<td style="text-align: right;">0,38</td>
<td style="text-align: right;">0,02</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q10. Non</td>
<td style="text-align: right;">-0,52</td>
<td style="text-align: right;">0,10</td>
<td style="text-align: right;">-0,05</td>
<td style="text-align: right;">7,10</td>
<td style="text-align: right;">0,45</td>
<td style="text-align: right;">0,13</td>
<td style="text-align: right;">0,38</td>
<td style="text-align: right;">0,02</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q11. Oui</td>
<td style="text-align: right;">0,85</td>
<td style="text-align: right;">-0,83</td>
<td style="text-align: right;">0,32</td>
<td style="text-align: right;">8,20</td>
<td style="text-align: right;">12,45</td>
<td style="text-align: right;">2,11</td>
<td style="text-align: right;">0,25</td>
<td style="text-align: right;">0,23</td>
<td style="text-align: right;">0,03</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q11. Non</td>
<td style="text-align: right;">-0,29</td>
<td style="text-align: right;">0,28</td>
<td style="text-align: right;">-0,11</td>
<td style="text-align: right;">2,79</td>
<td style="text-align: right;">4,24</td>
<td style="text-align: right;">0,72</td>
<td style="text-align: right;">0,25</td>
<td style="text-align: right;">0,23</td>
<td style="text-align: right;">0,03</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q12. Oui</td>
<td style="text-align: right;">0,16</td>
<td style="text-align: right;">0,02</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,97</td>
<td style="text-align: right;">0,02</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,11</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q12. Non</td>
<td style="text-align: right;">-0,84</td>
<td style="text-align: right;">-0,38</td>
<td style="text-align: right;">0,09</td>
<td style="text-align: right;">4,12</td>
<td style="text-align: right;">1,32</td>
<td style="text-align: right;">0,08</td>
<td style="text-align: right;">0,11</td>
<td style="text-align: right;">0,02</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q12. NSP/NRP</td>
<td style="text-align: right;">-0,36</td>
<td style="text-align: right;">0,56</td>
<td style="text-align: right;">-0,31</td>
<td style="text-align: right;">0,36</td>
<td style="text-align: right;">1,39</td>
<td style="text-align: right;">0,48</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,02</td>
<td style="text-align: right;">0,01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q13. Oui</td>
<td style="text-align: right;">0,17</td>
<td style="text-align: right;">0,31</td>
<td style="text-align: right;">0,31</td>
<td style="text-align: right;">0,70</td>
<td style="text-align: right;">3,91</td>
<td style="text-align: right;">4,37</td>
<td style="text-align: right;">0,04</td>
<td style="text-align: right;">0,13</td>
<td style="text-align: right;">0,12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q13. Non</td>
<td style="text-align: right;">-0,22</td>
<td style="text-align: right;">-0,40</td>
<td style="text-align: right;">-0,40</td>
<td style="text-align: right;">0,91</td>
<td style="text-align: right;">5,05</td>
<td style="text-align: right;">5,66</td>
<td style="text-align: right;">0,04</td>
<td style="text-align: right;">0,13</td>
<td style="text-align: right;">0,12</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ACMValeursCoordFig1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMValeursCoordFig1-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.36: Graphiques pour les résultats des modalités de l’axe 1 de l’ACM</figcaption></figure>
</div>
</div>
</div>
<p><strong>Interprétation des résultats de l’axe&nbsp;2 pour les variables</strong></p>
<p>Quatre modalités concourent le plus à la formation de l’axe&nbsp;2 résumant 8,8&nbsp;% de la variance&nbsp;: <code>Q3. De 1 à 4 ans</code> (15,30&nbsp;%), <code>Q9. 15 sortes ou plus</code> (14,42&nbsp;%), <code>Q11. Oui</code> (12,45&nbsp;%) et <code>Q9. 10 à 14 sortes</code> (9,42&nbsp;%). Les modalités suivantes sont présentes aux deux extrémités de l’axe&nbsp;2&nbsp;:</p>
<ul>
<li>
<strong>Coordonnées négatives</strong>&nbsp;: <code>Q9. 10 à 14 sortes</code> (-0,97), <code>Q11. Oui</code> (-0,83), <code>Q3. De 1 à 4 ans</code> (-0,79), <code>Q4. 10 à 25%</code> (-0,76). Cela signifie que lorsque les coordonnées des individus sont fortement négatives sur cet axe, les personnes pratiquant l’agriculture urbaine&nbsp;:
<ul>
<li>
<em>cultivent de 10 à 14 sortes de fruits, de fines herbes ou de légumes</em> (<code>Q9</code>);</li>
<li>
<em>échangent leurs semis ou leurs récoltes de fruits, de fines herbes ou de légumes avec d’autres personnes</em> (<code>Q11</code>);</li>
<li>
<em>cultivent des fruits, des fines herbes ou des légumes depuis 1 à 4 ans</em> (<code>Q3</code>);</li>
<li>
<em>de 10 à 25&nbsp;% de la proportion des fruits, des fines herbes et des légumes consommés durant l’été provient de leur propre production </em>(<code>Q4</code>).</li>
</ul>
</li>
<li>
<strong>Coordonnées positives</strong>&nbsp;: seule la modalité <code>Q9. 15 sortes ou plus</code> (2,15) présente une forte coordonnée positive.</li>
</ul>
<p><strong>En résumé, l’axe&nbsp;2</strong> permet surtout d’identifier des personnes pratiquant l’agriculture urbaine depuis quelques années (de 1 à 4 ans), mais cultivant déjà de nombreuses sortes de fruits et légumes et partageant aussi leurs semis ou récoltes.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ACMValeursCoordFig2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMValeursCoordFig2-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.37: Graphiques pour les résultats des modalités de l’axe 2 de l’ACM</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ACMValeursPlanFacto1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMValeursPlanFacto1-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.38: Premier plan factoriel de l’ACM pour les modalités</figcaption></figure>
</div>
</div>
</div>
<p><strong>Interprétation des résultats de l’axe&nbsp;3 pour les variables</strong></p>
<p>Trois modalités concourent le plus à la formation de l’axe&nbsp;3 résumant 7,6&nbsp;% de la variance&nbsp;: <code>Q8. Oui</code> (23,31), <code>Q3. De 5 à 9 ans</code> (19,43) et <code>Q9. 5 à 9 sortes</code> (17,31). Les modalités suivantes sont présentes aux deux extrémités de l’axe&nbsp;3&nbsp;:</p>
<ul>
<li>
<strong>Coordonnées négatives</strong>&nbsp;: <code>Q3. De 5 à 9 ans</code> (-1,11), <code>Q9. 5 à 9 sortes</code> (-0,79).</li>
<li>
<strong>Coordonnées positives</strong>&nbsp;: seule la modalité <code>Q8. Oui</code> présente une coordonnée fortement positive (1,21).</li>
</ul>
<p>Par conséquent, cet axe semble plus complexe à analyser et surtout moins intéressant que les deux premiers.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ACMValeursCoordFig3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMValeursCoordFig3-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.39: Graphiques pour les résultats des modalités de l’axe 3 de l’ACM</figcaption></figure>
</div>
</div>
</div>
<p><strong>Analyse des variables supplémentaires dans l’ACM</strong></p>
<p>Il est ensuite possible de projeter les modalités supplémentaires sur les axes de l’ACM retenus (<a href="#tbl-ACMValeursCoordSuppl">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-ACMValeursCoordSuppl</span></a> et <a href="#fig-ACMValeursPlanFactoSupp1">figure&nbsp;<span class="quarto-unresolved-ref">fig-ACMValeursPlanFactoSupp1</span></a>). Les faibles valeurs des coordonnées factorielles des modalités supplémentaires sur les deux axes semblent indiquer que le profil socioéconomique des personnes pratiquant l’agriculture urbaine ne semble pas (ou peu) relié aux profils identifiés par les axes factoriels.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-ACMValeursCoordSuppl" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;12.24: Résultats de l’ACM pour les modalités des variables supplémentaires</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Coordonnées
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cosinus carrés
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Modalité</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Q15. 18 à 34 ans</td>
<td style="text-align: right;">-0,09</td>
<td style="text-align: right;">-0,27</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,04</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q15. 35 à 49 ans</td>
<td style="text-align: right;">-0,06</td>
<td style="text-align: right;">-0,01</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q15. 50 à 64 ans</td>
<td style="text-align: right;">0,14</td>
<td style="text-align: right;">0,25</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,02</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q15. 65 ans et plus</td>
<td style="text-align: right;">0,11</td>
<td style="text-align: right;">0,25</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q16. Travail temps plein</td>
<td style="text-align: right;">-0,10</td>
<td style="text-align: right;">-0,06</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q16. Travail. temps partiel</td>
<td style="text-align: right;">0,36</td>
<td style="text-align: right;">-0,15</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q16. Étudiant</td>
<td style="text-align: right;">-0,14</td>
<td style="text-align: right;">-0,11</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q16. Retraité</td>
<td style="text-align: right;">0,17</td>
<td style="text-align: right;">0,25</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q16. Sans emploi</td>
<td style="text-align: right;">0,44</td>
<td style="text-align: right;">-0,14</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q16. À la maison</td>
<td style="text-align: right;">-0,06</td>
<td style="text-align: right;">0,18</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q17. Aucun certificat ou dipl.</td>
<td style="text-align: right;">0,28</td>
<td style="text-align: right;">0,16</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q17. Dipl. secondaires</td>
<td style="text-align: right;">-0,09</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q17. Dipl. collégiales</td>
<td style="text-align: right;">0,01</td>
<td style="text-align: right;">0,19</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q17. Études universitaires</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">-0,10</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q21. Propriétaire</td>
<td style="text-align: right;">0,03</td>
<td style="text-align: right;">0,02</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q22. Locataire</td>
<td style="text-align: right;">-0,06</td>
<td style="text-align: right;">-0,03</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: right;">0,00</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ACMValeursPlanFactoSupp1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMValeursPlanFactoSupp1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.40: Premier plan factoriel de l’ACM avec toutes les modalités incluant celles supplémentaires</figcaption></figure>
</div>
</div>
</div>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>Visualisation de variables qualitatives ordinales sur un plan factoriel</strong></p>
</div>
<div class="bloc_astuce-body">
<p>Lorsque les variables qualitatives sont ordinales et non nominales, il peut être intéressant de relier les différentes modalités avec une ligne. Cela permet de comprendre en un coup d’œil la trajectoire que suivent les modalités sur les deux axes factoriels. En guise d’exemple, nous réalisons cet exercice pour les variables <code>Q3</code> et <code>Q9</code> (<a href="#fig-ACMordinaleTrajectoire">figure&nbsp;<span class="quarto-unresolved-ref">fig-ACMordinaleTrajectoire</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ACMordinaleTrajectoire" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMordinaleTrajectoire-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.41: Trajectoires des variables ordinales sur le premier plan factoriel de l’ACM</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
</section><section id="sec-12413" class="level4" data-number="12.4.1.3"><h4 data-number="12.4.1.3" class="anchored" data-anchor-id="sec-12413">
<span class="header-section-number">12.4.1.3</span> Résultats de l’ACM pour les individus</h4>
<p>Comme toute méthode factorielle, les coordonnées factorielles, les cosinus carrés et les contributions sont aussi disponibles pour les individus en ACM. Nous proposons ici simplement de réaliser le premier plan factoriel pour les individus en attribuant un dégradé de couleurs avec les cosinus carrés (<a href="#fig-ACMPlanFacto12Ind1">figure&nbsp;<span class="quarto-unresolved-ref">fig-ACMPlanFacto12Ind1</span></a>). Il est aussi possible d’attribuer des couleurs aux différentes modalités d’une variable. Par exemple, sur le premier plan factoriel, nous avons utilisé la variable <code>Q12. Selon vous, l’agriculture urbaine contribue-t-elle à améliorer les rapports entre les gens?</code>. Cela permet de repérer visuellement que les personnes ayant répondu négativement à cette question ont surtout des coordonnées négatives sur l’axe&nbsp;1.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ACMPlanFacto12Ind1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMPlanFacto12Ind1-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.42: Premier plan factoriel de l’ACM pour les individus</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ACMPlanFacto12Ind2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMPlanFacto12Ind2-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.43: Premier plan factoriel de l’ACM pour les individus avec coloration d’une variable</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-1242" class="level3" data-number="12.4.2"><h3 data-number="12.4.2" class="anchored" data-anchor-id="sec-1242">
<span class="header-section-number">12.4.2</span> Mise en œuvre dans R</h3>
<section id="sec-12421" class="level4" data-number="12.4.2.1"><h4 data-number="12.4.2.1" class="anchored" data-anchor-id="sec-12421">
<span class="header-section-number">12.4.2.1</span> Calcul d’une ACM avec <code>FactoMineR</code>
</h4>
<p>Plusieurs <em>packages</em> permettent de calculer une ACM dans R, notamment <code>ExPosition</code> (fonction <code>epMCA</code>), <code>ade4</code> (fonction <code>dudi.mca</code>) et <code>FactoMineR</code> (fonction <code>MCA</code>). De nouveau, nous utilisons <code>FactoMineR</code> couplé au <em>package</em> <code>factoextra</code> pour réaliser rapidement des graphiques.</p>
<p>Pour calculer l’ACM, il suffit d’utiliser la fonction <code>MCA</code> de <code>FactoMineR</code>, puis la fonction <code>summary(res.acm)</code> qui renvoie les résultats de l’ACM pour&nbsp;:</p>
<ul>
<li><p>Les valeurs propres (section <code>Eigenvalues</code>) pour les axes factoriels (<code>Dim.1</code> à <code>Dim.n</code>) avec leur variance expliquée brute (<code>Variance</code>), en pourcentage (<code>% of var.</code>) et en pourcentage cumulé (<code>Cumulative % of var.</code>).</p></li>
<li><p>Les dix premières observations (section <code>Individuals</code>) avec les coordonnées factorielles (<code>Dim.1</code> à <code>Dim.n</code>), les contributions (<code>ctr</code>) et les cosinus carrés (<code>cos2</code>). Pour accéder aux résultats pour toutes les observations, utilisez les fonctions <code>res.acm$ind</code> ou encore <code>res.acm$ind$coord</code> (uniquement les coordonnées factorielles), <code>res.acm$ind$contrib</code> (uniquement les contributions) et <code>res.acm$ind$cos2</code> (uniquement les cosinus carrés).</p></li>
<li><p>Les dix premières modalités des variables (section <code>Categories</code>) avec les coordonnées factorielles (D<code>im.1</code> à <code>Dim.n</code>), les contributions (<code>ctr</code>) et les cosinus carrés (<code>cos2</code>).</p></li>
</ul>
<p>La syntaxe ci-dessous permet, dans un premier temps, de calculer l’ACM, puis de créer un <em>DataFrame</em> pour les résultats des valeurs propres.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op">)</span></span>
<span><span class="co"># Calcul de l'AFC</span></span>
<span><span class="va">res.acm</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/MCA.html">MCA</a></span><span class="op">(</span><span class="va">dfACM</span>,            <span class="co"># Nom du DataFrame</span></span>
<span>                ncp <span class="op">=</span> <span class="fl">3</span>,          <span class="co"># Nombre d'axes retenus</span></span>
<span>                quali.sup<span class="op">=</span><span class="fl">10</span><span class="op">:</span><span class="fl">13</span>,  <span class="co"># Variables supplémentaires</span></span>
<span>                graph <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                row.w <span class="op">=</span> <span class="va">dfenquete</span><span class="op">$</span><span class="va">pond</span><span class="op">)</span> <span class="co"># Variables pour la pondération des lignes</span></span>
<span><span class="co"># Affichage des résultats</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">res.acm</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>**Results of the Multiple Correspondence Analysis (MCA)**
The analysis was performed on 352 individuals, described by 13 variables
*The results are available in the following objects:

   name                description                                          
1  "$eig"              "eigenvalues"                                        
2  "$var"              "results for the variables"                          
3  "$var$coord"        "coord. of the categories"                           
4  "$var$cos2"         "cos2 for the categories"                            
5  "$var$contrib"      "contributions of the categories"                    
6  "$var$v.test"       "v-test for the categories"                          
7  "$var$eta2"         "coord. of variables"                                
8  "$ind"              "results for the individuals"                        
9  "$ind$coord"        "coord. for the individuals"                         
10 "$ind$cos2"         "cos2 for the individuals"                           
11 "$ind$contrib"      "contributions of the individuals"                   
12 "$quali.sup"        "results for the supplementary categorical variables"
13 "$quali.sup$coord"  "coord. for the supplementary categories"            
14 "$quali.sup$cos2"   "cos2 for the supplementary categories"              
15 "$quali.sup$v.test" "v-test for the supplementary categories"            
16 "$call"             "intermediate results"                               
17 "$call$marge.col"   "weights of columns"                                 
18 "$call$marge.li"    "weights of rows"                                    </code></pre>
</div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res.acm</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
MCA(X = dfACM, ncp = 3, quali.sup = 10:13, graph = FALSE, row.w = dfenquete$pond) 


Eigenvalues
                       Dim.1   Dim.2   Dim.3   Dim.4   Dim.5   Dim.6   Dim.7
Variance               0.248   0.156   0.135   0.127   0.126   0.123   0.114
% of var.             13.940   8.792   7.620   7.161   7.065   6.916   6.385
Cumulative % of var.  13.940  22.732  30.352  37.513  44.579  51.494  57.879
                       Dim.8   Dim.9  Dim.10  Dim.11  Dim.12  Dim.13  Dim.14
Variance               0.107   0.101   0.095   0.093   0.086   0.077   0.071
% of var.              6.003   5.671   5.327   5.234   4.822   4.340   4.011
Cumulative % of var.  63.882  69.553  74.880  80.115  84.937  89.277  93.288
                      Dim.15  Dim.16
Variance               0.064   0.055
% of var.              3.619   3.094
Cumulative % of var.  96.906 100.000

Individuals (the 10 first)
                               Dim.1    ctr   cos2    Dim.2    ctr   cos2  
4                           |  0.261  0.063  0.052 |  0.327  0.155  0.081 |
10                          | -0.533  0.688  0.278 |  0.050  0.010  0.002 |
11                          |  0.135  0.020  0.014 | -0.120  0.025  0.011 |
15                          |  0.020  0.000  0.000 |  0.271  0.073  0.061 |
17                          | -0.133  0.014  0.012 | -0.264  0.088  0.049 |
18                          |  0.196  0.024  0.018 |  0.279  0.078  0.037 |
19                          | -0.193  0.041  0.014 | -0.063  0.007  0.002 |
21                          |  0.845  0.731  0.369 | -0.337  0.184  0.059 |
23                          | -0.253  0.155  0.058 | -0.020  0.002  0.000 |
26                          |  0.802  0.552  0.170 |  0.460  0.288  0.056 |
                             Dim.3    ctr   cos2  
4                            0.251  0.105  0.048 |
10                          -0.413  0.757  0.167 |
11                          -0.354  0.252  0.097 |
15                          -0.503  0.291  0.209 |
17                           0.835  1.019  0.486 |
18                           0.104  0.012  0.005 |
19                           0.159  0.051  0.010 |
21                          -0.390  0.285  0.079 |
23                          -0.375  0.624  0.128 |
26                           0.098  0.015  0.003 |

Categories (the 10 first)
                                Dim.1     ctr    cos2  v.test     Dim.2     ctr
Q3. Moins de 1 an           |  -0.731   2.704   0.068  -4.940 |   0.677   3.681
Q3. De 1 à 4 ans            |  -0.286   1.259   0.043  -3.921 |  -0.791  15.299
Q3. De 5 à 9 ans            |   0.119   0.122   0.003   1.102 |   0.385   2.023
Q3. 10 ans ou plus          |   0.450   3.189   0.110   6.271 |   0.347   3.006
Q4. Moins de 10%            |  -0.562   7.874   0.395 -11.913 |   0.033   0.044
Q4. 10 à 25%                |   0.745   4.918   0.137   7.006 |  -0.765   8.220
Q4. 26 à 50%                |   0.775   3.815   0.099   5.966 |   0.644   4.176
Q4. Plus de 50%             |   0.527   1.310   0.033   3.424 |   0.395   1.167
Q5. Oui                     |   0.950   9.194   0.265   9.760 |   0.557   5.008
Q5. Non                     |  -0.279   2.701   0.265  -9.760 |  -0.164   1.471
                               cos2  v.test     Dim.3     ctr    cos2  v.test  
Q3. Moins de 1 an             0.058   4.578 |   0.627   3.636   0.050   4.236 |
Q3. De 1 à 4 ans              0.328 -10.855 |   0.390   4.304   0.080   5.360 |
Q3. De 5 à 9 ans              0.035   3.556 |  -1.110  19.427   0.293 -10.261 |
Q3. 10 ans ou plus            0.065   4.835 |   0.023   0.016   0.000   0.327 |
Q4. Moins de 10%              0.001   0.704 |   0.070   0.221   0.006   1.477 |
Q4. 10 à 25%                  0.144  -7.194 |  -0.109   0.191   0.003  -1.021 |
Q4. 26 à 50%                  0.068   4.957 |   0.154   0.276   0.004   1.187 |
Q4. Plus de 50%               0.018   2.566 |  -0.372   1.195   0.016  -2.417 |
Q5. Oui                       0.091   5.720 |  -0.126   0.294   0.005  -1.290 |
Q5. Non                       0.091  -5.720 |   0.037   0.086   0.005   1.290 |

Categorical variables (eta2)
                              Dim.1 Dim.2 Dim.3  
q3                          | 0.162 0.338 0.334 |
q4                          | 0.400 0.191 0.023 |
q5                          | 0.265 0.091 0.005 |
q8                          | 0.071 0.032 0.352 |
q9                          | 0.548 0.340 0.338 |
q10                         | 0.381 0.015 0.004 |
q11                         | 0.245 0.235 0.034 |
q12                         | 0.121 0.038 0.007 |
q13                         | 0.036 0.126 0.122 |

Supplementary categories (the 10 first)
                               Dim.1   cos2 v.test    Dim.2   cos2 v.test  
Q15. 18 à 34 ans            | -0.091  0.004 -1.221 | -0.271  0.037 -3.630 |
Q15. 35 à 49 ans            | -0.060  0.001 -0.731 | -0.014  0.000 -0.175 |
Q15. 50 à 64 ans            |  0.140  0.006  1.419 |  0.251  0.018  2.543 |
Q15. 65 ans et plus         |  0.107  0.002  0.874 |  0.248  0.011  2.020 |
Q16. Travail temps plein    | -0.096  0.012 -2.084 | -0.065  0.005 -1.404 |
Q16. Travail. temps partiel |  0.364  0.010  1.875 | -0.147  0.002 -0.757 |
Q16. Étudiant               | -0.139  0.002 -0.774 | -0.111  0.001 -0.617 |
Q16. Retraité               |  0.166  0.006  1.521 |  0.254  0.015  2.331 |
Q16. Sans emploi            |  0.440  0.006  1.433 | -0.142  0.001 -0.464 |
Q16. À la maison            | -0.056  0.000 -0.279 |  0.175  0.002  0.878 |
                             Dim.3   cos2 v.test  
Q15. 18 à 34 ans             0.092  0.004  1.232 |
Q15. 35 à 49 ans            -0.112  0.005 -1.360 |
Q15. 50 à 64 ans            -0.002  0.000 -0.020 |
Q15. 65 ans et plus          0.015  0.000  0.122 |
Q16. Travail temps plein    -0.025  0.001 -0.540 |
Q16. Travail. temps partiel  0.291  0.006  1.497 |
Q16. Étudiant               -0.088  0.001 -0.488 |
Q16. Retraité                0.031  0.000  0.284 |
Q16. Sans emploi            -0.495  0.007 -1.611 |
Q16. À la maison             0.144  0.001  0.720 |

Supplementary categorical variables (eta2)
                              Dim.1 Dim.2 Dim.3  
q15                         | 0.010 0.048 0.007 |
q16                         | 0.027 0.020 0.015 |
q17                         | 0.006 0.014 0.014 |
q21                         | 0.002 0.001 0.007 |</code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Construction d'un DataFrame pour les valeurs propres</span></span>
<span><span class="va">dfACMvp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">res.acm</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dfACMvp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"VP"</span> , <span class="st">"VP_pct"</span> , <span class="st">"VP_pctCumul"</span><span class="op">)</span></span>
<span><span class="va">dfACMvp</span><span class="op">$</span><span class="va">Axe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dfACMvp</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dfACMvp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dfACMvp</span> <span class="op">&lt;-</span> <span class="va">dfACMvp</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-124212" class="level4" data-number="12.4.2.2"><h4 data-number="12.4.2.2" class="anchored" data-anchor-id="sec-124212">
<span class="header-section-number">12.4.2.2</span> Exploration graphique des résultats de l’ACM pour les valeurs propres</h4>
<p>Pour créer un histogramme des valeurs propres de l’ACM, vous pouvez utiliser la fonction <code>fviz_screeplot</code> de <code>factoextra</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eigenvalue.html">fviz_screeplot</a></span><span class="op">(</span><span class="va">res.acm</span>, addlabels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               x <span class="op">=</span> <span class="st">"Composantes"</span>, y <span class="op">=</span> <span class="st">"Valeur propre"</span>, title <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ACMCodePartie1VPb" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMCodePartie1VPb-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.44: Graphique pour les valeurs propres de l’ACM avec factoextra</figcaption></figure>
</div>
</div>
</div>
<p>Avec un peu plus de lignes de code, il est relativement facile d’exploiter le <em>DataFrame</em> des valeurs propres créé précédemment (<code>dfACMvp</code>) pour construire des graphiques plus personnalisés.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">couleursAxes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"steelblue"</span> , <span class="st">"skyblue2"</span><span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfACMvp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">VP</span>, y <span class="op">=</span> <span class="va">Axe</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">.6</span>, alpha <span class="op">=</span> <span class="fl">.8</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"skyblue2"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Valeur propre"</span>, y <span class="op">=</span> <span class="st">"Axe factoriel"</span><span class="op">)</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfACMvp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">VP_pct</span>, y <span class="op">=</span> <span class="va">Axe</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">.6</span>, alpha <span class="op">=</span> <span class="fl">.8</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"skyblue2"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Variance expliquée (%)"</span>, y <span class="op">=</span> <span class="st">"Axe factoriel"</span><span class="op">)</span></span>
<span><span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfACMvp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">VP_pctCumul</span>, y <span class="op">=</span> <span class="va">Axe</span>, group<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">.6</span>, alpha <span class="op">=</span> <span class="fl">.8</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"skyblue2"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"brown"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, size<span class="op">=</span><span class="fl">.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span>, shape<span class="op">=</span><span class="fl">21</span>, color <span class="op">=</span> <span class="st">"brown"</span>, fill <span class="op">=</span> <span class="st">"brown"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Variance expliquée (% cumulé)"</span>, y <span class="op">=</span> <span class="st">"Axe factoriel"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">g2</span>, <span class="va">g3</span>,  nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ACMCodePartie1VPc" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMCodePartie1VPc-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.45: Graphiques pour les valeurs propres de l’ACM avec factoextra</figcaption></figure>
</div>
</div>
</div>
<p>La syntaxe ci-dessous permet de construire un tableau avec les coordonnées factorielles, les cosinus carrés et les contributions pour les modalités des variables qualitatives.</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="va">nAxes</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">dfmodalites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Modalite <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">res.acm</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">coord</span><span class="op">)</span>,</span>
<span>                           Coord <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">res.acm</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">coord</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nAxes</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>                           Cos2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">res.acm</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">cos2</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nAxes</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>                           ctr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">res.acm</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">contrib</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nAxes</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">dfmodalites</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dfmodalites</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dfmodalites</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dfmodalites</span><span class="op">)</span>, <span class="st">".Dim."</span>, <span class="st">"F"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-124213" class="level4" data-number="12.4.2.3"><h4 data-number="12.4.2.3" class="anchored" data-anchor-id="sec-124213">
<span class="header-section-number">12.4.2.3</span> Exploration graphique des résultats de l’ACM pour les modalités</h4>
<p>Avant d’explorer graphiquement les résultats pour les modalités, il est judicieux de construire un <em>DataFrame</em> avec les coordonnées factorielles, les contributions et les cosinus carrés des modalités (voir la syntaxe ci-dessous).</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="va">nAxes</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">dfmodalites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Modalite <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">res.acm</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">coord</span><span class="op">)</span>,</span>
<span>                           Coord <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">res.acm</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">coord</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nAxes</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                           ctr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">res.acm</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">contrib</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nAxes</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                           Cos2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">res.acm</span><span class="op">$</span><span class="va">var</span><span class="op">$</span><span class="va">cos2</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nAxes</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">dfmodalites</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dfmodalites</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dfmodalites</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dfmodalites</span><span class="op">)</span>, <span class="st">".Dim."</span>, <span class="st">"F"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plusieurs fonctions très faciles à utiliser de <code>factoextra</code> permettent de construire rapidement des graphiques&nbsp;: <code>fviz_mca_var</code> pour un nuage de points d’un plan factoriel, <code>fviz_cos2</code> et <code>fviz_contrib</code> (en utilisant le paramètre <code>choice=var.cat</code>) pour des histogrammes avec les cosinus carrés et les contributions des modalités.</p>
<p>Il est aussi possible de créer vos propres graphiques avec <code>ggplot2</code> en utilisant le <em>DataFrame</em> créé précédemment avec les modalités. Par exemple, la syntaxe ci-dessous renvoie deux histogrammes pour l’axe&nbsp;1&nbsp;: l’un avec les coordonnées, l’autre avec les contributions. Dans la syntaxe, repérez le terme <code>CoordF1</code>. Dupliquez la syntaxe et changez ce terme pour <code>CoordF2</code> et <code>CoordF3</code> pour réaliser les graphiques des axes&nbsp;2 et&nbsp;3.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Histogrammes pour les coordonnées des modalités</span></span>
<span><span class="va">couleursCoords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lightsalmon"</span> , <span class="st">"steelblue"</span><span class="op">)</span></span>
<span><span class="va">plotCoordF1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfmodalites</span>,</span>
<span>                      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">Modalite</span>, <span class="va">CoordF1</span><span class="op">)</span>,</span>
<span>                          x <span class="op">=</span> <span class="va">CoordF1</span>, fill <span class="op">=</span> <span class="va">CoordF1</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">.6</span>, alpha <span class="op">=</span> <span class="fl">.8</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Coordonnée"</span> , values <span class="op">=</span> <span class="va">couleursCoords</span>,</span>
<span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Positive"</span> , <span class="st">"Négative"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Coordonnées sur l'axe 1"</span>, y <span class="op">=</span> <span class="st">"Modalité"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>, axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plotCtrF1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfmodalites</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">Modalite</span>, <span class="va">ctrF1</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">ctrF1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, width <span class="op">=</span> <span class="fl">.6</span>, alpha <span class="op">=</span> <span class="fl">.8</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Contributions sur l'axe 1"</span>, y <span class="op">=</span> <span class="st">"Modalité"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>, axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">plotCoordF1</span>, <span class="va">plotCtrF1</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ACMMiseEnOeuvreVars1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMMiseEnOeuvreVars1-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.46: Exemple de graphiques pour les résultats des modalités</figcaption></figure>
</div>
</div>
</div>
<p>La syntaxe suivante permet de construire le premier plan factoriel pour les modalités avec la fonction <code>fviz_mca_var</code> de <code>factoextra</code> (<a href="#fig-ACMMiseEnOeuvreVars2">figure&nbsp;<span class="quarto-unresolved-ref">fig-ACMMiseEnOeuvreVars2</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res.acm2</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/MCA.html">MCA</a></span><span class="op">(</span><span class="va">dfACM</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, ncp <span class="op">=</span> <span class="fl">3</span>, graph <span class="op">=</span> <span class="cn">FALSE</span>, row.w <span class="op">=</span> <span class="va">dfenquete</span><span class="op">$</span><span class="va">pond</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_mca.html">fviz_mca_var</a></span><span class="op">(</span><span class="va">res.acm2</span>, repel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             choice <span class="op">=</span> <span class="st">"var.cat"</span>,</span>
<span>             axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>             <span class="co"># col.var = "black",</span></span>
<span>             title <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"Axe 1"</span>, ylab <span class="op">=</span> <span class="st">"Axe 2"</span>,</span>
<span>             ggtheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span> <span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ACMMiseEnOeuvreVars2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMMiseEnOeuvreVars2-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.47: Premier plan factoriel de l’ACM pour les modalités</figcaption></figure>
</div>
</div>
</div>
<p>La syntaxe suivante permet de construire le premier plan factoriel pour les modalités supplémentaires avec la fonction <code>fviz_mca_var</code> de <code>factoextra</code> (<a href="#fig-ACMMiseEnOeuvreVars3">figure&nbsp;<span class="quarto-unresolved-ref">fig-ACMMiseEnOeuvreVars3</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_mca.html">fviz_mca_var</a></span><span class="op">(</span><span class="va">res.acm</span>, repel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             choice <span class="op">=</span> <span class="st">"var.cat"</span>,</span>
<span>             axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>             col.var <span class="op">=</span> <span class="st">"gray23"</span>,</span>
<span>             col.quali.sup <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>             labelsize <span class="op">=</span> <span class="fl">3</span>,</span>
<span>             title <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"Axe 1"</span>, ylab <span class="op">=</span> <span class="st">"Axe 2"</span>, </span>
<span>             ggtheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span> <span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ACMMiseEnOeuvreVars3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMMiseEnOeuvreVars3-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.48: Premier plan factoriel de l’ACM pour les modalités supplémentaires</figcaption></figure>
</div>
</div>
</div>
<p>Finalement, la syntaxe ci-dessous renvoie un graphique avec la trajectoire de la variable <code>Q3</code> (<a href="#fig-ACMMiseEnOeuvreVars4">figure&nbsp;<span class="quarto-unresolved-ref">fig-ACMMiseEnOeuvreVars4</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span><span class="va">Q3</span> <span class="op">&lt;-</span> <span class="va">dfmodalites</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">Q3</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CoordF1</span>, y <span class="op">=</span> <span class="va">CoordF2</span>, label<span class="op">=</span><span class="va">Modalite</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">.75</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Q3. Depuis combien de temps cultivez-vous \n</span></span>
<span><span class="st">        des fruits, des fines herbes ou des légumes?"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Axe 1"</span>, y <span class="op">=</span> <span class="st">"Axe 2"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label</a></span><span class="op">(</span>nudge_x<span class="op">=</span><span class="fl">0</span>, nudge_y <span class="op">=</span> <span class="fl">0.07</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span> color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape<span class="op">=</span><span class="fl">21</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span>, size<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ACMMiseEnOeuvreVars4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMMiseEnOeuvreVars4-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.49: Trajectoires des variables ordinales sur le premier plan factoriel de l’ACM</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-124214" class="level4" data-number="12.4.2.4"><h4 data-number="12.4.2.4" class="anchored" data-anchor-id="sec-124214">
<span class="header-section-number">12.4.2.4</span> Exploration graphique des résultats de l’ACM pour les individus</h4>
<p>D’autres fonctions de <code>factoextra</code> produisent rapidement des graphiques pour les individus&nbsp;:</p>
<ul>
<li>
<code>fviz_cos2</code> et <code>fviz_contrib</code> (en utilisant le paramètre <code>choice=ind</code>) pour construire des histogrammes pour les cosinus carrés et les contributions des individus.</li>
<li>
<code>fviz_mca_ind</code> pour un nuage de points d’un plan factoriel (axes 1 et 2 habituellement).</li>
</ul>
<p>La syntaxe ci-dessous produit le premier axe factoriel pour les individus (<a href="#fig-ACMPlanFactoInd1Facto">figure&nbsp;<span class="quarto-unresolved-ref">fig-ACMPlanFactoInd1Facto</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_mca.html">fviz_mca_ind</a></span><span class="op">(</span><span class="va">res.acm</span>, col.ind <span class="op">=</span> <span class="st">"cos2"</span>,</span>
<span>             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,</span>
<span>             repel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             xlab <span class="op">=</span> <span class="st">"Axe 1"</span>, ylab <span class="op">=</span> <span class="st">"Axe 2"</span>, title <span class="op">=</span> <span class="st">""</span>,</span>
<span>             ggtheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ACMPlanFactoInd1Facto" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMPlanFactoInd1Facto-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.50: Premier plan factoriel de l’ACM pour les individus avec factoextra</figcaption></figure>
</div>
</div>
</div>
<p>La syntaxe ci-dessous produit aussi le premier plan factoriel pour les individus, mais en attribuant une couleur différente aux modalités de la variable <code>q12</code> (<a href="#fig-ACMPlanFactoInd2Facto">figure&nbsp;<span class="quarto-unresolved-ref">fig-ACMPlanFactoInd2Facto</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_mca.html">fviz_mca_ind</a></span> <span class="op">(</span><span class="va">res.acm</span>,</span>
<span>              label <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>              habillage <span class="op">=</span> <span class="st">"q12"</span>, <span class="co"># colorer par groupes</span></span>
<span>             xlab <span class="op">=</span> <span class="st">"Axe 1"</span>, ylab <span class="op">=</span> <span class="st">"Axe 2"</span>, title <span class="op">=</span> <span class="st">""</span>,</span>
<span>              palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span> <span class="op">(</span><span class="st">"darkred"</span>, <span class="st">"steelblue"</span>, <span class="st">"gray23"</span><span class="op">)</span>,</span>
<span>              ggtheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span> <span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ACMPlanFactoInd2Facto" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="12-AnalysesFactorielles_files/figure-html/fig-ACMPlanFactoInd2Facto-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.51: Premier plan factoriel de l’ACM pour les individus avec coloration d’une variable avec factoextra</figcaption></figure>
</div>
</div>
</div>
</section></section></section><section id="sec-125" class="level2" data-number="12.5"><h2 data-number="12.5" class="anchored" data-anchor-id="sec-125">
<span class="header-section-number">12.5</span> Quiz de révision du chapitre</h2>
<div id="Chapitre12_AnalysesFacto" class="card">
<link type="text/javascript" src="libs/quizlib.1.0.1.min.js">
<script>var Quiz=function(a,b){this.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),this.unansweredQuestionText="Question sans réponse !",this.container=document.getElementById(a),this.questions=[],this.result=new QuizResult,this.answers=b;for(var c=0;c<this.container.children.length;c++)this.container.children[c].classList.contains(Quiz.Classes.QUESTION)&&this.questions.push(this.container.children[c]);if(this.answers.length!=this.questions.length)throw new Error("Number of answers does not match number of questions!")};Quiz.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),Quiz.prototype.checkAnswers=function(a){void 0===a&&(a=!0);for(var b=[],c=[],d=0;d<this.questions.length;d++){var e=this.questions[d],f=this.answers[d],g=[];this.clearHighlights(e);for(var h,i=e.getElementsByClassName(Quiz.Classes.QUESTION_ANSWERS)[0].getElementsByTagName("input"),j=0;j<i.length;j++)h=i[j],"checkbox"===h.type||"radio"===h.type?h.checked&&g.push(h.value):""!==h.value&&g.push(h.value);1!=g.length||Array.isArray(f)?0===g.length&&b.push(e):g=g[0],c.push(Utils.compare(g,f))}if(0===b.length||!a)return this.result.setResults(c),!0;for(d=0;d<b.length;d++){var k=document.createElement("span");k.appendChild(document.createTextNode(this.unansweredQuestionText)),k.className=Quiz.Classes.QUESTION_WARNING,b[d].getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].appendChild(k)}return!1},Quiz.prototype.clearHighlights=function(a){for(var b=a.getElementsByClassName(Quiz.Classes.QUESTION_WARNING);b.length>0;)b[0].parentNode.removeChild(b[0]);var c,d=[a.getElementsByClassName(Quiz.Classes.CORRECT),a.getElementsByClassName(this.Classes.INCORRECT)];for(i=0;i<d.length;i++)for(;d[i].length>0;)c=d[i][0],c.classList.remove(Quiz.Classes.CORRECT),c.classList.remove(Quiz.Classes.INCORRECT);for(var e=a.getElementsByClassName(Quiz.Classes.TEMP);e.length>0;)e[0].parentNode.removeChild(e[0])},Quiz.prototype.highlightResults=function(a){for(var b,c=0;c<this.questions.length;c++)b=this.questions[c],b.getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].classList.add(this.result.results[c]?Quiz.Classes.CORRECT:Quiz.Classes.INCORRECT),void 0!==a&&a(this,b,c,this.result.results[c])};var QuizResult=function(){this.results=[],this.totalQuestions=0,this.score=0,this.scorePercent=0,this.scorePercentFormatted=0};QuizResult.prototype.setResults=function(a){this.results=a,this.totalQuestions=this.results.length,this.score=0;for(var b=0;b<this.results.length;b++)this.results[b]&&this.score++;this.scorePercent=this.score/this.totalQuestions,this.scorePercentFormatted=Math.floor(100*this.scorePercent)};var Utils=function(){};Utils.compare=function(a,b){if(a.length!=b.length)return!1;if(Array.isArray(a)&&Array.isArray(b)){for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b};

function showResults(quiz) {
    // Check answers and continue if all questions have been answered
    if (quiz.checkAnswers()) {
        var quizScorePercent = quiz.result.scorePercentFormatted; // The unformatted percentage is a decimal in range 0 - 1
        var quizResultElement = document.getElementById('quiz-result');
        quizResultElement.style.display = 'block';
        document.getElementById('quiz-percent').innerHTML = quizScorePercent.toString();

        // Change background colour of results div according to score percent
        if (quizScorePercent > 75) quizResultElement.style.backgroundColor = '#4caf50';
        else if (quizScorePercent > 50) quizResultElement.style.backgroundColor = '#ffc107';
        else if (quizScorePercent > 25) quizResultElement.style.backgroundColor = '#ff9800';
        else if (quizScorePercent > 0) quizResultElement.style.backgroundColor = '#f44336';

        // Highlight questions according to whether they were correctly answered. The callback allows us to highlight/show the correct answer
        quiz.highlightResults(handleAnswers);
    }
}

/** Callback for Quiz.highlightResults. Highlights the correct answers of incorrectly answered questions
 * Parameters are: the quiz object, the question element, question number, correctly answered flag
 */
function handleAnswers(quiz, question, no, correct) {
    if (!correct) {
        var answers = question.getElementsByTagName('input');
        for (var i = 0; i < answers.length; i++) {
            if (answers[i].type === 'checkbox' || answers[i].type === 'radio'){
                // If the current input element is part of the correct answer, highlight it
                if (quiz.answers[no].indexOf(answers[i].value) > -1) {
                    answers[i].parentNode.classList.add(Quiz.Classes.CORRECT);
                }
            } else {
                // If the input is anything other than a checkbox or radio button, show the correct answer next to the element
                var correctAnswer = document.createElement('span');
                correctAnswer.classList.add(Quiz.Classes.CORRECT);
                correctAnswer.classList.add(Quiz.Classes.TEMP); // quiz.checkAnswers will automatically remove elements with the temp class
                correctAnswer.innerHTML = quiz.answers[no];
                correctAnswer.style.marginLeft = '10px';
                answers[i].parentNode.insertBefore(correctAnswer, answers[i].nextSibling);
            }
        }
    }
}

  var quizz_Chapitre12_AnalysesFacto;
  window.onload = function() {
    quizz_Chapitre12_AnalysesFacto = new Quiz('Chapitre12_AnalysesFacto', ['1','1','1','2',['1', '2', '3'],'1','2',['1', '2', '3', '4']]);
  };</script><link rel="stylesheet" type="text/css" src="css/quizlib.min.css">
<div class="card quizlib-question">
<div class="quizlib-question-title">
Des variables latentes ne sont pas directement observées, mais plutôt produites par la méthode factorielle afin de résumer les relations/associations entre plusieurs variables mesurées initialement.
</div>
<div>
Relisez au besoin l’introduction du <a href="#sec-chap12">chapitre&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-chap12</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Vrai</label>
</td>
<td>
<input type="radio" name="q1" value="1">
</td>
</tr>
<tr>
<td>
<label>Faux</label>
</td>
<td>
<input type="radio" name="q1" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quelles sont les métriques utilisées pour les trois principales méthodes factorielles?
</div>
<div>
Relisez au besoin la <a href="#sec-1211">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-1211</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>ACP (distance euclidienne), AFC (distance du khi-deux), ACM (distance du khi-deux)</label>
</td>
<td>
<input type="radio" name="q2" value="1">
</td>
</tr>
<tr>
<td>
<label>ACP (distance du khi-deux), AFC (distance du khi-deux), ACM (distance euclidienne)</label>
</td>
<td>
<input type="radio" name="q2" value="2">
</td>
</tr>
<tr>
<td>
<label>ACP (distance euclidienne), AFC (distance euclidienne), ACM (distance du khi-deux)</label>
</td>
<td>
<input type="radio" name="q2" value="3">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
En ACP normée, la somme des valeurs propres (inertie totale) est égale au :
</div>
<div>
Relisez au besoin le début de la <a href="#sec-12221">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-12221</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>nombre de variables quantitatives du tableau initial</label>
</td>
<td>
<input type="radio" name="q3" value="1">
</td>
</tr>
<tr>
<td>
<label>nombre d’observations moins le nombre de variables</label>
</td>
<td>
<input type="radio" name="q3" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
En ACP normée, la coordonnée factorielle d’une variable sur un axe est :
</div>
<div>
Relisez au besoin la <a href="#sec-12222">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-12222</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>le covariance de la variable avec la composante principale (axe factoriel)</label>
</td>
<td>
<input type="radio" name="q4" value="1">
</td>
</tr>
<tr>
<td>
<label>le coefficient de corrélation de la variable avec la composante principale (axe factoriel)</label>
</td>
<td>
<input type="radio" name="q4" value="2">
</td>
</tr>
<tr>
<td>
<label>la variance de la variable</label>
</td>
<td>
<input type="radio" name="q4" value="3">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quelles affirmations sont exactes pour toutes les méthodes factorielles?
</div>
<div>
Relisez au besoin chacune des sections intitulées aides à l’interprétation pour les trois méthodes factorielles.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>La somme des cosinus carrés en ligne est toujours égale à 1</label>
</td>
<td>
<input type="checkbox" name="q5" value="1">
</td>
</tr>
<tr>
<td>
<label>La somme des valeurs propres est toujours égale à l’inertie totale du tableau</label>
</td>
<td>
<input type="checkbox" name="q5" value="2">
</td>
</tr>
<tr>
<td>
<label>La somme des contributions en colonne pour un axe est égale à 100 %</label>
</td>
<td>
<input type="checkbox" name="q5" value="3">
</td>
</tr>
<tr>
<td>
<label>Les coordonnées factorielles sont toujours le coefficient de corrélation de la variable avec l’axe</label>
</td>
<td>
<input type="checkbox" name="q5" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
L’analyse des correspondances multiples (ACM) est simplement une analyse des correspondances (AFC) sur un tableau disjonctif complet?
</div>
<div>
Relisez au besoin la <a href="#sec-124">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-124</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Vrai</label>
</td>
<td>
<input type="radio" name="q6" value="1">
</td>
</tr>
<tr>
<td>
<label>Faux</label>
</td>
<td>
<input type="radio" name="q6" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Dans une ACM, les variables du tableau disjonctif complet sont :
</div>
<div>
Relisez au besoin la <a href="#sec-124">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-124</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>les fréquences des modalités des variables qualitatives</label>
</td>
<td>
<input type="radio" name="q7" value="1">
</td>
</tr>
<tr>
<td>
<label>les modalités des variables qualitatives transformées en variables binaires</label>
</td>
<td>
<input type="radio" name="q7" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quelles sont les étapes essentielles pour bien interpréter une analyse factorielle (ACP, AFC ou ACM)?
</div>
<div>
Relisez le deuxième encadré à la <a href="#sec-1221">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-1221</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Interprétation des résultats des valeurs propres pour identifier le nombre d’axes à retenir</label>
</td>
<td>
<input type="checkbox" name="q8" value="1">
</td>
</tr>
<tr>
<td>
<label>Analyse des résultats pour les variables (coordonnées, cosinus carrés et contributions)</label>
</td>
<td>
<input type="checkbox" name="q8" value="2">
</td>
</tr>
<tr>
<td>
<label>Analyse des résultats pour les individus (coordonnées, cosinus carrés et contributions)</label>
</td>
<td>
<input type="checkbox" name="q8" value="3">
</td>
</tr>
<tr>
<td>
<label>Dénommer, qualifier chacun des axes suite à l’analyse des résultats pour les variables et les individus</label>
</td>
<td>
<input type="checkbox" name="q8" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<button type="button" onclick="showResults(quizz_Chapitre12_AnalysesFacto);" id="buttonID">
Vérifier votre résultat
</button>
<div id="quiz-result" class="card">
<p><span id="quiz-percent"></span></p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-audate2021motivations" class="csl-entry" role="listitem">
Audate, Pierre Paul, Geneviève Cloutier et Alexandre Lebel. 2021. <span>«&nbsp;The motivations of urban agriculture practitioners in deprived neighborhoods: A comparative study of Montreal and Quito.&nbsp;»</span> <em>Urban Forestry &amp; Urban Greening</em> 62: 127171. <a href="https://doi.org/10.1016/j.ufug.2021.127171">https://doi.org/10.1016/j.ufug.2021.127171</a>.
</div>
<div id="ref-bendixen1995compositional" class="csl-entry" role="listitem">
Bendixen, Mike T. 1995. <span>«&nbsp;Compositional perceptual mapping using chi-squared trees analysis and correspondence analysis.&nbsp;»</span> <em>Journal of Marketing Management</em> 11 (6): 571‑581. <a href="https://doi.org/10.1080/0267257X.1995.9964368">https://doi.org/10.1080/0267257X.1995.9964368</a>.
</div>
<div id="ref-benzecri1973analyse" class="csl-entry" role="listitem">
Benzécri, Jean-Paul. 1973. <em>L’analyse des donn<span>é</span>es. Tome 1. La taxinomie. Tome 2. L’analyse des correspondances</em>. Vol. 2. Dunod.
</div>
<div id="ref-bhatt2016cultivating" class="csl-entry" role="listitem">
Bhatt, Vikram et Leila Marie Farah. 2016. <span>«&nbsp;Cultivating Montreal: A Brief History of Citizens and Institutions Integrating Urban Agriculture in the City.&nbsp;»</span> <em>Urban Agriculture &amp; Regional Food Systems</em> 1 (1): 1‑12. <a href="http://dx.doi.org/10.2134/urbanag2015.01.1511">http://dx.doi.org/10.2134/urbanag2015.01.1511</a>.
</div>
<div id="ref-escofier1979traitement" class="csl-entry" role="listitem">
Escofier, Brigitte. 1979. <span>«&nbsp;Traitement simultan<span>é</span> de variables qualitatives et quantitatives en analyse factorielle.&nbsp;»</span> <em>Cahiers de l’Analyse des Donn<span>é</span>es</em> 4 (2): 137‑146.
</div>
<div id="ref-escofier1998analyses" class="csl-entry" role="listitem">
Escofier, Brigitte et Jérôme Pagès. 1998. <span>«&nbsp;Analyses factorielles simples et multiples.&nbsp;»</span> <em>Dunod, Paris</em>.
</div>
<div id="ref-2021_4" class="csl-entry" role="listitem">
Gelb, Jérémy et Philippe Apparicio. 2021. <span>«&nbsp;Apport de la classification floue c-means spatiale en g<span>é</span>ographie: essai de taxinomie socio-r<span>é</span>sidentielle et environnementale <span>à</span> Lyon.&nbsp;»</span> <em>Cybergeo: European Journal of Geography</em>. <a href="https://doi.org/10.4000/cybergeo.36414">https://doi.org/10.4000/cybergeo.36414</a>.
</div>
<div id="ref-hotelling1933analysis" class="csl-entry" role="listitem">
Hotelling, Harold. 1933. <span>«&nbsp;Analysis of a complex of statistical variables into principal components.&nbsp;»</span> <em>Journal of educational psychology</em> 24 (6): 417. <a href="https://psycnet.apa.org/doi/10.1037/h0071325">https://psycnet.apa.org/doi/10.1037/h0071325</a>.
</div>
<div id="ref-hubert2005robpca" class="csl-entry" role="listitem">
Hubert, Mia, Peter J Rousseeuw et Karlien Vanden Branden. 2005. <span>«&nbsp;ROBPCA: a new approach to robust principal component analysis.&nbsp;»</span> <em>Technometrics</em> 47 (1): 64‑79. <a href="https://doi.org/10.1198/004017004000000563">https://doi.org/10.1198/004017004000000563</a>.
</div>
<div id="ref-kaiser1960application" class="csl-entry" role="listitem">
Kaiser, Henry F. 1960. <span>«&nbsp;The application of electronic computers to factor analysis.&nbsp;»</span> <em>Educational and psychological measurement</em> 20 (1): 141‑151. <a href="https://doi.org/10.1177%2F001316446002000116">https://doi.org/10.1177%2F001316446002000116</a>.
</div>
<div id="ref-FactoMineR" class="csl-entry" role="listitem">
Lê, Sébastien, Julie Josse et François Husson. 2008. <span>«&nbsp;FactoMineR: A Package for Multivariate Analysis.&nbsp;»</span> <em>Journal of Statistical Software</em> 25 (1): 1‑18. <a href="https://10.18637/jss.v025.i01">10.18637/jss.v025.i01</a>.
</div>
<div id="ref-lebart1995statistique" class="csl-entry" role="listitem">
Lebart, Ludovic, Alain Morineau et Marie Piron. 1995. <em>Statistique exploratoire multidimensionnelle</em>. Dunod.
</div>
<div id="ref-mcclintock2018urban" class="csl-entry" role="listitem">
McClintock, Nathan. 2018. <span>«&nbsp;Urban agriculture, racial capitalism, and resistance in the settler-colonial city.&nbsp;»</span> <em>Geography Compass</em> 12 (6): 1‑16. <a href="https://doi.org/10.1111/gec3.12373">https://doi.org/10.1111/gec3.12373</a>.
</div>
<div id="ref-pages2002analyse" class="csl-entry" role="listitem">
Pagès, Jérôme. 2002. <span>«&nbsp;Analyse factorielle multiple appliqu<span>é</span>e aux variables qualitatives et aux donn<span>é</span>es mixtes.&nbsp;»</span> <em>Revue de statistique appliqu<span>é</span>e</em> 50 (4): 5‑37.
</div>
<div id="ref-pages2013analyse" class="csl-entry" role="listitem">
———. 2013. <em>Analyse factorielle multiple avec R</em>. EDP sciences.
</div>
<div id="ref-rivest1988analyse" class="csl-entry" role="listitem">
Rivest, Louis-Paul et Nathalie Plante. 1988. <span>«&nbsp;L’analyse en composantes principales robuste.&nbsp;»</span> <em>Revue de statistique appliqu<span>é</span>e</em> 36 (1): 55‑66. <a href="http://www.numdam.org/article/RSA_1988__36_1_55_0.pdf">http://www.numdam.org/article/RSA_1988__36_1_55_0.pdf</a>.
</div>
<div id="ref-sanders1989analyse" class="csl-entry" role="listitem">
Sanders, Lena. 1989. <em>L’analyse statistique des donn<span>é</span>es en g<span>é</span>ographie</em>. GIP Reclus.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./11-GAM.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modèles généralisés additifs</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./13-MethodeClassification.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Méthodes de classification non supervisée</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Méthodes quantitatives en sciences sociales : un grand bol d’R.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Ce livre a été réalisé avec <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>