<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Méthodes quantitatives en sciences sociales : un grand bol d’R - 1&nbsp; Prise en main de R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./02-univarie.html" rel="next">
<link href="./00-auteurs.html" rel="prev">
<link href="./images/introduction/Couverture.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer"
  }
}</script><link rel="stylesheet" href="css/quizlib.min.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-priseenmainR.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prise en main de R</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Recherche" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/SerieBoldR/MethodesQuantitatives" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Préface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-auteurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">À propos des auteurs</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 1. Découverte de R</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-priseenmainR.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prise en main de R</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 2. Analyses univariées et représentations graphiques</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-univarie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistiques descriptives univariées</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-magiedesgraphiques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Magie des graphiques</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 3. Analyses bivariées</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-bivarieeQuantiQuanti.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Relation linéaire entre deux variables quantitatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-bivarieeQualiQuali.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Relation entre deux variables qualitatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-bivarieeQualiQuanti.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Relation entre une variable qualitative et une variable quantitative</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 4. Modèles de régression</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-regressionlineaire.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Régression linéaire multiple</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-GLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Régressions linéaires généralisées (GLM)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-GLMM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Régressions à effets mixtes (GLMM)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Multiniveau.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Régressions multiniveaux</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-GAM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modèles généralisés additifs</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 5. Analyses exploratoires multivariées</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-AnalysesFactorielles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Méthodes factorielles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-MethodeClassification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Méthodes de classification non supervisée</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 6. Annexes et bibliographie</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-Annexes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Annexes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliographie</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table des matières</h2>
   
  <ul>
<li><a href="#sec-011" id="toc-sec-011" class="nav-link active" data-scroll-target="#sec-011"><span class="header-section-number">1.1</span> Histoire et philosophie de R</a></li>
  <li>
<a href="#sec-012" id="toc-sec-012" class="nav-link" data-scroll-target="#sec-012"><span class="header-section-number">1.2</span> Environnement de travail</a>
  <ul class="collapse">
<li><a href="#sec-0121" id="toc-sec-0121" class="nav-link" data-scroll-target="#sec-0121"><span class="header-section-number">1.2.1</span> Installation de R</a></li>
  <li><a href="#sec-0122" id="toc-sec-0122" class="nav-link" data-scroll-target="#sec-0122"><span class="header-section-number">1.2.2</span> Environnement RStudio</a></li>
  <li><a href="#sec-0123" id="toc-sec-0123" class="nav-link" data-scroll-target="#sec-0123"><span class="header-section-number">1.2.3</span> Installation et chargement un <em>package</em></a></li>
  <li><a href="#aide-disponible" id="toc-aide-disponible" class="nav-link" data-scroll-target="#aide-disponible"><span class="header-section-number">1.2.4</span> Aide disponible</a></li>
  </ul>
</li>
  <li>
<a href="#sec-013" id="toc-sec-013" class="nav-link" data-scroll-target="#sec-013"><span class="header-section-number">1.3</span> Bases du langage R</a>
  <ul class="collapse">
<li><a href="#sec-0131" id="toc-sec-0131" class="nav-link" data-scroll-target="#sec-0131"><span class="header-section-number">1.3.1</span> <em>Hello World</em>!</a></li>
  <li><a href="#sec-0132" id="toc-sec-0132" class="nav-link" data-scroll-target="#sec-0132"><span class="header-section-number">1.3.2</span> Objets et expressions</a></li>
  <li><a href="#sec-0_133" id="toc-sec-0_133" class="nav-link" data-scroll-target="#sec-0_133"><span class="header-section-number">1.3.3</span> Fonctions et arguments</a></li>
  <li><a href="#sec-0134" id="toc-sec-0134" class="nav-link" data-scroll-target="#sec-0134"><span class="header-section-number">1.3.4</span> Principaux types de données</a></li>
  <li><a href="#sec-0135" id="toc-sec-0135" class="nav-link" data-scroll-target="#sec-0135"><span class="header-section-number">1.3.5</span> Opérateurs</a></li>
  <li><a href="#sec-0136" id="toc-sec-0136" class="nav-link" data-scroll-target="#sec-0136"><span class="header-section-number">1.3.6</span> Structures de données</a></li>
  </ul>
</li>
  <li>
<a href="#sec-014" id="toc-sec-014" class="nav-link" data-scroll-target="#sec-014"><span class="header-section-number">1.4</span> Manipulation de données</a>
  <ul class="collapse">
<li><a href="#sec-0141" id="toc-sec-0141" class="nav-link" data-scroll-target="#sec-0141"><span class="header-section-number">1.4.1</span> Chargement d’un <em>DataFrame</em> depuis un fichier</a></li>
  <li><a href="#sec-0142" id="toc-sec-0142" class="nav-link" data-scroll-target="#sec-0142"><span class="header-section-number">1.4.2</span> Manipulation d’un <em>DataFrame</em></a></li>
  </ul>
</li>
  <li><a href="#sec-016" id="toc-sec-016" class="nav-link" data-scroll-target="#sec-016"><span class="header-section-number">1.5</span> Code R bien structuré</a></li>
  <li><a href="#sec-017" id="toc-sec-017" class="nav-link" data-scroll-target="#sec-017"><span class="header-section-number">1.6</span> Enregistrement des résultats</a></li>
  <li><a href="#sec-018" id="toc-sec-018" class="nav-link" data-scroll-target="#sec-018"><span class="header-section-number">1.7</span> Session de travail</a></li>
  <li><a href="#sec-019" id="toc-sec-019" class="nav-link" data-scroll-target="#sec-019"><span class="header-section-number">1.8</span> Conclusion et ressources pertinentes</a></li>
  <li><a href="#sec-0110" id="toc-sec-0110" class="nav-link" data-scroll-target="#sec-0110"><span class="header-section-number">1.9</span> Quiz de révision du chapitre</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/SerieBoldR/MethodesQuantitatives/issues/new" class="toc-action">Signaler un problème ou<br>formuler une suggestion</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-chap01" class="quarto-section-identifier"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prise en main de R</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Dans ce chapitre, nous revenons brièvement sur l’histoire de R et la philosophie qui entoure le logiciel. Nous donnons quelques conseils pour son installation et la mise en place d’un environnement de développement. Nous présentons les principaux objets qui sous-tendent le travail effectué avec R (<em>DataFrame</em>, vecteur, matrice, etc.) et comment les manipuler avec des exemples appliqués. Si vous maîtrisez déjà R, nullement besoin de lire ce chapitre!</p>
<div class="bloc_package">
<div class="bloc_package-header">
<div class="bloc_package-icon">

</div>
<p><strong>Liste des <em>packages</em> utilisés dans ce chapitre</strong></p>
</div>
<div class="bloc_package-body">
<ul>
<li>Pour importer des fichiers externes&nbsp;:
<ul>
<li>
<code>foreign</code> pour entre autres les fichiers <em>dbase</em> et ceux des logiciels SPSS et Stata.</li>
<li>
<code>sas7bdat</code> pour les fichiers du logiciel SAS.</li>
<li>
<code>xlsx</code> pour les fichiers Excel.</li>
</ul>
</li>
<li>Pour manipuler des chaînes de caractères et des dates&nbsp;:
<ul>
<li>
<code>stringr</code> pour les chaînes de caractères.</li>
<li>
<code>lubridate</code> pour les dates.</li>
</ul>
</li>
<li>Pour manipuler des données&nbsp;:
<ul>
<li>
<code>dplyr</code> du <code>tidyverse</code> propose une grammaire pour manipuler et structurer des données.</li>
</ul>
</li>
</ul>
</div>
</div>
<section id="sec-011" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="sec-011">
<span class="header-section-number">1.1</span> Histoire et philosophie de R</h2>
<p>R est à la fois un langage de programmation et un logiciel libre (sous la licence publique générale GNU) dédié à l’analyse statistique et soutenu par une fondation&nbsp;: <em>R Foundation for Statistical Computing</em>. Il est principalement écrit en C et en Fortran, deux langages de programmation de «&nbsp;bas niveau&nbsp;», proches du langage machine. À l’inverse, R est un langage de «&nbsp;haut niveau&nbsp;», car plus proche du langage humain.</p>
<p>R a été créé par Ross Ihaka et Robert Gentleman à l’Université d’Auckland en Nouvelle-Zélande. Si vous avez un jour l’occasion de passer dans le coin, une plaque est affichée dans le département de statistique de l’université; ça mérite le détour (<a href="#fig-Plaque">figure&nbsp;<span>1.1</span></a>). Une version expérimentale a été publiée en 1996, mais la première version stable ne date que de 2000. Il s’agit donc d’un logiciel relativement récent si nous le comparons à ses concurrents SPSS (1968), SAS (1976) et Stata (1984).</p>
<div id="fig-Plaque" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap01/plaque.jpg" class="img-fluid figure-img" style="width:40.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.1: Lieu de pèlerinage de R</figcaption></figure>
</div>
<p>R a cependant réussi à s’imposer tant dans le milieu de la recherche que dans le secteur privé. Pour s’en convaincre, il suffit de lire l’excellent article concernant la popularité des logiciels d’analyse de données tiré du site <a href="http://r4stats.com/articles/popularity" target="_blank">r4stats.com</a> (<a href="#fig-ArticlesR">figure&nbsp;<span>1.2</span></a>).</p>
<div id="fig-ArticlesR" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/r_citations.jpg" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.2: Nombre d’articles trouvés sur Google Scholar (source : Robert A. Muenchen)</figcaption></figure>
</div>
<p>Les nombreux atouts de R justifient largement sa popularité sans cesse croissante&nbsp;:</p>
<ul>
<li><p>R est un logiciel à code source ouvert (<em>open source</em>) et ainsi accessible à tous gratuitement.</p></li>
<li><p>Le développement du langage R est centralisé, mais la communauté peut créer et partager facilement des <em>packages</em>. Les nouvelles méthodes sont ainsi rapidement implémentées comparativement aux logiciels propriétaires.</p></li>
<li><p>R est un logiciel multiplateforme, fonctionnant sur Linux, Unix, Windows et Mac.</p></li>
<li><p>Comparativement à ses concurrents, R dispose d’excellentes solutions pour manipuler des données et réaliser des graphiques.</p></li>
<li><p>R dispose de nombreuses interfaces lui permettant de communiquer, notamment avec des systèmes de bases de données SQL et non SQL (MySQL, PostgresSQL, MongoDB, etc.), avec des systèmes de <em>big data</em> (Spark, Hadoop), avec des systèmes d’information géographique (QGIS, ArcGIS) et même avec des services en ligne comme Microsoft Azure ou Amazon AWS.</p></li>
<li><p>R est un langage de programmation à part entière, ce qui lui donne plus de flexibilité que ses concurrents commerciaux (SPSS, SAS, STATA). Avec R, vous pouvez accomplir de nombreuses tâches&nbsp;: monter un site web, créer un robot collectant des données en ligne, combiner des fichiers PDF, composer des diapositives pour une présentation ou même éditer un livre (comme celui-ci), mais aussi, et surtout, réaliser des analyses statistiques.</p></li>
</ul>
<p>Un des principaux attraits de R est la quantité astronomique de <em>packages</em> actuellement disponibles. <strong>Un <em>package</em> est un ensemble de nouvelles fonctionnalités développées par des personnes utilisatrices de R et mises à disposition de l’ensemble de la communauté</strong>. Par exemple, le <em>package</em> <code>ggplot2</code> est dédié à la réalisation de graphiques; les <em>packages</em> <code>data.table</code> et <code>dplyr</code> permettent de manipuler des tableaux de données; le <em>package</em> <code>car</code> offre de nombreux outils pour faciliter l’analyse de modèles de régressions, etc. Ce partage de <em>packages</em> rend accessible à tous des méthodes d’analyses complexes et récentes et favorise grandement la reproductibilité de la recherche. Cependant, ce fonctionnement implique quelques désavantages&nbsp;:</p>
<ul>
<li><p>Il existe généralement plusieurs <em>packages</em> pour effectuer le même type d’analyse, ce qui peut devenir une source de confusion.</p></li>
<li><p>Certains <em>packages</em> cessent d’être mis à jour au fil des années, ce qui nécessite de trouver des solutions de rechange (et ainsi apprendre la syntaxe de nouveaux <em>packages</em>).</p></li>
<li><p>Il est impératif de s’assurer de la fiabilité des <em>packages</em> que vous souhaitez utiliser, car n’importe qui peut proposer un <em>package</em>.</p></li>
</ul>
<p>Il nous semble important de relativiser d’emblée la portée du dernier point. Il est rarement nécessaire de lire et d’analyser le code source d’un <em>package</em> pour s’assurer de sa fiabilité. Nous ne sommes pas des spécialistes de tous les sujets et il peut être extrêmement ardu de comprendre la logique d’un code écrit par une autre personne. Nous vous recommandons donc de privilégier l’utilisation de <em>packages</em> qui&nbsp;:</p>
<ul>
<li><p>ont fait l’objet d’une publication dans une revue à comité de lecture ou qui ont déjà été cités dans des études ayant fait l’objet d’une publication revue par les pairs;</p></li>
<li><p>font partie de projets comme <a href="https://ropensci.org/" target="_blank">ROpensci</a> prônant la vérification par les pairs ou subventionnés par des organisations comme <a href="https://www.r-consortium.org/" target="_blank">R Consortium</a>;</p></li>
<li><p>sont disponibles sur l’un des deux principaux répertoires de <em>packages</em> R, soit <a href="https://cran.r-project.org/" target="_blank">CRAN</a> et <a href="https://www.bioconductor.org/" target="_blank">Bioconductor</a>.</p></li>
</ul>
<p>Toujours pour nuancer notre propos, il convient de distinguer <em>package</em> de <em>package</em>! Certains d’entre eux sont des ensembles très complexes de fonctions permettant de réaliser des analyses poussées alors que d’autres sont des projets plus modestes dont l’objectif principal est de simplifier le travail des personnes utilisant R. Ces derniers ressemblent à de petites boîtes à outils et font généralement moins l’objet d’une vérification intensive.</p>
<p>Pour conclure cette section, l’illustration partagée sur Twitter par Darren L Dahly résume avec humour la force du logiciel R et de sa communauté (<a href="#fig-fig03">figure&nbsp;<span>1.3</span></a>)&nbsp;: R apparaît clairement comme une communauté hétéroclite, mais diversifiée et adaptable.</p>
<div id="fig-fig03" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/softwares_and_cars.jpeg" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.3: Métaphore sur les langages et programmes d’analyse statistique</figcaption></figure>
</div>
<p>Dans ce livre, nous détaillons les <em>packages</em> utilisés dans chaque section avec un encadré spécifique.</p>
<div class="bloc_package">
<div class="bloc_package-header">
<div class="bloc_package-icon">

</div>
<p><strong>Bloc <em>packages</em></strong></p>
</div>
<div class="bloc_package-body">
<p>Habituellement localisé au début d’un chapitre, il comprend la liste des <em>packages</em> R utilisés pour un chapitre.</p>
</div>
</div>
</section><section id="sec-012" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="sec-012">
<span class="header-section-number">1.2</span> Environnement de travail</h2>
<p>Dans cette section, nous vous proposons une visite de l’environnement de travail de R.</p>
<section id="sec-0121" class="level3" data-number="1.2.1"><h3 data-number="1.2.1" class="anchored" data-anchor-id="sec-0121">
<span class="header-section-number">1.2.1</span> Installation de R</h3>
<p>La première étape pour travailler avec R est bien sûr de l’installer. Pour cela, il suffit de visiter le site web de <a href="https://cran.r-project.org/" target="_blank">CRAN</a> et de télécharger la dernière version de R en fonction de votre système d’exploitation&nbsp;: Windows, Linux ou Mac. Une fois installé, si vous démarrez R immédiatement, vous aurez accès à une console, plutôt rudimentaire, attendant sagement vos instructions (<a href="#fig-fig05">figure&nbsp;<span>1.4</span></a>).</p>
<div id="fig-fig05" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/r_console.jpeg" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.4: Console de base de R</figcaption></figure>
</div>
<p>Notez que vous pouvez aussi télécharger des versions plus anciennes de R en allant sur ce <a href="https://cran.r-project.org/bin/windows/base/old/" target="_blank">lien</a>. Cela peut être intéressant lorsque vous voulez reproduire des résultats d’une autre étude ou que certains <em>packages</em> ne sont plus disponibles dans les nouvelles versions.</p>
</section><section id="sec-0122" class="level3" data-number="1.2.2"><h3 data-number="1.2.2" class="anchored" data-anchor-id="sec-0122">
<span class="header-section-number">1.2.2</span> Environnement RStudio</h3>
<p>Rares sont les adeptes de R qui préfèrent travailler directement avec la console classique. Nous vous recommandons vivement d’utiliser RStudio, un environnement de développement (<em>IDE</em>) dédié à R offrant une intégration très intéressante d’une console, d’un éditeur de texte, d’une fenêtre de visualisation des données et d’une autre pour les graphiques, d’un accès à la documentation, etc. En d’autres termes, si R est un vélo minimaliste, RStudio permet d’y rajouter des freins, des vitesses, un porte-bagages, des garde-boues et une selle confortable. Vous pouvez <a href="https://rstudio.com/products/rstudio/download" target="_blank">télécharger</a> et installer RStudio sur Windows, Linux et Mac. La version de base est gratuite, mais l’entreprise qui développe ce logiciel propose aussi des versions commerciales du logiciel qui assurent essentiellement une assistance technique. Il existe d’autres environnements de développement pour travailler avec R (Visual Studio Code, Jupyter, Tinn-R, Radiant, RIDE, etc.), mais RStudio offre à ce jour la meilleure option en termes de facilité d’installation, de prise en main et de fonctionnalités proposées (voir l’interface de RStudio à la <a href="#fig-fig06">figure&nbsp;<span>1.5</span></a>).</p>
<div id="fig-fig06" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/r_studio_01.jpeg" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.5: Environnement de base de RStudio</figcaption></figure>
</div>
<p>Avant d’aller plus loin, notez que&nbsp;:</p>
<ul>
<li><p>La console actuellement ouverte dans RStudio vous informe de la version de R que vous utilisez. Vous pouvez en effet avoir plusieurs versions de R installées sur votre ordinateur et passer de l’une à l’autre avec RStudio. Pour cela, naviguez dans l’onglet <em>Tools/Global Options</em> et dans le volet <em>General</em>, puis sélectionnez la version de R que vous souhaitez utiliser.</p></li>
<li><p>L’aspect de RStudio peut être modifié en naviguant dans l’onglet <em>Tools/Global Options</em> et dans le volet <em>Appearance</em>. Nous avons une préférence pour le mode sombre avec le style <em>pastel on dark</em> (<a href="#fig-fig07">figure&nbsp;<span>1.6</span></a>), mais libre à vous de choisir le style qui vous convient.</p></li>
</ul>
<div id="fig-fig07" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/r_studio_02.jpeg" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.6: RStudio avec le style pastel on dark</figcaption></figure>
</div>
<p>Une fois ces détails réglés, vous pouvez ouvrir votre première feuille de code en allant dans l’onglet <em>File/New File/R Script</em>. Votre environnement est maintenant découpé en quatre fenêtres (<a href="#fig-fig08">figure&nbsp;<span>1.7</span></a>)&nbsp;:</p>
<ol type="1">
<li><p>L’éditeur de code, vous permettant d’écrire le script que vous voulez exécuter et de garder une trace de votre travail. Ce script peut être enregistré sur votre ordinateur avec l’extension <strong>.R</strong>, mais ce n’est qu’un simple fichier texte.</p></li>
<li><p>La console vous permettant d’exécuter votre code R et de voir les résultats s’afficher au fur et à mesure.</p></li>
<li><p>La fenêtre d’environnement vous montrant les objets, les fonctions et les jeux de données actuellement disponibles dans votre session (chargés dans la mémoire vive).</p></li>
<li><p>La fenêtre de l’aide, des graphiques et de l’explorateur de fichiers. Vous pouvez accéder ici à la documentation de R et des <em>packages</em> que vous utilisez, aux sorties graphiques que vous produisez et aux dossiers de votre environnement de travail.</p></li>
</ol>
<div id="fig-fig08" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/r_studio_03.jpeg" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.7: Fenêtres de RStudio</figcaption></figure>
</div>
<p>Prenons un bref exemple&nbsp;: tapez la syntaxe suivante dans l’éditeur de code (fenêtre 1 à la <a href="#fig-fig08">figure&nbsp;<span>1.7</span></a>)&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ma_somme</span> <span class="op">&lt;-</span> <span class="fl">4</span><span class="op">+</span><span class="fl">4</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sélectionnez ensuite cette syntaxe (mettre en surbrillance avec la souris) et utilisez le raccourci <em>Ctrl+Entrée</em> ou cliquez sur le bouton <em>Run</em> (avec la flèche verte) pour envoyer cette syntaxe à la console qui l’exécutera immédiatement. Notez que rien ne se passe tant que le code n’est pas envoyé à la console. Il s’agit donc de deux étapes distinctes&nbsp;: écrire son code, puis l’envoyer à la console. Constatez également qu’un objet <em>ma_somme</em> est apparu dans votre environnement et que sa valeur est bien 8. Votre console se «&nbsp;souvient&nbsp;» de cette valeur&nbsp;: elle est actuellement stockée dans votre mémoire vive sous le nom de <em>ma_somme</em> (<a href="#fig-fig09">figure&nbsp;<span>1.8</span></a>).</p>
<div id="fig-fig09" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/r_studio_04.jpeg" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.8: Exécuter du code dans RStudio</figcaption></figure>
</div>
<p>Pour conclure cette section, nous vous invitons à enregistrer votre première syntaxe R (<em>File/Save As</em>) dans un fichier <strong>.R</strong> que vous pouvez appeler <code>mon_premier_script.R</code> par exemple. Fermez ensuite RStudio, redémarrez-le et ouvrez (<em>File/Open File</em>) votre fichier <code>mon_premier_script.R</code>. Vous pouvez constater que votre code est toujours présent, mais que votre environnement est vide tant que vous n’exécutez pas votre syntaxe. En effet, lorsque vous fermez RStudio, l’environnement est vidé pour libérer de la mémoire vive. Cela peut poser problème lorsque certains codes sont très longs à exécuter, nous verrons donc plus tard comment enregistrer l’environnement en cours pour le recharger par la suite.</p>
</section><section id="sec-0123" class="level3" data-number="1.2.3"><h3 data-number="1.2.3" class="anchored" data-anchor-id="sec-0123">
<span class="header-section-number">1.2.3</span> Installation et chargement un <em>package</em>
</h3>
<p>Dans la section sur la Philosophie de R, nous avons souligné la place centrale jouée par les <em>packages</em>. Notez que les termes <em>paquet</em> et plus rarement <em>librairie</em> sont parfois utilisés en français. Voyons ensemble comment installer un <em>package</em>, par exemple celui intitulé <code>lubridate</code>, qui nous permettra plus tard de manipuler des données temporelles.</p>
<section id="sec-01231" class="level4" data-number="1.2.3.1"><h4 data-number="1.2.3.1" class="anchored" data-anchor-id="sec-01231">
<span class="header-section-number">1.2.3.1</span> Installation d’un <em>package</em> depuis <em>CRAN</em>
</h4>
<p>Pour installer un <em>package</em>, il est nécessaire d’être connecté à Internet puisque R va accéder au répertoire de <em>packages</em> <em>CRAN</em> pour télécharger le <em>package</em> et l’installer sur votre machine. Cette opération est réalisée avec la fonction <code>install.packages</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"lubridate"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notez qu’une fois que le <em>package</em> est installé, il demeure disponible localement sur votre ordinateur, à moins de le désinstaller explicitement avec la fonction <code>remove.packages</code>.</p>
</section><section id="sec-01232" class="level4" data-number="1.2.3.2"><h4 data-number="1.2.3.2" class="anchored" data-anchor-id="sec-01232">
<span class="header-section-number">1.2.3.2</span> Installation d’un <em>package</em> depuis GitHub</h4>
<p><em>CRAN</em> est le répertoire officiel des <em>packages</em> de R. Vous pouvez cependant télécharger des <em>packages</em> provenant d’autres sources. Très souvent, les <em>packages</em> sont disponibles sur le site web <a href="https://github.com/" target="_blank">GitHub</a> et nous pouvons même y trouver des versions en développement avec des fonctionnalités encore non intégrées dans la version sur <em>CRAN</em>. Reprenons le cas de <code>lubridate</code>, mais sur GitHub (il est disponible <a href="https://github.com/tidyverse/lubridate" target="_blank">ici</a>). Pour l’installer, nous devons d’abord installer un autre <em>package</em> appelé <code>remotes</code> (depuis <em>CRAN</em>).</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Maintenant que nous disposons de <code>remotes</code>, nous pouvons utiliser la fonction d’installation <code><a href="https://remotes.r-lib.org/reference/install_github.html">remotes::install_github</a></code> pour directement télécharger <code>lubridate</code> depuis GitHub.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"tidyverse/lubridate"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-01233" class="level4" data-number="1.2.3.3"><h4 data-number="1.2.3.3" class="anchored" data-anchor-id="sec-01233">
<span class="header-section-number">1.2.3.3</span> Chargement d’un <em>package</em>
</h4>
<p>Maintenant que <code>lubridate</code> est installé, nous pouvons le charger dans notre session actuelle de R et accéder aux fonctions qu’il propose. Pour cela, il suffit d’utiliser la fonction <code>library</code>. Conventionnellement, l’appel des <em>packages</em> se fait au tout début du script que vous rédigez. Rien ne vous empêche de le faire au fur et à mesure de votre code, mais ce dernier perd alors en lisibilité. Notez que pour chaque nouvelle session (redémarrage de R), il faut recharger les <em>packages</em> dont vous avez besoin avec la fonction <code>library</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si vous obtenez un message d’erreur du type&nbsp;:</p>
<p><code>Error in library(monPackage) : aucun package nommé ‘monPackage’ n'est trouvé</code></p>
<p>Cela signifie que le <em>package</em> que vous tentez de charger n’est pas encore installé sur votre ordinateur. Dans ce cas, réessayer de l’installer avec la fonction <code>install.packages</code>. Si le problème persiste, vérifiez que vous n’avez pas fait une faute de frappe dans le nom du <em>package.</em> Vous pouvez également redémarrer RStudio et réessayer d’installer ce <em>package</em>.</p>
</section></section><section id="aide-disponible" class="level3" data-number="1.2.4"><h3 data-number="1.2.4" class="anchored" data-anchor-id="aide-disponible">
<span class="header-section-number">1.2.4</span> Aide disponible</h3>
<p>Lorsque vous installez des <em>packages</em> dans R, vous téléchargez aussi leur documentation. Tous les <em>packages</em> de <em>CRAN</em> disposent d’une documentation, ce qui n’est pas forcément vrai pour ceux sur <em>GitHub</em>. Dans RStudio, vous pouvez accéder à la documentation des <em>packages</em> dans l’onglet <strong>Packages</strong> (<a href="#fig-fig010">figure&nbsp;<span>1.9</span></a>). Vous pouvez utiliser la barre de recherche pour retrouver rapidement un <em>package</em> installé. Si vous cliquez sur le nom du <em>package</em>, vous accédez directement à sa documentation dans cette fenêtre.</p>
<div id="fig-fig010" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/rstudio_packages.jpeg" class="img-fluid figure-img" style="width:45.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.9: Description des packages</figcaption></figure>
</div>
<p>Vous pouvez également accéder à ces informations en utilisant la syntaxe suivante dans votre console&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html">help</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">'lubridate'</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Souvent, vous aurez besoin d’accéder à la documentation d’une fonction spécifique d’un <em>package</em>. Affichons la documentation de la fonction <code>now</code> de <code>lubridate</code>&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html">help</a></span><span class="op">(</span><span class="va">now</span>, package <span class="op">=</span> <span class="st">'lubridate'</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ou plus simplement&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">?</span><span class="fu">lubridate</span><span class="fu">::</span><span class="va"><a href="https://lubridate.tidyverse.org/reference/now.html">now</a></span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vous pouvez aussi utiliser le raccourci suivant.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">?</span><span class="va">now</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si vous ne vous souvenez plus à quel <em>package</em> la fonction appartient, lancez une recherche en utilisant un double point d’interrogation&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">?</span><span class="op">?</span><span class="va">now</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vous découvrirez ainsi que la fonction <code>now</code> n’existe pas que dans <code>lubridate</code>, ce qui souligne l’importance de bien connaître les <em>packages</em> que nous installons et que nous chargeons dans notre session !</p>
<p>Maintenant que nous avons fait le tour de l’environnement de travail, nous pouvons passer aux choses sérieuses, soit les bases du langage R.</p>
</section></section><section id="sec-013" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="sec-013">
<span class="header-section-number">1.3</span> Bases du langage R</h2>
<p>R est un langage de programmation. Il vous permet de communiquer avec votre ordinateur pour lui donner des tâches à accomplir. Dans cette section, nous abordons les bases du langage. Ce type de section introductive à R est présente dans tous les manuels sur R; elle est donc incontournable. À la première lecture, elle vous semblera probablement aride, et ce, d’autant plus que nous ne réalisons pas d’analyse à proprement parler. Gardez en tête que l’analyse de données requiert au préalable une phase de structuration de ces dernières, opération qui nécessite la maîtrise des notions abordées dans cette section. Nous vous recommandons une première lecture de ce chapitre pour comprendre les manipulations que vous pouvez effectuer avec R, avant de poursuivre avec de la lecture des chapitres suivants dédiés aux analyses statistiques. Vous pourrez revenir consulter cette section au besoin. Notez aussi que la maîtrise des différents objets et des différentes opérations de base de R ne s’acquiert qu’en pratiquant. Vous gagnerez cette expertise au fil de vos prochains codes R, période durant laquelle vous pourrez consulter ce chapitre tel un guide de référence des objets et des notions fondamentales de R.</p>
<section id="sec-0131" class="level3" data-number="1.3.1"><h3 data-number="1.3.1" class="anchored" data-anchor-id="sec-0131">
<span class="header-section-number">1.3.1</span> <em>Hello World</em>!</h3>
<p>Une introduction à un langage de programmation se doit de commencer par le rite de passage <em>Hello World</em>. Il s’agit d’une forme de tradition consistant à montrer aux néophytes comment afficher le message <code>Hello World</code> à l’écran avec le langage en question.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Hello World"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello World"</code></pre>
</div>
</div>
<p>Bravo! Vous venez officiellement de faire votre premier pas dans R!</p>
</section><section id="sec-0132" class="level3" data-number="1.3.2"><h3 data-number="1.3.2" class="anchored" data-anchor-id="sec-0132">
<span class="header-section-number">1.3.2</span> Objets et expressions</h3>
<p>Dans R, nous passons notre temps à manipuler des <strong>objets</strong> à l’aide d’<strong>expressions</strong>. Prenons un exemple concret&nbsp;: si vous tapez la syntaxe <code>4 + 3</code>, vous manipulez deux objets (4 et 3) avec une expression indiquant que vous souhaitez obtenir la somme des deux objets.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">4</span> <span class="op">+</span> <span class="fl">3</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
</div>
<p>Cette expression est correcte, R comprend vos indications et effectue le calcul.</p>
<p>Il est possible d’enregistrer le résultat d’une expression et de le conserver dans un nouvel objet. On appelle cette opération&nbsp;: «&nbsp;déclarer une variable&nbsp;».</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ma_somme</span> <span class="op">&lt;-</span> <span class="fl">4</span> <span class="op">+</span> <span class="fl">3</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Concrètement, nous venons de demander à R d’enregistrer le résultat de <code>4 + 3</code> dans un espace spécifique de notre mémoire vive. Si vous regardez dans votre fenêtre <strong>Environment</strong>, vous verrez en effet qu’un objet appelé ma_somme est actuellement en mémoire et a pour valeur 7.</p>
<p>Notez ici que le nom des variables ne peut être composé que de lettres, de chiffres, de points (.) et de tirets bas (_) et doit commencer par une lettre. R est sensible à la casse; en d’autres termes, les variables <code>Ma_somme</code>, <code>ma_sommE</code>, <code>ma_SOMME</code>, et <code>MA_SOMME</code> renvoient toutes à un objet différent. Attention donc aux fautes de frappe. Si vous déclarez une variable en utilisant le nom d’une variable existante, la première est écrasée par la seconde&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fl">35</span></span>
<span><span class="va">age</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fl">45</span></span>
<span><span class="va">age</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 45</code></pre>
</div>
</div>
<p>Portez alors attention aux noms de variables que vous utilisez et réutilisez. Réutilisons notre objet <code>ma_somme</code> dans une nouvelle expression&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ma_somme2</span> <span class="op">&lt;-</span> <span class="va">ma_somme</span> <span class="op">+</span> <span class="va">ma_somme</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Avec cette nouvelle expression, nous indiquons à R que nous souhaitons déclarer une nouvelle variable appelée <code>ma_somme2</code>, et que cette variable aura pour valeur <code>ma_somme + ma_somme</code>, soit <code>7 + 7</code>. Sans surprise, <code>ma_somme2</code> a pour valeur 14.</p>
<p>Notez que la mémoire vive (l’environnement) est vidée lorsque vous fermez R. Autrement dit, R perd complètement la mémoire lorsque vous le fermez. Vous pouvez bien sûr recréer vos objets en relançant les mêmes syntaxes. C’est pourquoi vous devez conserver vos feuilles de codes et ne pas seulement travailler dans la console. La console ne garde aucune trace de votre travail. Pensez donc à bien enregistrer votre code!</p>
<p>Nous verrons dans une prochaine section comment sauvegarder des objets et les recharger dans une session ultérieure de R (<a href="#sec-017">section&nbsp;<span>1.6</span></a>). Ce type d’opération est pertinent quand le temps de calcul nécessaire à la production de certains objets est très long.</p>
</section><section id="sec-0_133" class="level3" data-number="1.3.3"><h3 data-number="1.3.3" class="anchored" data-anchor-id="sec-0_133">
<span class="header-section-number">1.3.3</span> Fonctions et arguments</h3>
<p>Dans R, nous manipulons le plus souvent nos objets avec des <strong>fonctions</strong>. Une fonction est elle-même un objet, mais qui a la particularité de pouvoir effectuer des opérations sur d’autres objets. Par exemple, déclarons l’objet <code>taille</code> avec une valeur de 175,897&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">taille</span> <span class="op">&lt;-</span> <span class="fl">175.897</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous utilisons la fonction <code>round</code>, dont l’objectif est d’arrondir un nombre avec décimales pour obtenir un nombre entier.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">taille</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 176</code></pre>
</div>
</div>
<p>Pour effectuer leurs opérations, les fonctions ont généralement besoin d’<strong>arguments</strong>. Ici, <code>taille</code> est un argument passé à la fonction <code>round</code>. Si nous regardons la documentation de <code>round</code> avec <code><a href="https://rdrr.io/r/base/Round.html">help(round)</a></code> (<a href="#fig-fig011">figure&nbsp;<span>1.10</span></a>), nous constatons que cette fonction prend en réalité deux arguments&nbsp;: <em>x</em> et <em>digits</em>. Le premier est le nombre que nous souhaitons arrondir et le second est le nombre de décimales à conserver. Nous pouvons lire dans la documentation que la valeur par défaut de <em>digits</em> est 0, ce qui explique que <code>round(taille)</code> a produit le résultat de 176.</p>
<div id="fig-fig011" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/help_round.jpeg" class="img-fluid figure-img" style="width:35.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.10: Arguments de la fonction <code>round</code></figcaption></figure>
</div>
<p>Réutilisons maintenant la fonction <code>round</code>, mais en gardant une décimale&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">taille</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 175.9</code></pre>
</div>
</div>
<p>Il est aussi possible que certaines fonctions ne requièrent pas d’argument. Par exemple, la fonction <code>now</code> indique la date précise (avec l’heure) et n’a besoin d’aucun argument pour le faire&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">now</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2024-07-03 17:32:55 EDT"</code></pre>
</div>
</div>
<p>Par contre, si nous essayons de lancer la fonction <code>round</code> sans argument, nous obtenons une erreur&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>Erreur : 0 argument passé à 'round' qui en exige 1 ou 2</code></p>
<p>Le message est très clair, <code>round</code> a besoin d’au moins un argument pour fonctionner. Si, au lieu d’un nombre, nous avions donné du texte à la fonction <code>round</code>, nous aurions aussi obtenu une erreur&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="st">"Hello World"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>Erreur dans round("Hello World") : argument non numérique pour une fonction mathématique</code></p>
<p>À nouveau le message est très explicite&nbsp;: nous avons passé un argument non numérique à une fonction mathématique. Lisez toujours vos messages d’erreurs&nbsp;: ils permettent de repérer les coquilles et de corriger votre code!</p>
<p>Nous terminons cette section avec une fonction essentielle, <code>print</code>, qui permet d’afficher la valeur d’une variable.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ma_somme</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
</div>
</section><section id="sec-0134" class="level3" data-number="1.3.4"><h3 data-number="1.3.4" class="anchored" data-anchor-id="sec-0134">
<span class="header-section-number">1.3.4</span> Principaux types de données</h3>
<p>Depuis le début de ce chapitre, nous avons déclaré plusieurs variables et essentiellement des données numériques. Dans R, il existe trois principaux types de données de base&nbsp;:</p>
<ul>
<li><p>Les données numériques qui peuvent être des nombres entiers (appelés <em>integers</em>) ou des nombres décimaux (appelés <em>floats</em> ou <em>doubles</em>), par exemple <code>15</code> et <code>15.3</code>.</p></li>
<li><p>Les données de type texte qui sont des chaînes de caractères (appelées <em>strings</em>) et déclarées entre guillemets <code>"abcdefg"</code>.</p></li>
<li><p>Les données booléennes (<em>booleans</em>) qui peuvent n’avoir que deux valeurs&nbsp;: vrai (<code>TRUE</code>) ou faux (<code>FALSE</code>).</p></li>
</ul>
<p>Déclarons une variable pour chacun de ces types&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fl">35</span></span>
<span><span class="va">taille</span> <span class="op">&lt;-</span> <span class="fl">175.5</span></span>
<span><span class="va">adresse</span> <span class="op">&lt;-</span> <span class="st">'4225 rue de la gauchetiere'</span></span>
<span><span class="va">proprietaire</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="bloc_notes">
<div class="bloc_notes-header">
<div class="bloc_notes-icon">

</div>
<p><strong>Simples ou doubles quotes?</strong></p>
</div>
<div class="bloc_notes-body">
<p>Pour déclarer des données de type texte, il est possible d’utiliser des quotes simples <code>'</code> (apostrophe) ou des quotes doubles <code>"</code> (guillemets), cela ne fait aucune différence pour R. Cependant, si la chaîne de caractères que vous créez contient une apostrophe, il est nécessaire d’utiliser des quotes doubles et inversement si votre chaîne de caractère contient des guillemets.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">phrase1</span> <span class="op">&lt;-</span> <span class="st">"J'adore le langage R!"</span></span>
<span><span class="va">phrase2</span> <span class="op">&lt;-</span> <span class="st">'Je cite : "il est le meilleur langage de statistique".'</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si la chaîne de caractère contient des guillemets et des apostrophes, il est nécessaire d’utiliser la barre oblique inversée <code>\</code> pour indiquer à R que ces apostrophes ou ces guillemets ne doivent pas être considérés comme la fin de la chaîne de caractère.</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">phrase3</span> <span class="op">&lt;-</span> <span class="st">"Je cite : \"j'en rêve la nuit\"."</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">phrase3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Je cite : "j'en rêve la nuit".</code></pre>
</div>
</div>
<p>Les barres obliques inversées ne font pas partie de la chaîne de caractère, ils sont là pour “échapper” les guillemets qui doivent rester dans la chaîne de caractère. Si une chaîne de caractère doit contenir une barre oblique inversée, alors il faut l’échapper également en utilisant une deuxième barre oblique inversée.</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">phrase4</span> <span class="op">&lt;-</span> <span class="st">"Une phrase avec une barre oblique inversée : \\"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">phrase4</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Une phrase avec une barre oblique inversée : \</code></pre>
</div>
</div>
<p>Faites attention à la coloration syntaxique de RStudio! Elle peut vous aider à repérer facilement une chaîne de caractère qui aurait été interrompue par un guillemet ou une apostrophe mal placés.</p>
</div>
</div>
<p>Si vous avez un doute sur le type de données stockées dans une variable, vous pouvez utiliser la fonction <code>typeof</code>. Par exemple, cela permet de repérer si des données qui sont censées être numériques sont en fait stockées sous forme de texte comme dans l’exemple ci-dessous.</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">taille</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Ici tailletxt est définie comme une chaîne de caractère car la valeur est </span></span>
<span><span class="co"># définie entre des guillemets.</span></span>
<span><span class="va">tailletxt</span> <span class="op">&lt;-</span> <span class="st">"175.5"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">tailletxt</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<p>Notez également qu’il existe des types pour représenter l’absence de données&nbsp;:</p>
<ul>
<li><p>pour représenter un objet vide, nous utilisons l’objet <code>NULL</code>,</p></li>
<li><p>pour représenter une donnée manquante, nous utilisons l’objet <code>NA</code>,</p></li>
<li><p>pour représenter un texte vide, nous utilisons une chaîne de caractère de longueur 0, soit <code>""</code>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">age2</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">taille2</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">adresse2</span> <span class="op">&lt;-</span> <span class="st">''</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-0135" class="level3" data-number="1.3.5"><h3 data-number="1.3.5" class="anchored" data-anchor-id="sec-0135">
<span class="header-section-number">1.3.5</span> Opérateurs</h3>
<p>Nous avons vu que les fonctions permettent de manipuler des objets. Nous pouvons également effectuer un grand nombre d’opérations avec les opérateurs.</p>
<section id="sec-01351" class="level4" data-number="1.3.5.1"><h4 data-number="1.3.5.1" class="anchored" data-anchor-id="sec-01351">
<span class="header-section-number">1.3.5.1</span> Opérateurs mathématiques</h4>
<p>Les opérateurs mathématiques (<a href="#tbl-OperateurMath">tableau&nbsp;<span>1.1</span></a>) permettent d’effectuer des calculs avec des données de type numérique.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-OperateurMath" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;1.1: Opérateurs mathématiques</caption>
<thead><tr class="header">
<th style="text-align: left;">Opérateur</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Syntaxe</th>
<th style="text-align: right;">Résultat</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>+</code></td>
<td style="text-align: left;">Addition</td>
<td style="text-align: left;"><code>4 + 4</code></td>
<td style="text-align: right;">8,0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>-</code></td>
<td style="text-align: left;">Soustraction</td>
<td style="text-align: left;"><code>4 - 3</code></td>
<td style="text-align: right;">1,0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>*</code></td>
<td style="text-align: left;">Multiplication</td>
<td style="text-align: left;"><code>4 * 3</code></td>
<td style="text-align: right;">12,0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>/</code></td>
<td style="text-align: left;">Division</td>
<td style="text-align: left;"><code>12 / 4</code></td>
<td style="text-align: right;">3,0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>^</code></td>
<td style="text-align: left;">Exponentiel</td>
<td style="text-align: left;"><code>4 ^ 3</code></td>
<td style="text-align: right;">64,0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>**</code></td>
<td style="text-align: left;">Exponentiel</td>
<td style="text-align: left;"><code>4 ** 3</code></td>
<td style="text-align: right;">64,0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%%</code></td>
<td style="text-align: left;">Reste de division</td>
<td style="text-align: left;"><code>15,5 %% 2</code></td>
<td style="text-align: right;">1,5</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%/%</code></td>
<td style="text-align: left;">Division entière</td>
<td style="text-align: left;"><code>15,5 %/% 2</code></td>
<td style="text-align: right;">7,0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="sec-01352" class="level4" data-number="1.3.5.2"><h4 data-number="1.3.5.2" class="anchored" data-anchor-id="sec-01352">
<span class="header-section-number">1.3.5.2</span> Opérateurs relationnels</h4>
<p>Les opérateurs relationnels (<a href="#tbl-OperateurRelationnels">tableau&nbsp;<span>1.2</span></a>) permettent de vérifier des conditions dans R. Ils renvoient un booléen, <code>TRUE</code> si la condition est vérifiée et <code>FALSE</code> si ce n’est pas le cas.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-OperateurRelationnels" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;1.2: Opérateurs relationnels</caption>
<thead><tr class="header">
<th style="text-align: left;">Opérateur</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Syntaxe</th>
<th style="text-align: left;">Résultat</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>==</code></td>
<td style="text-align: left;">Égalité</td>
<td style="text-align: left;"><code>4 == 4</code></td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>!=</code></td>
<td style="text-align: left;">Différence</td>
<td style="text-align: left;"><code>4 != 4</code></td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>&gt;</code></td>
<td style="text-align: left;">Est supérieur</td>
<td style="text-align: left;"><code>5 &gt; 4</code></td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&lt;</code></td>
<td style="text-align: left;">Est inférieur</td>
<td style="text-align: left;"><code>5 &lt; 4</code></td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>&gt;=</code></td>
<td style="text-align: left;">Est supérieur ou égal</td>
<td style="text-align: left;"><code>5 &gt;= 4</code></td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&lt;=</code></td>
<td style="text-align: left;">Est inférieur ou égal</td>
<td style="text-align: left;"><code>5 &lt;= 4</code></td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="sec-01353" class="level4" data-number="1.3.5.3"><h4 data-number="1.3.5.3" class="anchored" data-anchor-id="sec-01353">
<span class="header-section-number">1.3.5.3</span> Opérateurs logiques</h4>
<p>Les opérateurs logiques (<a href="#tbl-tableOperateurLogi">tableau&nbsp;<span>1.3</span></a>) permettent de combiner plusieurs conditions&nbsp;:</p>
<ul>
<li><p>L’opérateur <strong>ET</strong> (<code>&amp;</code>) permet de vérifier que deux conditions (l’une ET l’autre) sont TRUE. Si l’une des deux est FALSE, il renvoie FALSE.</p></li>
<li><p>L’opérateur <strong>OU</strong> (<code>|</code>) permet de vérifier que l’une des deux conditions est TRUE (l’une OU l’autre). Si les deux sont FALSE, alors il renvoie FALSE.</p></li>
<li><p>L’opérateur <strong>NOT</strong> (<code>!</code>) permet d’inverser une condition. Ainsi, NOT TRUE donne FALSE et NOT FALSE donne TRUE.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-tableOperateurLogi" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;1.3: Opérateurs logiques</caption>
<thead><tr class="header">
<th style="text-align: left;">Opérateur</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Syntaxe</th>
<th style="text-align: left;">Résultat</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>&amp;</code></td>
<td style="text-align: left;">ET</td>
<td style="text-align: left;"><code>TRUE &amp; FALSE</code></td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&amp;#124;</code></td>
<td style="text-align: left;">OU</td>
<td style="text-align: left;"><code>TRUE &amp;#124; FALSE</code></td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>!</code></td>
<td style="text-align: left;">NOT</td>
<td style="text-align: left;"><code>! TRUE</code></td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Prenons le temps pour un rapide exemple&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fl">4</span> </span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">5</span></span>
<span></span>
<span><span class="co"># Produit TRUE car A est bien plus petit que B et C est bien plus petit que A</span></span>
<span><span class="va">A</span> <span class="op">&lt;</span> <span class="va">B</span> <span class="op">&amp;</span> <span class="va">C</span> <span class="op">&lt;</span> <span class="va">A</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Produit FALSE car si A est bien plus petit que B, </span></span>
<span><span class="co"># B est en revanche plus grand que c</span></span>
<span><span class="va">A</span> <span class="op">&lt;</span> <span class="va">B</span> <span class="op">&amp;</span> <span class="va">B</span> <span class="op">&lt;</span> <span class="va">C</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Produit TRUE car la seconde condition est inversée</span></span>
<span><span class="va">A</span> <span class="op">&lt;</span> <span class="va">B</span> <span class="op">&amp;</span>  <span class="op">!</span> <span class="va">B</span> <span class="op">&lt;</span> <span class="va">C</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Produit TRUE car au moins une des deux conditions est juste</span></span>
<span><span class="va">A</span> <span class="op">&lt;</span> <span class="va">B</span> <span class="op">|</span>  <span class="va">B</span> <span class="op">&lt;</span> <span class="va">C</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Notez que l’opérateur <strong>ET</strong> est prioritaire sur l’opérateur <strong>OU</strong> et que les parenthèses sont prioritaires sur tous les opérateurs&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Produit TRUE car nous commençons par tester A &lt; B puis B &lt; C ce qui donne FALSE</span></span>
<span><span class="co"># On obtient ensuite</span></span>
<span><span class="co"># FALSE |  A &gt; C</span></span>
<span><span class="co"># Enfin, A est bien supérieur à C, donc l'une des deux conditions est vraie</span></span>
<span><span class="va">A</span> <span class="op">&lt;</span> <span class="va">B</span> <span class="op">&amp;</span> <span class="va">B</span> <span class="op">&lt;</span> <span class="va">C</span> <span class="op">|</span>  <span class="va">A</span> <span class="op">&gt;</span> <span class="va">C</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Notez qu’en arrière-plan, les opérateurs sont en réalité des fonctions déguisées. Il est donc possible de définir de nouveaux comportements pour les opérateurs. Il est par exemple possible d’additionner ou de comparer des objets spéciaux comme des dates, des géométries, des graphes, etc.</p>
</section></section><section id="sec-0136" class="level3" data-number="1.3.6"><h3 data-number="1.3.6" class="anchored" data-anchor-id="sec-0136">
<span class="header-section-number">1.3.6</span> Structures de données</h3>
<p>Jusqu’à présent, nous avons utilisé des objets ne comprenant qu’une seule valeur. Or, des analyses statistiques nécessitent de travailler avec des volumes de données bien plus grands. Pour stocker des valeurs, nous travaillons avec différentes structures de données&nbsp;: les vecteurs, les matrices, les tableaux de données et les listes.</p>
<section id="sec-01361" class="level4" data-number="1.3.6.1"><h4 data-number="1.3.6.1" class="anchored" data-anchor-id="sec-01361">
<span class="header-section-number">1.3.6.1</span> Vecteurs</h4>
<p>Les vecteurs sont la brique élémentaire de R. Ils permettent de stocker une série de valeurs <strong>du même type</strong> dans une seule variable. Pour déclarer un vecteur, nous utilisons la fonction <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">35</span>,<span class="fl">45</span>,<span class="fl">72</span>,<span class="fl">56</span>,<span class="fl">62</span><span class="op">)</span></span>
<span><span class="va">tailles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">175.5</span>,<span class="fl">180.3</span>,<span class="fl">168.2</span>,<span class="fl">172.8</span>,<span class="fl">167.6</span><span class="op">)</span></span>
<span><span class="va">adresses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'4225 rue de la gauchetiere'</span>,</span>
<span>              <span class="st">'4223 rue de la gauchetiere'</span>,</span>
<span>              <span class="st">'4221 rue de la gauchetiere'</span>,</span>
<span>              <span class="st">'4219 rue de la gauchetiere'</span>,</span>
<span>              <span class="st">'4217 rue de la gauchetiere'</span><span class="op">)</span></span>
<span><span class="va">proprietaires</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous venons ainsi de déclarer quatre nouvelles variables étant chacune un vecteur de longueur cinq (comprenant chacun cinq valeurs). Ces vecteurs représentent, par exemple, les réponses de plusieurs personnes à un questionnaire.</p>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Distinction entre un vecteur de type texte et un vecteur de type facteur</strong></p>
</div>
<div class="bloc_attention-body">
<p>Il existe dans R une subtilité à l’origine de nombreux malentendus&nbsp;: la distinction entre un vecteur de type <strong>texte</strong> et un vecteur de type <strong>facteur</strong>. Dans l’exemple précédent, le vecteur <em>adresses</em> est un vecteur de type texte. Chaque nouvelle valeur ajoutée dans le vecteur peut être n’importe quelle nouvelle adresse. Déclarons un nouveau vecteur qui contient cette fois-ci la couleur des yeux de personnes ayant répondu au questionnaire.</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">couleurs_yeux</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'marron'</span>, <span class="st">'marron'</span>, <span class="st">'bleu'</span>, <span class="st">'bleu'</span>, <span class="st">'marron'</span>, <span class="st">'vert'</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Contrairement aux adresses, il y a un nombre limité de couleurs que nous pouvons mettre dans ce vecteur. Il est donc intéressant de fixer les valeurs possibles du vecteur pour éviter d’en ajouter de nouvelles par erreur. Pour cela, nous devons convertir ce vecteur texte en vecteur de type facteur, ci-après nommé simplement facteur, avec la fonction <code>as.factor</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">couleurs_yeux_facteur</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">couleurs_yeux</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notez qu’à présent, nous pouvons ajouter une nouvelle couleur dans le premier vecteur, mais pas dans le second.</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">couleurs_yeux</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"rouge"</span></span>
<span><span class="va">couleurs_yeux_facteur</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"rouge"</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in `[&lt;-.factor`(`*tmp*`, 7, value = "rouge"): niveau de facteur
incorrect, NAs générés</code></pre>
</div>
</div>
<p>Le message d’erreur nous informe que nous avons tenté d’introduire une valeur invalide dans le facteur.</p>
<p>Les facteurs peuvent sembler restrictifs et, très régulièrement, nous préférons travailler avec de simples vecteurs de type texte plutôt que des facteurs. Cependant, de nombreuses fonctions d’analyse nécessitent d’utiliser des facteurs, car ils assurent une certaine cohérence dans les données. Il est donc essentiel de savoir passer du texte au facteur avec la fonction <code>as.factor</code>. À l’inverse, il est parfois nécessaire de revenir à une variable de type texte avec la fonction <code>as.character</code>.</p>
<p>Notez que des vecteurs numériques peuvent aussi être convertis en facteurs&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tailles_facteur</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">tailles</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Cependant, si vous souhaitez reconvertir ce facteur en format numérique, il faudra passer dans un premier temps par le format texte&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">tailles_facteur</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 5 2 3 1</code></pre>
</div>
</div>
<p>Comme vous pouvez le voir, convertir un facteur en valeur numérique renvoie des nombres entiers. Ceci est dû au fait que les valeurs dans un facteur sont recodées sous forme de nombres entiers, chaque nombre correspondant à une des valeurs originales (appelées niveaux). Si nous convertissons un facteur en valeurs numériques, nous obtenons donc ces nombres entiers.</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">tailles_facteur</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 175.5 180.3 168.2 172.8 167.6</code></pre>
</div>
</div>
<p>Morale de l’histoire&nbsp;: ne confondez pas les données de type texte et de type facteur. Dans le doute, vous pouvez demander à R quel est le type d’un vecteur avec la fonction <code>class</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">tailles</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">tailles_facteur</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">couleurs_yeux</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">couleurs_yeux_facteur</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
</div>
</div>
</div>
<p>Quasiment toutes les fonctions utilisent des vecteurs. Par exemple, nous pouvons calculer la moyenne du vecteur <em>ages</em> en utilisant la fonction <code>mean</code> présente de base dans R.</p>
<div class="cell">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ages</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 54</code></pre>
</div>
</div>
<p>Cela démontre bien que le vecteur est la brique élémentaire de R! Toutes les variables que nous avons déclarées dans les sections précédentes sont aussi des vecteurs, mais de longueur 1.</p>
</section><section id="sec-01362" class="level4" data-number="1.3.6.2"><h4 data-number="1.3.6.2" class="anchored" data-anchor-id="sec-01362">
<span class="header-section-number">1.3.6.2</span> Matrices</h4>
<p>Il est possible de combiner des vecteurs pour former des matrices. Une matrice est un tableau en deux dimensions (colonnes et lignes) et est généralement utilisée pour représenter certaines structures de données comme des images (pixels), effectuer du calcul matriciel ou plus simplement présenter des matrices de corrélations. Vous aurez rarement à travailler directement avec des matrices, mais il est bon de savoir ce qu’elles sont. Créons deux matrices à partir de nos précédents vecteurs.</p>
<div class="cell">
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrice1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">ages</span>, <span class="va">tailles</span><span class="op">)</span></span>
<span><span class="co"># Afficher la matrice 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">matrice1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ages tailles
[1,]   35   175.5
[2,]   45   180.3
[3,]   72   168.2
[4,]   56   172.8
[5,]   62   167.6</code></pre>
</div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Afficher les dimensions de la matrice 1 (1er chiffre : lignes; 2e chiffre : colonnes)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">matrice1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5 2</code></pre>
</div>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrice2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">ages</span>, <span class="va">tailles</span><span class="op">)</span></span>
<span><span class="co"># Afficher la matrice 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">matrice2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]  [,2]  [,3]  [,4]  [,5]
ages     35.0  45.0  72.0  56.0  62.0
tailles 175.5 180.3 168.2 172.8 167.6</code></pre>
</div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Afficher les dimensions de la matrice 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">matrice2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 5</code></pre>
</div>
</div>
<p>Comme vous pouvez le constater, la fonction <code>cbind</code> permet de concaténer des vecteurs comme s’ils étaient les colonnes d’une matrice, alors que <code>rbind</code> les combine comme s’ils étaient les lignes d’une matrice. La <a href="#fig-fig012">figure&nbsp;<span>1.11</span></a> présente graphiquement le passage du vecteur à la matrice.</p>
<div id="fig-fig012" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/vecteur_to_matrix.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.11: Du vecteur à la matrice</figcaption></figure>
</div>
<p>Notez que vous pouvez transposer une matrice avec la fonction <code>t</code>. Si nous essayons maintenant de comparer la matrice 1 à la matrice 2 nous allons avoir une erreur, car elles n’ont pas les mêmes dimensions.</p>
<div class="cell">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrice1</span> <span class="op">==</span> <span class="va">matrice2</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>Erreur dans matrice1 == matrice2 : tableaux de tailles inadéquates</code></p>
<p>En revanche, nous pouvons transposer la matrice 1 et refaire cette comparaison&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">matrice1</span><span class="op">)</span> <span class="op">==</span> <span class="va">matrice2</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1] [,2] [,3] [,4] [,5]
ages    TRUE TRUE TRUE TRUE TRUE
tailles TRUE TRUE TRUE TRUE TRUE</code></pre>
</div>
</div>
<p>Le résultat souligne bien que nous avons les mêmes valeurs dans les deux matrices. Il est aussi possible de construire des matrices directement avec la fonction <code>matrix</code>, ce que nous montrons dans la prochaine section.</p>
</section><section id="sec-01363" class="level4" data-number="1.3.6.3"><h4 data-number="1.3.6.3" class="anchored" data-anchor-id="sec-01363">
<span class="header-section-number">1.3.6.3</span> <em>Arrays</em>
</h4>
<p>S’il est rare de travailler avec des matrices, il est encore plus rare de manipuler des <em>arrays</em>. Un <em>array</em> est une matrice spéciale qui peut avoir plus que deux dimensions. Un cas simple serait un <em>array</em> en trois dimensions&nbsp;: lignes, colonnes, profondeur, que nous pourrions représenter comme un cube, ou une série de matrices de mêmes dimensions et empilées. Au-delà de trois dimensions, il devient difficile de les représenter mentalement. Cette structure de données peut être utilisée pour représenter les différentes bandes spectrales d’une image satellitaire. Les lignes et les colonnes délimiteraient les pixels de l’image et la profondeur délimiterait les différentes bandes composant l’image (<a href="#fig-fig012">figure&nbsp;<span>1.11</span></a>).</p>
<div id="fig-fig013" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/array.png" class="img-fluid figure-img" style="width:15.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.12: Un array avec trois dimensions</figcaption></figure>
</div>
<p>Créons un <em>array</em> en combinant trois matrices avec la fonction <code>array</code>. Chacune de ces matrices est composée respectivement de 1, de 2 et de 3 et a une dimension de 5 x 5. L’<em>array</em> final a donc une dimension de 5 x 5 x 3.</p>
<div class="cell">
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">5</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">mat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">5</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">mat3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">3</span>, nrow <span class="op">=</span> <span class="fl">5</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mon_array</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">mat1</span>, <span class="va">mat2</span>, <span class="va">mat3</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">mon_array</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , 1

     [,1] [,2] [,3] [,4] [,5]
[1,]    1    1    1    1    1
[2,]    1    1    1    1    1
[3,]    1    1    1    1    1
[4,]    1    1    1    1    1
[5,]    1    1    1    1    1

, , 2

     [,1] [,2] [,3] [,4] [,5]
[1,]    2    2    2    2    2
[2,]    2    2    2    2    2
[3,]    2    2    2    2    2
[4,]    2    2    2    2    2
[5,]    2    2    2    2    2

, , 3

     [,1] [,2] [,3] [,4] [,5]
[1,]    3    3    3    3    3
[2,]    3    3    3    3    3
[3,]    3    3    3    3    3
[4,]    3    3    3    3    3
[5,]    3    3    3    3    3</code></pre>
</div>
</div>
</section><section id="sec-01364" class="level4" data-number="1.3.6.4"><h4 data-number="1.3.6.4" class="anchored" data-anchor-id="sec-01364">
<span class="header-section-number">1.3.6.4</span> <em>DataFrames</em>
</h4>
<p>S’il est rare de manipuler des matrices et des <em>arrays</em>, le <em>DataFrame</em> (tableau de données en français) est la structure de données la plus souvent utilisée. Dans cette structure, chaque ligne du tableau représente un individu et chaque colonne représente une caractéristique de cet individu. Ces colonnes ont des noms qui permettent facilement d’accéder à leurs valeurs. Créons un <em>DataFrame</em> (<a href="#tbl-tabfirsttable">tableau&nbsp;<span>1.4</span></a>) à partir de nos quatre vecteurs et de la fonction <code>data.frame</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">"age"</span> <span class="op">=</span> <span class="va">ages</span>,</span>
<span>  <span class="st">"taille"</span> <span class="op">=</span> <span class="va">tailles</span>,</span>
<span>  <span class="st">"adresse"</span> <span class="op">=</span> <span class="va">adresses</span>,</span>
<span>  <span class="st">"proprietaire"</span> <span class="op">=</span> <span class="va">proprietaires</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-tabfirsttable" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;1.4: Premier DataFrame</caption>
<thead><tr class="header">
<th style="text-align: center;">age</th>
<th style="text-align: center;">taille</th>
<th style="text-align: left;">adresse</th>
<th style="text-align: left;">proprietaire</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">35</td>
<td style="text-align: center;">175,5</td>
<td style="text-align: left;">4225 rue de la gauchetiere</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: center;">45</td>
<td style="text-align: center;">180,3</td>
<td style="text-align: left;">4223 rue de la gauchetiere</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: center;">72</td>
<td style="text-align: center;">168,2</td>
<td style="text-align: left;">4221 rue de la gauchetiere</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: center;">56</td>
<td style="text-align: center;">172,8</td>
<td style="text-align: left;">4219 rue de la gauchetiere</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: center;">62</td>
<td style="text-align: center;">167,6</td>
<td style="text-align: left;">4217 rue de la gauchetiere</td>
<td style="text-align: left;">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Dans RStudio, vous pouvez visualiser votre tableau de données avec la fonction <code>View(df)</code>. Comme vous pouvez le constater, chaque vecteur est devenu une colonne de votre tableau de données <em>df</em>. La <a href="#fig-fig013">figure&nbsp;<span>1.13</span></a> résume ce passage d’une simple donnée à un <em>DataFrame</em> en passant par un vecteur.</p>
<div id="fig-fig013" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/vecteur_to_dataframe.png" class="img-fluid figure-img" style="width:25.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.13: De la donnée au DataFrame</figcaption></figure>
</div>
<p>Plusieurs fonctions de base de R fournissent des informations importantes sur un <em>DataFrame</em>&nbsp;:</p>
<ul>
<li>
<code>names</code> renvoie les noms des colonnes du <em>DataFrame</em>;</li>
<li>
<code>nrow</code> renvoie le nombre de lignes;</li>
<li>
<code>ncol</code> renvoie le nombre de colonnes.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "age"          "taille"       "adresse"      "proprietaire"</code></pre>
</div>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>Vous pouvez accéder à chaque colonne de <em>df</em> en utilisant le symbole <code>$</code> ou <code>[["nom_de_la_colonne"]]</code>. Recalculons ainsi la moyenne des âges&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 54</code></pre>
</div>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="st">"age"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 54</code></pre>
</div>
</div>
</section><section id="sec-01365" class="level4" data-number="1.3.6.5"><h4 data-number="1.3.6.5" class="anchored" data-anchor-id="sec-01365">
<span class="header-section-number">1.3.6.5</span> Listes</h4>
<p>La dernière structure de données à connaître est la liste. Elle ressemble à un vecteur, au sens où elle permet de stocker un ensemble d’objets les uns à la suite des autres. Cependant, une liste peut contenir n’importe quel type d’objets. Vous pouvez ainsi construire des listes de matrices, des listes d’<em>arrays</em>, des listes mixant des vecteurs, des graphiques, des <em>DataFrames</em>, des listes de listes…</p>
<p>Créons ensemble une liste qui va contenir des vecteurs et des matrices à l’aide de la fonction <code>list.</code></p>
<div class="cell">
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ma_liste</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">3</span>, nrow <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">5</span>, ncol <span class="op">=</span> <span class="fl">3</span>, nrow <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>                 <span class="st">'A'</span></span>
<span>                 <span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il est possible d’accéder aux éléments de la liste par leur position dans cette dernière en utilisant les doubles crochets <code>[[ ]]</code>&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ma_liste</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4</code></pre>
</div>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ma_liste</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "A"</code></pre>
</div>
</div>
<p>Il est aussi possible de donner des noms aux éléments de la liste et d’utiliser le symbole <code>$</code> pour y accéder. Créons une nouvelle liste de vecteurs et donnons-leur des noms avec la fonction <code>names</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">liste2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">35</span>, <span class="fl">45</span>, <span class="fl">72</span>, <span class="fl">56</span>, <span class="fl">62</span><span class="op">)</span>, </span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">175.5</span>, <span class="fl">180.3</span>, <span class="fl">168.2</span>, <span class="fl">172.8</span>, <span class="fl">167.6</span><span class="op">)</span>,</span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">liste2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"taille"</span>, <span class="st">"proprietaire"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">liste2</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35 45 72 56 62</code></pre>
</div>
</div>
<p>Si vous avez bien suivi, vous devriez avoir compris qu’un <em>DataFrame</em> n’est en fait rien d’autre qu’une liste de vecteurs avec des noms!</p>
<p>Bravo! Vous venez de faire le tour des bases du langage R. Vous allez apprendre désormais à manipuler des données dans des <em>DataFrames</em>!</p>
</section></section></section><section id="sec-014" class="level2" data-number="1.4"><h2 data-number="1.4" class="anchored" data-anchor-id="sec-014">
<span class="header-section-number">1.4</span> Manipulation de données</h2>
<p>Dans cette section, vous apprendrez à charger et à manipuler des <em>DataFrames</em> en vue d’effectuer des opérations classiques de gestion de données.</p>
<section id="sec-0141" class="level3" data-number="1.4.1"><h3 data-number="1.4.1" class="anchored" data-anchor-id="sec-0141">
<span class="header-section-number">1.4.1</span> Chargement d’un <em>DataFrame</em> depuis un fichier</h3>
<p>Il est rarement nécessaire de créer vos <em>DataFrames</em> manuellement. Le plus souvent, vous disposerez de fichiers contenant vos données et utiliserez des fonctions pour les importer dans R sous forme d’un <em>DataFrame</em>. Les formats à importer les plus répandus sont&nbsp;:</p>
<ul>
<li><p><em>.csv</em>, soit un fichier texte dont chaque ligne représente une ligne du tableau de données et dont les colonnes sont séparées par un délimiteur (généralement une virgule ou un point-virgule);</p></li>
<li><p><em>.dbf</em>, ou fichier <em>dBase</em>, souvent associés à des fichiers d’information géographique au format <em>ShapeFile</em>;</p></li>
<li><p><em>.xls</em> et <em>.xlsx</em>, soit des fichiers générés par Excel;</p></li>
<li><p><em>.json</em>, soit un fichier texte utilisant la norme d’écriture propre au langage JavaScript.</p></li>
</ul>
<p>Plus rarement, il se peut que vous ayez à charger des fichiers provenant de logiciels propriétaires&nbsp;:</p>
<ul>
<li>
<em>.sas7bdat</em> (SAS);</li>
<li>
<em>.sav</em> (SPSS);</li>
<li>
<em>.dta</em> (STATA).</li>
</ul>
<p>Pour lire la plupart de ces fichiers, nous utilisons le <em>package</em> <code>foreign</code> dédié à l’importation d’une multitude de formats. Nous commençons donc par l’installer (<code>install.packages("foreign")</code>). Ensuite, nous chargeons cinq fois le même jeu de données enregistré dans des formats différents (<em>csv</em>, <em>dbf</em>, <em>dta</em>, <em>sas7bdat</em> et <em>xlsx</em>) et nous mesurons le temps nécessaire pour importer chacun de ces fichiers avec la fonction <code>Sys.time</code>.</p>
<section id="sec-01411" class="level4" data-number="1.4.1.1"><h4 data-number="1.4.1.1" class="anchored" data-anchor-id="sec-01411">
<span class="header-section-number">1.4.1.1</span> Lecture d’un fichier <em>csv</em>
</h4>
<p>Pour le format <em>csv</em>, il n’est pas nécessaire d’utiliser un <em>package</em> puisque R dispose d’une fonction de base pour lire ce format.</p>
<div class="cell">
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/priseenmain/SR_MTL_2016.csv"</span>, </span>
<span>         header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span>,</span>
<span>         stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="va">t2</span>, <span class="va">t1</span>, units <span class="op">=</span> <span class="st">"secs"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Le DataFrame df1 a "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span>,<span class="st">" observations"</span>,</span>
<span>    <span class="st">'et '</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span>,<span class="st">" colonnes\n"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Le DataFrame df1 a  951  observations et  48  colonnes</code></pre>
</div>
</div>
<p>Rien de bien compliqué! Notez tout de même que&nbsp;:</p>
<ul>
<li><p>Lorsque vous chargez un fichier <em>csv</em>, vous devez connaître le <strong>délimiteur</strong> (ou <strong>séparateur</strong>), soit le caractère utilisé pour délimiter les colonnes. Dans le cas présent, il s’agit d’une virgule (spécifiez avec l’argument <code>sep = ","</code>), mais il pourrait tout aussi bien être un point virgule (<code>sep = ";"</code>), une tabulation (<code>sep = "    "</code>), etc.</p></li>
<li><p>Vous devez également spécifier le caractère utilisé comme séparateur de décimales. Le plus souvent, ce sera le point (<code>dec = "."</code>), mais certains logiciels avec des paramètres régionaux de langue française (notamment Excel) exportent des fichiers <em>csv</em> avec des virgules comme séparateur de décimales (utilisez alors <code>dec = ","</code>).</p></li>
<li><p>L’argument <code>header</code> indique si la première ligne (l’entête) du fichier comprend ou non les noms des colonnes du jeu de données (avec les valeurs <code>TRUE</code> ou <code>FALSE</code>). Il arrive que certains fichiers <em>csv</em> soient fournis sans entête et que le nom et la description des colonnes soient fournis dans un autre fichier.</p></li>
<li><p>L’argument <code>stringsAsFactors</code> permet d’indiquer à R que les colonnes comportant du texte doivent être chargées comme des vecteurs de type texte et non de type facteur.</p></li>
</ul></section><section id="sec-01412" class="level4" data-number="1.4.1.2"><h4 data-number="1.4.1.2" class="anchored" data-anchor-id="sec-01412">
<span class="header-section-number">1.4.1.2</span> Lecture d’un fichier <em>dbase</em>
</h4>
<p>Pour lire un fichier <em>dbase</em> (.dbf), nous utilisons la fonction <code>read.dbf</code> du <em>package</em> <code>foreign</code> installé précédemment&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/foreign/">foreign</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.dbf.html">read.dbf</a></span><span class="op">(</span><span class="st">"data/priseenmain/SR_MTL_2016.dbf"</span><span class="op">)</span></span>
<span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="va">t2</span>, <span class="va">t1</span>, units <span class="op">=</span> <span class="st">"secs"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Le DataFrame df2 a "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span>,<span class="st">" observations"</span>,</span>
<span>    <span class="st">"et "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span>,<span class="st">" colonnes\n"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Le DataFrame df2 a  951  observations et  48  colonnes</code></pre>
</div>
</div>
<p>Comme vous pouvez le constater, nous obtenons les mêmes résultats qu’avec le fichier <em>csv</em>.</p>
</section><section id="sec-01413" class="level4" data-number="1.4.1.3"><h4 data-number="1.4.1.3" class="anchored" data-anchor-id="sec-01413">
<span class="header-section-number">1.4.1.3</span> Lecture d’un fichier <em>dta</em> (Stata)</h4>
<p>Si vous travaillez avec des collègues utilisant le logiciel Stata, il se peut que ces derniers vous partagent des fichiers <em>dta</em>. Toujours en utilisant le <em>package</em> <code>foreign</code>, vous serez en mesure de les charger directement dans R.</p>
<div class="cell">
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.dta.html">read.dta</a></span><span class="op">(</span><span class="st">"data/priseenmain/SR_MTL_2016.dta"</span><span class="op">)</span></span>
<span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">d3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="va">t2</span>, <span class="va">t1</span>, units <span class="op">=</span> <span class="st">"secs"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Le DataFrame df3 a "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df3</span><span class="op">)</span>,<span class="st">" observations "</span>,</span>
<span>    <span class="st">"et "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df3</span><span class="op">)</span>, <span class="st">" colonnes\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Le DataFrame df3 a 951 observations et 48 colonnes</code></pre>
</div>
</div>
</section><section id="sec-01414" class="level4" data-number="1.4.1.4"><h4 data-number="1.4.1.4" class="anchored" data-anchor-id="sec-01414">
<span class="header-section-number">1.4.1.4</span> Lecture d’un fichier <em>sav</em> (SPSS)</h4>
<p>Pour importer un fichier <em>sav</em> provenant du logiciel statistique SPSS, utilisez la fonction <code>read.spss</code> du <em>package</em> <code>foreign</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">df4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.spss.html">read.spss</a></span><span class="op">(</span><span class="st">"data/priseenmain/SR_MTL_2016.sav"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">d4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="va">t2</span>, <span class="va">t1</span>, units <span class="op">=</span> <span class="st">"secs"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Le DataFrame df4 a "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df4</span><span class="op">)</span>,<span class="st">" observations "</span>,</span>
<span>    <span class="st">"et "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df4</span><span class="op">)</span>, <span class="st">" colonnes\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Le DataFrame df4 a 951 observations et 48 colonnes</code></pre>
</div>
</div>
</section><section id="sec-01415" class="level4" data-number="1.4.1.5"><h4 data-number="1.4.1.5" class="anchored" data-anchor-id="sec-01415">
<span class="header-section-number">1.4.1.5</span> Lecture d’un fichier <em>sas7bdat</em> (SAS)</h4>
<p>Pour importer un fichier <em>sas7bdat</em> provenant du logiciel statistique SAS, utilisez la fonction <code>read.sas7bdat</code> du <em>package</em> <code>sas7bdat</code>. Installez préalablement le <em>package</em> (<code>install.packages("sas7bdat")</code>) et chargez-le (<code><a href="https://rdrr.io/r/base/library.html">library(sas7bdat)</a></code>).</p>
<div class="cell">
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">sas7bdat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">df5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sas7bdat/man/read.sas7bdat.html">read.sas7bdat</a></span><span class="op">(</span><span class="st">"data/priseenmain/SR_MTL_2016.sas7bdat"</span><span class="op">)</span></span>
<span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">d5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="va">t2</span>, <span class="va">t1</span>, units <span class="op">=</span> <span class="st">"secs"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Le DataFrame df5 a "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df5</span><span class="op">)</span>,<span class="st">" observations "</span>,</span>
<span>    <span class="st">"et "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df5</span><span class="op">)</span>,<span class="st">" colonnes\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Le DataFrame df5 a 951 observations et 48 colonnes</code></pre>
</div>
</div>
</section><section id="sec-01416" class="level4" data-number="1.4.1.6"><h4 data-number="1.4.1.6" class="anchored" data-anchor-id="sec-01416">
<span class="header-section-number">1.4.1.6</span> Lecture d’un fichier <em>xlsx</em> (Excel)</h4>
<p>Lire un fichier Excel dans R n’est pas toujours une tâche facile. Généralement, nous recommandons d’exporter le fichier en question au format <em>csv</em> dans un premier temps, puis de le lire avec la fonction <code>read.csv</code> dans un second temps (<a href="#sec-01411">section&nbsp;<span>1.4.1.1</span></a>).</p>
<p>Il est néanmoins possible de lire directement un fichier <em>xlsx</em> avec le <em>package</em> <code>xlsx</code>. Ce dernier requiert que le logiciel JAVA soit installé sur votre ordinateur (Windows, Mac ou Linux). Si vous utilisez la version 64 bit de R, vous devrez télécharger et installer la version 64 bit de JAVA. Une fois que ce logiciel tiers est installé, il ne vous restera plus qu’à installer (<code>install.packages("xlsx")</code>) et charger (<code><a href="https://github.com/colearendt/xlsx">library(xlsx)</a></code>) le <em>package</em> <code>xlsx</code>. Sous windows, il est possible que vous deviez également installer manuellement le <em>package</em> <code>rJava</code> et indiquer à R où se trouve JAVA sur votre ordinateur. La procédure est détaillée <a href="https://cimentadaj.github.io/blog/2018-05-25-installing-rjava-on-windows-10/installing-rjava-on-windows-10/">ici</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/colearendt/xlsx">xlsx</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">df6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"data/priseenmain/SR_MTL_2016.xlsx"</span>,</span>
<span>                 sheetIndex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 as.data.frame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">d6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="va">t2</span>, <span class="va">t1</span>, units <span class="op">=</span> <span class="st">"secs"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Le DataFrame df6 a "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df6</span><span class="op">)</span>,<span class="st">" observations "</span>,</span>
<span>    <span class="st">"et "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df6</span><span class="op">)</span>,<span class="st">" colonnes\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Le DataFrame df6 a 951 observations et 48 colonnes</code></pre>
</div>
</div>
<p>Il est possible d’accélérer significativement la vitesse de lecture d’un fichier <em>xlsx</em> en utilisant la fonction <code>read.xlsx2</code>. Il faut cependant indiquer à cette dernière le type de données de chaque colonne. Dans le cas présent, les cinq premières colonnes contiennent des données de type texte (<code>character</code>), alors que les 43 autres sont des données numériques (<code>numeric</code>). Nous utilisons la fonction <code>rep</code> afin de ne pas avoir à écrire plusieurs fois <em>character</em> et <em>numeric</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/colearendt/xlsx">xlsx</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">df7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xlsx/man/read.xlsx.html">read.xlsx2</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"data/priseenmain/SR_MTL_2016.xlsx"</span>,</span>
<span>                  sheetIndex <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                  as.data.frame <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  colClasses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"character"</span>,<span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"numeric"</span>,<span class="fl">43</span><span class="op">)</span><span class="op">)</span></span>
<span>                  <span class="op">)</span></span>
<span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">d7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="va">t2</span>, <span class="va">t1</span>, units <span class="op">=</span> <span class="st">"secs"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Le DataFrame df6 a "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df7</span><span class="op">)</span>,<span class="st">" observations "</span>,</span>
<span>    <span class="st">"et "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df7</span><span class="op">)</span>,<span class="st">" colonnes\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Le DataFrame df6 a 951 observations et 48 colonnes</code></pre>
</div>
</div>
<p>Si nous comparons les temps d’exécution (<a href="#tbl-tableduration">tableau&nbsp;<span>1.5</span></a>), nous constatons que la lecture des fichiers <em>xlsx</em> peut être extrêmement longue si nous ne spécifions pas le type des colonnes, ce qui peut devenir problématique pour des fichiers volumineux. Notez également que la lecture d’un fichier <em>csv</em> devient de plus en plus laborieuse à mesure que sa taille augmente. Si vous devez un jour charger des fichiers <em>csv</em> de plusieurs gigaoctets, nous vous recommandons vivement d’utiliser la fonction <code>fread</code> du <em>package</em> <code>data.table</code> qui est beaucoup plus rapide.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-tableduration" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;1.5: Temps nécessaire pour lire les données en fonction du type de fichiers</caption>
<thead><tr class="header">
<th style="text-align: right;">Fonction</th>
<th style="text-align: left;">Durée (secondes)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">read.csv</td>
<td style="text-align: left;">0,03</td>
</tr>
<tr class="even">
<td style="text-align: right;">read.dbf</td>
<td style="text-align: left;">0,03</td>
</tr>
<tr class="odd">
<td style="text-align: right;">read.spss</td>
<td style="text-align: left;">0,01</td>
</tr>
<tr class="even">
<td style="text-align: right;">read.dta</td>
<td style="text-align: left;">0,01</td>
</tr>
<tr class="odd">
<td style="text-align: right;">read.sas7bdat</td>
<td style="text-align: left;">0,54</td>
</tr>
<tr class="even">
<td style="text-align: right;">read.xlsx</td>
<td style="text-align: left;">12,21</td>
</tr>
<tr class="odd">
<td style="text-align: right;">read.xlsx2</td>
<td style="text-align: left;">0,41</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section></section><section id="sec-0142" class="level3" data-number="1.4.2"><h3 data-number="1.4.2" class="anchored" data-anchor-id="sec-0142">
<span class="header-section-number">1.4.2</span> Manipulation d’un <em>DataFrame</em>
</h3>
<p>Une fois le <em>DataFrame</em> chargé, voyons comment il est possible de le manipuler.</p>
<section id="sec-01421" class="level4" data-number="1.4.2.1"><h4 data-number="1.4.2.1" class="anchored" data-anchor-id="sec-01421">
<span class="header-section-number">1.4.2.1</span> Petit mot sur le <code>tidyverse</code>
</h4>
<p><code>tidyverse</code> est un ensemble de <em>packages</em> conçus pour faciliter la structuration et la manipulation des données dans R. Avant d’aller plus loin, il est important d’aborder brièvement un débat actuel dans la Communauté R. Entre 2010 et 2020, l’utilisation du <code>tidyverse</code> s’est peu à peu répandue. Développé et maintenu par Hadley Wickham, <code>tidyverse</code> introduit une philosophie et une grammaire spécifiques qui diffèrent du langage R traditionnel. Une partie de la communauté a pour ainsi dire complètement embrassé le <code>tidyverse</code> et de nombreux <em>packages</em>, en dehors du <code>tidyverse</code>, ont adopté sa grammaire et sa philosophie. À l’inverse, une autre partie de la communauté est contre cette évolution (<a href="https://blog.ephorie.de/why-i-dont-use-the-tidyverse" target="_blank">voir l’article du blogue suivant</a>). Les arguments pour et contre <code>tidyverse</code> sont résumés dans le (<a href="#tbl-Tidyverse">tableau&nbsp;<span>1.6</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-Tidyverse" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;1.6: Avantages et inconvénients du tidyverse</caption>
<colgroup>
<col style="width: 33%">
<col style="width: 66%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Avantage du tidyverse</th>
<th style="text-align: left;">Problème posé par le tidyverse</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Simplicité d’écriture et d’apprentissage</td>
<td style="text-align: left;">Nouvelle syntaxe à apprendre</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ajout de l’opérateur <code>%&gt;%</code> permettant d’enchaîner les traitements</td>
<td style="text-align: left;">Perte de lisibilité avec l’opérateur <code>-&gt;</code>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;">La meilleure librairie pour réaliser des graphiques : <code>ggplot2</code>
</td>
<td style="text-align: left;">Remplacement de certaines fonctions de base par d’autres provenant du <code>tidyverse</code> lors de son chargement, pouvant créer des erreurs.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Crée un écosystème cohérent</td>
<td style="text-align: left;">Ajout d’une dépendance dans le code</td>
</tr>
<tr class="odd">
<td style="text-align: left;">
<em>Package</em> en développement et de plus en plus utilisé</td>
<td style="text-align: left;">Philosophie d’évolution agressive, aucune assurance de rétrocompatibilité</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Le dernier point est probablement le plus problématique. Dans sa volonté d’évoluer au mieux et sans restriction, le <em>package</em> <code>tidyverse</code> n’offre aucune garantie de rétrocompatibilité. En d’autres termes, des changements importants peuvent être introduits d’une version à l’autre rendant potentiellement obsolète votre ancien code. Nous n’avons pas d’opinion tranchée sur le sujet&nbsp;: <code>tidyverse</code> est un outil très intéressant dans de nombreux cas; nous évitons simplement de l’utiliser systématiquement et préférons charger directement des sous-<em>packages</em> (comme <code>dplyr</code> ou <code>ggplot2</code>) du <code>tidyverse</code>. Notez que le <em>package</em> <code>data.table</code> offre une alternative au <code>tidyverse</code> dans la manipulation de données. Au prix d’une syntaxe généralement un peu plus complexe, le package <code>data.table</code> offre une vitesse de calcul bien supérieure au <code>tidyverse</code> et assure une bonne rétrocompatibilité.</p>
</section><section id="sec-01422" class="level4" data-number="1.4.2.2"><h4 data-number="1.4.2.2" class="anchored" data-anchor-id="sec-01422">
<span class="header-section-number">1.4.2.2</span> Gestion des colonnes d’un <em>DataFrame</em>
</h4>
<p>Repartons du <em>DataFrame</em> que nous avions chargé précédemment en important un fichier <em>csv</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"data/priseenmain/SR_MTL_2016.csv"</span>, </span>
<span>               header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span>,</span>
<span>               stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sec-014221" class="level5" data-number="1.4.2.2.1"><h5 data-number="1.4.2.2.1" class="anchored" data-anchor-id="sec-014221">
<span class="header-section-number">1.4.2.2.1</span> Sélection d’une colonne</h5>
<p>Rappelons qu’il est possible d’accéder aux colonnes dans ce <em>DataFrame</em> en utilisant le symbole dollar <code>$ma_colonne</code> ou les doubles crochets <code>[["ma_colonne"]]</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcul de la superficie totale de l'Île de Montréal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">KM2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4680.543</code></pre>
</div>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="st">"KM2"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4680.543</code></pre>
</div>
</div>
</section><section id="sec-014222" class="level5" data-number="1.4.2.2.2"><h5 data-number="1.4.2.2.2" class="anchored" data-anchor-id="sec-014222">
<span class="header-section-number">1.4.2.2.2</span> Sélection de plusieurs colonnes</h5>
<p>Il est possible de sélectionner plusieurs colonnes d’un <em>DataFrame</em> et de filtrer ainsi les colonnes inutiles. Pour cela, nous pouvons utiliser un vecteur contenant soit les positions des colonnes (1 pour la première colonne, 2 pour la seconde et ainsi de suite), soit les noms des colonnes.</p>
<div class="cell">
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Conserver les 5 premières colonnes</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Conserver les colonnes 1, 5, 10 et 15</span></span>
<span><span class="va">df3</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">15</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Cela peut aussi être utilisé pour changer l'ordre des champs</span></span>
<span><span class="va">df3</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">15</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Conserver les colonnes 1 à 5, 7 à 12, 17 et 22</span></span>
<span><span class="va">df4</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">7</span><span class="op">:</span><span class="fl">12</span>,<span class="fl">17</span>,<span class="fl">22</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Conserver les colonnes avec leurs noms</span></span>
<span><span class="va">df5</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SRIDU"</span> , <span class="st">"KM2"</span> , <span class="st">"Pop2016"</span> , <span class="st">"MaisonIndi"</span> , <span class="st">"LoyerMed"</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-014223" class="level5" data-number="1.4.2.2.3"><h5 data-number="1.4.2.2.3" class="anchored" data-anchor-id="sec-014223">
<span class="header-section-number">1.4.2.2.3</span> Suppression de colonnes</h5>
<p>Il est parfois plus intéressant et rapide de supprimer directement des colonnes plutôt que de recréer un nouveau <em>DataFrame</em>. Pour ce faire, nous attribuons la valeur <code>NULL</code> à ces colonnes.</p>
<div class="cell">
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Supprimer les colonnes 2, 3 et 5</span></span>
<span><span class="va">df3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Supprimer une colonne avec son nom</span></span>
<span><span class="va">df4</span><span class="op">$</span><span class="va">OID</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="co"># Supprimer plusieurs colonnes par leur nom</span></span>
<span><span class="va">df5</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SRIDU"</span> , <span class="st">"LoyerMed"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notez que si vous supprimez une colonne, vous ne pouvez pas revenir en arrière. Il faudra recharger votre jeu de données ou éventuellement relancer les calculs qui avaient produit cette colonne.</p>
</section><section id="sec-014224" class="level5" data-number="1.4.2.2.4"><h5 data-number="1.4.2.2.4" class="anchored" data-anchor-id="sec-014224">
<span class="header-section-number">1.4.2.2.4</span> Modification du nom des colonnes</h5>
<p>Il est possible de changer le nom d’une colonne. Cette opération est importante pour faciliter la lecture du <em>DataFrame</em> ou encore s’assurer que l’exportation du <em>DataFrame</em> dans un format particulier (tel que <em>.dbf</em> qui ne supporte que les noms de colonnes avec moins de 10 caractères) ne posera pas de problème.</p>
<div class="cell">
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Voici les noms des colonnes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df5</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "KM2"        "Pop2016"    "MaisonIndi"</code></pre>
</div>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Renommer toutes les colonnes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df5</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'superficie_km2'</span>,<span class="st">'population_2016'</span>, <span class="st">'maison_individuelle_prt'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df5</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "superficie_km2"          "population_2016"        
[3] "maison_individuelle_prt"</code></pre>
</div>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Renommer avec dplyr</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">df4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="va">df4</span>, <span class="st">"population_2016"</span> <span class="op">=</span> <span class="st">"Pop2016"</span>,</span>
<span>              <span class="st">"prs_moins_14ans_prt"</span> <span class="op">=</span> <span class="st">"A014"</span>,</span>
<span>              <span class="st">"prs_15_64_ans_prt"</span> <span class="op">=</span> <span class="st">"A1564"</span>,</span>
<span>              <span class="st">"prs_65plus_ans_prt"</span> <span class="op">=</span> <span class="st">"A65plus"</span></span>
<span>              <span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="sec-01423" class="level4" data-number="1.4.2.3"><h4 data-number="1.4.2.3" class="anchored" data-anchor-id="sec-01423">
<span class="header-section-number">1.4.2.3</span> Calcul de nouvelles variables</h4>
<p>Il est possible d’utiliser les colonnes de type numérique pour calculer de nouvelles colonnes en utilisant les opérateurs mathématiques vus dans la <a href="#sec-0135">section&nbsp;<span>1.3.5</span></a>. Prenons un exemple concret&nbsp;: calculons la densité de population par secteur de recensement dans notre <em>DataFrame</em>, puis affichons un résumé de cette nouvelle variable.</p>
<div class="cell">
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcul de la densité</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">pop_density_2016</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Pop2016</span> <span class="op">/</span> <span class="va">df</span><span class="op">$</span><span class="va">KM2</span></span>
<span></span>
<span><span class="co"># Statistiques descriptives</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">pop_density_2016</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
   17.45  1946.96  3700.50  5465.03  7918.39 48811.79 </code></pre>
</div>
</div>
<p>Nous pouvons aussi calculer le ratio entre le nombre de maisons et le nombre d’appartements.</p>
<div class="cell">
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcul du ratio</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">total_maison</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">MaisonIndi</span> <span class="op">+</span> <span class="va">df</span><span class="op">$</span><span class="va">MaisJumule</span> <span class="op">+</span> <span class="va">df</span><span class="op">$</span><span class="va">MaisRangee</span> <span class="op">+</span> <span class="va">df</span><span class="op">$</span><span class="va">AutreMais</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">total_apt</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">AppDuplex</span> <span class="op">+</span> <span class="va">df</span><span class="op">$</span><span class="va">App5Moins</span> <span class="op">+</span> <span class="va">df</span><span class="op">$</span><span class="va">App5Plus</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">ratio_maison_apt</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">total_maison</span> <span class="op">/</span> <span class="va">df</span><span class="op">$</span><span class="va">total_apt</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Retenez ici que R applique le calcul à chaque ligne de votre jeu de données et stocke le résultat dans une nouvelle colonne. Cette opération est du calcul vectoriel&nbsp;: toute la colonne est calculée en une seule fois. R est d’ailleurs optimisé pour le calcul vectoriel.</p>
</section><section id="sec-01424" class="level4" data-number="1.4.2.4"><h4 data-number="1.4.2.4" class="anchored" data-anchor-id="sec-01424">
<span class="header-section-number">1.4.2.4</span> Fonctions mathématiques</h4>
<p>R propose un ensemble de fonctions de base pour effectuer du calcul. Voici une liste non exhaustive des principales fonctions&nbsp;:</p>
<ul>
<li><p><code>abs</code> calcule la valeur absolue de chaque valeur d’un vecteur;</p></li>
<li><p><code>sqrt</code> calcule la racine carrée de chaque valeur d’un vecteur;</p></li>
<li><p><code>log</code> calcule le logarithme de chaque valeur d’un vecteur;</p></li>
<li><p><code>exp</code> calcule l’exponentielle de chaque valeur d’un vecteur;</p></li>
<li><p><code>factorial</code> calcule la factorielle de chaque valeur d’un vecteur;</p></li>
<li><p><code>round</code> arrondit la valeur d’un vecteur;</p></li>
<li><p><code>ceiling</code>, <code>floor</code> arrondit à l’unité supérieure ou inférieure de chaque valeur d’un vecteur;</p></li>
<li><p><code>sin</code>, <code>asin</code>, <code>cos</code>, <code>acos</code>, <code>tan</code>, <code>atan</code> sont des fonctions de trigonométrie;</p></li>
<li><p><code>cumsum</code> calcule la somme cumulative des valeurs d’un vecteur.</p></li>
</ul>
<p>Ces fonctions sont des fonctions vectorielles puisqu’elles s’appliquent à tous les éléments d’un vecteur. Si votre vecteur en entrée comprend cinq valeurs, le vecteur en sortie comprendra aussi cinq valeurs.</p>
<p>À l’inverse, les fonctions suivantes s’appliquent directement à l’ensemble d’un vecteur et ne vont renvoyer qu’une seule valeur&nbsp;:</p>
<ul>
<li><p><code>sum</code> calcule la somme des valeurs d’un vecteur;</p></li>
<li><p><code>prod</code> calcule le produit des valeurs d’un vecteur;</p></li>
<li><p><code>min</code>, <code>max</code> renvoient les valeurs maximale et minimale d’un vecteur;</p></li>
<li><p><code>mean</code>, <code>median</code> renvoient la moyenne et la médiane d’un vecteur;</p></li>
<li><p><code>quantile</code> renvoie les percentiles d’un vecteur.</p></li>
</ul></section><section id="sec-01425" class="level4" data-number="1.4.2.5"><h4 data-number="1.4.2.5" class="anchored" data-anchor-id="sec-01425">
<span class="header-section-number">1.4.2.5</span> Fonctions pour manipuler des chaînes de caractères</h4>
<p>Outre les données numériques, vous aurez à travailler avec des données de type texte (<code>string</code>). Le <code>tidyverse</code> avec le <em>package</em> <code>stringr</code> offre des fonctions très intéressantes pour manipuler ce type de données. Pour un aperçu de toutes les fonctions offertes par <code>stringr</code>, référez-vous à sa <a href="https://github.com/rstudio/cheatsheets/blob/master/strings.pdf" target="_blank"><em>Cheat Sheet</em></a>. Commençons avec un <em>DataFrame</em> assez simple comprenant des adresses et des noms de personnes.</p>
<div class="cell">
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  noms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Jérémy Toutanplace"</span> , <span class="st">"constant Tinople"</span> , <span class="st">"dino Resto"</span> , <span class="st">"Luce tancil"</span><span class="op">)</span>,</span>
<span>  adresses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'15 rue Levy'</span>, <span class="st">'413 Blvd Saint-Laurent'</span>, <span class="st">'3606 rue Duké'</span>, <span class="st">'2457 route St Marys'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sec-014251" class="level5" data-number="1.4.2.5.1"><h5 data-number="1.4.2.5.1" class="anchored" data-anchor-id="sec-014251">
<span class="header-section-number">1.4.2.5.1</span> Majuscules et minuscules</h5>
<p>Pour harmoniser ce <em>DataFrame</em>, nous mettons, dans un premier temps, des majuscules à la première lettre des prénoms et des noms des individus avec la fonction <code>str_to_title</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">noms_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_title</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">noms</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">noms_corr</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Jérémy Toutanplace" "Constant Tinople"   "Dino Resto"        
[4] "Luce Tancil"       </code></pre>
</div>
</div>
<p>Nous pourrions également tout mettre en minuscules ou tout en majuscules.</p>
<div class="cell">
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">noms_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">noms</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">noms_maj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">noms</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">noms_min</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "jérémy toutanplace" "constant tinople"   "dino resto"        
[4] "luce tancil"       </code></pre>
</div>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">noms_maj</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "JÉRÉMY TOUTANPLACE" "CONSTANT TINOPLE"   "DINO RESTO"        
[4] "LUCE TANCIL"       </code></pre>
</div>
</div>
</section><section id="sec-014252" class="level5" data-number="1.4.2.5.2"><h5 data-number="1.4.2.5.2" class="anchored" data-anchor-id="sec-014252">
<span class="header-section-number">1.4.2.5.2</span> Remplacement du texte</h5>
<p>Les adresses comprennent des caractères accentués. Ce type de caractères cause régulièrement des problèmes d’encodage. Nous pourrions alors décider de les remplacer par des caractères simples avec la fonction <code>str_replace_all</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">adresses_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">adresses</span>,<span class="st">'é'</span>,<span class="st">'e'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">adresses_1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "15 rue Levy"            "413 Blvd Saint-Laurent" "3606 rue Duke"         
[4] "2457 route St Marys"   </code></pre>
</div>
</div>
<p>La même fonction peut être utilisée pour remplacer les <em>St</em> par <em>Saint</em> et les <em>Blvd</em> par <em>Boulevard</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">adresses_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">adresses_1</span>,<span class="st">' St '</span>,<span class="st">' Saint '</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">adresses_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">adresses_2</span>,<span class="st">' Blvd '</span>,<span class="st">' Boulevard '</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">adresses_3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "15 rue Levy"                 "413 Boulevard Saint-Laurent"
[3] "3606 rue Duke"               "2457 route Saint Marys"     </code></pre>
</div>
</div>
</section><section id="sec-014253" class="level5" data-number="1.4.2.5.3"><h5 data-number="1.4.2.5.3" class="anchored" data-anchor-id="sec-014253">
<span class="header-section-number">1.4.2.5.3</span> Découpage du texte</h5>
<p>Il est parfois nécessaire de découper du texte pour en extraire des éléments. Nous devons alors choisir un caractère de découpage. Dans notre exemple, nous pourrions vouloir extraire les numéros civiques des adresses en sélectionnant le premier espace comme caractère de découpage, et en utilisant la fonction <code>str_split_fixed</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">num_civique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split_fixed</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">adresses_3</span>, <span class="st">' '</span>, n<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">num_civique</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "15"   "413"  "3606" "2457"</code></pre>
</div>
</div>
<p>Pour être exact, sachez que pour notre exemple, la fonction <code>str_split_fixed</code> renvoie deux colonnes de texte&nbsp;: une avec le texte avant le premier espace, soit le numéro civique, et une avec le reste du texte. Le nombre de colonnes est contrôlé par l’argument <code>n</code>. Si <code>n = 1</code>, la fonction ne fait aucun découpage; avec <code>n = 2</code> la fonction découpe en deux parties le texte avec la première occurrence du délimiteur et ainsi de suite. En ajoutant <code>[,1]</code> à la fin, nous indiquons que nous souhaitons garder seulement la première des deux colonnes.</p>
<p>Il est également possible d’extraire des parties de texte et de ne garder par exemple que les <em>N</em> premiers caractères ou les <em>N</em> derniers caractères&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Ne garder que les 5 premiers caractères</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">adresses_3</span>, start <span class="op">=</span> <span class="fl">1</span>, stop <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "15 ru" "413 B" "3606 " "2457 "</code></pre>
</div>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Ne garder que les 5 derniers caractères</span></span>
<span><span class="va">n_caract</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">adresses_3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">adresses_3</span>, start <span class="op">=</span> <span class="va">n_caract</span><span class="op">-</span><span class="fl">4</span>, stop <span class="op">=</span> <span class="va">n_caract</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] " Levy" "urent" " Duke" "Marys"</code></pre>
</div>
</div>
<p>Notez que les paramètres <code>start</code> et <code>stop</code> de la fonction <code>substr</code> peuvent accepter un vecteur de valeurs. Il est ainsi possible d’appliquer une sélection de texte différente à chaque chaîne de caractères dans notre vecteur en entrée. Nous pourrions par exemple vouloir récupérer tout le texte avant le second espace pour garder uniquement le numéro civique et le type de rue.</p>
<div class="cell">
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Étape 1 : récupérer les positions des espaces pour chaque adresses</span></span>
<span><span class="va">positions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_locate.html">str_locate_all</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">adresses_3</span>, <span class="st">" "</span><span class="op">)</span></span>
<span><span class="co"># Étape 2 : récupérer les positions des seconds espaces</span></span>
<span><span class="va">sec_positions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">positions</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">i</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co"># Étape 3 : appliquer le découpage</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">adresses_3</span>, start <span class="op">=</span> <span class="fl">1</span>, stop <span class="op">=</span> <span class="va">sec_positions</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "15 rue"        "413 Boulevard" "3606 rue"      "2457 route"   </code></pre>
</div>
</div>
</section><section id="sec-014254" class="level5" data-number="1.4.2.5.4"><h5 data-number="1.4.2.5.4" class="anchored" data-anchor-id="sec-014254">
<span class="header-section-number">1.4.2.5.4</span> Concaténation du texte</h5>
<p>À l’inverse du découpage, il est parfois nécessaire de concaténer des éléments de texte, ce qu’il est possible de réaliser avec la fonction <code>paste</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">texte_complet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">noms_corr</span>, <span class="va">df</span><span class="op">$</span><span class="va">adresses_3</span>, sep <span class="op">=</span> <span class="st">" : "</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">texte_complet</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Jérémy Toutanplace : 15 rue Levy"              
[2] "Constant Tinople : 413 Boulevard Saint-Laurent"
[3] "Dino Resto : 3606 rue Duke"                    
[4] "Luce Tancil : 2457 route Saint Marys"          </code></pre>
</div>
</div>
<p>Le paramètre <code>sep</code> permet d’indiquer le ou les caractères à intercaler entre les éléments à concaténer. Notez qu’il est possible de concaténer plus que deux éléments.</p>
<div class="cell">
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">ville</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Montreal'</span>,<span class="st">'Montreal'</span>,<span class="st">'Montreal'</span>,<span class="st">'Montreal'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">noms_corr</span>, <span class="va">df</span><span class="op">$</span><span class="va">adresses_3</span>, <span class="va">df</span><span class="op">$</span><span class="va">ville</span>, sep <span class="op">=</span> <span class="st">", "</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Jérémy Toutanplace, 15 rue Levy, Montreal"              
[2] "Constant Tinople, 413 Boulevard Saint-Laurent, Montreal"
[3] "Dino Resto, 3606 rue Duke, Montreal"                    
[4] "Luce Tancil, 2457 route Saint Marys, Montreal"          </code></pre>
</div>
</div>
<p>Si vous souhaitez concaténer des éléments de texte sans séparateur, la fonction <code>paste0</code> peut être plus simple à utiliser.</p>
<div class="cell">
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Please conca"</span>, <span class="st">"tenate me!"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Please concatenate me!"</code></pre>
</div>
</div>
</section></section><section id="sec-01426" class="level4" data-number="1.4.2.6"><h4 data-number="1.4.2.6" class="anchored" data-anchor-id="sec-01426">
<span class="header-section-number">1.4.2.6</span> Manipulation des colonnes de type date</h4>
<p>Nous avons vu que les principaux types de données dans R sont le numérique, le texte, le booléen et le facteur. Il existe d’autres types introduits par différents <em>packages</em>. Nous abordons ici les types date et heure (<em>date</em> and <em>time</em>). Pour les manipuler, nous privilégions l’utilisation du <em>package</em> <code>lubridate</code> du <code>tidyverse</code>. Pour illustrer le tout, nous l’utilisons avec un jeu de données ouvertes de la Ville de Montréal représentant les collisions routières impliquant au moins un cycliste survenues après le 1<sup>er</sup> janvier 2017.</p>
<div class="cell">
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">accidents_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"data/priseenmain/accidents.csv"</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "HEURE_ACCDN"       "DT_ACCDN"          "NB_VICTIMES_TOTAL"</code></pre>
</div>
</div>
<p>Nous disposons de trois colonnes représentant respectivement l’heure, la date et le nombre de victimes impliquées dans la collision.</p>
<section id="sec-014261" class="level5" data-number="1.4.2.6.1"><h5 data-number="1.4.2.6.1" class="anchored" data-anchor-id="sec-014261">
<span class="header-section-number">1.4.2.6.1</span> Du texte à la date</h5>
<p>Actuellement, les colonnes <code>HEURE_ACCDN</code> et <code>DT_ACCDN</code> sont au format texte. Nous pouvons afficher quelques lignes du jeu de données avec la fonction <code>head</code> pour visualiser comment elles ont été saisies.</p>
<div class="cell">
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">accidents_df</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        HEURE_ACCDN   DT_ACCDN NB_VICTIMES_TOTAL
1 16:00:00-16:59:00 2017/11/02                 0
2 06:00:00-06:59:00 2017/01/16                 1
3 18:00:00-18:59:00 2017/04/18                 0
4 11:00:00-11:59:00 2017/05/28                 1
5 15:00:00-15:59:00 2017/05/28                 1</code></pre>
</div>
</div>
<p>Un peu de ménage s’impose&nbsp;: les heures sont indiquées comme des périodes d’une heure. Nous utilisons la fonction <code>str_split_fixed</code> du <em>package</em> <code>stringr</code> pour ne garder que la première partie de l’heure (avant le tiret). Ensuite, Nous concaténons l’heure et la date avec la fonction <code>paste</code>, puis nous convertissons ce résultat en un objet <em>date-time</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Étape 1 : découper la colonne Heure_ACCDN</span></span>
<span><span class="va">accidents_df</span><span class="op">$</span><span class="va">heure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split_fixed</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">HEURE_ACCDN</span>, <span class="st">"-"</span>, n<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="co"># Étape 2 : concaténer l'heure et la date</span></span>
<span><span class="va">accidents_df</span><span class="op">$</span><span class="va">date_heure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">DT_ACCDN</span>, </span>
<span>                                 <span class="va">accidents_df</span><span class="op">$</span><span class="va">heure</span>,</span>
<span>                                 sep <span class="op">=</span> <span class="st">' '</span><span class="op">)</span></span>
<span><span class="co"># Étape 3 : convertir au format datetime</span></span>
<span><span class="va">accidents_df</span><span class="op">$</span><span class="va">datetime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html">as_datetime</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">date_heure</span>,</span>
<span>                                     format <span class="op">=</span> <span class="st">"%Y/%m/%d %H:%M:%S"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pour effectuer la conversion, nous avons utilisé la fonction <code>as_datetime</code> du <em>package</em> <code>lubridate</code>. Elle prend comme paramètre un vecteur de texte et une indication du format de ce vecteur de texte. Il existe de nombreuses façons de spécifier une date et une heure et l’argument <em>format</em> permet d’indiquer celle à utiliser. Dans cet exemple, la date est structurée comme suit&nbsp;: <code>année/mois/jour heure:minute:seconde</code>, ce qui se traduit par le format <code>%Y/%m/%d %H:%M:%S</code>.</p>
<ul>
<li><p>%Y signifie une année indiquée avec quatre caractères&nbsp;: 2017;</p></li>
<li><p>%m signifie un mois, indiqué avec deux caractères&nbsp;: 01, 02, 03, … 12;</p></li>
<li><p>%d signifie un jour, indiqué avec deux caractères&nbsp;: 01, 02, 03, … 31;</p></li>
<li><p>%H signifie une heure, au format 24 heures avec deux caractères&nbsp;: 00, 02, … 23;</p></li>
<li><p>%M signifie des minutes indiquées avec deux caractères&nbsp;: 00, 02, … 59;</p></li>
<li><p>%S signifie des secondes, indiquées avec deux caractères&nbsp;: 00, 02, … 59.</p></li>
</ul>
<p>Notez que les caractères séparant les années, jours, heures, etc. sont aussi à indiquer dans le format. Dans notre exemple, nous utilisons la barre oblique (<code>/</code>) pour séparer les éléments de la date et le deux points (<code>:</code>) pour l’heure, et une espace pour séparer la date et l’heure.</p>
<p>Il existe d’autres nomenclatures pour spécifier un format <em>datetime</em>&nbsp;: par exemple, des mois renseignés par leur nom, l’indication AM-PM, etc. Vous pouvez vous référer à la documentation de la fonction <code>strptime</code> (<code><a href="https://rdrr.io/r/base/strptime.html">help(strptime)</a></code>) pour explorer les différentes nomenclatures et choisir celle qui vous convient. Bien évidemment, il est nécessaire que toutes les dates de votre colonne soient renseignées dans le même format, pour éviter que la fonction ne retourne la valeur <code>NA</code> lorsqu’elle ne peut lire le format. Après toutes ces opérations, rejetons un oeil à notre <em>DataFrame</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">accidents_df</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        HEURE_ACCDN   DT_ACCDN NB_VICTIMES_TOTAL    heure          date_heure
1 16:00:00-16:59:00 2017/11/02                 0 16:00:00 2017/11/02 16:00:00
2 06:00:00-06:59:00 2017/01/16                 1 06:00:00 2017/01/16 06:00:00
3 18:00:00-18:59:00 2017/04/18                 0 18:00:00 2017/04/18 18:00:00
4 11:00:00-11:59:00 2017/05/28                 1 11:00:00 2017/05/28 11:00:00
5 15:00:00-15:59:00 2017/05/28                 1 15:00:00 2017/05/28 15:00:00
             datetime
1 2017-11-02 16:00:00
2 2017-01-16 06:00:00
3 2017-04-18 18:00:00
4 2017-05-28 11:00:00
5 2017-05-28 15:00:00</code></pre>
</div>
</div>
</section><section id="sec-014262" class="level5" data-number="1.4.2.6.2"><h5 data-number="1.4.2.6.2" class="anchored" data-anchor-id="sec-014262">
<span class="header-section-number">1.4.2.6.2</span> Extraction des informations d’une date</h5>
<p>À partir de la nouvelle colonne <code>datetime</code>, nous sommes en mesure d’extraire des informations intéressantes comme&nbsp;:</p>
<ul>
<li>le nom du jour de la semaine avec la fonction <code>weekdays</code>
</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">accidents_df</span><span class="op">$</span><span class="va">jour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html">weekdays</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">datetime</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>la période de la journée avec les fonctions <code>am</code> et <code>pm</code>
</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">accidents_df</span><span class="op">$</span><span class="va">AM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/am.html">am</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">datetime</span><span class="op">)</span></span>
<span><span class="va">accidents_df</span><span class="op">$</span><span class="va">PM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/am.html">pm</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">datetime</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"jour"</span>, <span class="st">"AM"</span>, <span class="st">"PM"</span><span class="op">)</span><span class="op">]</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      jour    AM    PM
1    jeudi FALSE  TRUE
2    lundi  TRUE FALSE
3    mardi FALSE  TRUE
4 dimanche  TRUE FALSE
5 dimanche FALSE  TRUE</code></pre>
</div>
</div>
<p>Il est aussi possible d’accéder aux sous-éléments d’un <em>datetime</em> comme l’année, le mois, le jour, l’heure, la minute et la seconde avec les fonctions <code><a href="https://lubridate.tidyverse.org/reference/year.html">year()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/month.html">month()</a></code>,<code><a href="https://lubridate.tidyverse.org/reference/day.html">day()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/hour.html">hour()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/minute.html">minute()</a></code> et <code><a href="https://lubridate.tidyverse.org/reference/second.html">second()</a></code>.</p>
</section><section id="sec-014263" class="level5" data-number="1.4.2.6.3"><h5 data-number="1.4.2.6.3" class="anchored" data-anchor-id="sec-014263">
<span class="header-section-number">1.4.2.6.3</span> Calcul d’une durée entre deux <em>datetime</em>
</h5>
<p>Une autre utilisation intéressante du format <em>datetime</em> est de calculer des différences de temps. Par exemple, nous pourrions utiliser le nombre de minutes écoulées depuis 7 h comme une variable dans une analyse visant à déterminer le moment critique des collisions routières durant l’heure de pointe du matin. Pour cela, nous devons créer un <em>datetime</em> de référence en concaténant la date de chaque observation, et le temps <code>07:00:00</code>, qui est notre point de départ.</p>
<div class="cell">
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">accidents_df</span><span class="op">$</span><span class="va">date_heure_07</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">DT_ACCDN</span>, </span>
<span>                                 <span class="st">'07:00:00'</span>,</span>
<span>                                 sep <span class="op">=</span> <span class="st">' '</span><span class="op">)</span></span>
<span><span class="va">accidents_df</span><span class="op">$</span><span class="va">ref_datetime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html">as_datetime</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">date_heure_07</span>,</span>
<span>                                     format <span class="op">=</span> <span class="st">"%Y/%m/%d %H:%M:%S"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il ne nous reste plus qu’à calculer la différence de temps entre la colonne <em>datetime</em> et notre temps de référence <em>ref_datetime</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/difftime.html">difftime</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">datetime</span>,</span>
<span>                                   <span class="va">accidents_df</span><span class="op">$</span><span class="va">ref_datetime</span>,</span>
<span>                                   units <span class="op">=</span> <span class="st">'min'</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notez qu’ici la colonne <em>diff_time</em> est d’un type spécial&nbsp;: une différence temporelle (<em>difftime</em>). Il faut encore la convertir au format numérique pour l’utiliser avec la fonction <code>as.numeric</code>. Par curiosité, réalisons rapidement un histogramme avec la fonction <code>hist</code> pour analyser rapidement cette variable d’écart de temps!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span>, breaks <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig015" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="01-priseenmainR_files/figure-html/fig-fig015-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.14: Répartition temporelle des accidents à vélo</figcaption></figure>
</div>
</div>
</div>
<p>Nous observons clairement deux pics, un premier entre 0 et 100 (entre 7 h et 8 h 30 environ) et un second plus important entre 550 et 650 (entre 16 h et 17 h 30 environ), ce qui correspond sans surprise aux heures de pointe (<a href="#fig-fig015">figure&nbsp;<span>1.14</span></a>). Il est intéressant de noter que plus d’accidents se produisent à l’heure de pointe du soir qu’à celle du matin.</p>
</section><section id="sec-014264" class="level5" data-number="1.4.2.6.4"><h5 data-number="1.4.2.6.4" class="anchored" data-anchor-id="sec-014264">
<span class="header-section-number">1.4.2.6.4</span> Fuseau horaire</h5>
<p>Lorsque nous travaillons avec des données provenant de différents endroits dans le monde ou que nous devons tenir compte des heures d’été et d’hiver, il convient de tenir compte du fuseau horaire. Pour créer une date avec un fuseau horaire, il est possible d’utiliser le paramètre <code>tz</code> dans la fonction <code>as_datetime</code> et d’utiliser l’identifiant du fuseau approprié. Dans notre cas, les données d’accident ont été collectées à Montréal, qui a un décalage de -5 heures par rapport au temps de référence UTC (+1 heure en été). Le code spécifique de ce fuseau horaire est <em>EDT</em>; il est facile de trouver ces codes avec le site web <a href="https://www.timeanddate.com/time/map/">timeanddate.com</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">accidents_df</span><span class="op">$</span><span class="va">datetime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html">as_datetime</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">date_heure</span>,</span>
<span>                                     format <span class="op">=</span> <span class="st">"%Y/%m/%d %H:%M:%S"</span>,</span>
<span>                                     tz <span class="op">=</span> <span class="st">"EDT"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="sec-01427" class="level4" data-number="1.4.2.7"><h4 data-number="1.4.2.7" class="anchored" data-anchor-id="sec-01427">
<span class="header-section-number">1.4.2.7</span> Recodage des variables</h4>
<p>Recoder une variable signifie changer ses valeurs selon une condition afin d’obtenir une nouvelle variable. Si nous reprenons le jeu de données précédent sur les accidents à vélo, nous pourrions vouloir créer une nouvelle colonne nous indiquant si la collision a eu lieu en heures de pointe ou non. Nous obtiendrions ainsi une nouvelle variable avec seulement deux catégories plutôt que la variable numérique originale. Nous pourrions aussi définir quatre catégories avec l’heure de pointe du matin, l’heure de pointe du soir, le reste de la journée et la nuit.</p>
<section id="sec-014271" class="level5" data-number="1.4.2.7.1"><h5 data-number="1.4.2.7.1" class="anchored" data-anchor-id="sec-014271">
<span class="header-section-number">1.4.2.7.1</span> Cas binaire avec <code>ifelse</code>
</h5>
<p>Si nous ne souhaitons créer que deux catégories, le plus simple est d’utiliser la fonction <code>ifelse</code>. Cette fonction évalue une condition (<a href="#sec-0135">section&nbsp;<span>1.3.5</span></a>) pour chaque ligne d’un <em>DataFrame</em> et produit un nouveau vecteur. Créons donc une variable binaire indiquant si une collision a eu lieu durant les heures de pointe ou hors heures de pointe. Nous devons alors évaluer les conditions suivantes&nbsp;:</p>
<p>Est-ce que l’accident a eu lieu entre 7 h (0) <strong>ET</strong> 9 h (120), <strong>OU</strong> entre 16 h 30 (570) <strong>ET</strong> 18 h 30 (690)?</p>
<div class="cell">
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
 2414    40 </code></pre>
</div>
</div>
<p>Notons dans un premier temps que nous avons 40 observations sans valeur pour la colonne <code>diff_time_num</code>. Il s’agit d’observations pour lesquelles nous ne disposions pas de dates au départ.</p>
<div class="cell">
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Cond1</span> <span class="op">&lt;-</span> <span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span> <span class="op">&gt;=</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span> <span class="op">&lt;=</span> <span class="fl">120</span></span>
<span><span class="va">Cond2</span> <span class="op">&lt;-</span> <span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span> <span class="op">&gt;=</span> <span class="fl">570</span> <span class="op">&amp;</span> <span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span> <span class="op">&lt;=</span> <span class="fl">690</span></span>
<span></span>
<span><span class="va">accidents_df</span><span class="op">$</span><span class="va">moment_bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Cond1</span> <span class="op">|</span> <span class="va">Cond2</span>,</span>
<span>                                  <span class="st">"en heures de pointe"</span>,</span>
<span>                                  <span class="st">"hors heures de pointe"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Comme vous pouvez le constater, la fonction <code>ifelse</code> nécessite trois arguments&nbsp;:</p>
<ul>
<li><p>une condition, pouvant être <code>TRUE</code> ou <code>FALSE</code>;</p></li>
<li><p>la valeur à renvoyer si la condition est <code>FALSE</code>;</p></li>
<li><p>la valeur à renvoyer si la condition est <code>TRUE</code>.</p></li>
</ul>
<p>Avec la fonction <code>table</code>, nous pouvons rapidement visualiser les effectifs des deux catégories ainsi créées&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">moment_bin</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  en heures de pointe hors heures de pointe 
                  841                  1573 </code></pre>
</div>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Vérifier si nous avons toujours seulement 40 NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">moment_bin</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
 2414    40 </code></pre>
</div>
</div>
<p>Les heures de pointe représentent quatre heures de la journée, ce qui nous laisse neuf heures hors heures de pointe entre 7 h et 20 h.</p>
<div class="cell">
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Ratio de collisions routières en heures de pointe</span></span>
<span><span class="op">(</span><span class="fl">841</span> <span class="op">/</span> <span class="fl">2414</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">4</span> <span class="op">/</span> <span class="fl">13</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.132249</code></pre>
</div>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Ratio de collisions routières hors heure de pointe</span></span>
<span><span class="op">(</span><span class="fl">1573</span> <span class="op">/</span> <span class="fl">2414</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">9</span> <span class="op">/</span> <span class="fl">13</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9412225</code></pre>
</div>
</div>
<p>En rapportant les collisions aux durées des deux périodes, nous observons une nette surreprésentation des collisions impliquant un vélo pendant les heures de pointe d’environ 13&nbsp;% comparativement à la période hors des heures de pointe.</p>
</section><section id="sec-014272" class="level5" data-number="1.4.2.7.2"><h5 data-number="1.4.2.7.2" class="anchored" data-anchor-id="sec-014272">
<span class="header-section-number">1.4.2.7.2</span> Cas multiple avec la <code>case_when</code>
</h5>
<p>Lorsque nous souhaitons créer plus que deux catégories, il est possible soit d’enchaîner plusieurs fonctions <code>ifelse</code> (ce qui produit un code plus long et moins lisible), soit d’utiliser la fonction <code>case_when</code> du <em>package</em> <code>dplyr</code> du <code>tidyverse</code>. Reprenons notre exemple et créons quatre catégories&nbsp;:</p>
<ul>
<li><p>en heures de pointe du matin;</p></li>
<li><p>en heures de pointe du soir;</p></li>
<li><p>le reste de la journée (entre 7 h et 20 h);</p></li>
<li><p>la nuit (entre 21 h et 7 h).</p></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">accidents_df</span><span class="op">$</span><span class="va">moment_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>  <span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span> <span class="op">&gt;=</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span> <span class="op">&lt;=</span> <span class="fl">120</span> <span class="op">~</span> <span class="st">"pointe matin"</span>,</span>
<span>  <span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span> <span class="op">&gt;=</span> <span class="fl">570</span> <span class="op">&amp;</span> <span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span> <span class="op">&lt;=</span> <span class="fl">690</span> <span class="op">~</span> <span class="st">"pointe soir"</span>,</span>
<span>  <span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span> <span class="op">&gt;</span> <span class="fl">690</span> <span class="op">&amp;</span> <span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span> <span class="op">&lt;</span> <span class="fl">780</span> <span class="op">~</span> <span class="st">"journee"</span>,</span>
<span>  <span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span> <span class="op">&gt;</span> <span class="fl">120</span> <span class="op">&amp;</span> <span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span> <span class="op">&lt;</span> <span class="fl">570</span> <span class="op">~</span> <span class="st">"journee"</span>,</span>
<span>  <span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">accidents_df</span><span class="op">$</span><span class="va">diff_time_num</span> <span class="op">&gt;=</span> <span class="fl">780</span> <span class="op">~</span> <span class="st">"nuit"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">moment_multi</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     journee         nuit pointe matin  pointe soir 
        1155          418          404          437 </code></pre>
</div>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Vérifions encore les NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">accidents_df</span><span class="op">$</span><span class="va">moment_multi</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
 2414    40 </code></pre>
</div>
</div>
<p>La syntaxe de cette fonction est un peu particulière. Elle accepte un nombre illimité (ou presque) d’arguments. Chaque argument est composé d’une condition et d’une valeur à renvoyer si la condition est vraie; ces deux éléments étant reliés par le symbole <code>~</code>. Notez que toutes les évaluations sont effectuées dans l’ordre des arguments. En d’autres termes, la fonction teste d’abord la première condition et assigne ses valeurs, puis recommence pour les prochaines conditions. Ainsi, si une observation (ligne du tableau de données) obtient <code>TRUE</code> à plusieurs conditions, elle obtient au final la valeur de la dernière condition validée. Dans l’exemple précédent, si la première condition est <code>accidents_df$diff_time_num &gt;= 0 | accidents_df$diff_time_num &lt;= 120</code>, alors nous obtenons pour seule valeur en résultat <code>"pointe matin"</code> puisque chaque observation a une valeur supérieure à 0 et que nous avons remplacé l’opérateur <code>&amp;</code> (ET) par l’opérateur <code>|</code> (OU).</p>
</section></section><section id="sec-01428" class="level4" data-number="1.4.2.8"><h4 data-number="1.4.2.8" class="anchored" data-anchor-id="sec-01428">
<span class="header-section-number">1.4.2.8</span> Sous-sélection d’un <em>DataFrame</em>
</h4>
<p>Dans cette section, nous voyons comment extraire des sous-parties d’un <em>DataFrame</em>. Il est possible de sous-sélectionner des lignes et des colonnes en se basant sur des conditions ou leur index. Pour cela, nous utilisons un jeu de données fourni avec R&nbsp;: le jeu de données <strong>iris</strong> décrivant des fleurs du même nom.</p>
<div class="cell">
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"iris"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Nombre de lignes et de colonnes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 150   5</code></pre>
</div>
</div>
<section id="sec-014281" class="level5" data-number="1.4.2.8.1"><h5 data-number="1.4.2.8.1" class="anchored" data-anchor-id="sec-014281">
<span class="header-section-number">1.4.2.8.1</span> Sous-sélection des lignes</h5>
<p>Sous-sélectionner des lignes par index est relativement simple. Admettons que nous souhaitons sélectionner les lignes 1 à 5, 10 à 25, 37 et 58.</p>
<div class="cell">
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sub_iris</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">:</span><span class="fl">25</span>, <span class="fl">37</span>, <span class="fl">58</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sub_iris</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 23</code></pre>
</div>
</div>
<p>Sous-sélectionner des lignes avec une condition peut être effectué soit avec une syntaxe similaire, soit en utilisant la fonction <code>subset</code>. Sélectionnons toutes les fleurs de l’espèce Virginica.</p>
<div class="cell">
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris_virginica1</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"virginica"</span>,<span class="op">]</span></span>
<span><span class="va">iris_virginica2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">iris</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"virginica"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Vérifions que les deux DataFrames ont le même nombre de lignes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">iris_virginica1</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">iris_virginica2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Vous pouvez utiliser, dans les deux cas, tous les opérateurs vus dans les sections <a href="#sec-01351"><span>1.3.5.1</span></a> et <a href="#sec-01353"><span>1.3.5.3</span></a>. L’enjeu est d’arriver à créer un vecteur booléen final permettant d’identifier les observations à conserver.</p>
</section><section id="sec-014282" class="level5" data-number="1.4.2.8.2"><h5 data-number="1.4.2.8.2" class="anchored" data-anchor-id="sec-014282">
<span class="header-section-number">1.4.2.8.2</span> Sous-sélection des colonnes</h5>
<p>Nous avons déjà vu comment sélectionner des colonnes en utilisant leur nom ou leur index dans la <a href="#sec-014221">section&nbsp;<span>1.4.2.2.1</span></a>. Ajoutons ici un cas particulier où nous souhaitons sélectionner des colonnes selon une condition. Par exemple, nous pourrions vouloir conserver que les colonnes comprenant le mot <em>Length</em>. Pour cela, nous utilisons la fonction <code>grepl</code>, permettant de déterminer si des caractères sont présents dans une chaîne de caractères.</p>
<div class="cell">
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nom_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">nom_cols</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sepal.Length" "Sepal.Width"  "Petal.Length" "Petal.Width"  "Species"     </code></pre>
</div>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test_nom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Length"</span>, <span class="va">nom_cols</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">ok_nom</span> <span class="op">&lt;-</span> <span class="va">nom_cols</span><span class="op">[</span><span class="va">test_nom</span><span class="op">]</span></span>
<span></span>
<span><span class="va">iris_2</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="va">ok_nom</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris_2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sepal.Length" "Petal.Length"</code></pre>
</div>
</div>
<p>Il est possible d’obtenir ce résultat en une seule ligne de code, mais elle est un peu moins lisible.</p>
<div class="cell">
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris2</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Length"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-014283" class="level5" data-number="1.4.2.8.3"><h5 data-number="1.4.2.8.3" class="anchored" data-anchor-id="sec-014283">
<span class="header-section-number">1.4.2.8.3</span> Sélection des colonnes et des lignes</h5>
<p>Nous avons vu qu’avec les crochets <code>[]</code>, nous pouvons extraire les colonnes et les lignes d’un <em>DataFrame</em>. Il est possible de combiner les deux opérations simultanément. Pour ce faire, il faut indiquer en premier les index ou la condition permettant de sélectionner une ligne, puis les index ou la condition pour sélectionner les colonnes&nbsp;: <code>[index_lignes , index_colonnes]</code>. Sélectionnons cinq premières lignes et les trois premières colonnes du jeu de données iris&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris_5x3</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">iris_5x3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length
1          5.1         3.5          1.4
2          4.9         3.0          1.4
3          4.7         3.2          1.3
4          4.6         3.1          1.5
5          5.0         3.6          1.4</code></pre>
</div>
</div>
<p>Combinons nos deux exemples précédents pour sélectionner uniquement les lignes avec des fleurs de l’espèce <em>virginica</em>, et les colonnes avec le mot <em>Length</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris_virginica3</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"virginica"</span>,</span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Length"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iris_virginica3</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sepal.Length Petal.Length
101          6.3          6.0
102          5.8          5.1
103          7.1          5.9
104          6.3          5.6
105          6.5          5.8</code></pre>
</div>
</div>
</section></section><section id="sec-01429" class="level4" data-number="1.4.2.9"><h4 data-number="1.4.2.9" class="anchored" data-anchor-id="sec-01429">
<span class="header-section-number">1.4.2.9</span> Fusion de <em>DataFrames</em>
</h4>
<p>Terminons cette section avec la fusion de <em>DataFrames</em>. Nous distinguons deux méthodes répondant à des besoins différents&nbsp;: par ajout ou par jointure.</p>
<section id="sec-014291" class="level5" data-number="1.4.2.9.1"><h5 data-number="1.4.2.9.1" class="anchored" data-anchor-id="sec-014291">
<span class="header-section-number">1.4.2.9.1</span> Fusion de <em>DataFrames</em> par ajout</h5>
<p>Ajouter deux <em>DataFrames</em> peut se faire en fonction de leurs colonnes ou en fonction de leurs lignes. Dans ces deux cas, nous utilisons respectivement les fonctions <code>cbind</code> et <code>rbind</code>. La <a href="#fig-fig016">figure&nbsp;<span>1.15</span></a> résume graphiquement le fonctionnement des deux fonctions.</p>
<div id="fig-fig016" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/rbind_cbind.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.15: Fusion de DataFrames</figcaption></figure>
</div>
<p>Pour que <code>cbind</code> fonctionne, il faut que les deux <em>DataFrames</em> aient le même nombre de lignes. Pour <code>rbind</code>, les deux <em>DataFrames</em> doivent avoir le même nombre de colonnes. Prenons à nouveau comme exemple le jeu de données iris. Nous commençons par le séparer en trois sous-jeux de données comprenant chacun une espèce d’iris. Puis, nous fusionnons deux d’entre eux avec la fonction <code>rbind</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">iris</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"virginica"</span><span class="op">)</span></span>
<span><span class="va">iris2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">iris</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"versicolor"</span><span class="op">)</span></span>
<span><span class="va">iris3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">iris</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"setosa"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">iris_comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">iris2</span>,<span class="va">iris3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous pourrions aussi extraire dans les deux <em>DataFrames</em> les colonnes comprenant le mot <em>Length</em> et le mot <em>Width</em>, puis les fusionner.</p>
<div class="cell">
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris_l</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Length"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">iris_w</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Width"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="va">iris_comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">iris_l</span>,<span class="va">iris_w</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris_comb</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sepal.Length" "Petal.Length" "Sepal.Width"  "Petal.Width" </code></pre>
</div>
</div>
</section><section id="sec-014292" class="level5" data-number="1.4.2.9.2"><h5 data-number="1.4.2.9.2" class="anchored" data-anchor-id="sec-014292">
<span class="header-section-number">1.4.2.9.2</span> Jointure de <em>DataFrames</em>
</h5>
<p>Une jointure est une opération un peu plus complexe qu’un simple ajout. L’idée est d’associer des informations de plusieurs <em>DataFrames</em> en utilisant une colonne (appelée une clef) présente dans les deux jeux de données. Nous distinguons plusieurs types de jointure&nbsp;:</p>
<ul>
<li><p>Les jointures internes permettant de combiner les éléments communs entre deux <em>DataFrames</em> A <strong>et</strong> B.</p></li>
<li><p>La jointure complète permettant de combiner les éléments présents dans A <strong>ou</strong> B.</p></li>
<li><p>La jointure à gauche, permettant de ne conserver que les éléments présents dans A même s’ils n’ont pas de correspondance dans B.</p></li>
</ul>
<p>Ces trois jointures sont présentées à la <a href="#fig-fig017">figure&nbsp;<span>1.16</span></a>; pour ces trois cas, la colonne commune se nomme <em>id</em>.</p>
<div id="fig-fig017" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/merging.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.16: Jointure de DataFrames</figcaption></figure>
</div>
<p>Vous retiendrez que les deux dernières jointures peuvent produire des valeurs manquantes. Pour réaliser ces opérations, nous utilisons la fonction <code>merge</code>. Prenons un exemple simple à partir d’un petit jeu de données.</p>
<div class="cell">
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">auteurs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Tukey"</span>, <span class="st">"Venables"</span>, <span class="st">"Tierney"</span>, <span class="st">"Ripley"</span>, <span class="st">"McNeil"</span>, <span class="st">"Apparicio"</span><span class="op">)</span>,</span>
<span>    nationality <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"US"</span>, <span class="st">"Australia"</span>, <span class="st">"US"</span>, <span class="st">"UK"</span>, <span class="st">"Australia"</span>, <span class="st">"Canada"</span><span class="op">)</span>,</span>
<span>    retired <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"yes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">livres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    aut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Tukey"</span>, <span class="st">"Venables"</span>, <span class="st">"Tierney"</span>, <span class="st">"Ripley"</span>, <span class="st">"Ripley"</span>, <span class="st">"McNeil"</span> , <span class="st">"Wickham"</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Exploratory Data Analysis"</span>,</span>
<span>              <span class="st">"Modern Applied Statistics ..."</span>,</span>
<span>              <span class="st">"LISP-STAT"</span>,</span>
<span>              <span class="st">"Spatial Statistics"</span>, <span class="st">"Stochastic Simulation"</span>,</span>
<span>               <span class="st">"Interactive Data Analysis"</span>, <span class="st">"R for Data Science"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous avons donc deux <em>DataFrames</em>, le premier décrivant des auteurs et le second des livres. Effectuons une première jointure interne afin de savoir pour chaque livre la nationnalité de son auteur et si ce dernier est à la retraite.</p>
<div class="cell">
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">livres</span>, <span class="va">auteurs</span>, <span class="co">#les deux DataFrames </span></span>
<span>             by.x <span class="op">=</span> <span class="st">"aut"</span>, by.y <span class="op">=</span> <span class="st">"name"</span>, <span class="co">#les noms des colonnes de jointures</span></span>
<span>             all.x <span class="op">=</span> <span class="cn">FALSE</span>, all.y <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       aut                         title nationality retired
1   McNeil     Interactive Data Analysis   Australia      no
2   Ripley            Spatial Statistics          UK      no
3   Ripley         Stochastic Simulation          UK      no
4  Tierney                     LISP-STAT          US      no
5    Tukey     Exploratory Data Analysis          US     yes
6 Venables Modern Applied Statistics ...   Australia      no</code></pre>
</div>
</div>
<p>Cette jointure est interne, car les deux paramètres <em>all.x</em> et <em>all.y</em> ont pour valeur <code>FALSE</code>. Ainsi, nous indiquons à la fonction que nous ne souhaitons ni garder tous les éléments du premier <em>DataFrame</em> ni tous les éléments du second, mais uniquement les éléments présents dans les deux. Vous noterez ainsi que le livre “R for Data Science” n’est pas présent dans le jeu de données final, car son auteur “Wickham” ne fait pas partie du <em>DataFrame</em> auteurs. De même, l’auteur “Apparicio” n’apparaît pas dans la jointure, car aucun livre dans le <em>DataFrame</em> books n’a été écrit par cet auteur.</p>
<p>Pour conserver tous les livres, nous pouvons effectuer une jointure à gauche en renseignant <code>all.x = TRUE</code>. Nous forçons ainsi la fonction à garder tous les livres et à mettre des valeurs vides aux informations manquantes des auteurs.</p>
<div class="cell">
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">livres</span>, <span class="va">auteurs</span>, <span class="co">#les deux DataFrames </span></span>
<span>             by.x <span class="op">=</span> <span class="st">"aut"</span>, by.y <span class="op">=</span> <span class="st">"name"</span>, <span class="co">#les noms des colonnes de jointures</span></span>
<span>             all.x <span class="op">=</span> <span class="cn">TRUE</span>, all.y <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       aut                         title nationality retired
1   McNeil     Interactive Data Analysis   Australia      no
2   Ripley            Spatial Statistics          UK      no
3   Ripley         Stochastic Simulation          UK      no
4  Tierney                     LISP-STAT          US      no
5    Tukey     Exploratory Data Analysis          US     yes
6 Venables Modern Applied Statistics ...   Australia      no
7  Wickham            R for Data Science        &lt;NA&gt;    &lt;NA&gt;</code></pre>
</div>
</div>
<p>Pour garder tous les livres et tous les auteurs, nous pouvons faire une jointure complète en indiquant <code>all.x = TRUE</code> et <code>all.y = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">livres</span>, <span class="va">auteurs</span>, <span class="co">#les deux DataFrames </span></span>
<span>             by.x <span class="op">=</span> <span class="st">"aut"</span>, by.y <span class="op">=</span> <span class="st">"name"</span>, <span class="co">#les noms des colonnes de jointures</span></span>
<span>             all.x <span class="op">=</span> <span class="cn">TRUE</span>, all.y <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        aut                         title nationality retired
1 Apparicio                          &lt;NA&gt;      Canada      no
2    McNeil     Interactive Data Analysis   Australia      no
3    Ripley            Spatial Statistics          UK      no
4    Ripley         Stochastic Simulation          UK      no
5   Tierney                     LISP-STAT          US      no
6     Tukey     Exploratory Data Analysis          US     yes
7  Venables Modern Applied Statistics ...   Australia      no
8   Wickham            R for Data Science        &lt;NA&gt;    &lt;NA&gt;</code></pre>
</div>
</div>
</section></section></section></section><section id="sec-016" class="level2" data-number="1.5"><h2 data-number="1.5" class="anchored" data-anchor-id="sec-016">
<span class="header-section-number">1.5</span> Code R bien structuré</h2>
<p>Terminons ici avec quelques conseils sur la rédaction d’un code R. Bien rédiger son code est essentiel pour trois raisons&nbsp;:</p>
<ol type="1">
<li>Pouvoir relire et réutiliser son code dans le futur.</li>
<li>Permettre à d’autres personnes de bien lire et de réutiliser votre code.</li>
<li>Minimiser les risques d’erreurs.</li>
</ol>
<p>Ne négligez pas l’importance d’un code bien rédigé et bien documenté, vous vous éviterez ainsi des migraines lorsque vous devrez exhumer du code écrit il y a plusieurs mois.</p>
<p>Voici quelques lignes directrices peu contraignantes, mais qui devraient vous être utiles&nbsp;:</p>
<ol type="1">
<li>
<strong>Privilégier la clarté à la concision</strong>&nbsp;: il vaut mieux parfois scinder une ligne de code en plusieurs sous-étapes afin de faciliter la lecture de l’opération réalisée. Par exemple, si nous reprenons une ligne de code d’une section précédente où nous sélectionnions l’ensemble des colonnes du jeu de données <code>iris</code> comprenant le mot <code>Length</code>&nbsp;:</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris_l</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Length"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous pouvons simplifier la lecture de ce code en détaillant les différentes étapes comme suit&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">noms_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">sel_noms</span> <span class="op">&lt;-</span> <span class="va">noms_cols</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Length"</span>, <span class="va">noms_cols</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">iris_l</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="va">sel_noms</span><span class="op">]</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>
<strong>Documenter et commenter son code le plus possible</strong>&nbsp;: il est possible d’ajouter du texte dans un code R qui ne sera pas exécuté, ce que nous appelons des commentaires. Typiquement, une ligne commençant par un <code>#</code> n’est pas interprétée par le logiciel. Utilisez des commentaires le plus souvent possible pour décrire les actions que vous souhaitez effectuer avec votre code. Il sera ainsi plus facile de le relire, de naviguer dedans, mais également de repérer d’éventuelles erreurs. Si nous reprenons l’exemple précédent&nbsp;:</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb216"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Récupération du nom des colonnes dans le DataFrame iris</span></span>
<span><span class="va">noms_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="co"># Sélection des colonnes avec les caractères "Length"</span></span>
<span><span class="va">sel_noms</span> <span class="op">&lt;-</span> <span class="va">noms_cols</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Length"</span>, <span class="va">noms_cols</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># Extraction des colonnes sélectionnées dans un nouveau DataFrame</span></span>
<span><span class="va">iris_l</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="va">sel_noms</span><span class="op">]</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li><p><strong>Éviter le code à rallonge…</strong>&nbsp;: typiquement, essayez de vous limiter à des lignes de code d’une longueur maximale de 80 caractères. Au-delà de ce seuil, il est judicieux de découper votre code en plusieurs lignes.</p></li>
<li><p><strong>Adopter une convention d’écriture</strong>&nbsp;: une convention d’écriture est un ensemble de règles strictes définissant comment un code doit être rédigé. À titre d’exemple, il est parfois recommandé d’utiliser le <em>lowerCamelCase</em>, le <em>UpperCamelCase</em>, ou encore de séparer les mots par des tirets bas <em>upper_camel_case</em>. Un mélange de ces différentes conventions peut être utilisé pour distinguer les variables, les fonctions et les classes. Il peut être difficile de réellement arrêter une telle convention, car les différents <em>packages</em> dans R utilisent des conventions différentes. Dans vos propres codes, il est surtout important d’avoir une certaine cohérence et ne pas changer de convention.</p></li>
<li><p><strong>Indenter le code</strong>&nbsp;: l’indentation du code permet de le rendre beaucoup plus lisible. Indenter son code signifie d’insérer, au début de chaque ligne de code, un certain nombre d’espaces permettant d’indiquer à quel niveau de profondeur nous nous situons. Typiquement, lorsque des accolades ou des parenthèses sont ouvertes dans une fonction, une boucle ou une condition, nous rajoutons deux ou quatre espaces en début de ligne. Prenons un exemple très concret&nbsp;: admettons que nous écrivons une fonction affichant un résumé statistique à chaque colonne d’un jeu de données si cette colonne est de type numérique. L’indentation dans cette fonction joue un rôle crucial dans sa lisibilité. Sans indentation et sans respecter la règle des 80 caractères, nous obtenons ceci&nbsp;:</p></li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summary_all_num_cols</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span><span class="op">{</span><span class="kw">for</span><span class="op">(</span><span class="va">col</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="va">col</span><span class="op">]</span><span class="op">]</span> <span class="op">==</span> <span class="st">"numeric"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="va">col</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">}</span><span class="op">}</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Avec de l’indentation et des commentaires, la syntaxe est beaucoup plus lisible puisqu’elle permet de repérer facilement trois niveaux/paliers dans le code&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Définition d'une fonction</span></span>
<span><span class="va">summary_all_num_cols</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># Itération sur chaque colonne de la fonction</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">col</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co"># A chaque itération, testons si la colonne est de type numérique</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="va">col</span><span class="op">]</span><span class="op">]</span> <span class="op">==</span> <span class="st">"numeric"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="co"># Si oui, nous affichons un résumé statistique pour cette colonne</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[[</span><span class="va">col</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="co"># Ici nous sortons de la condition (niveau 3)</span></span>
<span>  <span class="op">}</span> <span class="co"># Ici nous sortons de la boucle (niveau 2)</span></span>
<span><span class="op">}</span> <span class="co"># Ici nous sortons de la fonction (niveau 1)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="6" type="1">
<li>
<strong>Adopter une structure globale pour vos scripts</strong>&nbsp;: un code R peut être comparé à une recette de cuisine. Si tous les éléments sont dans le désordre et sans structure globale, la recette risque d’être très difficile à suivre. Cette structure risque de changer quelque peu en fonction de la recette ou de l’auteur(e), mais les principaux éléments restent les mêmes. Dans un code R, nous pouvons distinguer plusieurs éléments récurrents que nous vous recommandons d’organiser de la façon suivante&nbsp;:</li>
</ol>
<ol type="a">
<li><p>Charger les différents <em>packages</em> <strong>utilisés</strong> par le script. Cela permet dès le début du code de savoir quelles sont les fonctions et méthodes qui seront employées dans le script. Cela limite aussi les risques d’oublier des <em>packages</em> qui seraient chargés plus loin dans le code.</p></li>
<li><p>Définir les fonctions dont vous aurez besoin en plus de celles présentes dans les <em>packages.</em> Idem, placer nos fonctions en début de code évite d’oublier de les charger ou de les chercher quand nous en avons besoin.</p></li>
<li><p>Définir le répertoire de travail avec la fonction <code>setwd</code> et charger les données nécessaires.</p></li>
<li><p>Effectuer au besoin les opérations de manipulation sur les données.</p></li>
<li><p>Effectuer les analyses nécessaires en scindant si possible les différentes étapes. Notez également que l’étape de définition des fonctions complémentaires peut être effectuée dans une feuille de code séparée, et l’ensemble de ces fonctions chargées à l’aide de la fonction <code>source</code>. De même, si la manipulation des données est conséquente, il est recommandé de l’effectuer avec un code à part, d’enregistrer les données structurées, puis de les charger directement au début de votre code dédié à l’analyse.</p></li>
</ol>
<ol start="7" type="1">
<li>
<strong>Exploiter les commentaires délimitant les sections dans RStudio</strong>&nbsp;: il est possible d’écrire des commentaires d’une certaine façon pour que l’IDE les détecte comme des délimiteurs de sections. L’intérêt principal est que nous pouvons ensuite facilement naviguer entre ces sections en utilisant RStudio comme montré à la <a href="#fig-sectionsRstudio">figure&nbsp;<span>1.17</span></a>, mais aussi masquer des sections afin de faciliter la lecture du reste du code. Pour délimiter une section, il suffit d’ajouter une ligne de commentaire comprenant quatre fois les caractères <code>-</code>, <code>=</code> ou <code>#</code> à la suite.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Voici ma section 1 ----------------------------------</span></span>
<span></span>
<span><span class="co"># Voici ma section 2 ==================================</span></span>
<span></span>
<span><span class="co"># Voici ma section 3 ##################################</span></span>
<span></span>
<span><span class="co"># Autre exemple pour mieux marquer la rupture dans un code : </span></span>
<span></span>
<span><span class="co">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span>
<span><span class="co">#### Titre de ma section 4 ####</span></span>
<span><span class="co">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-sectionsRstudio" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/sections_rstudio.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.17: Navigation dans des sections de codes avec RStudio</figcaption></figure>
</div>
<ol start="8" type="1">
<li>
<strong>Adopter une structure globale pour vos projets</strong>&nbsp;: au-delà du script, il est nécessaire de bien structurer vos projets, le plus important étant d’utiliser une structure commune à chaque projet pour vous faciliter le travail. Nous proposons à la <a href="#fig-structFolder">figure&nbsp;<span>1.18</span></a> un exemple de structure assez générale pouvant être utilisée dans la plupart des cas. Elle sépare notamment les données originales des données structurées, ainsi que les fonctions complémentaires et la structuration des données du principal bloc d’analyse.</li>
</ol>
<div id="fig-structFolder" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/structurationprojet.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.18: Structure de dossier recommandée pour un projet avec R</figcaption></figure>
</div>
<p><strong>Ne négligez jamais l’importance d’un code bien écrit et documenté !</strong></p>
</section><section id="sec-017" class="level2" data-number="1.6"><h2 data-number="1.6" class="anchored" data-anchor-id="sec-017">
<span class="header-section-number">1.6</span> Enregistrement des résultats</h2>
<p>Comme nous l’avons indiqué précédemment, l’ensemble des objets actuellement chargés dans votre session R sont perdus si vous la fermez. Cela peut être problématique si certains résultats nécessitent de longs temps de calcul ou si vous avez besoin de partager les objets obtenus avec d’autres personnes, mais pas le code pour les obtenir. Il est possible de retrouver les résultats d’une session précédente si ceux-ci ont été enregistrés sur votre disque dur puisque l’action d’enregistrer permet de faire passer vos objets présents dans votre mémoire vive dans des fichiers stockés sur votre disque dur. Vous pouvez pour cela utiliser la fonction <code>save.image</code> ou <code>save</code>.</p>
<p><code>save.image</code> enregistre une copie exacte de votre session actuelle avec tous les objets présents dans votre environnement dans un fichier <code>RData</code>. La fonction <code>save</code> permet d’être plus sélectif et de ne garder que certains objets spécifiques.</p>
<p>Voici la syntaxe pour enregistrer toute votre session&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html">save.image</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'chemin/vers/mon/fichier/session.RData'</span>, compress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vous pouvez aussi utiliser le bouton d’enregistrement dans l’onglet <em>Environnement</em> dans RStudio (<a href="#fig-saveobj">figure&nbsp;<span>1.19</span></a>).</p>
<div id="fig-saveobj" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/save_session.png" class="img-fluid figure-img" style="width:25.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.19: Bouton enregistrer la session</figcaption></figure>
</div>
<p>Il est recommandé de compresser ces fichiers (<code>compress = TRUE</code>) pour minimiser leur taille. Pour n’enregistrer que certains objets (ici <code>iris</code> et <code>noms_cols</code>), vous pouvez adapter cette syntaxe&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">iris</span>, <span class="va">noms_cols</span>, file <span class="op">=</span> <span class="st">'chemin/vers/mon/fichier/mes_objet.RData'</span>, compress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pour récupérer ces objets dans une autre session, il suffit d’utiliser la fonction <code>load</code>&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'chemin/vers/mon/fichier/mes_objet.RData'</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ou d’utiliser le bouton <em>ouvrir</em> de l’onglet <em>Environnement</em> dans RStudio (<a href="#fig-loadobj">figure&nbsp;<span>1.20</span></a>).</p>
<div id="fig-loadobj" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/chap01/load_session.png" class="img-fluid figure-img" style="width:25.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1.20: Bouton charger un fichier RDA</figcaption></figure>
</div>
</section><section id="sec-018" class="level2" data-number="1.7"><h2 data-number="1.7" class="anchored" data-anchor-id="sec-018">
<span class="header-section-number">1.7</span> Session de travail</h2>
<p>Comme vous avez pu le constater dans les sections <a href="#sec-017"><span>Section&nbsp;1.6</span></a> et <a href="#sec-0141"><span>Section&nbsp;1.4.1</span></a>, il est nécessaire de connaître les chemins vers les fichiers que vous souhaitez utiliser dans votre code R. Si tous ces fichiers sont organisés dans un même dossier (ce que nous vous recommandons à la <a href="#fig-structFolder">figure&nbsp;<span>1.18</span></a>, il est possible de définir un répertoire de travail avec la fonction <code>setwd</code>. Il est recommandé d’effectuer cette étape au début de votre code R, après le chargement des <em>packages</em>. Ainsi, vous n’aurez pas besoin de réécrire à chaque fois le chemin complet pour accéder à vos fichiers.</p>
<div class="cell">
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Chemin complet</span></span>
<span><span class="va">mes_donnes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"C:/projets/articles/2022/mon_projet/data/mes_donnes.csv"</span><span class="op">)</span></span>
<span><span class="co"># Utilisation de setwd</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="st">"C:/projets/articles/2022/mon_projet"</span><span class="op">)</span></span>
<span><span class="va">mes_donnes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/mes_donnes.csv"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La fonction <code>getwd</code> permet d’afficher le répertoire de travail utilisé actuellement par R.</p>
<p>Si vous utilisez RStudio, il est possible d’utiliser une petite astuce pour définir comme répertoire de travail le dossier dans lequel se trouve le fichier de code R que vous utilisez actuellement&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html">dirname</a></span><span class="op">(</span><span class="fu">rstudioapi</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/rstudioapi/reference/rstudio-editors.html">getActiveDocumentContext</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">path</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Admettons que votre code R se trouve dans un sous dossier appelé <em>CodeR</em> de votre répertoire de travail, vous pouvez remonter d’un niveau dans votre arborescence en utilisant la syntaxe suivante&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html">dirname</a></span><span class="op">(</span><span class="fu">rstudioapi</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/rstudioapi/reference/rstudio-editors.html">getActiveDocumentContext</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">path</span><span class="op">)</span>, <span class="st">"/.."</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Le double point (<code>..</code>) indique que nous souhaitons remonter dans le dossier parent du dossier dans lequel nous se trouvons acutellement.</p>
<p>Il existe deux solutions de rechange à l’utilisation de <code>setwd</code> que certains jugent un peu démodé.</p>
<ul>
<li>La première est le package <code>here</code> permettant de spécifier plus facilement des chemins relatifs et de définir un <em>top-level directory</em> pour votre projet.</li>
<li>La seconde est l’utilisation de la fonctionnalité <a href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects">projects</a> de RStudio.</li>
</ul></section><section id="sec-019" class="level2" data-number="1.8"><h2 data-number="1.8" class="anchored" data-anchor-id="sec-019">
<span class="header-section-number">1.8</span> Conclusion et ressources pertinentes</h2>
<p>Voilà qui conclut ce chapitre sur les bases du langage R. Vous avez maintenant les connaissances nécessaires pour commencer à travailler. N’hésitez pas à revenir sur les différentes sous-sections au besoin! Quelques ressources pertinentes qui pourraient vous être utiles sont aussi reportées au <a href="#tbl-tableRessources">tableau&nbsp;<span>1.7</span></a></p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-tableRessources" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;1.7: Ressources pertinente pour en apprendre plus sur R</caption>
<thead><tr class="header">
<th style="text-align: left;">Ressource</th>
<th style="text-align: left;">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://www.r-bloggers.com" target="_blank">Rbloggers</a></td>
<td style="text-align: left;">Un recueil de nombreux blogues sur R : parfait pour être tenu au courant des nouveautés et faire des découvertes.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://cran.r-project.org/web/packages/available_packages_by_date.html" target="_blank">CRAN packages by date</a></td>
<td style="text-align: left;">Les derniers packages publiés sur <em>CRAN</em> : cela permet de garder un oeil sur les nouvelles fonctionnalités de vos packages préférés.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://juba.github.io/tidyverse/index.html" target="_blank">Introduction à R et au TidyVerse</a></td>
<td style="text-align: left;">Une excellente ressource en français pour en apprendre plus sur le tidyverse.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://www.youtube.com/user/TheLearnR/featured" target="_blank">Numyard</a></td>
<td style="text-align: left;">Une chaîne YouTube pour revoir les bases de R en vidéo.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://rstudio.com/resources/cheatsheets" target="_blank">cheatsheets</a></td>
<td style="text-align: left;">Des feuilles de triche résumant les fonctionnalités de nombreux packages.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="sec-0110" class="level2" data-number="1.9"><h2 data-number="1.9" class="anchored" data-anchor-id="sec-0110">
<span class="header-section-number">1.9</span> Quiz de révision du chapitre</h2>
<div id="Chap01" class="card">
<link type="text/javascript" src="libs/quizlib.1.0.1.min.js">
<script>var Quiz=function(a,b){this.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),this.unansweredQuestionText="Question sans réponse !",this.container=document.getElementById(a),this.questions=[],this.result=new QuizResult,this.answers=b;for(var c=0;c<this.container.children.length;c++)this.container.children[c].classList.contains(Quiz.Classes.QUESTION)&&this.questions.push(this.container.children[c]);if(this.answers.length!=this.questions.length)throw new Error("Number of answers does not match number of questions!")};Quiz.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),Quiz.prototype.checkAnswers=function(a){void 0===a&&(a=!0);for(var b=[],c=[],d=0;d<this.questions.length;d++){var e=this.questions[d],f=this.answers[d],g=[];this.clearHighlights(e);for(var h,i=e.getElementsByClassName(Quiz.Classes.QUESTION_ANSWERS)[0].getElementsByTagName("input"),j=0;j<i.length;j++)h=i[j],"checkbox"===h.type||"radio"===h.type?h.checked&&g.push(h.value):""!==h.value&&g.push(h.value);1!=g.length||Array.isArray(f)?0===g.length&&b.push(e):g=g[0],c.push(Utils.compare(g,f))}if(0===b.length||!a)return this.result.setResults(c),!0;for(d=0;d<b.length;d++){var k=document.createElement("span");k.appendChild(document.createTextNode(this.unansweredQuestionText)),k.className=Quiz.Classes.QUESTION_WARNING,b[d].getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].appendChild(k)}return!1},Quiz.prototype.clearHighlights=function(a){for(var b=a.getElementsByClassName(Quiz.Classes.QUESTION_WARNING);b.length>0;)b[0].parentNode.removeChild(b[0]);var c,d=[a.getElementsByClassName(Quiz.Classes.CORRECT),a.getElementsByClassName(this.Classes.INCORRECT)];for(i=0;i<d.length;i++)for(;d[i].length>0;)c=d[i][0],c.classList.remove(Quiz.Classes.CORRECT),c.classList.remove(Quiz.Classes.INCORRECT);for(var e=a.getElementsByClassName(Quiz.Classes.TEMP);e.length>0;)e[0].parentNode.removeChild(e[0])},Quiz.prototype.highlightResults=function(a){for(var b,c=0;c<this.questions.length;c++)b=this.questions[c],b.getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].classList.add(this.result.results[c]?Quiz.Classes.CORRECT:Quiz.Classes.INCORRECT),void 0!==a&&a(this,b,c,this.result.results[c])};var QuizResult=function(){this.results=[],this.totalQuestions=0,this.score=0,this.scorePercent=0,this.scorePercentFormatted=0};QuizResult.prototype.setResults=function(a){this.results=a,this.totalQuestions=this.results.length,this.score=0;for(var b=0;b<this.results.length;b++)this.results[b]&&this.score++;this.scorePercent=this.score/this.totalQuestions,this.scorePercentFormatted=Math.floor(100*this.scorePercent)};var Utils=function(){};Utils.compare=function(a,b){if(a.length!=b.length)return!1;if(Array.isArray(a)&&Array.isArray(b)){for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b};

function showResults(quiz) {
    // Check answers and continue if all questions have been answered
    if (quiz.checkAnswers()) {
        var quizScorePercent = quiz.result.scorePercentFormatted; // The unformatted percentage is a decimal in range 0 - 1
        var quizResultElement = document.getElementById('quiz-result');
        quizResultElement.style.display = 'block';
        document.getElementById('quiz-percent').innerHTML = quizScorePercent.toString();

        // Change background colour of results div according to score percent
        if (quizScorePercent > 75) quizResultElement.style.backgroundColor = '#4caf50';
        else if (quizScorePercent > 50) quizResultElement.style.backgroundColor = '#ffc107';
        else if (quizScorePercent > 25) quizResultElement.style.backgroundColor = '#ff9800';
        else if (quizScorePercent > 0) quizResultElement.style.backgroundColor = '#f44336';

        // Highlight questions according to whether they were correctly answered. The callback allows us to highlight/show the correct answer
        quiz.highlightResults(handleAnswers);
    }
}

/** Callback for Quiz.highlightResults. Highlights the correct answers of incorrectly answered questions
 * Parameters are: the quiz object, the question element, question number, correctly answered flag
 */
function handleAnswers(quiz, question, no, correct) {
    if (!correct) {
        var answers = question.getElementsByTagName('input');
        for (var i = 0; i < answers.length; i++) {
            if (answers[i].type === 'checkbox' || answers[i].type === 'radio'){
                // If the current input element is part of the correct answer, highlight it
                if (quiz.answers[no].indexOf(answers[i].value) > -1) {
                    answers[i].parentNode.classList.add(Quiz.Classes.CORRECT);
                }
            } else {
                // If the input is anything other than a checkbox or radio button, show the correct answer next to the element
                var correctAnswer = document.createElement('span');
                correctAnswer.classList.add(Quiz.Classes.CORRECT);
                correctAnswer.classList.add(Quiz.Classes.TEMP); // quiz.checkAnswers will automatically remove elements with the temp class
                correctAnswer.innerHTML = quiz.answers[no];
                correctAnswer.style.marginLeft = '10px';
                answers[i].parentNode.insertBefore(correctAnswer, answers[i].nextSibling);
            }
        }
    }
}

  var quizz_Chap01;
  window.onload = function() {
    quizz_Chap01 = new Quiz('Chap01', ['4','2','2','1',['1', '2', '3'],'2','4']);
  };</script><link rel="stylesheet" type="text/css" src="css/quizlib.min.css">
<div class="card quizlib-question">
<div class="quizlib-question-title">
Avec quelle fonction peut-on sélectionner son répertoire de travail?
</div>
<div>
Relisez au besoin la <a href="#sec-018">section&nbsp;<span>1.7</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>get.wd</label>
</td>
<td>
<input type="radio" name="q1" value="1">
</td>
</tr>
<tr>
<td>
<label>set.wd</label>
</td>
<td>
<input type="radio" name="q1" value="2">
</td>
</tr>
<tr>
<td>
<label>setWd</label>
</td>
<td>
<input type="radio" name="q1" value="3">
</td>
</tr>
<tr>
<td>
<label>setwd</label>
</td>
<td>
<input type="radio" name="q1" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Installer RStudio est suffisant pour pouvoir utiliser R.
</div>
<div>
Relisez au besoin le début de la <a href="#sec-012">section&nbsp;<span>1.2</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Vrai</label>
</td>
<td>
<input type="radio" name="q2" value="1">
</td>
</tr>
<tr>
<td>
<label>Faux</label>
</td>
<td>
<input type="radio" name="q2" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Un package doit être réinstallé à chaque fois que l’on souhaite l’utiliser.
</div>
<div>
Relisez au besoin la <a href="#sec-0123">section&nbsp;<span>1.2.3</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Vrai</label>
</td>
<td>
<input type="radio" name="q3" value="1">
</td>
</tr>
<tr>
<td>
<label>Faux</label>
</td>
<td>
<input type="radio" name="q3" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
La brique de données élémentaire dans R est :
</div>
<div>
Relisez au besoin la <a href="#sec-0136">section&nbsp;<span>1.3.6</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Le vecteur</label>
</td>
<td>
<input type="radio" name="q4" value="1">
</td>
</tr>
<tr>
<td>
<label>Le DataFrame</label>
</td>
<td>
<input type="radio" name="q4" value="2">
</td>
</tr>
<tr>
<td>
<label>La liste</label>
</td>
<td>
<input type="radio" name="q4" value="3">
</td>
</tr>
<tr>
<td>
<label>La matrice</label>
</td>
<td>
<input type="radio" name="q4" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Un vecteur peut contenir :
</div>
<div>
Relisez au besoin la <a href="#sec-0136">section&nbsp;<span>1.3.6</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>uniquement des valeurs numériques</label>
</td>
<td>
<input type="checkbox" name="q5" value="1">
</td>
</tr>
<tr>
<td>
<label>uniquement des valeurs textuelles</label>
</td>
<td>
<input type="checkbox" name="q5" value="2">
</td>
</tr>
<tr>
<td>
<label>uniquement des valeurs booléennes</label>
</td>
<td>
<input type="checkbox" name="q5" value="3">
</td>
</tr>
<tr>
<td>
<label>des valeurs de types différents</label>
</td>
<td>
<input type="checkbox" name="q5" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
La jointure et la concaténation de DataFrames désignent exactement la même opération.
</div>
<div>
Relisez au besoin la <a href="#sec-01429">section&nbsp;<span>1.4.2.9</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Vrai</label>
</td>
<td>
<input type="radio" name="q6" value="1">
</td>
</tr>
<tr>
<td>
<label>Faux</label>
</td>
<td>
<input type="radio" name="q6" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Comparativement à une jointure complète, une jointure interne génère un DataFrame avec :
</div>
<div>
Relisez le deuxième encadré à la <a href="#sec-014292">section&nbsp;<span>1.4.2.9.2</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>nécessairement moins d’observations</label>
</td>
<td>
<input type="radio" name="q7" value="1">
</td>
</tr>
<tr>
<td>
<label>nécessairement plus d’observations</label>
</td>
<td>
<input type="radio" name="q7" value="2">
</td>
</tr>
<tr>
<td>
<label>au moins autant d’observations</label>
</td>
<td>
<input type="radio" name="q7" value="3">
</td>
</tr>
<tr>
<td>
<label>autant ou moins d’observations</label>
</td>
<td>
<input type="radio" name="q7" value="4">
</td>
</tr>
<tr>
<td>
<label>le même nombre d’observation</label>
</td>
<td>
<input type="radio" name="q7" value="5">
</td>
</tr>
</tbody></table>
</div>
</div>
<button type="button" onclick="showResults(quizz_Chap01);" id="buttonID">
Vérifier votre résultat
</button>
<div id="quiz-result" class="card">
<p><span id="quiz-percent"></span></p>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./00-auteurs.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">À propos des auteurs</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./02-univarie.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistiques descriptives univariées</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Méthodes quantitatives en sciences sociales : un grand bol d’R.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Ce livre a été réalisé avec <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>