<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Méthodes quantitatives en sciences sociales : un grand bol d’R - 5&nbsp; Relation entre deux variables qualitatives</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-bivarieeQualiQuanti.html" rel="next">
<link href="./04-bivarieeQuantiQuanti.html" rel="prev">
<link href="./images/introduction/Couverture.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="css/quizlib.min.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-bivarieeQualiQuali.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Relation entre deux variables qualitatives</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Recherche" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/SerieBoldR/MethodesQuantitatives" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Préface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-auteurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">À propos des auteurs</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 1. Découverte de R</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-priseenmainR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prise en main de R</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 2. Analyses univariées et représentations graphiques</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-univarie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistiques descriptives univariées</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-magiedesgraphiques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Magie des graphiques</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 3. Analyses bivariées</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-bivarieeQuantiQuanti.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Relation linéaire entre deux variables quantitatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-bivarieeQualiQuali.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Relation entre deux variables qualitatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-bivarieeQualiQuanti.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Relation entre une variable qualitative et une variable quantitative</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 4. Modèles de régression</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-regressionlineaire.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Régression linéaire multiple</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-GLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Régressions linéaires généralisées (GLM)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-GLMM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Régressions à effets mixtes (GLMM)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Multiniveau.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Régressions multiniveaux</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-GAM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modèles généralisés additifs</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 5. Analyses exploratoires multivariées</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-AnalysesFactorielles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Méthodes factorielles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-MethodeClassification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Méthodes de classification non supervisée</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 6. Annexes et bibliographie</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-Annexes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Annexes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliographie</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table des matières</h2>
   
  <ul>
<li><a href="#sec-051" id="toc-sec-051" class="nav-link active" data-scroll-target="#sec-051"><span class="header-section-number">5.1</span> Construction de tableau de contingence</a></li>
  <li><a href="#sec-052" id="toc-sec-052" class="nav-link" data-scroll-target="#sec-052"><span class="header-section-number">5.2</span> Test du khi-deux</a></li>
  <li><a href="#sec-053" id="toc-sec-053" class="nav-link" data-scroll-target="#sec-053"><span class="header-section-number">5.3</span> Mise en œuvre dans R</a></li>
  <li><a href="#sec-054" id="toc-sec-054" class="nav-link" data-scroll-target="#sec-054"><span class="header-section-number">5.4</span> Interprétation d’un tableau de contingence</a></li>
  <li><a href="#sec-055" id="toc-sec-055" class="nav-link" data-scroll-target="#sec-055"><span class="header-section-number">5.5</span> Quiz de révision du chapitre</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/SerieBoldR/MethodesQuantitatives/issues/new" class="toc-action">Signaler un problème ou<br>formuler une suggestion</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-chap05" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Relation entre deux variables qualitatives</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Dans le cadre de ce chapitre, nous présentons les deux principales méthodes permettant d’explorer les associations entre deux variables qualitatives&nbsp;: la construction d’un tableau de contingence et le test du khi-deux (<span class="math inline">\(\chi^2\)</span>, appelé aussi khi carré).</p>
<div class="bloc_package">
<div class="bloc_package-header">
<div class="bloc_package-icon">

</div>
<p><strong>Liste des <em>packages</em> utilisés dans ce chapitre</strong></p>
</div>
<div class="bloc_package-body">
<ul>
<li>
<code>gmodels</code> pour construire des tableaux de contingence.</li>
<li>
<code>vcd</code> pour construire un graphique pour un tableau de contingence.</li>
<li>
<code>DescTools</code> pour calculer le khi-deux de Mantel-Haenszel.</li>
<li>
<code>stargazer</code> pour imprimer des tableaux.</li>
</ul>
</div>
</div>
<div class="bloc_objectif">
<div class="bloc_objectif-header">
<div class="bloc_objectif-icon">

</div>
<p><strong>Deux variables qualitatives sont-elles associées entre elles?</strong></p>
</div>
<div class="bloc_objectif-body">
<p>Plus spécifiquement, certaines modalités d’une variable qualitative sont-elles associées significativement à certaines modalités d’une autre variable qualitative?</p>
<p>Prenons l’exemple de deux variables qualitatives&nbsp;: l’une intitulée <em>groupe d’âge</em> comprenant trois modalités (15 à 29 ans, 30 à 44 ans, 45 à 64 ans); l’autre intitulée <em>mode de transport habituel pour se rendre au travail</em> comprenant quatre modalités (véhicule motorisé, transport en commun, vélo, marche).</p>
<p>Comparativement aux deux autres groupes, nous pourrions supposer que les jeunes se déplacent proportionnellement plus en modes de transport actif (vélo et marche) et en transport en commun. À l’inverse, il est possible que les 45 à 64 ans se déplacent majoritairement en véhicules motorisés.</p>
<p>Pour vérifier l’existence d’associations significatives entre les modalités de deux variables qualitatives, il est possible de construire un <strong>tableau de contingence</strong> (<a href="#sec-051">section&nbsp;<span>5.1</span></a>), puis de réaliser le <strong>test du khi-deux</strong> (<a href="#sec-052">section&nbsp;<span>5.2</span></a>).</p>
</div>
</div>
<section id="sec-051" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="sec-051">
<span class="header-section-number">5.1</span> Construction de tableau de contingence</h2>
<p>Les données du tableau de contingence suivant décrivent 279 projets d’habitation à loyer modique (HLM) dans l’ancienne ville de Montréal, croisant les modalités de la période de construction (en colonne) et de la taille (en ligne) des projets HLM <span class="citation" data-cites="TheseApparicio">(<a href="references.html#ref-TheseApparicio" role="doc-biblioref">Apparicio 2002</a>)</span>. Les différents éléments du tableau sont décrits ci-dessous.</p>
<ul>
<li><p><strong>Les fréquences observées</strong> (<em>Count</em> au tableau ci-dessous), nommées communément <span class="math inline">\(f_{ij}\)</span>, correspondent aux observations appartenant à la fois à la <em>i<sup>e</sup></em> modalité de la variable en ligne et à la <em>j<sup>e</sup></em> modalité de la variable en colonne. À titre d’exemple, nous comptons 14 projets HLM construits entre 1985 et 1989 comprenant moins de 25 logements.</p></li>
<li><p><strong>Les marges</strong> du tableau sont les totaux pour chaque modalité en ligne (<span class="math inline">\(n_{i.}\)</span>) et en colonne (<span class="math inline">\(n_{j.}\)</span>). En guise d’exemple, sur les 279 projets HLM, 53 comprennent de 25 à 49 logements et 56 ont été construites entre 1968 et 1974. Bien entendu, la somme des marges en ligne (<span class="math inline">\(n_{i.}\)</span>) est égale au nombre total d’observations (<span class="math inline">\(n_{ij}\)</span>), tout comme la somme de marges en colonne (<span class="math inline">\(n_{.j}\)</span>).</p></li>
<li><p><strong>Trois pourcentages</strong> sont disponibles (total, en ligne, en colonne; <em>Total Percent</em>, <em>Row Percent</em> et <em>Column Percent</em> au tableau ci-dessous). Ils sont respectivement la fréquence observée divisée par le nombre d’observations (<span class="math inline">\(f_{ij}/n_{ij}\times100\)</span>), par la marge en ligne (<span class="math inline">\(f_{ij}/n_{i.} \times 100\)</span>) et en colonne (<span class="math inline">\(f_{ij}/n_{.j}\times100\)</span>). En guise d’exemple, 5&nbsp;% des 279 projets HLM ont été construites entre 1985 et 1989 et comprennent moins de 25 logements (pourcentage total, soit 14&nbsp;/&nbsp;279&nbsp;×&nbsp;100). Aussi, plus de la moitié des habitations de moins de 25 logements ont été construits entre 1990 et 1994 (pourcentage en ligne, 41&nbsp;/&nbsp;80&nbsp;×&nbsp;100). Finalement, près de 36&nbsp;% des logements construits avant 1975 ont 100&nbsp;logements et plus (20&nbsp;/&nbsp;56&nbsp;×&nbsp;100).</p></li>
<li><p><strong>Les fréquences théoriques</strong> (<em>Expected Values</em> au tableau ci-dessous), représentent les valeurs que l’on devrait observer théoriquement s’il y avait indépendance entre les modalités des deux variables; autrement dit, si la répartition des deux modalités des deux variables était dû au hasard. Pour le croisement de deux modalités, la fréquence théorique est égale au produit des marges divisé par le nombre total d’observations (<span class="math inline">\(ft_{ij} = (n_{i.}n_{.j})/n_{ij}\)</span>). Par exemple, la fréquence théorique pour le croisement des modalités <em>moins de 25 logements</em> et <em>avant 1975</em> est égale à&nbsp;: (80&nbsp;×&nbsp;56)&nbsp;/&nbsp;279&nbsp;=&nbsp;16,06. Nous observons ici que la valeur théorique (16,06) est bien supérieure à la valeur réelle (6). Nous avons donc moins de projets HLM de moins de 25&nbsp;logements avant 1975 auxquels nous pourrions nous attendre du hasard.</p></li>
<li><p><strong>La déviation</strong> (<em>Residual</em> au tableau ci-dessous) est la différence entre la fréquence observée et la fréquence théorique (<span class="math inline">\(f_{ij}-ft_{ij}\)</span>). Plus la déviation est grande, plus nous nous écartons d’une situation d’indépendance entre les deux modalités <em>i</em> et <em>j</em>. La somme des déviations sur une ligne ou sur une colonne est nulle. Si la déviation <em>ij</em> est nulle, la fréquence théorique est égale à la fréquence observée, ce qui signifie qu’il y a indépendance entre les modalités <em>i</em> et <em>j</em>. Une déviation positive traduit, quant à elle, une attraction entre les modalités <em>i</em> et <em>j</em> ou, autrement dit, une surreprésentation du phénomène <em>ij</em>; tandis qu’une déviation négative renvoie à une répulsion entre les modalités <em>i</em> et <em>j</em>, soit une sous-représentation du phénomène <em>ij</em>. Dans le cas précédent, nous observions six habitations de moins de 25&nbsp;logements construits avant 1975 et une fréquence théorique de 16,06. La déviation est donc -10,06, soit une sous-représentation du phénomène.</p></li>
<li><p><strong>La contribution au khi-deux</strong> (<em>Chi-square contribution</em> au tableau ci-dessous) est égale à la déviation au carré divisée par la fréquence théorique&nbsp;: <span class="math inline">\(\chi_{ij}^2 = (f_{ij}-ft_{ij})^2/ft_{ij}\)</span>. Plus sa valeur est forte, plus il y a association entre les deux modalités. La somme des contributions au khi-deux représente le khi-deux total pour l’ensemble du tableau de contingence (ici à 63,54), que nous aborderons dans la section suivante.</p></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
   Cell Contents
|-------------------------|
|                   Count |
|         Expected Values |
| Chi-square contribution |
|             Row Percent |
|          Column Percent |
|           Total Percent |
|                Residual |
|-------------------------|

Total Observations in Table:  279 

               | TabKhi2$Periode 
TabKhi2$Taille | Av. 1975  |  1975-79  |  1980-84  |  1985-89  |  1990-94  | Row Total | 
---------------|-----------|-----------|-----------|-----------|-----------|-----------|
     &lt; 25 log. |        6  |       11  |        8  |       14  |       41  |       80  | 
               |    16.06  |    13.76  |    13.76  |    13.48  |    22.94  |           | 
               |     6.30  |     0.55  |     2.41  |     0.02  |    14.22  |           | 
               |     7.50% |    13.75% |    10.00% |    17.50% |    51.25% |    28.67% | 
               |    10.71% |    22.92% |    16.67% |    29.79% |    51.25% |           | 
               |     2.15% |     3.94% |     2.87% |     5.02% |    14.70% |           | 
               |   -10.06  |    -2.76  |    -5.76  |     0.52  |    18.06  |           | 
---------------|-----------|-----------|-----------|-----------|-----------|-----------|
         25-49 |       10  |        5  |        8  |        8  |       22  |       53  | 
               |    10.64  |     9.12  |     9.12  |     8.93  |    15.20  |           | 
               |     0.04  |     1.86  |     0.14  |     0.10  |     3.05  |           | 
               |    18.87% |     9.43% |    15.09% |    15.09% |    41.51% |    19.00% | 
               |    17.86% |    10.42% |    16.67% |    17.02% |    27.50% |           | 
               |     3.58% |     1.79% |     2.87% |     2.87% |     7.89% |           | 
               |    -0.64  |    -4.12  |    -1.12  |    -0.93  |     6.80  |           | 
---------------|-----------|-----------|-----------|-----------|-----------|-----------|
         50-99 |       20  |       21  |       22  |       21  |       15  |       99  | 
               |    19.87  |    17.03  |    17.03  |    16.68  |    28.39  |           | 
               |     0.00  |     0.92  |     1.45  |     1.12  |     6.31  |           | 
               |    20.20% |    21.21% |    22.22% |    21.21% |    15.15% |    35.48% | 
               |    35.71% |    43.75% |    45.83% |    44.68% |    18.75% |           | 
               |     7.17% |     7.53% |     7.89% |     7.53% |     5.38% |           | 
               |     0.13  |     3.97  |     4.97  |     4.32  |   -13.39  |           | 
---------------|-----------|-----------|-----------|-----------|-----------|-----------|
      100 et + |       20  |       11  |       10  |        4  |        2  |       47  | 
               |     9.43  |     8.09  |     8.09  |     7.92  |    13.48  |           | 
               |    11.83  |     1.05  |     0.45  |     1.94  |     9.77  |           | 
               |    42.55% |    23.40% |    21.28% |     8.51% |     4.26% |    16.85% | 
               |    35.71% |    22.92% |    20.83% |     8.51% |     2.50% |           | 
               |     7.17% |     3.94% |     3.58% |     1.43% |     0.72% |           | 
               |    10.57  |     2.91  |     1.91  |    -3.92  |   -11.48  |           | 
---------------|-----------|-----------|-----------|-----------|-----------|-----------|
  Column Total |       56  |       48  |       48  |       47  |       80  |      279  | 
               |    20.07% |    17.20% |    17.20% |    16.85% |    28.67% |           | 
---------------|-----------|-----------|-----------|-----------|-----------|-----------|

 
Statistics for All Table Factors


Pearson's Chi-squared test 
------------------------------------------------------------
Chi^2 =  63.54291     d.f. =  12     p =  5.063109e-09 


 
       Minimum expected frequency: 7.917563 </code></pre>
</div>
</div>
</section><section id="sec-052" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="sec-052">
<span class="header-section-number">5.2</span> Test du khi-deux</h2>
<p>Avec le test du khi-deux, nous postulons qu’il y a indépendance entre les modalités des deux variables qualitatives, soit l’hypothèse nulle (<em>H<sub>0</sub></em>). Puis, nous calculons le nombre de degrés de liberté&nbsp;: <span class="math inline">\(DL = (n-1)(l-1)\)</span>, avec <span class="math inline">\(l\)</span> et <span class="math inline">\(n\)</span> étant respectivement les nombres de modalités en ligne et en colonne. Pour notre tableau de contingence, nous avons 12 degrés de liberté&nbsp;: <span class="math inline">\((4-1)(5-1)=12\)</span>.</p>
<p>À partir du nombre de degrés de liberté et d’un seuil critique de significativité (prenons 5&nbsp;% ici), nous pouvons trouver la valeur critique de khi-deux dans la table des valeurs critiques du khi-deux, soit 21,03 (<a href="14-Annexes.html#sec-141">section&nbsp;<span>14.1</span></a>). Puisque la valeur du khi-deux calculée dans le tableau de contingence (63,54) est bien supérieure à celle obtenue dans le tableau des valeurs critiques (21,03), nous pouvons rejeter l’hypothèse d’indépendance au seuil de 5&nbsp;%. Autrement dit, si les deux variables n’étaient pas associées, nous aurions eu moins de 5&nbsp;% de chances de collecter des données avec ce niveau d’association, ce qui nous permet de rejeter l’hypothèse nulle (absence d’association). Notez que le test reste significatif avec des seuils de 1&nbsp;% (<em>p</em>&nbsp;=&nbsp;0,01) et 0,1&nbsp;% (<em>p</em>&nbsp;=&nbsp;0,001) puisque les valeurs critiques sont de 26,22 et de 32,91.</p>
<p>Bien entendu, une fois que nous connaissons le nombre de degrés de liberté, nous pouvons directement calculer les valeurs critiques pour différents seuils de signification et éviter ainsi de recourir à la table du du khi-deux. Dans la même veine, nous pouvons aussi calculer la valeur de <em>p</em> d’un tableau de contingence en spécifiant le nombre de degrés de liberté et la valeur du khi-deux obtenue.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Valeurs critiques du khi-deux avec le nombre de degrés de liberté"</span>, <span class="st">"\n"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">qchisq</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">0.95</span>,  df<span class="op">=</span><span class="fl">12</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>, <span class="st">"avec p=0,05"</span>, <span class="st">"\n"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">qchisq</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">0.99</span>,  df<span class="op">=</span><span class="fl">12</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>, <span class="st">"avec p=0,01"</span>, <span class="st">"\n"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">qchisq</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">0.999</span>, df<span class="op">=</span><span class="fl">12</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>, <span class="st">"avec p=0,0001"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Valeurs critiques du khi-deux avec le nombre de degrés de liberté 
 5.226 avec p=0,05 
 3.571 avec p=0,01 
 2.214 avec p=0,0001</code></pre>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Valeur de p du khi-deux obtenu (63,54291) avec 12 degrés de liberté :"</span>, <span class="st">"\n"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span>q<span class="op">=</span><span class="fl">63.54291</span>, df<span class="op">=</span><span class="fl">12</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Valeur de p du khi-deux obtenu (63,54291) avec 12 degrés de liberté : 
 5.063101e-09</code></pre>
</div>
</div>
<div class="bloc_aller_loin">
<div class="bloc_aller_loin-header">
<div class="bloc_aller_loin-icon">

</div>
<p><strong>Autres mesures d’association</strong></p>
</div>
<div class="bloc_aller_loin-body">
<p>Outre le khi-deux, d’autres mesures d’association permettent de mesurer le degré d’association entre deux variables qualitatives. Les plus courantes sont reportées dans le <a href="#tbl-EncadreAsso">tableau&nbsp;<span>5.1</span></a>. À des fins de comparaison, le khi-deux décrit précédemment est aussi reporté sur la première ligne du tableau.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-EncadreAsso" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;5.1: Autres mesures d’association entre deux variables qualitatives</caption>
<thead><tr class="header">
<th style="text-align: left;">Statistique</th>
<th style="text-align: left;">Formule</th>
<th style="text-align: left;">Propriété et interprétation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Khi-deux</td>
<td style="text-align: left;"><span class="math inline">\(\chi^2 = \sum \frac{(f_{ij}-ft_{ij})^2}{ft_{ij}}\)</span></td>
<td style="text-align: left;">Mesure classique du khi-deux calculée à partir des différences entre les fréquences observées et attendues. Valeur de <em>p</em> disponible.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ratio de vraisemblance du khi-deux</td>
<td style="text-align: left;"><span class="math inline">\(G^2 = 2 \sum f_{ij} \ln{(\frac{f_{ij}}{ft_{ij}})}\)</span></td>
<td style="text-align: left;">Calculé à partir du ratio entre les fréquences observées et attendues. Valeur de <em>p</em> disponible.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">khi-deux de Mantel-Haenszel</td>
<td style="text-align: left;"><span class="math inline">\(Q_{MH}=(N−1)r^2\)</span></td>
<td style="text-align: left;">avec <em>r</em> étant le coefficient de corrélation entre les deux variables qualitatives; par exemple, entre les valeurs des modalités de 1 à 5 de la variable <em>période de construction</em> et celles de 1 à 4 de la variable <em>taille du projet</em> HLM. Ce coefficient est très utile quand les deux variables qualitatives ne sont pas nominales, mais <strong>ordinales</strong>. Valeur de <em>p</em> disponible.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrélation polychorique</td>
<td style="text-align: left;">Obtenue itérativement par maximum de vraisemblance</td>
<td style="text-align: left;">Dans le même esprit que le khi-deux de Mantel-Haenszel, la corrélation polychorique s’applique à deux variables <strong>ordinales</strong>. Plus spécifiquement, elle formule le postulat que deux variables théoriques normalement distribuées ont été mesurées de façon approximative avec deux échelles ordinales. Par exemple, en psychologie, le sentiment de bien-être et le sentiment de sécurité peuvent être conceptualisés comme deux variables continues normalement distribuées. Cependant, les mesurer directement est très difficile, nous avons donc recours à des échelles de Likert allant de 1 à 10. Pour cet exemple, il est pertinent d’utiliser la corrélation polychorique. Comme pour une corrélation de Pearson, la corrélation polychorique varie de -1 à 1, une valeur négative indiquant une relation inverse entre les deux variables théoriques et inversement. Valeur de <em>p</em> disponible.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Coefficient Phi</td>
<td style="text-align: left;"><span class="math inline">\(\phi=\sqrt{\frac{\chi^2}{n}}\)</span></td>
<td style="text-align: left;">Simplement le khi-deux divisé par le nombre d’observations. Si les deux variables qualitatives comprennent deux modalités chacune alors <span class="math inline">\(\phi\)</span> varie de −1 à 1; sinon, de 0 à <span class="math inline">\(min(\sqrt{c-1}, \sqrt{l-1})\)</span> avec <em>c</em> et <em>l</em> étant le nombre de modalités en colonne et en ligne. Par conséquent, ce coefficient est surtout utile pour les tableaux comprenant deux modalités pour chacune des variables. Pas de valeur de <em>p</em> disponible.</td>
</tr>
<tr class="even">
<td style="text-align: left;">V de Cramer</td>
<td style="text-align: left;"><span class="math inline">\(V=\sqrt{\frac{\chi^2/n}{min(c-1,l-1)}}\)</span></td>
<td style="text-align: left;">Il représente un ajustement du coefficient Phi et varie de 0 à 1. Plus sa valeur est forte, plus les deux variables sont associées. À la lecture des deux formules, vous constaterez que, pour un tableau de 2x2, la valeur du V de Carmer sera égale à celle du Coefficient Phi. Pas de valeur de <em>p</em> disponible.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section><section id="sec-053" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="sec-053">
<span class="header-section-number">5.3</span> Mise en œuvre dans R</h2>
<p>Pour calculer le khi-deux entre deux variables qualitatives, nous utilisons la fonction de base&nbsp;:</p>
<p><code>chisq.test(x = ..., y = ...)</code> qui renvoie le nombre de degrés de liberté, les valeurs du khi-deux et de <em>p</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Importation du csv</span></span>
<span><span class="va">dataHLM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/bivariee/hlm.csv"</span><span class="op">)</span></span>
<span><span class="co"># Calcul du khi-deux avec la fonction de base chisq.test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dataHLM</span><span class="op">$</span><span class="va">Taille</span>, y <span class="op">=</span> <span class="va">dataHLM</span><span class="op">$</span><span class="va">Periode</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  dataHLM$Taille and dataHLM$Periode
X-squared = 63.543, df = 12, p-value = 5.063e-09</code></pre>
</div>
</div>
<p>Pour la construction du tableau de contingence, deux options sont possibles dépendamment de la structure de votre tableau de données. Premier cas de figure&nbsp;: votre tableau comprend une ligne par observation avec les différentes modalités dans deux colonnes (ici <em>Periode</em> et <em>Taille</em>). Dans la syntaxe ci-dessous, pour chacune des deux variables qualitatives, nous créons un facteur afin de spécifier un intitulé à chaque modalité (<code>factor(levels =c(....), labels = c(..)</code>). Puis, nous utilisons la fonction <code>CrossTable</code> du <em>package</em> <code>gmodels</code>. Pour obtenir les fréquences théoriques, les contributions locales au khi-deux et les déviations, nous spécifions les options suivantes&nbsp;: <code>expected = TRUE, chisq=TRUE, resid=TRUE</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/r-gregmisc/gmodels">"gmodels"</a></span><span class="op">)</span></span>
<span><span class="co"># Premiers enregistrements du tableau</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataHLM</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Periode Taille
1       5      1
2       5      1
3       5      2
4       5      1
5       5      1
6       5      2</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># La variable Periode comprend 5 modalités (de 1 à 5)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dataHLM</span><span class="op">$</span><span class="va">Periode</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2  3  4  5 
56 48 48 47 80 </code></pre>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># La variable Taille comprend 4 modalités (de 1 à 4)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dataHLM</span><span class="op">$</span><span class="va">Taille</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2  3  4 
80 53 99 47 </code></pre>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Création d'un facteur pour les cinq modalités de la période de construction</span></span>
<span><span class="va">dataHLM</span><span class="op">$</span><span class="va">Periode</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dataHLM</span><span class="op">$</span><span class="va">Periode</span>, </span>
<span>                          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>, </span>
<span>                          labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"&lt;1975"</span>, </span>
<span>                                     <span class="st">"1975-1979"</span>, </span>
<span>                                     <span class="st">"1980-1984"</span>, </span>
<span>                                     <span class="st">"1985-1989"</span>, </span>
<span>                                     <span class="st">"1990-1994"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Création d'un facteur pour les quatre modalités de la taille des habitations</span></span>
<span><span class="va">dataHLM</span><span class="op">$</span><span class="va">Taille</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dataHLM</span><span class="op">$</span><span class="va">Taille</span>, </span>
<span>                         levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>                         labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"&lt;25 log."</span>, </span>
<span>                                    <span class="st">"25-49"</span>, </span>
<span>                                    <span class="st">"50-99"</span>, </span>
<span>                                    <span class="st">"100 et +"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Pour construire un tableau de contingence, nous utilisons </span></span>
<span><span class="co"># la fonction CrossTable du package gmodels. </span></span>
<span><span class="co"># Les deux lignes ci-dessous sont mises en commentaire pour ne pas répéter le tableau.</span></span>
<span><span class="co"># CrossTable(x=dataHLM$Taille, y = dataHLM$Periode, digits = 2,</span></span>
<span><span class="co">#           expected = TRUE, chisq = TRUE, resid = TRUE, format="SPSS")</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Deuxième cas de figure&nbsp;: vous disposez déjà d’un tableau de contingence, soit les fréquences observées (<span class="math inline">\(f_{ij}\)</span>). Nous n’utilisons donc pas la fonction <code>CrossTable</code>, mais directement la fonction <code>chisq.test</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Importation des données</span></span>
<span><span class="va">df1</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/bivariee/data_transport.csv"</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">df1</span> <span class="co"># Visualisation du tableau</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                    ModeTransport  Homme  Femme
1 Automobile, camion ou fourgonnette - conducteur 689400 561830
2   Automobile, camion ou fourgonnette - passager  21315  40010
3                             Transport en commun 181435 238330
4                                          A pied  43715  54360
5                                      Bicyclette  24295  13765
6                                     Autre moyen   8395   6970</code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Matrice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">df1</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Homme"</span> , <span class="st">"Femme"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">Matrice</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df1</span><span class="op">$</span><span class="va">ModeTransport</span><span class="op">)</span>, Sexe<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Homme"</span> , <span class="st">"Femme"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Notez que vous pouvez saisir vos données directement si vous avez peu d'observations</span></span>
<span><span class="va">Femme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">689400</span>, <span class="fl">21315</span>, <span class="fl">181435</span>, <span class="fl">43715</span>, <span class="fl">24295</span>, <span class="fl">8395</span><span class="op">)</span> <span class="co"># Vecteur de valeurs pour les femmes</span></span>
<span><span class="va">Homme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">561830</span>, <span class="fl">40010</span>, <span class="fl">238330</span>, <span class="fl">54360</span>, <span class="fl">13765</span>, <span class="fl">6970</span><span class="op">)</span> <span class="co"># Vecteur de valeurs pour les hommes</span></span>
<span><span class="va">Matrice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">as.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">Femme</span>, <span class="va">Homme</span><span class="op">)</span><span class="op">)</span> <span class="co"># Création du tableau</span></span>
<span><span class="co"># Nom des deux variables et de leurs modalités respectives</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">Matrice</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Transport<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Automobile (conducteur)"</span>,</span>
<span>                                      <span class="st">"Automobile (passager)"</span>,</span>
<span>                                      <span class="st">"Transport en commun"</span>,                            </span>
<span>                                      <span class="st">"À pied"</span>,</span>
<span>                                      <span class="st">"Bicyclette"</span>,</span>
<span>                                      <span class="st">"Autre moyen"</span><span class="op">)</span>,</span>
<span>                          Sexe<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Homme"</span> , <span class="st">"Femme"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Test du khi-deux</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">Matrice</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  Matrice
X-squared = 29134, df = 5, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Fréquences observées (Fij)</span></span>
<span><span class="va">test</span><span class="op">$</span><span class="va">observed</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Sexe
Transport                  Homme  Femme
  Automobile (conducteur) 689400 561830
  Automobile (passager)    21315  40010
  Transport en commun     181435 238330
  À pied                   43715  54360
  Bicyclette               24295  13765
  Autre moyen               8395   6970</code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Fréquences théoriques (FTij)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">expected</span>,<span class="fl">0</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Sexe
Transport                  Homme  Femme
  Automobile (conducteur) 643313 607917
  Automobile (passager)    31530  29795
  Transport en commun     215820 203945
  À pied                   50425  47650
  Bicyclette               19568  18492
  Autre moyen               7900   7465</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Déviations (Fij - FTij)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">observed</span><span class="op">-</span><span class="va">test</span><span class="op">$</span><span class="va">expected</span>,<span class="fl">0</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Sexe
Transport                  Homme  Femme
  Automobile (conducteur)  46087 -46087
  Automobile (passager)   -10215  10215
  Transport en commun     -34385  34385
  À pied                   -6710   6710
  Bicyclette                4727  -4727
  Autre moyen                495   -495</code></pre>
</div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Contributions au khi-deux</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">observed</span><span class="op">-</span><span class="va">test</span><span class="op">$</span><span class="va">expected</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="va">test</span><span class="op">$</span><span class="va">expected</span>,<span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Sexe
Transport                   Homme   Femme
  Automobile (conducteur) 3301.74 3493.98
  Automobile (passager)   3309.37 3502.05
  Transport en commun     5478.22 5797.18
  À pied                   892.81  944.80
  Bicyclette              1141.71 1208.19
  Autre moyen               31.04   32.85</code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Marges en ligne et en colonne</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">Matrice</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Homme  Femme 
968555 915265 </code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">Matrice</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Automobile (conducteur)   Automobile (passager)     Transport en commun 
                1251230                   61325                  419765 
                 À pied              Bicyclette             Autre moyen 
                  98075                   38060                   15365 </code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Grand total</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Matrice</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1883820</code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Pourcentages</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Matrice</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Matrice</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>,<span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Sexe
Transport                 Homme Femme
  Automobile (conducteur) 36.60 29.82
  Automobile (passager)    1.13  2.12
  Transport en commun      9.63 12.65
  À pied                   2.32  2.89
  Bicyclette               1.29  0.73
  Autre moyen              0.45  0.37</code></pre>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Pourcentages en ligne</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Matrice</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">Matrice</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>,<span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Sexe
Transport                 Homme Femme
  Automobile (conducteur) 55.10 44.90
  Automobile (passager)   34.76 65.24
  Transport en commun     43.22 56.78
  À pied                  44.57 55.43
  Bicyclette              63.83 36.17
  Autre moyen             54.64 45.36</code></pre>
</div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Pourcentages en colonne</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Matrice</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">Matrice</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>,<span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Sexe
Transport                 Homme Femme
  Automobile (conducteur) 71.18 58.01
  Automobile (passager)    2.33  4.37
  Transport en commun     18.73 24.61
  À pied                   4.78  5.94
  Bicyclette               2.51  1.42
  Autre moyen              0.92  0.76</code></pre>
</div>
</div>
<p>Pour obtenir les autres mesures d’association (<a href="#tbl-MesuresAssociations">tableau&nbsp;<span>5.2</span></a>), nous pourrons utiliser la syntaxe suivante&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/bivariee/hlm.csv"</span><span class="op">)</span></span>
<span><span class="co"># Fonction pour calculer les autres mesures d'association</span></span>
<span><span class="va">AutresMesuresKhi2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">testChi2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="co"># Calcul du khi-deux</span></span>
<span>  <span class="va">n</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">testChi2</span><span class="op">$</span><span class="va">observed</span><span class="op">)</span>  <span class="co"># Nombre d'observations</span></span>
<span>  <span class="va">nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">testChi2</span><span class="op">$</span><span class="va">observed</span><span class="op">)</span> <span class="co"># Nombre de colonnes</span></span>
<span>  <span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">testChi2</span><span class="op">$</span><span class="va">observed</span><span class="op">)</span> <span class="co"># Nombre de lignes</span></span>
<span>  <span class="va">dl</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">nc</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">l</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>            <span class="co"># Nombre de degrés de libertés</span></span>
<span>  <span class="va">chi2</span> <span class="op">&lt;-</span> <span class="va">testChi2</span><span class="op">$</span><span class="va">statistic</span>   <span class="co"># Valeur du khi-deux</span></span>
<span>  <span class="va">Pchi2</span> <span class="op">&lt;-</span> <span class="va">testChi2</span><span class="op">$</span><span class="va">p.value</span>    <span class="co"># P pour le khi-deux</span></span>
<span>  </span>
<span>  <span class="co">#Ratio de vraisemblance du khi-deux</span></span>
<span>  <span class="va">G</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">testChi2</span><span class="op">$</span><span class="va">observed</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">testChi2</span><span class="op">$</span><span class="va">observed</span><span class="op">/</span><span class="va">testChi2</span><span class="op">$</span><span class="va">expected</span><span class="op">)</span><span class="op">)</span> <span class="co"># G2</span></span>
<span>  <span class="va">PG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="va">G</span>, df<span class="op">=</span><span class="va">dl</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># P pour le G22</span></span>
<span>  </span>
<span>  <span class="co"># khi-deux de Mantel-Haenszel avec le package DescTools</span></span>
<span>  <span class="va">MHTest</span> <span class="op">&lt;-</span> <span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/MHChisqTest.html">MHChisqTest</a></span><span class="op">(</span><span class="va">testChi2</span><span class="op">$</span><span class="va">observed</span><span class="op">)</span></span>
<span>  <span class="va">MH</span> <span class="op">&lt;-</span> <span class="va">MHTest</span><span class="op">$</span><span class="va">statistic</span></span>
<span>  <span class="va">PMH</span> <span class="op">&lt;-</span> <span class="va">MHTest</span><span class="op">$</span><span class="va">p.value</span></span>
<span>  </span>
<span>  <span class="co"># Coefficient de correlation polychorique</span></span>
<span>  <span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"x"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 <span class="st">"y"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">polychoricCorr</span> <span class="op">&lt;-</span> <span class="fu">correlation</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/correlation/reference/cor_test.html">cor_test</a></span><span class="op">(</span><span class="va">df1</span>,<span class="st">"x"</span> , <span class="st">"y"</span>, method <span class="op">=</span> <span class="st">"polychoric"</span><span class="op">)</span></span>
<span>  <span class="va">polyR</span> <span class="op">&lt;-</span> <span class="va">polychoricCorr</span><span class="op">$</span><span class="va">rho</span></span>
<span>  <span class="va">polyP</span> <span class="op">&lt;-</span> <span class="va">polychoricCorr</span><span class="op">$</span><span class="va">p</span></span>
<span></span>
<span>  <span class="co"># Coefficient Phi et V de Cramer</span></span>
<span>  <span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">chi2</span><span class="op">/</span><span class="va">n</span><span class="op">)</span></span>
<span>  <span class="va">vc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">chi2</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">nc</span><span class="op">-</span><span class="fl">1</span>,<span class="va">l</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Tableau pour les résultats</span></span>
<span>  <span class="va">dfsortie</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>        Statistique <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Khi-deux"</span>, </span>
<span>                        <span class="st">"Ratio de vraisemblance du  khi-deux"</span>, </span>
<span>                        <span class="st">"Khi-deux de Mantel-Haenszel"</span>,</span>
<span>                        <span class="st">"Corrélation Polychorique"</span>,</span>
<span>                        <span class="st">"Coefficient de Phi"</span>,</span>
<span>                        <span class="st">"V de Cramer"</span><span class="op">)</span>, </span>
<span>        Valeur <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">chi2</span>, <span class="va">G</span>, <span class="va">MH</span>, <span class="va">polyR</span>, <span class="va">phi</span>, <span class="va">vc</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>        P <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Pchi2</span>, <span class="va">PG</span>, <span class="va">PMH</span>, <span class="va">polyP</span> , <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">dfsortie</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dfkhi2</span> <span class="op">&lt;-</span> <span class="fu">AutresMesuresKhi2</span><span class="op">(</span><span class="va">df1</span><span class="op">$</span><span class="va">Periode</span>, <span class="va">df1</span><span class="op">$</span><span class="va">Taille</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Impression du tableau avec le package stargazer</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stargazer</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/stargazer/man/stargazer.html">stargazer</a></span><span class="op">(</span><span class="va">dfkhi2</span>, type <span class="op">=</span> <span class="st">"text"</span>, summary <span class="op">=</span> <span class="cn">FALSE</span>, rownames <span class="op">=</span> <span class="cn">FALSE</span>, align <span class="op">=</span> <span class="cn">FALSE</span>, digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>          title <span class="op">=</span> <span class="st">"Mesures d'association entre les deux variables qualitatives"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-MesuresAssociations" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;5.2: Mesures d’association entre deux variables qualitatives</caption>
<thead><tr class="header">
<th style="text-align: left;">Statistique</th>
<th style="text-align: right;">Valeur</th>
<th style="text-align: right;">P</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Khi-deux</td>
<td style="text-align: right;">63.543</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ratio de vraisemblance du khi-deux</td>
<td style="text-align: right;">67.286</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Khi-deux de Mantel-Haenszel</td>
<td style="text-align: right;">48.486</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrélation Polychorique</td>
<td style="text-align: right;">-0.479</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Coefficient de Phi</td>
<td style="text-align: right;">0.477</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">V de Cramer</td>
<td style="text-align: right;">0.276</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="sec-054" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="sec-054">
<span class="header-section-number">5.4</span> Interprétation d’un tableau de contingence</h2>
<p>Nous vous proposons une démarche très simple pour vérifier l’association entre deux variables qualitatives avec les deux étapes suivantes&nbsp;:</p>
<ul>
<li><p>Nous posons l’hypothèse nulle (<em>H<sub>0</sub></em>), soit l’indépendance entre les deux variables.</p></li>
<li><p>Si la valeur du khi-deux total du tableau de contingence est inférieure à la valeur critique du khi-deux avec <em>p</em>&nbsp;=&nbsp;0,05 et le nombre de degrés de liberté de la table des valeurs critiques de khi-deux, alors il y a bien indépendance. La valeur de <em>p</em> est alors supérieure à 0,05. <strong>L’analyse s’arrête donc là!</strong> Autrement dit, il n’est pas nécessaire d’analyser le contenu de votre tableau de contingence puisqu’il n’y a pas d’association significative entre les modalités des deux variables. Vous pouvez simplement signaler que selon les résultats du test du khi-deux, il n’y a pas d’association significative entre les deux variables (<span class="math inline">\(\chi\)</span> = … avec <em>p</em> = …).</p></li>
<li><p>S’il y a dépendance (<span class="math inline">\(khi_{observé}^2 &gt; khi_{critique}^2\)</span>), trouvez les cellules <em>ij</em> où les contributions au khi-deux sont les plus fortes, c’est-à-dire où les associations entre les modalités <em>i</em> de la variable en ligne et les modalités <em>j</em> de la variable en colonne sont les plus marquées. Pour ces cellules, le phénomène <em>ij</em> est surreprésenté si la déviation est positive ou sous-représenté si la déviation est négative. Commentez ces associations et utilisez les pourcentages en ligne ou en colonne pour appuyer vos propos.</p></li>
</ul>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>Repérer les contributions au khi-deux les plus importantes</strong></p>
</div>
<div class="bloc_astuce-body">
<p>Pour repérer rapidement les cellules où les contributions au khi-deux sont les plus fortes, vous pouvez construire un graphique avec la fonction <code>mosaic</code> du <em>package</em> <code>vcd</code>. À la <a href="#fig-VDC">figure&nbsp;<span>5.1</span></a>, la taille des rectangles représente les effectifs entre les deux modalités tandis que les associations sont représentées comme suit&nbsp;: en gris lorsqu’elles ne sont pas significatives, en rouge pour des déviations significatives et négatives et en bleu pour des déviations significatives et positives.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">vcd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vcd/man/mosaic.html">mosaic</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Taille</span><span class="op">+</span><span class="va">Periode</span>, </span>
<span>         data <span class="op">=</span> <span class="va">dataHLM</span>, shade <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         labeling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vcd/man/labeling_border.html">labeling_border</a></span><span class="op">(</span>rot_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">45</span>, <span class="fl">90</span><span class="op">)</span>,</span>
<span>         just_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"center"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-VDC" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="05-bivarieeQualiQuali_files/figure-html/fig-VDC-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.1: Figure avec la fonction mosaic du package vcd</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
<p><strong>Exemple d’interprétation.</strong> «&nbsp;Les résultats du test du khi-deux signalent qu’il existe des associations entre les modalités de la taille et de la période de construction des projets d’habitation (<span class="math inline">\(\chi\)</span>&nbsp;=&nbsp;63,5, <em>p</em>&nbsp;&lt;&nbsp;0,001). Les fortes contributions au khi-deux et le signe positif ou négatif des déviations correspondantes permettent de repérer cinq associations majeures entre les modalités de taille et de période de construction des projets HLM&nbsp;: <strong>1)</strong> la répulsion entre les projets d’habitation de moins de 25 logements et la période de construction 1964-1974; <strong>2)</strong> l’attraction entre les projets d’habitation de 100&nbsp;logements et plus et la période de construction de 1969-1974; <strong>3)</strong> l’attraction entre les projets d’habitation de moins de 25 logements et la période de construction de 1990-1994; <strong>4)</strong> la répulsion entre les projets d’habitation de 50 à 99 logements et la période de construction 1990-1994; <strong>5)</strong> la répulsion entre les projets d’habitation de 100&nbsp;logements et plus et la période de construction 1990-1994. On observe donc une tendance bien marquée dans l’évolution du type de construction entre 1970 et 1994&nbsp;: entre 1969 et 1974, on a construit de grandes habitations dépassant souvent 100 logements; du milieu des années 1970 à la fin des années 1980, on privilégie la construction d’habitations de taille plus modeste, entre 50 et 100 logements; tandis qu’au début des années 1990, on opte plutôt pour des habitations de taille réduite (moins de 50 logements). Quelques chiffres à l’appui&nbsp;: sur les 56 habitations réalisées entre 1969 et 1974, 20 ont plus de 100 logements, 20 comprennent entre 50 et 99 logements et seules 10 ont moins de 25 logements. Près de la moitié des habitations construites entre 1975 et 1989 regroupent 50 à 99 logements (43,8&nbsp;% pour la période 1975-1979, 45,8&nbsp;% pour 1980-1984 et 44,7&nbsp;% pour 1985-1989). Par contre, 51&nbsp;% des habitations érigés à partir de 1990 disposent de moins de 25 logements&nbsp;» (<span class="citation" data-cites="TheseApparicio">Apparicio (<a href="references.html#ref-TheseApparicio" role="doc-biblioref">2002</a>)</span>, p.&nbsp;117-118). Notez que cette évolution décroissante est aussi soutenue par le coefficient négatif de la corrélation polychorique.</p>
<p>Vous pouvez aussi construire un graphique pour appuyer vos constats, soit avec les pourcentages en ligne ou en colonne (<a href="#fig-hml">figure&nbsp;<span>5.2</span></a> tirée de <span class="citation" data-cites="TheseApparicio">Apparicio (<a href="references.html#ref-TheseApparicio" role="doc-biblioref">2002</a>)</span>).</p>
<div id="fig-hml" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap05/figurehlm.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;5.2: Taille des projets d’habitation à loyer modique selon la période de construction</figcaption></figure>
</div>
<p><strong>Comment rapporter succinctement les résultats d’un test du khi-deux?</strong></p>
<p>Le test du khi-deux a été réalisé pour examiner la relation entre la taille et la période de construction des habitations HLM. Cette relation est significative&nbsp;: <span class="math inline">\(\chi^2\)</span>(12, N&nbsp;=&nbsp;279)&nbsp;=&nbsp;63,5, <em>p</em>&nbsp;&lt;&nbsp;0,001. Plus les projets ont été construites récemment, plus ils sont de taille réduite.</p>
<p>Pour un texte en anglais, consultez <a href="https://www.socscistatistics.com/tutorials/chisquare/default.aspx" target="_blank">https://www.socscistatistics.com/tutorials/chisquare/default.aspx</a>.</p>
</section><section id="sec-055" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="sec-055">
<span class="header-section-number">5.5</span> Quiz de révision du chapitre</h2>
<div id="Chapitre5_QualiQuali" class="card">
<link type="text/javascript" src="libs/quizlib.1.0.1.min.js">
<script>var Quiz=function(a,b){this.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),this.unansweredQuestionText="Question sans réponse !",this.container=document.getElementById(a),this.questions=[],this.result=new QuizResult,this.answers=b;for(var c=0;c<this.container.children.length;c++)this.container.children[c].classList.contains(Quiz.Classes.QUESTION)&&this.questions.push(this.container.children[c]);if(this.answers.length!=this.questions.length)throw new Error("Number of answers does not match number of questions!")};Quiz.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),Quiz.prototype.checkAnswers=function(a){void 0===a&&(a=!0);for(var b=[],c=[],d=0;d<this.questions.length;d++){var e=this.questions[d],f=this.answers[d],g=[];this.clearHighlights(e);for(var h,i=e.getElementsByClassName(Quiz.Classes.QUESTION_ANSWERS)[0].getElementsByTagName("input"),j=0;j<i.length;j++)h=i[j],"checkbox"===h.type||"radio"===h.type?h.checked&&g.push(h.value):""!==h.value&&g.push(h.value);1!=g.length||Array.isArray(f)?0===g.length&&b.push(e):g=g[0],c.push(Utils.compare(g,f))}if(0===b.length||!a)return this.result.setResults(c),!0;for(d=0;d<b.length;d++){var k=document.createElement("span");k.appendChild(document.createTextNode(this.unansweredQuestionText)),k.className=Quiz.Classes.QUESTION_WARNING,b[d].getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].appendChild(k)}return!1},Quiz.prototype.clearHighlights=function(a){for(var b=a.getElementsByClassName(Quiz.Classes.QUESTION_WARNING);b.length>0;)b[0].parentNode.removeChild(b[0]);var c,d=[a.getElementsByClassName(Quiz.Classes.CORRECT),a.getElementsByClassName(this.Classes.INCORRECT)];for(i=0;i<d.length;i++)for(;d[i].length>0;)c=d[i][0],c.classList.remove(Quiz.Classes.CORRECT),c.classList.remove(Quiz.Classes.INCORRECT);for(var e=a.getElementsByClassName(Quiz.Classes.TEMP);e.length>0;)e[0].parentNode.removeChild(e[0])},Quiz.prototype.highlightResults=function(a){for(var b,c=0;c<this.questions.length;c++)b=this.questions[c],b.getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].classList.add(this.result.results[c]?Quiz.Classes.CORRECT:Quiz.Classes.INCORRECT),void 0!==a&&a(this,b,c,this.result.results[c])};var QuizResult=function(){this.results=[],this.totalQuestions=0,this.score=0,this.scorePercent=0,this.scorePercentFormatted=0};QuizResult.prototype.setResults=function(a){this.results=a,this.totalQuestions=this.results.length,this.score=0;for(var b=0;b<this.results.length;b++)this.results[b]&&this.score++;this.scorePercent=this.score/this.totalQuestions,this.scorePercentFormatted=Math.floor(100*this.scorePercent)};var Utils=function(){};Utils.compare=function(a,b){if(a.length!=b.length)return!1;if(Array.isArray(a)&&Array.isArray(b)){for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b};

function showResults(quiz) {
    // Check answers and continue if all questions have been answered
    if (quiz.checkAnswers()) {
        var quizScorePercent = quiz.result.scorePercentFormatted; // The unformatted percentage is a decimal in range 0 - 1
        var quizResultElement = document.getElementById('quiz-result');
        quizResultElement.style.display = 'block';
        document.getElementById('quiz-percent').innerHTML = quizScorePercent.toString();

        // Change background colour of results div according to score percent
        if (quizScorePercent > 75) quizResultElement.style.backgroundColor = '#4caf50';
        else if (quizScorePercent > 50) quizResultElement.style.backgroundColor = '#ffc107';
        else if (quizScorePercent > 25) quizResultElement.style.backgroundColor = '#ff9800';
        else if (quizScorePercent > 0) quizResultElement.style.backgroundColor = '#f44336';

        // Highlight questions according to whether they were correctly answered. The callback allows us to highlight/show the correct answer
        quiz.highlightResults(handleAnswers);
    }
}

/** Callback for Quiz.highlightResults. Highlights the correct answers of incorrectly answered questions
 * Parameters are: the quiz object, the question element, question number, correctly answered flag
 */
function handleAnswers(quiz, question, no, correct) {
    if (!correct) {
        var answers = question.getElementsByTagName('input');
        for (var i = 0; i < answers.length; i++) {
            if (answers[i].type === 'checkbox' || answers[i].type === 'radio'){
                // If the current input element is part of the correct answer, highlight it
                if (quiz.answers[no].indexOf(answers[i].value) > -1) {
                    answers[i].parentNode.classList.add(Quiz.Classes.CORRECT);
                }
            } else {
                // If the input is anything other than a checkbox or radio button, show the correct answer next to the element
                var correctAnswer = document.createElement('span');
                correctAnswer.classList.add(Quiz.Classes.CORRECT);
                correctAnswer.classList.add(Quiz.Classes.TEMP); // quiz.checkAnswers will automatically remove elements with the temp class
                correctAnswer.innerHTML = quiz.answers[no];
                correctAnswer.style.marginLeft = '10px';
                answers[i].parentNode.insertBefore(correctAnswer, answers[i].nextSibling);
            }
        }
    }
}

  var quizz_Chapitre5_QualiQuali;
  window.onload = function() {
    quizz_Chapitre5_QualiQuali = new Quiz('Chapitre5_QualiQuali', ['4',['1', '2', '3', '4', '6'],'1','1']);
  };</script><link rel="stylesheet" type="text/css" src="css/quizlib.min.css">
<div class="card quizlib-question">
<div class="quizlib-question-title">
Pour analyser la relation entre deux variables qualitatives, vous utilisez :
</div>
<div>
Relisez au besoin l’introduction du <a href="#sec-chap05">chapitre&nbsp;<span>5</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>la covariance</label>
</td>
<td>
<input type="radio" name="q1" value="1">
</td>
</tr>
<tr>
<td>
<label>la régression linéaire simple</label>
</td>
<td>
<input type="radio" name="q1" value="2">
</td>
</tr>
<tr>
<td>
<label>le coefficient de corrélation de Pearson</label>
</td>
<td>
<input type="radio" name="q1" value="3">
</td>
</tr>
<tr>
<td>
<label>un tableau de continence et un test du khi2</label>
</td>
<td>
<input type="radio" name="q1" value="4">
</td>
</tr>
<tr>
<td>
<label>le coefficient de corrélation de Spearman</label>
</td>
<td>
<input type="radio" name="q1" value="5">
</td>
</tr>
<tr>
<td>
<label>un compteur Geiger</label>
</td>
<td>
<input type="radio" name="q1" value="6">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Dans un tableau de contingence, quels sont les éléments disponibles?
</div>
<div>
Relisez au besoin la <a href="#sec-051">section&nbsp;<span>5.1</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Fréquences théoriques</label>
</td>
<td>
<input type="checkbox" name="q2" value="1">
</td>
</tr>
<tr>
<td>
<label>Fréquences observées</label>
</td>
<td>
<input type="checkbox" name="q2" value="2">
</td>
</tr>
<tr>
<td>
<label>Trois pourcentages (total, en lignes et en colonnes)</label>
</td>
<td>
<input type="checkbox" name="q2" value="3">
</td>
</tr>
<tr>
<td>
<label>Déviations</label>
</td>
<td>
<input type="checkbox" name="q2" value="4">
</td>
</tr>
<tr>
<td>
<label>Variance</label>
</td>
<td>
<input type="checkbox" name="q2" value="5">
</td>
</tr>
<tr>
<td>
<label>Contributions au khi-deux</label>
</td>
<td>
<input type="checkbox" name="q2" value="6">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
La corrélation polychorique est particulièrement bien adaptée pour mesurer l’association entre deux variables qualitatives :
</div>
<div>
Relisez au besoin l’encadré à la <a href="#sec-052">section&nbsp;<span>5.2</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>ordinales</label>
</td>
<td>
<input type="radio" name="q3" value="1">
</td>
</tr>
<tr>
<td>
<label>nominales</label>
</td>
<td>
<input type="radio" name="q3" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
S’il y a indépendance entre les deux variables qualitatives (khi-deux observé inférieur au khi-deux critique), il n’est pas nécessaire d’analyser en détail le tableau de contingence.
</div>
<div>
Relisez au besoin la <a href="#sec-054">section&nbsp;<span>5.4</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Vrai</label>
</td>
<td>
<input type="radio" name="q4" value="1">
</td>
</tr>
<tr>
<td>
<label>Faux</label>
</td>
<td>
<input type="radio" name="q4" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<button type="button" onclick="showResults(quizz_Chapitre5_QualiQuali);" id="buttonID">
Vérifier votre résultat
</button>
<div id="quiz-result" class="card">
<p><span id="quiz-percent"></span></p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-TheseApparicio" class="csl-entry" role="listitem">
Apparicio, Philippe. 2002. <span>«&nbsp;Apport des syst<span>è</span>mes d’information g<span>é</span>ographique <span>à</span> l’<span>é</span>tude de l’insertion des HLM dans les quartiers montr<span>é</span>alais.&nbsp;»</span> Thèse de doctorat, Université du Maine. <a href="http://www.theses.fr/2002LEMA3007">http://www.theses.fr/2002LEMA3007</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./04-bivarieeQuantiQuanti.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Relation linéaire entre deux variables quantitatives</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-bivarieeQualiQuanti.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Relation entre une variable qualitative et une variable quantitative</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Méthodes quantitatives en sciences sociales : un grand bol d’R.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Ce livre a été réalisé avec <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>