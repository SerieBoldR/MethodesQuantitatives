<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Méthodes quantitatives en sciences sociales : un grand bol d’R - 2&nbsp; Statistiques descriptives univariées</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-magiedesgraphiques.html" rel="next">
<link href="./01-priseenmainR.html" rel="prev">
<link href="./images/introduction/Couverture.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="css/quizlib.min.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-univarie.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistiques descriptives univariées</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Recherche" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/SerieBoldR/MethodesQuantitatives" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Préface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-auteurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">À propos des auteurs</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 1. Découverte de R</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-priseenmainR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prise en main de R</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 2. Analyses univariées et représentations graphiques</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-univarie.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistiques descriptives univariées</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-magiedesgraphiques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Magie des graphiques</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 3. Analyses bivariées</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-bivarieeQuantiQuanti.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Relation linéaire entre deux variables quantitatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-bivarieeQualiQuali.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Relation entre deux variables qualitatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-bivarieeQualiQuanti.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Relation entre une variable qualitative et une variable quantitative</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 4. Modèles de régression</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-regressionlineaire.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Régression linéaire multiple</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-GLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Régressions linéaires généralisées (GLM)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-GLMM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Régressions à effets mixtes (GLMM)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Multiniveau.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Régressions multiniveaux</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-GAM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modèles généralisés additifs</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 5. Analyses exploratoires multivariées</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-AnalysesFactorielles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Méthodes factorielles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-MethodeClassification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Méthodes de classification non supervisée</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 6. Annexes et bibliographie</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-Annexes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Annexes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliographie</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table des matières</h2>
   
  <ul>
<li>
<a href="#sec-021" id="toc-sec-021" class="nav-link active" data-scroll-target="#sec-021"><span class="header-section-number">2.1</span> Notion et types de variable</a>
  <ul class="collapse">
<li><a href="#sec-0211" id="toc-sec-0211" class="nav-link" data-scroll-target="#sec-0211"><span class="header-section-number">2.1.1</span> Notion de variable</a></li>
  <li><a href="#sec-0212" id="toc-sec-0212" class="nav-link" data-scroll-target="#sec-0212"><span class="header-section-number">2.1.2</span> Types de variables</a></li>
  </ul>
</li>
  <li>
<a href="#sec-022" id="toc-sec-022" class="nav-link" data-scroll-target="#sec-022"><span class="header-section-number">2.2</span> Types de données</a>
  <ul class="collapse">
<li><a href="#sec-0221" id="toc-sec-0221" class="nav-link" data-scroll-target="#sec-0221"><span class="header-section-number">2.2.1</span> Données secondaires <em>versus</em> données primaires</a></li>
  <li><a href="#sec-0222" id="toc-sec-0222" class="nav-link" data-scroll-target="#sec-0222"><span class="header-section-number">2.2.2</span> Données transversales <em>versus</em> données longitudinales</a></li>
  <li><a href="#sec-0223" id="toc-sec-0223" class="nav-link" data-scroll-target="#sec-0223"><span class="header-section-number">2.2.3</span> Données spatiales versus données aspatiales</a></li>
  <li><a href="#sec-0224" id="toc-sec-0224" class="nav-link" data-scroll-target="#sec-0224"><span class="header-section-number">2.2.4</span> Données individuelles <em>versus</em> données agrégées</a></li>
  </ul>
</li>
  <li>
<a href="#sec-023" id="toc-sec-023" class="nav-link" data-scroll-target="#sec-023"><span class="header-section-number">2.3</span> Statistique descriptive et statistique inférentielle</a>
  <ul class="collapse">
<li><a href="#sec-0231" id="toc-sec-0231" class="nav-link" data-scroll-target="#sec-0231"><span class="header-section-number">2.3.1</span> Population, échantillon et inférence</a></li>
  <li><a href="#sec-0232" id="toc-sec-0232" class="nav-link" data-scroll-target="#sec-0232"><span class="header-section-number">2.3.2</span> Deux grandes familles de méthodes statistiques</a></li>
  </ul>
</li>
  <li>
<a href="#sec-024" id="toc-sec-024" class="nav-link" data-scroll-target="#sec-024"><span class="header-section-number">2.4</span> Notion de distribution</a>
  <ul class="collapse">
<li><a href="#d%C3%A9finition-g%C3%A9n%C3%A9rale" id="toc-définition-générale" class="nav-link" data-scroll-target="#d%C3%A9finition-g%C3%A9n%C3%A9rale"><span class="header-section-number">2.4.1</span> Définition générale</a></li>
  <li><a href="#anatomie-dune-distribution" id="toc-anatomie-dune-distribution" class="nav-link" data-scroll-target="#anatomie-dune-distribution"><span class="header-section-number">2.4.2</span> Anatomie d’une distribution</a></li>
  <li><a href="#principales-distributions" id="toc-principales-distributions" class="nav-link" data-scroll-target="#principales-distributions"><span class="header-section-number">2.4.3</span> Principales distributions</a></li>
  <li><a href="#conclusion-sur-les-distributions" id="toc-conclusion-sur-les-distributions" class="nav-link" data-scroll-target="#conclusion-sur-les-distributions"><span class="header-section-number">2.4.4</span> Conclusion sur les distributions</a></li>
  </ul>
</li>
  <li>
<a href="#sec-025" id="toc-sec-025" class="nav-link" data-scroll-target="#sec-025"><span class="header-section-number">2.5</span> Statistiques descriptives sur des variables quantitatives</a>
  <ul class="collapse">
<li><a href="#sec-0251" id="toc-sec-0251" class="nav-link" data-scroll-target="#sec-0251"><span class="header-section-number">2.5.1</span> Paramètres de tendance centrale</a></li>
  <li><a href="#sec-0252" id="toc-sec-0252" class="nav-link" data-scroll-target="#sec-0252"><span class="header-section-number">2.5.2</span> Paramètres de position</a></li>
  <li><a href="#sec-0253" id="toc-sec-0253" class="nav-link" data-scroll-target="#sec-0253"><span class="header-section-number">2.5.3</span> Paramètres de dispersion</a></li>
  <li><a href="#sec-0254" id="toc-sec-0254" class="nav-link" data-scroll-target="#sec-0254"><span class="header-section-number">2.5.4</span> Paramètres de forme</a></li>
  <li><a href="#sec-0255" id="toc-sec-0255" class="nav-link" data-scroll-target="#sec-0255"><span class="header-section-number">2.5.5</span> Transformation des variables</a></li>
  <li><a href="#sec-0256" id="toc-sec-0256" class="nav-link" data-scroll-target="#sec-0256"><span class="header-section-number">2.5.6</span> Mise en œuvre dans R</a></li>
  </ul>
</li>
  <li>
<a href="#sec-026" id="toc-sec-026" class="nav-link" data-scroll-target="#sec-026"><span class="header-section-number">2.6</span> Statistiques descriptives sur des variables qualitatives et semi-qualitatives</a>
  <ul class="collapse">
<li><a href="#sec-0261" id="toc-sec-0261" class="nav-link" data-scroll-target="#sec-0261"><span class="header-section-number">2.6.1</span> Fréquences</a></li>
  <li><a href="#sec-0262" id="toc-sec-0262" class="nav-link" data-scroll-target="#sec-0262"><span class="header-section-number">2.6.2</span> Mise en œuvre dans R</a></li>
  </ul>
</li>
  <li><a href="#sec-027" id="toc-sec-027" class="nav-link" data-scroll-target="#sec-027"><span class="header-section-number">2.7</span> Statistiques descriptives pondérées&nbsp;: pour aller plus loin</a></li>
  <li><a href="#sec-028" id="toc-sec-028" class="nav-link" data-scroll-target="#sec-028"><span class="header-section-number">2.8</span> Quiz de révision du chapitre</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/SerieBoldR/MethodesQuantitatives/issues/new" class="toc-action">Signaler un problème ou<br>formuler une suggestion</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-chap02" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistiques descriptives univariées</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Comprendre la notion de variable et de ses différents types est essentiel en statistiques. En effet, en fonction du type de variable à l’étude, les méthodes de statistique exploratoire ou inférentielle sont différentes. Nous distinguons ainsi cinq types de variables&nbsp;: nominale, ordinale, discrète, continue et semi-quantitative. Aussi, nous abordons un concept central de la statistique&nbsp;: les distributions. Finalement, dans ce chapitre, nous présentons les différentes statistiques descriptives univariées qui peuvent s’appliquer à ces types de variables.</p>
<div class="bloc_package">
<div class="bloc_package-header">
<div class="bloc_package-icon">

</div>
<p><strong>Liste des <em>packages</em> utilisés dans ce chapitre</strong></p>
</div>
<div class="bloc_package-body">
<ul>
<li>Pour créer des graphiques&nbsp;:
<ul>
<li>
<code>ggplot2</code>, le seul, l’unique!</li>
<li>
<code>ggpubr</code> pour combiner des graphiques et réaliser des diagrammes quantiles-quantiles.</li>
</ul>
</li>
<li>Pour créer des distributions&nbsp;:
<ul>
<li>
<code>fitdistrplus</code> pour générer différentes distributions.</li>
<li>
<code>actuar</code> pour la fonction de densité de Pareto.</li>
<li>
<code>gamlss.dist</code> pour des distributions de Poisson.</li>
</ul>
</li>
<li>Pour les statistiques descriptives&nbsp;:
<ul>
<li>
<code>stats</code> et <code>moments</code> pour les statistiques descriptives.</li>
<li>
<code>nortest</code> pour le test de Kolmogorov-Smirnov.</li>
<li>
<code>DescTools</code> pour les tests de Lilliefors, Shapiro-Wilk, Anderson-Darling et Jarque-Bera.</li>
</ul>
</li>
<li>Autres <em>packages</em>&nbsp;:
<ul>
<li>
<code>Hmisc</code> et <code>Weighted.Desc.Stat</code> pour les statistiques descriptives pondérées.</li>
<li>
<code>foreign</code> pour importer des fichiers externes.</li>
</ul>
</li>
</ul>
</div>
</div>
<section id="sec-021" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="sec-021">
<span class="header-section-number">2.1</span> Notion et types de variable</h2>
<section id="sec-0211" class="level3" data-number="2.1.1"><h3 data-number="2.1.1" class="anchored" data-anchor-id="sec-0211">
<span class="header-section-number">2.1.1</span> Notion de variable</h3>
<p>D’un point de vue empirique, une variable est une propriété, une caractéristique d’une unité statistique, d’une observation. Il convient alors de bien saisir à quelle unité d’analyse (ou unité d’observation) s’appliquent les valeurs d’une variable&nbsp;: des personnes, des ménages, des municipalités, des entreprises, etc. Par exemple, pour des individus, l’<em>âge</em>, le <em>genre</em> ou encore le <em>revenu</em> sont autant de caractéristiques qui peuvent être mesurées à partir de variables. Autrement dit, une variable permet de mesurer un phénomène (dans un intervalle de valeurs, c’est-à-dire de manière quantitative) ou de le qualifier (avec plusieurs catégories, c’est-à-dire de manière qualitative).</p>
<p>D’un point de vue plus théorique, une variable permet d’opérationnaliser un concept en sciences sociales <span class="citation" data-cites="gilles1994elements">(<a href="references.html#ref-gilles1994elements" role="doc-biblioref">Gilles et Maranda 1994, 30</a>)</span>, soit une «&nbsp;idée générale et abstraite que se fait l’esprit humain d’un objet de pensée concret ou abstrait, et qui lui permet de rattacher à ce même objet les diverses perceptions qu’il en a, et d’en organiser les connaissances&nbsp;» (<a href="https://www.larousse.fr/dictionnaires/francais/concept/17875?q=concept#17749" target="_blank">Larousse</a>). En effet, la construction d’un modèle théorique suppose d’opérationnaliser différents concepts et d’établir les relations qu’ils partagent entre eux. Or, l’opérationnalisation d’un concept nécessite soit de mesurer (dans un intervalle de valeurs, c’est-à-dire de manière quantitative), soit de qualifier (avec plusieurs catégories, c’est-à-dire de manière qualitative) un phénomène.</p>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Maîtriser la définition des variables que vous utilisez&nbsp;: un enjeu crucial! </strong></p>
</div>
<div class="bloc_attention-body">
<p>Ne pas maîtriser la définition d’une variable revient à ne pas bien saisir la caractéristique ou encore le concept sous-jacent qu’elle tente de mesurer. Si vous exploitez des données secondaires – par exemple, issues d’un recensement de population ou d’une enquête longitudinale ou transversale –, il faut impérativement lire les définitions des variables que vous souhaitez utiliser. Ne pas le faire risque d’aboutir à&nbsp;:</p>
<ul>
<li><p>Une mauvaise opérationnalisation de votre modèle théorique, même si votre analyse est bien menée statistiquement parlant. Autrement dit, vous risquez de ne pas sélectionner les bonnes variables&nbsp;: prenons un exemple concret. Vous avez construit un modèle théorique dans lequel vous souhaitez inclure un concept sur la langue des personnes. Dans le recensement canadien de 2016, plusieurs variables relatives à la langue sont disponibles&nbsp;: [connaissance des langues officielles, langue parlée à la maison, langue maternelle, première langue officielle parlée, connaissance des langues non officielles et langue de travail] (https://www12.statcan.gc.ca/census-recensement/2016/ref/guides/003/98-500-x2016003-fra.cfm). La sélection de l’une de ces variables doit être faite de manière rigoureuse, c’est-à-dire en lien avec votre cadre théorique et suite à une bonne compréhension des définitions des variables. Dans une étude sur le marché du travail, nous sélectionnerions probablement la variable <em>sur la connaissance des langues officielles du Canada</em>, afin d’évaluer son effet sur l’employabilité, toutes choses étant égales par ailleurs. Dans une autre étude portant sur la réussite ou la performance scolaire, il est probable que nous utiliserions la <em>langue maternelle</em>.</p></li>
<li><p>Une mauvaise interprétation et discussion de vos résultats en lien avec votre cadre théorique.</p></li>
<li><p>Une mauvaise identification des pistes de recherche.</p></li>
</ul>
<p>Finalement, la définition d’une variable peut évoluer à travers plusieurs recensements de population&nbsp;: la société évolue, les variables aussi! Par conséquent, si vous comptez utiliser plusieurs années de recensement dans une même étude, assurez-vous que les définitions des variables sont similaires d’un jeu de données à l’autre et qu’elles mesurent ainsi la même chose.</p>
<p><strong>Comprendre les variables utilisées dans un article scientifique&nbsp;: un exercice indispensable dans l’élaboration d’une revue de littérature</strong></p>
<p>Une lecture rigoureuse d’un article scientifique suppose, entre autres, de bien comprendre les concepts et les variables mobilisés. Il convient alors de lire attentivement la section méthodologique (pas uniquement la section des résultats ou pire, celle du résumé), sans quoi vous risquez d’aboutir à une revue de littérature approximative. Ayez aussi un <strong>regard critique</strong> sur les variables utilisées en lien avec le cadre théorique. Certains concepts sont très difficiles à traduire en variables; leurs opérationnalisations (mesures) peuvent ainsi faire l’objet de vifs débats au sein de la communauté scientifique. Très succinctement, c’est notamment le cas du concept de capital social. D’une part, les définitions et ancrages sont bien différents selon Bourdieu (sociologue, ancrage au niveau des individus) et Putman (politologue, ancrage au niveau des collectivités); d’autre part, aucun consensus ne semble clairement se dégager quant à la définition de variables permettant de mesurer le capital social efficacement (de manière quantitative).</p>
<p><strong>Variable de substitution (<em>proxy variable</em> en anglais)</strong></p>
<p>Nous faisons la moins pire des recherches! En effet, les données disponibles sont parfois imparfaites pour répondre avec précision à une question de recherche; nous pouvons toujours les exploiter, tout en signalant honnêtement leurs faiblesses et limites, et ce, tant pour les données que pour les variables utilisées.</p>
<ul>
<li><p>Des bases de données peuvent être en effet imparfaites. Par exemple, en criminologie, lorsqu’une étude est basée sur l’exploitation de données policières, la limite du <strong>chiffre noir</strong> est souvent signalée&nbsp;: les données policières comprennent uniquement les crimes et délits découverts par la police et occultent ainsi les crimes non découverts; ils ne peuvent ainsi refléter la criminalité réelle sur un territoire donné.</p></li>
<li><p>Des variables peuvent aussi être imparfaites. Dans un jeu de données, il est fréquent qu’une variable ne soit pas disponible ou qu’elle n’ait tout simplement pas été mesurée. Nous cherchons alors une variable de substitution (<em>proxy</em>) pour la remplacer. Prenons un exemple concret portant sur l’exposition des cyclistes à la pollution atmosphérique ou au bruit environnemental. L’un des principaux facteurs d’exposition à ces pollutions est le trafic routier&nbsp;: plus ce dernier est élevé, plus les cyclistes risquent de rouler dans un environnement bruyant et pollué. Toutefois, il est rare de disposer de mesures du trafic en temps réel qui nécessitent des comptages de véhicules pendant le trajet des cyclistes (par exemple, à partir de vidéos captées par une caméra fixée sur le guidon). Pour pallier l’absence de mesures directes, plusieurs auteur(e)s utilisent des variables de substitution de la densité du trafic, comme la typologie des types d’axes (primaire, secondaire, tertiaire, rue locale, etc.), supposant ainsi qu’un axe primaire supporte un volume de véhicules supérieur à un axe secondaire.</p></li>
</ul>
</div>
</div>
</section><section id="sec-0212" class="level3" data-number="2.1.2"><h3 data-number="2.1.2" class="anchored" data-anchor-id="sec-0212">
<span class="header-section-number">2.1.2</span> Types de variables</h3>
<p>Nous distinguons habituellement les variables qualitatives (nominale ou ordinale) des variables quantitatives (discrète ou continue). Comme illustré à la <a href="#fig-univarie1">figure&nbsp;<span>2.1</span></a>, plusieurs mécanismes différents visent à qualifier, à classer, à compter ou à mesurer afin de caractériser les unités statistiques (observations) d’une population ou d’un échantillon.</p>
<div id="fig-univarie1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap02/figure1.jpg" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.1: Types de variables</figcaption></figure>
</div>
<section id="sec-02121" class="level4" data-number="2.1.2.1"><h4 data-number="2.1.2.1" class="anchored" data-anchor-id="sec-02121">
<span class="header-section-number">2.1.2.1</span> Variables qualitatives</h4>
<p><strong>Une variable nominale</strong> permet de <strong>qualifier</strong> des observations (individus) à partir de plusieurs catégories dénommées modalités. Par exemple, la variable <em>couleur des yeux</em> pourrait comprendre les modalités <em>bleu</em>, <em>marron</em>, <em>vert</em>, <em>noir</em> tandis que le <em>type de famille</em> comprendrait les modalités <em>couple marié</em>, <em>couple en union libre</em> et <em>famille monoparentale</em>.</p>
<p><strong>Une variable ordinale</strong> permet de <strong>classer</strong> des observations à partir de plusieurs modalités hiérarchisées. L’exemple le plus connu est certainement l’échelle de Likert, très utilisée dans les sondages évaluant le degré d’accord d’une personne à une affirmation avec les modalités suivantes&nbsp;: <em>tout à fait d’accord</em>, <em>d’accord</em>, <em>ni en désaccord ni d’accord</em>, <em>pas d’accord</em> et <em>pas du tout d’accord</em>. Une multitude de variantes sont toutefois possibles pour classer la fréquence d’un phénomène (<em>très souvent</em>, <em>souvent</em>, <em>parfois</em>, <em>rarement</em>, <em>jamais</em>), l’importance accordée à un phénomène (<em>pas du tout important</em>, <em>peu important</em>, <em>plus ou moins important</em>, <em>important</em>, <em>très important</em>) ou la proximité perçue d’un lieu (<em>très éloigné</em>, <em>loin</em>, <em>plus ou moins proche</em>, <em>proche</em>, <em>très proche</em>).</p>
<p>En fonction du nombre de modalités qu’elle comprend, une variable qualitative (nominale ou ordinale) est soit <strong>dichotomique (binaire)</strong> (deux modalités), soit <strong>polytomique</strong> (plus de deux modalités). Par exemple, dans le recensement canadien, le <em>sexe</em> est une variable binaire (avec les modalités <em>sexe masculin</em>, <em>sexe féminin</em>), tandis que le <em>genre</em> est une variable polytomique (avec les modalités <em>genre masculin</em>, <em>genre féminin</em> et <em>diverses identités de genre</em>).</p>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Fréquences pour des variables nominales et ordinales</strong></p>
</div>
<div class="bloc_attention-body">
<p>Les variables nominales et ordinales sont habituellement encodées avec des valeurs numériques entières (par exemple, 1 pour <em>couple marié</em>, 2 pour <em>couple en union libre</em> et 3 pour <em>famille monoparentale</em>). Toutefois, aucune opération arithmétique (moyenne ou écart-type par exemple) n’est possible sur ces valeurs. Dans R, nous utilisons un facteur pour attribuer un intitulé à chacune des valeurs numériques de la variable qualitative&nbsp;:</p>
<p><code>df$Famille &lt;- factor(df$Famille, c(1,2,3),  labels = c("couple marié" , "couple en union libre", "famille monoparentale"))</code></p>
<p>Nous calculons toutefois les fréquences des différentes modalités pour une variable nominale ou ordinale. Il est aussi possible de calculer la médiane sur une variable ordinale.</p>
</div>
</div>
</section><section id="sec-02122" class="level4" data-number="2.1.2.2"><h4 data-number="2.1.2.2" class="anchored" data-anchor-id="sec-02122">
<span class="header-section-number">2.1.2.2</span> Variables quantitatives</h4>
<p><strong>Une variable discrète</strong> permet de <strong>compter</strong> un phénomène dans un ensemble fini de valeurs, comme le nombre d’accidents impliquant un ou une cycliste à une intersection sur une période de cinq ans ou encore le nombre de vélos en libre-service disponibles à une station. Il existe ainsi une variable binaire sous-jacente&nbsp;: la présence ou non d’un accident à l’intersection ou la disponibilité d’un vélo ou non à la station pour laquelle nous opérons un comptage. Habituellement, une variable discrète ne peut prendre que des valeurs entières (sans décimale), comme le nombre de personnes fréquentant un parc.</p>
<p><strong>Une variable continue</strong> permet de <strong>mesurer</strong> un phénomène avec un nombre infini de valeurs réelles (avec décimales) dans un intervalle donné. Par exemple, une variable relative à la distance de dépassement d’un ou d’une cycliste par un véhicule motorisé pourrait varier de 0 à 5 mètres (<span class="math inline">\(X \in \left[0,5\right]\)</span>); toutefois, cette distance peut être de 0,759421 ou de 4,785612 mètres. Le nombre de décimales de la valeur réelle dépend de la précision et de la fiabilité de la mesure. Pour un capteur de distance de dépassement, le nombre de décimales dépend de la précision du lidar ou du sonar de l’appareil; aussi, l’utilisation de trois décimales – soit une précision au millimètre – est largement suffisante pour mesurer la distance de dépassement. De plus, une variable continue est soit une variable d’intervalle, soit une variable de rapport. Les <strong>variables d’intervalle</strong> ont une échelle relative, c’est-à-dire que les intervalles entre les valeurs de la variable ne sont pas constants; elles n’ont pas de vrai zéro. Autrement dit, ce type de variable a une échelle relative avec un zéro arbitraire. Ces valeurs peuvent être manipulées uniquement par addition et soustraction et non par multiplication et division. La variable d’intervalle la plus connue est certainement celle de la température. S’il fait 10 degrés Celsius à Montréal et 30&nbsp;°C à Mumbai (soit 50 et 86 degrés en Fahrenheit), nous pouvons affirmer qu’il y a 20&nbsp;°C ou 36&nbsp;°F d’écart entre les deux villes, mais ne pouvons pas affirmer qu’il fait trois fois plus chaud à Mumbai. Presque toutes les mesures statistiques sur une variable d’intervalle peuvent être calculées, excepté le coefficient de variation et la moyenne géométrique puisqu’il n’y a pas de vrai zéro ni d’intervalles constants entre les valeurs. À l’inverse, les <strong>variables de rapport</strong> ont une échelle absolue, c’est-à-dire que les intervalles entre les valeurs sont constants et elles ont un vrai zéro. Elles peuvent ainsi être manipulées par addition, soustraction, multiplication et division. Par exemple, le prix d’un produit exprimé dans une unité monétaire ou la distance exprimée dans le système métrique sont des variables de rapport. Un vélo dont le prix affiché est de 1000&nbsp;$ est bien deux fois plus cher qu’un autre à 500&nbsp;$, une piste cyclable hors rue à 25 mètres du tronçon routier le plus proche est bien quatre fois plus proche qu’une autre à 100&nbsp;mètres.</p>
<p><strong>Une variable semi-quantitative</strong>, appelée aussi variable quantitative ordonnée, est une variable discrète ou continue dont les valeurs ont été regroupées en classes hiérarchisées. Par exemple, l’âge est une variable continue pouvant être transformée avec les groupes d’âge ordonnés suivants&nbsp;: <em>moins 25 ans</em>, <em>25 à 44 ans</em>, <em>45 à 64 ans</em> et <em>65 ans et plus</em>.</p>
</section></section></section><section id="sec-022" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="sec-022">
<span class="header-section-number">2.2</span> Types de données</h2>
<p>Différents types de données sont utilisés en sciences sociales. L’objectif ici n’est pas de les décrire en détail, mais plutôt de donner quelques courtes définitions. En fonction de votre question de recherche et des bases des données disponibles, il s’agit de sélectionner le ou les types de données les plus appropriés à votre étude.</p>
<section id="sec-0221" class="level3" data-number="2.2.1"><h3 data-number="2.2.1" class="anchored" data-anchor-id="sec-0221">
<span class="header-section-number">2.2.1</span> Données secondaires <em>versus</em> données primaires</h3>
<p>Les <strong>données secondaires</strong> sont des données qui existent déjà au début de votre projet de recherche&nbsp;: nul besoin de les collecter, il suffit de les exploiter! Une multitude de données de recensements ou d’enquêtes de Statistique Canada sont disponibles et largement exploitées en sciences sociales (par exemple, l’enquête nationale auprès des ménages – ENM, l’enquête sur la dynamique du marché du travail et du revenu – EDTR, l’enquête longitudinale auprès des immigrants – ELIC, etc.).</p>
<div class="bloc_notes">
<div class="bloc_notes-header">
<div class="bloc_notes-icon">

</div>
<p><strong>Accès aux microdonnées</strong></p>
</div>
<div class="bloc_notes-body">
<p>Au Canada, les personnes qui font de la recherche, qui étudient ou qui enseignent, ont accès aux microdonnées des enquêtes de Statistique Canada dans les centres de données de recherche (CDR). Vous pouvez consulter le moteur de recherche du Réseau canadien des Centres de données de recherche (https://crdcn.org/fr/donn%C3%A9es) afin d’explorer les différentes enquêtes disponibles.</p>
<p>Au Québec, l’accès à ces enquêtes est possible dans les différentes antennes du Centre interuniversitaire québécois de statistiques sociales de Statistique Canada (https://www.ciqss.org/).</p>
</div>
</div>
<p>Par opposition, les <strong>données primaires</strong> n’existent pas quand vous démarrez votre projet&nbsp;: vous devez les collecter spécifiquement pour votre étude! Par exemple, une chercheuse souhaitant analyser l’exposition des cyclistes au bruit et à la pollution dans une ville donnée doit réaliser une collecte de données avec idéalement plusieurs personnes participantes (équipées de différents capteurs), et ce, sur plusieurs jours. Une collecte de données primaires peut aussi être réalisée avec une enquête par sondage. Brièvement, réaliser une collecte de données primaires nécessite différentes phases complexes comme la définition de la méthode de collecte et de la population à l’étude, l’estimation de la taille de l’échantillon, la validation des outils de collecte avec une phase de test, la réalisation de la collecte, la structuration, la gestion et l’exploitation de données collectées. Finalement, dans le milieu académique, une collecte de données primaires auprès d’individus doit être approuvée par le comité d’éthique de la recherche de l’université à laquelle est affiliée la personne responsable du projet de recherche.</p>
</section><section id="sec-0222" class="level3" data-number="2.2.2"><h3 data-number="2.2.2" class="anchored" data-anchor-id="sec-0222">
<span class="header-section-number">2.2.2</span> Données transversales <em>versus</em> données longitudinales</h3>
<p>Les <strong>données transversales</strong> sont des mesures pour une période relativement courte. L’exemple classique est un jeu de données constitué des variables extraites d’un recensement de population pour une année donnée (comme celui de 2016 de Statistique Canada).</p>
<p>Les <strong>données longitudinales</strong>, appelées aussi données par panel, sont des mesures répétées pour plusieurs observations au cours du temps (<em>N</em> observations pour <em>T</em> dates). Par exemple, des observations pourraient être des pays, les dates pourraient être différentes années (de 1990 à 2019) pour lesquelles différentes variables seraient disponibles (population totale, taux d’urbanisation, produit intérieur brut par habitant, émissions de gaz à effet de serre par habitant, etc.).</p>
</section><section id="sec-0223" class="level3" data-number="2.2.3"><h3 data-number="2.2.3" class="anchored" data-anchor-id="sec-0223">
<span class="header-section-number">2.2.3</span> Données spatiales versus données aspatiales</h3>
<p>Les observations des <strong>données spatiales</strong> sont des unités spatiales géoréférencées. Elles peuvent être par exemple&nbsp;:</p>
<ul>
<li><p>des points <em>(x, y)</em> ou <em>(lat-long)</em> représentant des entreprises avec plusieurs variables (adresse, date de création, nombre d’employés, secteurs d’activité, etc.);</p></li>
<li><p>les lignes représentant des tronçons de rues pour lesquels plusieurs variables sont disponibles (type de rue, longueur en mètres, nombre de voies, débit journalier moyen annuel, etc.);</p></li>
<li><p>des polygones délimitant des régions ou des arrondissements pour lesquels une multitude de variables sociodémographiques et socioéconomiques sont disponibles;</p></li>
<li><p>les pixels des bandes spectrales d’une image satellite.</p></li>
</ul>
<p>À l’inverse, aucune information spatiale n’est disponible pour des <strong>données aspatiales</strong>.</p>
</section><section id="sec-0224" class="level3" data-number="2.2.4"><h3 data-number="2.2.4" class="anchored" data-anchor-id="sec-0224">
<span class="header-section-number">2.2.4</span> Données individuelles <em>versus</em> données agrégées</h3>
<p>Comme son nom l’indique, pour des <strong>données individuelles</strong>, chaque observation correspond à un individu. Les microdonnées de recensements ou d’enquêtes, par exemple, sont des données individuelles pour lesquelles toute une série de variables est disponible. Une étude analysant les caractéristiques de chaque arbre d’un quartier nécessite aussi des données individuelles&nbsp;: l’information doit être disponible pour chaque arbre. Pour les microdonnées des recensements canadiens, «&nbsp;chaque enregistrement au niveau de la personne comprend des identifiants (comme les identifiants du ménage et de la famille), des variables géographiques et des variables directes et dérivées tirées du questionnaire&nbsp;» (<a href="https://www150.statcan.gc.ca/n1/pub/12-002-x/2012001/article/11642-fra.htm" target="_blank">Statistique Canada</a>). Comme signalé plus haut, ces microdonnées de recensements ou d’enquêtes sont uniquement accessibles dans les centres de données de recherche (CDR).</p>
<p>Les données individuelles peuvent être <strong>agrégées</strong> à un niveau supérieur. Prenons le cas de microdonnées d’un recensement. Les informations disponibles pour chaque individu sont agrégées par territoire géographique (province, région économique, division de recensement, subdivision de recensement, région et agglomération de recensement, secteurs de recensement, aires de diffusion, etc.) en fonction du lieu de résidence des individus. Des sommaires statistiques – basés sur la moyenne, la médiane, la somme ou la proportion de chacune des variables mesurées au niveau individuel (âge, sexe, situation familiale, revenu, etc.) – sont alors construits pour ces différents découpages géographiques (<a href="https://www.statcan.gc.ca/fra/idd/trousse/section5#a4" target="_blank">Statistique Canada</a>).</p>
<p>L’agrégation n’est pas nécessairement géographique. En éducation, il est fréquent de travailler avec des données concernant les élèves, mais agrégées au niveau des écoles. La <a href="#fig-univarie1b">figure&nbsp;<span>2.2</span></a> donne un exemple simple d’agrégation de données individuelles.</p>
<div id="fig-univarie1b" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap02/aggregation.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.2: Exemple d’agrégation de données individuelles</figcaption></figure>
</div>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Erreur écologique et erreur atomiste</strong>: attention aux interprétations abusives</p>
</div>
<div class="bloc_attention-body">
<p>Il convient d’être prudent dans l’analyse des données agrégées. Très fréquente en géographie, l’<strong>erreur écologique</strong> (<em>ecological fallacy</em> en anglais) est une mauvaise interprétation des résultats. Elle consiste à attribuer des constats obtenus à partir de données agrégées pour un territoire aux individus qui forment la population de ce territoire. À l’inverse, attribuer des résultats à partir de données individuelles à des territoires est une <strong>erreur atomiste</strong>.</p>
<p>Prenons un exemple concret tiré d’une étude récente sur la localisation des écoles primaires et le bruit aérien dans la région métropolitaine de Toronto <span class="citation" data-cites="audrin2021localisation">(<a href="references.html#ref-audrin2021localisation" role="doc-biblioref">Audrin, Apparicio et Séguin 2021</a>)</span>. Un des objectifs de cette étude est de vérifier si les écoles primaires (ns&nbsp;=&nbsp;1420) avec des niveaux de bruit aérien élevés présentent des niveaux de réussite scolaire plus faibles. Les résultats de leur étude démontrent que les enfants scolarisés dans les écoles primaires avec à des niveaux élevés de bruit aérien sont issus de milieux plus défavorisés et ont plus souvent une langue maternelle autre que la langue d’enseignement. Aussi, les écoles avec des niveaux de bruit aérien élevés présentent des niveaux de réussite scolaire plus faibles.</p>
<p>Toutefois, étant donné que les variables sur la réussite scolaire sont mesurées au niveau de l’école (soit les pourcentages d’élèves ayant atteint ou dépassé la norme provinciale en lecture, en écriture et en mathématique, respectivement pour la 3<sup>e</sup> année et la 6<sup>e</sup> année) et non au niveau individuel, nous ne pouvons pas conclure que le bruit aérien à un impact significatif sur la réussite scolaire des élèves&nbsp;:</p>
<p>«&nbsp;Nous avons pu démontrer que les écoles primaires localisées dans la zone NEF 25 présentent des taux de réussite plus faibles. Rappelons toutefois qu’une association obtenue avec des données agrégées ne peut pas nous permettre de conclure à une influence directe au niveau individuel, car l’agrégation des données entraîne une perte d’information. Cette erreur d’interprétation dite erreur écologique (<em>ecological fallacy</em>) tend à laisser penser que les associations entre les groupes s’appliquent à chaque individu (Robinson, 1950). Nos résultats gagneraient à être corroborés à partir d’analyses reposant sur des données individuelles&nbsp;».</p>
</div>
</div>
<p>Pour le cas de l’agrégation géographique, il convient alors de bien comprendre la hiérarchie des régions géographiques délimitées par l’organisme ou l’agence ayant la responsabilité de produire, de gérer et de diffuser les données des recensements et des enquêtes, puis de sélectionner le découpage géographique qui répond le mieux à votre question de recherche.</p>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p>Hiérarchie et définitions des régions géographiques du recensement canadien</p>
</div>
<div class="bloc_astuce-body">
<ul>
<li><p>la <a href="https://www12.statcan.gc.ca/census-recensement/2016/ref/dict/figures/f1_1-fra.cfm">hiérarchie des régions géographiques normalisées pour la diffusion</a></p></li>
<li><p>le <a href="https://www150.statcan.gc.ca/n1/pub/92-195-x/92-195-x2016001-fra.htm">glossaire illustré</a> des régions géographiques</p></li>
<li><p><a href="https://www12.statcan.gc.ca/census-recensement/2021/dp-pd/prof/index.cfm?Lang=F">les différents profils du recensement de 2021</a> à télécharger pour les différentes régions géographiques.</p></li>
</ul>
</div>
</div>
<div class="bloc_notes">
<div class="bloc_notes-header">
<div class="bloc_notes-icon">

</div>
<p><strong>Les différents types de données abordés ci-dessus ne sont pas exclusifs.</strong></p>
</div>
<div class="bloc_notes-body">
<p>Par exemple, des données pour des régions administratives extraites de plusieurs recensements sont en fait des données secondaires, spatiales, agrégées et longitudinales.</p>
<p>Des données sur la pollution atmosphérique et sonore collectées à vélo (avec différents capteurs et un GPS) sont des données spatiales primaires.</p>
</div>
</div>
</section></section><section id="sec-023" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="sec-023">
<span class="header-section-number">2.3</span> Statistique descriptive et statistique inférentielle</h2>
<section id="sec-0231" class="level3" data-number="2.3.1"><h3 data-number="2.3.1" class="anchored" data-anchor-id="sec-0231">
<span class="header-section-number">2.3.1</span> Population, échantillon et inférence</h3>
<p>Les notions de <strong>population</strong> et d’<strong>échantillon</strong> sont essentielles en statistique puisqu’elles sont le socle de l’inférence statistique. Un échantillon est un <strong>sous-ensemble représentatif</strong> d’une population donnée. Prenons un exemple concret&nbsp;: une chercheuse veut comprendre la mobilité des personnes étudiant dans une université. Bien entendu, elle ne peut interroger toutes les personnes étudiantes de son université. Elle devra donc s’assurer d’obtenir un échantillon de taille suffisante et représentatif de la population étudiante. Une fois les données collectées (avec un sondage par exemple), elle pourra utiliser des techniques inférentielles pour analyser la mobilité des personnes interrogées. Si son échantillon est représentatif, les résultats obtenus pourront être inférés – c’est-à-dire généralisés, extrapolés – à l’ensemble de la population.</p>
<div class="bloc_aller_loin">
<div class="bloc_aller_loin-header">
<div class="bloc_aller_loin-icon">

</div>
<p><strong>Les méthodes d’échantillonnage</strong></p>
</div>
<div class="bloc_aller_loin-body">
<p>Nous n’abordons pas ici les méthodes d’échantillonnage. Sachez toutefois qu’il existe plusieurs méthodes probabilistes pour constituer un échantillon, notamment de manière aléatoire, systématique, stratifiée, par grappes. Consultez par exemple cette <a href="https://www150.statcan.gc.ca/n1/edu/power-pouvoir/ch13/prob/5214899-fra.htm">publication de Statistique Canada</a>.</p>
</div>
</div>
<p>Autre exemple, une autre chercheuse souhaite comprendre les facteurs influençant le sentiment de sécurité des cyclistes dans un quartier. De nouveau, elle ne peut pas enquêter sur l’ensemble des cyclistes du quartier et devra constituer un échantillon représentatif. Par la suite, la mise en œuvre de techniques inférentielles lui permettra d’identifier les caractéristiques individuelles (âge, sexe, habiletés à vélo, etc.) et de l’environnement urbain (types de voies empruntés, niveaux de trafic, de pollution, de bruit, etc.) ayant des effets significatifs sur le sentiment de sécurité. Si l’échantillon est représentatif, les résultats pourront être généralisés à l’ensemble des cyclistes du quartier.</p>
</section><section id="sec-0232" class="level3" data-number="2.3.2"><h3 data-number="2.3.2" class="anchored" data-anchor-id="sec-0232">
<span class="header-section-number">2.3.2</span> Deux grandes familles de méthodes statistiques</h3>
<p>Nous distinguons habituellement deux grandes familles de méthodes statistiques&nbsp;: la statistique descriptive et exploratoire et la statistiques inférentielle et confirmatoire. Il existe de nombreuses définitions de ces deux branches de la statistique, celles proposées de Lebart et al. <span class="citation" data-cites="lebart1995statistique">(<a href="references.html#ref-lebart1995statistique" role="doc-biblioref">1995</a>)</span> étant parmi les plus abouties&nbsp;:</p>
<ul>
<li><p>«&nbsp;<strong>La statistique descriptive et exploratoire</strong>&nbsp;: elle permet, par des résumés et des graphiques plus ou moins élaborés, de décrire des ensembles de données statistiques, d’établir des relations entre les variables sans faire jouer de rôle privilégié à une variable particulière. Les conclusions ne portent dans cette phase de travail que sur les données étudiées, sans être inférées à une population plus large. L’analyse exploratoire s’appuie essentiellement sur des notions élémentaires telles que des indicateurs de moyenne et de dispersion, sur des représentations graphiques. […]</p></li>
<li><p><strong>La statistique inférentielle et confirmatoire</strong>&nbsp;: elle permet de valider ou d’infirmer, à partir de tests statistiques ou de modèles probabilistes, des hypothèses formulées a priori (ou après une phase exploratoire), et d’extrapoler, c’est-à-dire d’étendre certaines propriétés d’un échantillon à une population plus large. Les conclusions obtenues à partir des données vont au-delà de ces données. La statistique confirmatoire fait surtout appel aux méthodes dites explicatives et prévisionnelles, destinées, comme leurs noms l’indiquent, à expliquer puis à prévoir, suivant des règles de décision, une variable privilégiée à l’aide d’une ou plusieurs variables explicatives (régressions multiples et logistiques, analyse de variance, analyse discriminante, segmentation, etc.)&nbsp;» <span class="citation" data-cites="lebart1995statistique">(<a href="references.html#ref-lebart1995statistique" role="doc-biblioref">Lebart, Morineau et Piron 1995, 209</a>)</span>.</p></li>
</ul></section></section><section id="sec-024" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="sec-024">
<span class="header-section-number">2.4</span> Notion de distribution</h2>
<div class="bloc_objectif">
<div class="bloc_objectif-header">
<div class="bloc_objectif-icon">

</div>
<p><strong>Les distributions : une notion centrale en statistique</strong></p>
</div>
<div class="bloc_objectif-body">
<p>Prenez le temps de lire cette section à tête reposée et assurez-vous de bien comprendre chaque idée avant de passer à la suivante. N’hésitez pas à y revenir plusieurs fois si nécessaire, car la compréhension de ces concepts est essentielle pour utiliser adéquatement les méthodes que nous abordons dans ce livre.</p>
</div>
</div>
<section id="définition-générale" class="level3" data-number="2.4.1"><h3 data-number="2.4.1" class="anchored" data-anchor-id="définition-générale">
<span class="header-section-number">2.4.1</span> Définition générale</h3>
<p>En probabilité, nous nous intéressons aux résultats d’expériences. Du point de vue de la théorie des probabilités, lancer un dé, mesurer la pollution atmosphérique, compter le nombre de collisions à une intersection, et demander à une personne d’évaluer son sentiment de sécurité sur une échelle de 1 à 10 sont autant d’expériences pouvant produire des résultats.</p>
<p><strong>Une distribution est un modèle mathématique permettant d’associer pour chaque résultat possible d’une expérience la probabilité d’obtenir ce résultat</strong>. D’un point de vue pratique, si nous disposons de la distribution régissant l’expérience&nbsp;: «&nbsp;mesurer la concentration d’ozone à Montréal à 13&nbsp;h en été&nbsp;», nous pouvons calculer la probabilité de mesurer une valeur inférieure à 15&nbsp;μg/m<sup>3</sup>.</p>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Loi de probabilité et distribution</strong></p>
</div>
<div class="bloc_attention-body">
<p>L’utilisation que nous faisons ici du terme «&nbsp;distribution&nbsp;» est un anglicisme (éhonté diront certaines personnes). En effet, en français, la définition précédente est plus proche du terme «&nbsp;loi de probabilité&nbsp;». Cependant, la quasi-totalité de la documentation sur R est en anglais et, dans la pratique, ces deux termes ont tendance à se confondre. Nous avons donc fait le choix de poursuivre avec ce terme dans le reste du livre.</p>
</div>
</div>
<p>Une distribution est toujours définie dans un intervalle en dehors duquel elle n’est définie; les valeurs dans cet intervalle sont appelées <strong>l’espace d’échantillonnage</strong>. Il s’agit donc des valeurs possibles que peut produire l’expérience. La somme des probabilités de l’ensemble des valeurs de l’espace d’échantillonnage est 1 (100&nbsp;%). Intuitivement, cela signifie que si nous réalisons l’expérience, nous obtenons nécessairement un résultat, et que la somme des probabilités est répartie entre tous les résultats possibles de l’expérience. En langage mathématique, nous disons que l’intégrale de la fonction de densité d’une distribution est 1 dans son intervalle de définition.</p>
<p>Prenons un exemple concret avec l’expérience suivante&nbsp;: tirer à pile ou face avec une pièce de monnaie non truquée. Si l’on souhaite décrire la probabilité d’obtenir pile ou face, nous pouvons utiliser une distribution qui aura comme espace d’échantillonnage [pile; face] et ces deux valeurs auront chacune comme probabilité 0,5. Il est facile d’étendre cet exemple au cas d’un dé à six faces. La distribution de probabilité décrivant l’expérience «&nbsp;lancer le dé&nbsp;» a pour espace d’échantillonnage [1,2,3,4,5,6], chacune de ces valeurs étant associée à la probabilité de 1/6.</p>
<p>Chacune des deux expériences précédentes est régie par une distribution appartenant à la famille des distributions <strong>discrètes</strong>. Elles servent à représenter des expériences dont le nombre de valeurs possibles est fini. Par opposition, la seconde famille de distributions regroupe les distributions <strong>continues</strong>, décrivant des expériences dont le nombre de résultats possibles est en principe infini. Par exemple, mesurer la taille d’une personne adulte sélectionnée au hasard peut produire en principe un nombre infini de valeurs. Les distributions sont utiles pour décrire les résultats potentiels d’une expérience. Reprenons notre exemple du dé. Nous savons que chaque face a une chance sur six d’être tirée au hasard. Nous pouvons représenter cette distribution avec un graphique (<a href="#fig-fig251">figure&nbsp;<span>2.3</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig251" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig251-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.3: Distribution théorique d’un lancer de dé</figcaption></figure>
</div>
</div>
</div>
<p>Nous avons donc sous les yeux un modèle statistique décrivant le comportement attendu d’un dé, soit sa distribution <strong>théorique</strong>. Cependant, si nous effectuons dix fois l’expérience (nous collectons donc un échantillon), nous obtiendrons une distribution différente de cette distribution théorique (<a href="#fig-fig252">figure&nbsp;<span>2.4</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig252" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig252-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.4: Distribution empirique d’un lancer de dé (n = 10)</figcaption></figure>
</div>
</div>
</div>
<p>Il s’agit de la distribution <strong>empirique</strong>. Chaque échantillon aura sa propre distribution empirique. Cependant, comme le prédit la loi des grands nombres&nbsp;: si une expérience est répétée un grand nombre de fois, la probabilité empirique d’un résultat se rapproche de la probabilité théorique à mesure que le nombre de répétitions augmente. Du point de vue de la théorie des probabilités, chaque échantillon correspond à un ensemble de tirages aléatoires effectués à partir de la distribution théorique du phénomène étudié.</p>
<p>Pour nous en convaincre, collectons trois échantillons de lancer de dé de respectivement 30, 100 et 1000 observations (<a href="#fig-fig253">figure&nbsp;<span>2.5</span></a>). Comme le montre la <a href="#fig-fig252">figure&nbsp;<span>2.4</span></a>, nous connaissons la distribution théorique qui régit cette expérience.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig253" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig253-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.5: Distribution empirique d’un lancer de dé</figcaption></figure>
</div>
</div>
</div>
<p>Nous constatons bien qu’au fur et à mesure que la taille de l’échantillon augmente, nous tendons vers la distribution théorique.</p>
<p>Cette relation a été étudiée pour la première fois au XVIII<sup>e</sup> siècle par le mathématicien Daniel Bernoulli, qui a montré que la probabilité que la moyenne d’une distribution empirique soit éloignée de la moyenne de la distribution théorique dont elle est tirée diminuait lorsque nous augmentons le nombre des tirages et donc la taille de l’échantillon. Un autre mathématicien, Siméon-Denis Poisson, a fait connaître cette relation sous le nom de «&nbsp;loi des grands nombres&nbsp;».</p>
<p>Les distributions théoriques sont utilisées pour modéliser des phénomènes réels et sont à la base de presque tous les tests statistiques d’inférence fréquentiste ou bayésienne. En pratique, la question que nous nous posons le plus souvent est&nbsp;: quelle distribution théorique peut le mieux décrire le phénomène empirique à l’étude? Pour répondre à cette question, deux approches sont possibles&nbsp;:</p>
<ul>
<li><p>Considérant la littérature existante sur le sujet, les connaissances accumulées et la nature de la variable étudiée, sélectionner des distributions théoriques pouvant vraisemblablement correspondre au phénomène mesuré.</p></li>
<li><p>Comparer visuellement ou à l’aide de tests statistiques la distribution empirique de la variable et diverses distributions théoriques pour trouver la plus adaptée.</p></li>
</ul>
<p>Idéalement, le choix d’une distribution théorique devrait reposer sur ces deux méthodes combinées.</p>
</section><section id="anatomie-dune-distribution" class="level3" data-number="2.4.2"><h3 data-number="2.4.2" class="anchored" data-anchor-id="anatomie-dune-distribution">
<span class="header-section-number">2.4.2</span> Anatomie d’une distribution</h3>
<p>Une distribution (ou loi de probabilité) est une fonction. Il est possible de la représenter à l’aide d’une formule mathématique (appelée <strong>fonction de masse</strong> pour les distributions discrètes et <strong>fonction de densité</strong> pour les distributions continues) associant chaque résultat possible de l’expérience régie par la distribution à la probabilité d’observer ce résultat. Prenons un premier exemple concret avec la distribution théorique associée au lancer de pièce de monnaie&nbsp;: la distribution de <strong>Bernoulli</strong>. Sa formule est la suivante&nbsp;:</p>
<p><span id="eq-Bernoulli"><span class="math display">\[
f(x ; p)=\left\{\begin{array}{ll}
q=1-p &amp; \text { si } x=0 \\
p &amp; \text { si } x=1
\end{array}\right.
\tag{2.1}\]</span></span></p>
<p>avec <em>p</em> la probabilité d’obtenir <span class="math inline">\(x = 1\)</span> (pile), et <span class="math inline">\(1 – p\)</span> la probabilité d’avoir <span class="math inline">\(x = 0\)</span> (face). La distribution de Bernoulli ne dépend que d’un paramètre&nbsp;: <em>p</em>. Avec différentes valeurs de <em>p</em>, nous pouvons obtenir différentes formes pour la distribution de Bernoulli. Si <em>p</em> = 1/2, la distribution de Bernoulli décrit parfaitement l’expérience&nbsp;: obtenir pile à un lancer de pièce de monnaie. Si <em>p</em> = 1/6, elle décrit alors l’expérience&nbsp;: obtenir 4 (tout comme n’importe quelle valeur de 1 à 6) à un lancer de dé. Pour un exemple plus appliqué, la distribution de Bernoulli est utilisée en analyse spatiale pour étudier la concentration d’accidents de la route ou de crimes en milieu urbain. À chaque endroit du territoire, il est possible de calculer la probabilité qu’un tel évènement ait lieu ou non en modélisant les données observées au moyen de la loi de Bernoulli. La distribution continue la plus simple à décrire est certainement la distribution <strong>uniforme</strong>. Il s’agit d’une distribution un peu spéciale puisqu’elle attribue la même probabilité à toutes ses valeurs dans son espace d’échantillonnage. Elle est définie sur l’intervalle <span class="math inline">\([-\infty; +\infty]\)</span> et a la fonction de densité suivante&nbsp;:</p>
<p><span id="eq-Uniforme"><span class="math display">\[
f(x ; \mathrm{a} ; \mathrm{b})=\left\{\begin{array}{cc}
\frac{1}{a-b} &amp; \text { si } a \geq x \geq b \\
0 &amp; \text { sinon }
\end{array}\right.
\tag{2.2}\]</span></span></p>
<p>La fonction de densité de la distribution uniforme a donc deux paramètres, <em>a</em> et <em>b</em>, représentant respectivement les valeurs maximale et minimale au-delà desquelles les valeurs ont une probabilité 0 d’être obtenues. Pour avoir une meilleure intuition de ce que décrit une fonction de densité, il est intéressant de la représenter avec un graphique (<a href="#fig-fig254">figure&nbsp;<span>2.6</span></a>). Notez que sur ce graphique, l’axe des ordonnées n’indique pas précisément la probabilité associée à chaque valeur, car celle-ci est infinitésimale. Il sert uniquement à représenter la valeur de la fonction de densité de la distribution pour chaque valeur de x.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig254" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig254-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.6: Distributions uniformes continues</figcaption></figure>
</div>
</div>
</div>
<p>Nous observons clairement que toutes les valeurs de <em>x</em> entre <em>a</em> et <em>b</em> ont la même probabilité pour chacune de trois distributions uniformes présentées dans le graphique. Plus l’étendue est grande (<span class="math inline">\(a-b\)</span>), plus l’espace d’échantillonnage est grand et plus la probabilité totale est répartie dans cet espace. Cette distribution est donc idéale pour décrire un phénomène pour lequel chaque valeur a autant de chance de se produire qu’une autre. Prenons pour exemple un cas fictif avec un jeu de hasard qui vous proposerait la situation suivante&nbsp;: en tirant sur la manette d’une machine à sous, un nombre est tiré aléatoirement entre -60 et +50. Si le nombre est négatif, vous perdez de l’argent et inversement si le nombre est positif. Nous pouvons représenter cette situation avec une distribution uniforme continue et l’utiliser pour calculer quelques informations essentielles&nbsp;:</p>
<ol type="1">
<li><p>Selon cette distribution, quelle est la probabilité de gagner de l’argent lors d’un tirage (x&nbsp;&gt;&nbsp;0)?</p></li>
<li><p>Quelle est la probabilité de perdre de l’argent (x &lt; 0)?</p></li>
<li><p>Si je perds moins de 30&nbsp;$ au premier tirage, quelle est la probabilité que j’ai de récupérer au moins ma mise au second tirage (x&nbsp;&gt;&nbsp;30)?</p></li>
</ol>
<p>Il est assez facile de calculer ces probabilités en utilisant la fonction <code>punif</code> dans R. Concrètement, cela permet de calculer l’intégrale de la fonction de masse sur un intervalle donné.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Probabilité d'obtenir une valeur supérieure ou égale à 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">punif</a></span><span class="op">(</span><span class="fl">0</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">60</span>, max <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5454545</code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Probabilité d'obtenir une valeur inférieure à 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">punif</a></span><span class="op">(</span><span class="fl">0</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">60</span>, max <span class="op">=</span> <span class="fl">50</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4545455</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Probabilité d'obtenir une valeur supérieure à 30</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">punif</a></span><span class="op">(</span><span class="fl">30</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">60</span>, max <span class="op">=</span> <span class="fl">50</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1818182</code></pre>
</div>
</div>
<p>Les paramètres permettent donc d’ajuster la fonction de masse ou de densité d’une distribution afin de lui permettre de prendre des formes différentes. Certains paramètres changent la localisation de la distribution (la déplacer vers la droite ou la gauche de l’axe des X), d’autres changent son degré de dispersion (distribution pointue ou aplatie) ou encore sa forme (symétrie). Les différents paramètres d’une distribution correspondent donc à sa carte d’identité et donnent une idée précise sur sa nature.</p>
<div class="bloc_aller_loin">
<div class="bloc_aller_loin-header">
<div class="bloc_aller_loin-icon">

</div>
<p><strong>Fonction de répartition, de survie et d’intensité</strong></p>
</div>
<div class="bloc_aller_loin-body">
<p>Si les fonctions de densité ou de masse d’une distribution sont le plus souvent utilisées pour décrire une distribution, d’autres types de fonctions peuvent également être employées et disposent de propriétés intéressantes.</p>
<ol type="1">
<li>La fonction de répartition&nbsp;: il s’agit d’une fonction décrivant le cumul de probabilités d’une distribution. Cette fonction a un minimum de zéro qui est obtenu pour la plus petite valeur de l’espace d’échantillonnage de la distribution, et un maximum d’un pour la plus grande valeur de ce même espace. Formellement, la fonction de répartition (<span class="math inline">\(F\)</span>) est l’intégrale de la fonction de densité (<span class="math inline">\(f\)</span>).</li>
</ol>
<p><span class="math display">\[F(x) = \int_{-\infty}^{x}f(u)du\]</span> 2. La fonction de survie&nbsp;: soit l’inverse additif de la fonction de répartition (<span class="math inline">\(R\)</span>)</p>
<p><span class="math display">\[R(x) = 1-F(x)\]</span> 3. La fonction de d’intensité, soit le quotient de la fonction de densité et de la fonction de survie (<span class="math inline">\(D\)</span>). <span class="math display">\[D(x) = \frac{f(x)}{D(x)}\]</span> Ces fonctions jouent notamment un rôle central dans la modélisation des phénomènes qui régissent la survenue des événements, par exemple la mort, les accidents de la route ou les bris d’équipement.</p>
</div>
</div>
</section><section id="principales-distributions" class="level3" data-number="2.4.3"><h3 data-number="2.4.3" class="anchored" data-anchor-id="principales-distributions">
<span class="header-section-number">2.4.3</span> Principales distributions</h3>
<p>Il existe un très grand nombre de distributions théoriques et parmi elles, de nombreuses sont en fait des cas spéciaux d’autres distributions. Pour un petit aperçu du «&nbsp;bestiaire&nbsp;», vous pouvez faire un saut à la page <a href="http://www.math.wm.edu/~leemis/chart/UDR/UDR.html" target="_blank"><em>Univariate Distribution Relationships</em></a>, qui liste près de 80 distributions.</p>
<p>Nous nous concentrons ici sur une sélection de dix-huit distributions très répandues en sciences sociales. La <a href="#fig-distribs">figure&nbsp;<span>2.7</span></a> présente graphiquement leurs fonctions de masse et de densité présentées dans cette section. Notez que ces graphiques correspondent tous à une forme possible de chaque distribution. En modifiant leurs paramètres, il est possible de produire une figure très différente. Les distributions discrètes sont représentées avec des graphiques en barre, et les distributions continues avec des graphiques de densité.</p>
<div id="fig-distribs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap02/all_distributions.png" class="img-fluid figure-img" style="width:95.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.7: Dix-huit distributions essentielles, figure inspirée de <span class="citation" data-cites="SeanOwendist">Sean (<a href="references.html#ref-SeanOwendist" role="doc-biblioref">2018</a>)</span></figcaption></figure>
</div>
<section id="distribution-uniforme-discrète" class="level4" data-number="2.4.3.1"><h4 data-number="2.4.3.1" class="anchored" data-anchor-id="distribution-uniforme-discrète">
<span class="header-section-number">2.4.3.1</span> Distribution uniforme discrète</h4>
<p>Nous avons déjà abordé cette distribution dans les exemples précédents. Elle permet de décrire un phénomène dont tous les résultats possibles ont exactement la même probabilité de se produire. L’exemple classique est bien sûr un lancer de dé.</p>
</section><section id="distribution-de-bernoulli" class="level4" data-number="2.4.3.2"><h4 data-number="2.4.3.2" class="anchored" data-anchor-id="distribution-de-bernoulli">
<span class="header-section-number">2.4.3.2</span> Distribution de Bernoulli</h4>
<p>La distribution de Bernoulli permet de décrire une expérience pour laquelle deux résultats sont possibles. Son espace d’échantillonnage est donc <span class="math inline">\([0; 1]\)</span>. Sa fonction de masse est la suivante&nbsp;:</p>
<p><span id="eq-BernoulliB"><span class="math display">\[
f(x ; p)=\left\{\begin{array}{ll}
q=1-p &amp; \text { si } x=0 \\
p &amp; \text { si } x=1
\end{array}\right.
\tag{2.3}\]</span></span></p>
<p>avec <em>p</em> la probabilité d’obtenir <span class="math inline">\(x = 1\)</span> (réussite) et donc <span class="math inline">\(1 – p\)</span> la probabilité d’avoir <span class="math inline">\(x = 0\)</span> (échec). La distribution de Bernoulli ne dépend que d’un paramètre&nbsp;: <em>p</em>, contrôlant la probabilité de réussite de l’expérience. Notez que si <span class="math inline">\(p = 1/2\)</span>, alors la distribution de Bernoulli est également une distribution uniforme. Un exemple d’application de la distribution de Bernoulli en études urbaines est la modélisation de la survie d’un ou d’une cycliste (1 pour survie, 0 pour décès) lors d’une collision avec un véhicule motorisé, selon une vitesse donnée.</p>
</section><section id="distribution-binomiale" class="level4" data-number="2.4.3.3"><h4 data-number="2.4.3.3" class="anchored" data-anchor-id="distribution-binomiale">
<span class="header-section-number">2.4.3.3</span> Distribution binomiale</h4>
<p>La distribution binomiale est utilisée pour caractériser la somme de variables aléatoires (expériences) suivant chacune une distribution de Bernoulli. Un exemple simple est l’accumulation des lancers d’une pièce de monnaie. Si nous comptons le nombre de fois où nous obtenons pile, cette expérience est décrite par une distribution binomiale. Son espace d’échantillonnage est donc <span class="math inline">\([0; +\infty[\)</span> (limité aux nombres entiers). Sa fonction de masse est la suivante&nbsp;:</p>
<p><span id="eq-Binomial"><span class="math display">\[
f(x ; n )=\binom{n}{x}p^x(1-p)^{n-x}
\tag{2.4}\]</span></span></p>
<p>avec <em>x</em> le nombre de tirages réussis sur <em>n</em> essais avec une probabilité <em>p</em> de réussite à chaque tirage (<a href="#fig-fig256">figure&nbsp;<span>2.8</span></a>). Pour reprendre l’exemple précédent concernant les accidents de la route, une distribution binomiale permettrait de représenter la distribution du nombre de cyclistes ayant survécu sur dix personnes à vélo impliquées dans un accident avec une voiture à une intersection.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig256" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig256-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.8: Distribution binomiale</figcaption></figure>
</div>
</div>
</div>
</section><section id="distribution-géométrique" class="level4" data-number="2.4.3.4"><h4 data-number="2.4.3.4" class="anchored" data-anchor-id="distribution-géométrique">
<span class="header-section-number">2.4.3.4</span> Distribution géométrique</h4>
<p>La distribution géométrique permet de représenter le nombre de tirages qu’il faut faire avec une distribution de Bernoulli avant d’obtenir une réussite. Par exemple, avec un lancer de dé, l’idée serait de compter le nombre de lancers nécessaires avant de tomber sur un 6. Son espace d’échantillonnage est donc <span class="math inline">\([1; +\infty[\)</span> (limité aux nombres entiers). Sa distribution de masse est la suivante&nbsp;:</p>
<p><span id="eq-geometrique"><span class="math display">\[
f(x; p)= (1-p)^xp
\tag{2.5}\]</span></span></p>
<p>avec <em>x</em> le nombre de tentatives avant d’obtenir une réussite, <span class="math inline">\(f(x)\)</span> la probabilité que le premier succès n’arrive qu’après <em>x</em> tentatives et <em>p</em> la probabilité de réussite à chaque tentative (<a href="#fig-fig257">figure&nbsp;<span>2.9</span></a>). Cette distribution est notamment utilisée en marketing pour modéliser le nombre d’appels nécessaires avant de réussir une vente.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig257" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig257-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.9: Distribution géométrique</figcaption></figure>
</div>
</div>
</div>
</section><section id="distribution-binomiale-négative" class="level4" data-number="2.4.3.5"><h4 data-number="2.4.3.5" class="anchored" data-anchor-id="distribution-binomiale-négative">
<span class="header-section-number">2.4.3.5</span> Distribution binomiale négative</h4>
<p>La distribution binomiale négative est proche de la distribution géométrique. Elle permet de représenter le nombre de tentatives nécessaires afin d’obtenir un nombre <em>n</em> de réussites <span class="math inline">\([1; +\infty[\)</span> (limité aux nombres entiers positifs). Sa formule est la suivante&nbsp;:</p>
<p><span id="eq-binomialnegative"><span class="math display">\[
f(x; n; p)=\left(\begin{array}{c}
x+n-1 \\
n
\end{array}\right) p^{n}(1-p)^{x}
\tag{2.6}\]</span></span></p>
<p>avec <em>x</em> le nombre de tentatives avant d’obtenir <em>n</em> réussites et <em>p</em> la probabilité d’obtenir une réussite à chaque tentative (<a href="#fig-fig258">figure&nbsp;<span>2.10</span></a>). Cette distribution pourrait être utilisée pour modéliser le nombre de questionnaires <em>x</em> à envoyer pour une enquête pour obtenir au moins <em>n</em> réponses, sachant que la probabilité d’une réponse est <em>p</em>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig258" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig258-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.10: Distribution binomiale négative</figcaption></figure>
</div>
</div>
</div>
</section><section id="distribution-de-poisson" class="level4" data-number="2.4.3.6"><h4 data-number="2.4.3.6" class="anchored" data-anchor-id="distribution-de-poisson">
<span class="header-section-number">2.4.3.6</span> Distribution de Poisson</h4>
<p>La distribution de Poisson est utilisée pour modéliser des comptages. Son espace d’échantillonnage est donc <span class="math inline">\([0; +\infty[\)</span> (limité aux nombres entiers positifs). Par exemple, il est possible de compter à une intersection le nombre de collisions entre des automobilistes et des cyclistes sur une période donnée. Cet exemple devrait vous faire penser à la distribution binomiale vue plus haut. En effet, il est possible de noter chaque rencontre entre une voiture et un ou une cycliste et de considérer que leur collision est une «&nbsp;réussite&nbsp;» (0&nbsp;: pas d’accidents, 1&nbsp;: accident). Cependant, ce type de données est fastidieux à collecter comparativement au simple comptage des accidents. La distribution de Poisson a une fonction de densité avec un seul paramètre généralement noté <span class="math inline">\(\lambda\)</span> (lambda) et est décrite par la formule suivante&nbsp;:</p>
<p><span id="eq-poisson"><span class="math display">\[
f(x; \lambda)=\frac{\lambda^{x}}{x !} e^{-\lambda}
\tag{2.7}\]</span></span> avec <em>x</em> le nombre de cas, <em>f(x)</em> la probabilité d’obtenir <em>x</em> sachant <span class="math inline">\(\lambda\)</span>. <span class="math inline">\(\lambda\)</span> peut être vu comme le taux moyen d’occurrences (nombre d’évènements divisé par la durée totale de l’expérience). Il permet à la fois de caractériser le centre et la dispersion de la distribution. Notez également que plus le paramètre <span class="math inline">\(\lambda\)</span> augmente, plus la distribution de Poisson tend vers une distribution normale.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig259" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig259-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.11: Distribution de Poisson</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-poissonzero" class="level4" data-number="2.4.3.7"><h4 data-number="2.4.3.7" class="anchored" data-anchor-id="sec-poissonzero">
<span class="header-section-number">2.4.3.7</span> Distribution de Poisson avec excès de zéros</h4>
<p>Il arrive régulièrement qu’une variable de comptage mesurée produise un très grand nombre de zéros. Prenons pour exemple le nombre de seringues de drogue injectable par tronçon de rue ramassées sur une période d’un mois. À l’échelle de toute une ville, un très grand nombre de tronçons n’auront tout simplement aucune seringue et dans ce contexte, la distribution classique de Poisson n’est pas adaptée. Nous lui préférons alors une autre distribution&nbsp;: la distribution de Poisson avec excès de zéros (ou distribution de Pólya) qui inclut un paramètre contrôlant la forte présence de zéros. Sa fonction de densité est la suivante&nbsp;:</p>
<p><span id="eq-poissonzi"><span class="math display">\[
f(x; \lambda; p)=(1-p)\frac{\lambda^{x}}{x !} e^{-\lambda}
\tag{2.8}\]</span></span></p>
<p>Plus exactement, la distribution de Poisson avec excès de zéro (<em>zero-inflated</em> en anglais) est une combinaison de deux processus générant des zéros. En effet, un zéro peut être produit par la distribution de Poisson proprement dite (aussi appelé vrai zéro) ou alors par le processus générant les zéros excédentaires dans le jeu de données, capturé par la probabilité <em>p</em> (faux zéro). <em>p</em> est donc le paramètre contrôlant la probabilité d’obtenir un zéro, indépendamment du phénomène étudié.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig259b" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig259b-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.12: Distribution de Poisson avec excès de zéros</figcaption></figure>
</div>
</div>
</div>
</section><section id="distribution-gaussienne" class="level4" data-number="2.4.3.8"><h4 data-number="2.4.3.8" class="anchored" data-anchor-id="distribution-gaussienne">
<span class="header-section-number">2.4.3.8</span> Distribution gaussienne</h4>
<p>Plus communément appelée la distribution normale, la distribution gaussienne est utilisée pour représenter des variables continues centrées sur leur moyenne. Son espace d’échantillonnage est <span class="math inline">\(]-\infty; +\infty[\)</span>. Cette distribution joue un rôle central en statistique. Selon la formule consacrée, cette distribution résulte de la superposition d’un très grand nombre de petits effets fortuits indépendants. C’est ce qu’exprime formellement le théorème central limite qui montre que la somme d’un grand nombre de variables aléatoires tend généralement vers une distribution normale. Autrement dit, lorsque nous répétons une même expérience et que nous conservons les résultats de ces expériences, la distribution du résultat de ces expériences tend vers la normalité. Cela s’explique par le fait qu’en moyenne, chaque répétition de l’expérience produit le même résultat, mais qu’un ensemble de petits facteurs aléatoires viennent ajouter de la variabilité dans les données collectées. Prenons un exemple concret&nbsp;: si nous plantons une centaine d’arbres simultanément dans un parc avec un degré d’ensoleillement identique et que nous leur apportons les mêmes soins pendant dix ans, la distribution de leurs tailles suivra une distribution normale. Un ensemble de facteurs aléatoires (composition du sol, exposition au vent, aléas génétiques, passage de nuages, etc.) auront affecté différemment chaque arbre, ajoutant ainsi un peu de hasard dans leur taille finale. Cette dernière est cependant davantage affectée par des paramètres majeurs (comme l’espèce, l’ensoleillement, l’arrosage, etc.), et est donc centrée autour d’une moyenne. La fonction de densité de la distribution normale est la suivante&nbsp;:</p>
<p><span id="eq-gaussien"><span class="math display">\[
f(x ; \mu ; \sigma)=\frac{1}{\sigma \sqrt{2 \pi}} e^{-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^{2}}
\tag{2.9}\]</span></span></p>
<p>avec <em>x</em> une valeur dont nous souhaitons connaître la probabilité, <em>f(x)</em> sa probabilité, <span class="math inline">\(\mu\)</span> (mu) la moyenne de la distribution normale (paramètre de localisation) et <span class="math inline">\(\sigma\)</span> (sigma) son écart-type (paramètre de dispersion). Cette fonction suit une courbe normale ayant une forme de cloche. Notez que&nbsp;:</p>
<ul>
<li>68,2&nbsp;% de la masse de la distribution normale est comprise dans l’intervalle <span class="math inline">\([\mu- \sigma≤x≤ \mu+ \sigma]\)</span>
</li>
<li>95,4&nbsp;% dans l’intervalle <span class="math inline">\([\mu- 2\sigma≤x≤ \mu+ 2\sigma]\)</span>
</li>
<li>99,7&nbsp;% dans l’intervalle <span class="math inline">\([\mu- 3\sigma≤x≤ \mu+ 3\sigma]\)</span>
</li>
</ul>
<p>Autrement dit, dans le cas d’une distribution normale, il est très invraisemblable d’observer des données situées à plus de trois écarts types de la moyenne. Ces différentes égalités sont vraies <strong>quelles que soient les valeurs de la moyenne et de l’écart-type</strong>. Notez ici que lorsque <span class="math inline">\(\mu = 0\)</span> et <span class="math inline">\(\sigma = 1\)</span>, nous obtenons la loi normale générale (ou centrée réduite) (<a href="#sec-02552">section&nbsp;<span>2.5.5.2</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig260" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig260-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.13: Distribution gaussienne</figcaption></figure>
</div>
</div>
</div>
</section><section id="distribution-gaussienne-asymétrique" class="level4" data-number="2.4.3.9"><h4 data-number="2.4.3.9" class="anchored" data-anchor-id="distribution-gaussienne-asymétrique">
<span class="header-section-number">2.4.3.9</span> Distribution gaussienne asymétrique</h4>
<p>La distribution normale asymétrique (<em>skew-normal</em>) est une extension de la distribution gaussienne permettant de lever la contrainte de symétrie de la simple distribution gaussienne. Son espace d’échantillonnage est donc <span class="math inline">\(]-\infty; +\infty[\)</span>. Sa fonction de densité est la suivante&nbsp;:</p>
<p><span id="eq-skewgaussien"><span class="math display">\[
f(x;\xi;\omega;\alpha) = \frac{2}{\omega \sqrt{2 \pi}} e^{-\frac{(x-\xi)^{2}}{2 \omega^{2}}} \int_{-\infty}^{\alpha\left(\frac{x-\xi}{\omega}\right)} \frac{1}{\sqrt{2 \pi}} e^{-\frac{t^{2}}{2}} d t
\tag{2.10}\]</span></span></p>
<p>avec <span class="math inline">\(\xi\)</span> (xi) le paramètre de localisation, <span class="math inline">\(\omega\)</span> (omega) le paramètre de dispersion (ou d’échelle) et <span class="math inline">\(\alpha\)</span> (alpha) le paramètre de forme (contrôlant le degré de symétrie). Si <span class="math inline">\(\alpha = 0\)</span>, alors la distribution normale asymétrique est une distribution normale ordinaire. Ce type de distribution est très utile lorsque nous souhaitons modéliser une variable pour laquelle nous savons que des valeurs plus extrêmes s’observeront d’un côté ou de l’autre de la distribution. Les revenus totaux annuels des personnes ou des ménages sont de très bons exemples puisqu’ils sont distribués généralement avec une asymétrie positive&nbsp;: bien qu’une moyenne existe, il y a généralement plus de personnes ou de ménages avec des revenus très faibles que de personnes ou de ménages avec des revenus très élevés.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig261" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig261-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.14: Distribution gaussienne asymétrique</figcaption></figure>
</div>
</div>
</div>
</section><section id="distribution-log-normale" class="level4" data-number="2.4.3.10"><h4 data-number="2.4.3.10" class="anchored" data-anchor-id="distribution-log-normale">
<span class="header-section-number">2.4.3.10</span> Distribution log-normale</h4>
<p>Au même titre que la distribution normale asymétrique, la distribution log-normale est une version asymétrique de la distribution normale. Son espace d’échantillonnage est <span class="math inline">\(]0; +\infty[\)</span>. Cela signifie que cette distribution ne peut décrire que des données continues et positives. Sa fonction de densité est la suivante&nbsp;:</p>
<p><span id="eq-loggaussien"><span class="math display">\[
f(x ; \mu ; \sigma)=\frac{1}{x \sigma \sqrt{2 \pi}} e^{-\left(\frac{(\ln x-\mu)^{2}}{2 \sigma^{2}}\right)}
\tag{2.11}\]</span></span></p>
<p>À la différence la distribution <em>skew-normal</em>, la distribution log-normale ne peut avoir qu’une asymétrie positive (étirée vers la droite). Elle est cependant intéressante puisqu’elle ne compte que deux paramètres (<span class="math inline">\(\mu\)</span> et <span class="math inline">\(\sigma\)</span>), ce qui la rend plus facile à ajuster. À nouveau, une distribution log-normale peut être utilisée pour décrire les revenus totaux annuels des individus ou des ménages ou les revenus d’emploi. Elle est aussi utilisée en économie sur les marchés financiers pour représenter les cours des actions et des biens (ces derniers ne pouvant pas être inférieurs à 0).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig262" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig262-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.15: Distribution log-gaussienne</figcaption></figure>
</div>
</div>
</div>
<p>Plus spécifiquement, la distribution log-normale est une transformation de la distribution normale. Comme son nom l’indique, elle permet de décrire le logarithme d’une variable aléatoire suivant une distribution normale.</p>
</section><section id="sec-024311" class="level4" data-number="2.4.3.11"><h4 data-number="2.4.3.11" class="anchored" data-anchor-id="sec-024311">
<span class="header-section-number">2.4.3.11</span> Distribution de Student</h4>
<p>La distribution de Student joue un rôle important en statistique. Elle est par exemple utilisée lors du test <em>t</em> pour calculer le degré de significativité du test. Comme la distribution gaussienne, la distribution de Student a une forme de cloche, est centrée sur sa moyenne et définie sur <span class="math inline">\(]-\infty; +\infty[\)</span>. Elle se distingue de la distribution normale principalement par le rôle que joue son troisième paramètre, <span class="math inline">\(\nu\)</span>&nbsp;: le nombre de degrés de liberté, contrôlant le poids des queues de la distribution. Une petite valeur de <span class="math inline">\(\nu\)</span> signifie que la distribution a des «&nbsp;queues plus lourdes&nbsp;» (<em>heavy tails</em> en anglais). Entendez par-là que les valeurs extrêmes ont une plus grande probabilité d’occurrence&nbsp;:</p>
<p><span id="eq-student"><span class="math display">\[
p(x ; \nu ; \hat{\mu} ; \hat{\sigma})=\frac{\Gamma\left(\frac{\nu+1}{2}\right)}{\Gamma\left(\frac{\nu}{2}\right) \sqrt{\pi \nu} \hat{\sigma}}\left(1+\frac{1}{\nu}\left(\frac{x-\hat{\mu}}{\hat{\sigma}}\right)^{2}\right)^{-\frac{\nu+1}{2}}
\tag{2.12}\]</span></span></p>
<p>avec <span class="math inline">\(\mu\)</span> le paramètre de localisation, <span class="math inline">\(\sigma\)</span> le paramètre de dispersion (qui n’est cependant pas un écart-type comme pour la distribution normale) et <span class="math inline">\(\nu\)</span> le nombre de degrés de liberté. Plus <span class="math inline">\(\nu\)</span> est grand, plus la distribution de Student tend vers une distribution normale. Ici, la lettre grecque <span class="math inline">\(\Gamma\)</span> représente la fonction mathématique gamma (à ne pas confondre avec la distribution Gamma). Un exemple d’application en études urbaines est l’exposition au bruit environnemental de cyclistes. Cette distribution s’approcherait certainement d’une distribution normale, mais les cyclistes croisent régulièrement des secteurs peu bruyants (parcs, rues résidentielles, etc.) et des secteurs très bruyants (artères majeures, zones industrielles, etc.), plus souvent que ce que prévoit une distribution normale, justifiant le choix d’une distribution de Student.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig263" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig263-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.16: Distribution de Student</figcaption></figure>
</div>
</div>
</div>
</section><section id="distribution-de-cauchy" class="level4" data-number="2.4.3.12"><h4 data-number="2.4.3.12" class="anchored" data-anchor-id="distribution-de-cauchy">
<span class="header-section-number">2.4.3.12</span> Distribution de Cauchy</h4>
<p>La distribution de Cauchy est également une distribution symétrique définie sur l’intervalle <span class="math inline">\(]-\infty; +\infty[\)</span>. Elle a comme particularité d’être plus aplatie que la distribution de Student (d’avoir des queues potentiellement plus lourdes). Elle est notamment utilisée pour modéliser des phénomènes extrêmes comme les précipitations maximales annuelles, les niveaux d’inondations maximaux annuels ou les seuils critiques de perte pour les portefeuilles financiers. Il est également intéressant de noter que le quotient de deux variables indépendantes normalement distribuées suit une distribution de Cauchy. Sa fonction de densité est la suivante&nbsp;:</p>
<p><span id="eq-cauchy"><span class="math display">\[
\frac{1}{\pi \gamma}\left[\frac{\gamma^{2}}{\left(x-x_{0}\right)^{2}+\gamma^{2}}\right]
\tag{2.13}\]</span></span></p>
<p>Elle dépend donc de deux paramètres&nbsp;: <span class="math inline">\(x_0\)</span>, le paramètre de localisation indiquant le pic de la distribution et <span class="math inline">\(\gamma\)</span>, un paramètre de dispersion.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig264" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig264-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.17: Distribution de Cauchy</figcaption></figure>
</div>
</div>
</div>
</section><section id="distribution-du-khi-deux" class="level4" data-number="2.4.3.13"><h4 data-number="2.4.3.13" class="anchored" data-anchor-id="distribution-du-khi-deux">
<span class="header-section-number">2.4.3.13</span> Distribution du khi-deux</h4>
<p>La distribution du khi-deux est utilisée dans de nombreux tests statistiques. Par exemple, le test du khi-deux de Pearson est utilisé pour comparer les écarts au carré entre des fréquences attendues et observées de deux variables qualitatives. La distribution du khi-deux décrit plus généralement la somme des carrés d’un nombre <em>k</em> de variables indépendantes normalement distribuées. Il est assez rare de modéliser un phénomène à l’aide d’une distribution du khi-deux, mais son omniprésence dans les tests statistiques justifie qu’elle soit mentionnée ici. Cette distribution est définie sur l’intervalle <span class="math inline">\([0; +\infty[\)</span> et a pour fonction de densité&nbsp;:</p>
<p><span id="eq-chi2"><span class="math display">\[
f(x;k) = \frac{1}{2^{k / 2} \Gamma(k / 2)} x^{k / 2-1} e^{-x / 2}
\tag{2.14}\]</span></span></p>
<p>La distribution du khi-deux n’a qu’un paramètre <em>k</em>, représentant donc le nombre de variables mises au carré et dont nous faisons la somme pour obtenir la distribution du khi-deux.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig265" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig265-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.18: Distribution du khi-deux</figcaption></figure>
</div>
</div>
</div>
</section><section id="distribution-exponentielle" class="level4" data-number="2.4.3.14"><h4 data-number="2.4.3.14" class="anchored" data-anchor-id="distribution-exponentielle">
<span class="header-section-number">2.4.3.14</span> Distribution exponentielle</h4>
<p>La distribution exponentielle est une version continue de la distribution géométrique. Pour cette dernière, nous nous intéressons au nombre de tentatives nécessaires pour obtenir un résultat positif, soit une dimension discrète. Pour la distribution exponentielle, cette dimension discrète est remplacée par une dimension continue. L’exemple le plus intuitif est sûrement le cas du temps. Dans ce cas, la distribution exponentielle sert à modéliser le temps d’attente nécessaire pour qu’un évènement se produise. Il peut aussi s’agir d’une force que nous appliquons jusqu’à ce qu’un matériau cède. Cette distribution est donc définie sur l’intervalle [0; +<span class="math inline">\(\infty\)</span>[ et a pour fonction de densité&nbsp;:</p>
<p><span id="eq-exponentiel"><span class="math display">\[
f(x;\lambda) = \lambda e^{-\lambda x}
\tag{2.15}\]</span></span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig266" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig266-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.19: Distribution exponentielle</figcaption></figure>
</div>
</div>
</div>
<p>La distribution exponentielle est conceptuellement proche de la distribution de Poisson. La distribution de Poisson régit le nombre des événements qui surviennent au cours d’un laps de temps donné. La distribution exponentielle peut servir à modéliser le temps qui s’écoule entre deux événements.</p>
</section><section id="sec-024315" class="level4" data-number="2.4.3.15"><h4 data-number="2.4.3.15" class="anchored" data-anchor-id="sec-024315">
<span class="header-section-number">2.4.3.15</span> Distribution Gamma</h4>
<p>La distribution Gamma peut être vue comme la généralisation d’un grand nombre de distributions. Ainsi, les distributions exponentielle et du khi-deux peuvent être vues comme des cas particuliers de la distribution Gamma. Cette distribution est définie sur l’intervalle ]0; +<span class="math inline">\(\infty\)</span>[ (notez que le 0 est exclu) et sa fonction de densité est la suivante&nbsp;:</p>
<p><span id="eq-gamma"><span class="math display">\[
f(x ; \alpha; \beta)=\frac{\beta^{\alpha} x^{\alpha-1} e^{-\beta x}}{\Gamma(\alpha)}
\tag{2.16}\]</span></span></p>
<p>Elle comprend donc deux paramètres&nbsp;: <span class="math inline">\(\alpha\)</span> et <span class="math inline">\(\beta\)</span>. Le premier est le paramètre de forme et le second un paramètre d’échelle (à l’inverse d’un paramètre de dispersion, plus sa valeur est petite, plus la distribution est dispersée). Notez que cette distribution ne dispose pas d’un paramètre de localisation. Du fait de sa flexibilité, cette distribution est largement utilisée, notamment pour la modélisation des temps d’attente avant un évènement, de la taille des réclamations d’assurance, des quantités de précipitations, etc.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig267" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig267-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.20: Distribution Gamma</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-024316" class="level4" data-number="2.4.3.16"><h4 data-number="2.4.3.16" class="anchored" data-anchor-id="sec-024316">
<span class="header-section-number">2.4.3.16</span> Distribution bêta</h4>
<p>La distribution bêta est définie sur l’intervalle [0; 1], elle est donc énormément utilisée pour modéliser des variables étant des proportions ou des probabilités.</p>
<p>La distribution bêta a été élaborée pour modéliser la superposition d’un très grand nombre de petits effets fortuits qui ne sont pas indépendants et notamment pour étudier l’effet de la réalisation d’un événement aléatoire sur la probabilité des tirages subséquents. Elle a aussi une utilité pratique en statistique, car elle peut être combinée avec d’autres distributions (distribution bêta binomiale, bêta négative binomiale, etc.). Un autre usage plus rare mais intéressant est la modélisation de la fraction du temps représentée par une tâche dans le temps nécessaire à la réalisation de deux tâches de façon séquentielle. Cela est dû au fait que la distribution d’une distribution Gamma <em>g1</em> divisée par la somme de <em>g1</em> et d’une autre distribution Gamma <em>g2</em> suit une distribution bêta. Un exemple concret est, par exemple, la fraction du temps effectué à pied dans un déplacement multimodal. La distribution de bêta a la fonction de densité suivante&nbsp;:</p>
<p><span id="eq-beta"><span class="math display">\[
f(x;\alpha;\beta) = \frac{1}{\mathrm{B}(\alpha, \beta)} x^{\alpha-1}(1-x)^{\beta-1}
\tag{2.17}\]</span></span></p>
<p>Elle a donc deux paramètres <span class="math inline">\(\alpha\)</span> et <span class="math inline">\(\beta\)</span> contrôlant tous les deux la forme de la distribution. Cette caractéristique lui permet d’avoir une très grande flexibilité et même d’adopter des formes bimodales. <span class="math inline">\(B\)</span> correspond à la fonction mathématique Beta&nbsp;: ne pas la confondre avec la distribution Beta et le paramètre Beta (<span class="math inline">\(\beta\)</span>) de cette même distribution.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig268" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig268-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.21: Distribution bêta</figcaption></figure>
</div>
</div>
</div>
</section><section id="distribution-de-weibull" class="level4" data-number="2.4.3.17"><h4 data-number="2.4.3.17" class="anchored" data-anchor-id="distribution-de-weibull">
<span class="header-section-number">2.4.3.17</span> Distribution de Weibull</h4>
<p>La distribution de Weibull est directement liée à la distribution exponentielle, cette dernière étant en fait un cas particulier de distribution Weibull. Elle sert donc souvent à modéliser une quantité <em>x</em> (souvent le temps) à accumuler pour qu’un évènement se produise. La distribution de Weibull est définie sur l’intervalle [0; +<span class="math inline">\(\infty\)</span>[ et a la fonction de densité suivante&nbsp;:</p>
<p><span id="eq-weibull"><span class="math display">\[
f(x;\lambda) = \frac{k}{\lambda} (\frac{x}{\lambda})^{k-1} e^{-(\frac{x}{\lambda})^k}
\tag{2.18}\]</span></span></p>
<p><span class="math inline">\(\lambda\)</span> est le paramètre de dispersion (analogue à celui d’une distribution exponentielle classique) et <em>k</em> le paramètre de forme. Pour bien comprendre le rôle de <em>k</em>, prenons un exemple&nbsp;: la propagation d’un champignon d’un arbre à son voisin. Si <span class="math inline">\(k&lt;1\)</span>, le risque instantané que l’évènement modélisé se produise diminue avec le temps (en d’autres termes, plus le temps passe, plus petite devient la probabilité d’être contaminé). Si <span class="math inline">\(k=1\)</span>, alors le risque instantané que l’évènement se produise reste identique dans le temps (la loi de Weibull se résume alors à une loi exponentielle). Si <span class="math inline">\(k &gt; 1\)</span>, alors le risque instantané que l’évènement se produise augmente avec le temps (la probabilité pour un arbre d’être contaminé s’il ne l’a pas déjà été — pas seulement le risque cumulé — augmente en fonction du temps). La distribution de Weibull est très utilisée en analyse de survie, en météorologie, en ingénierie des matériaux et dans la théorie des valeurs extrêmes.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig269" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig269-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.22: Distribution de Weibull</figcaption></figure>
</div>
</div>
</div>
</section><section id="distribution-pareto" class="level4" data-number="2.4.3.18"><h4 data-number="2.4.3.18" class="anchored" data-anchor-id="distribution-pareto">
<span class="header-section-number">2.4.3.18</span> Distribution Pareto</h4>
<p>Cette distribution a été élaborée par Vilfredo Pareto pour donner une forme mathématique à ce qui porte aujourd’hui le nom de principe de Pareto et que nous exprimons souvent de manière imagée — dans une société donnée, 20&nbsp;% des individus possèdent 80&nbsp;% de la richesse —, mais qui est plus justement exprimée en écrivant que, de manière générale, dans toute société, la plus grande partie du capital est détenue par une petite fraction de la population. Elle est définie sur l’intervalle <span class="math inline">\([x_m; +\infty[\)</span> avec la fonction de densité suivante&nbsp;:</p>
<p><span id="eq-pareto"><span class="math display">\[
f(x;x_m;k) = (\frac{x_m}{x})^k
\tag{2.19}\]</span></span></p>
<p>Elle comprend donc deux paramètres, <span class="math inline">\(x_m\)</span> étant un paramètre de localisation (décalant la distribution vers la droite ou vers la gauche) et <span class="math inline">\(k\)</span> un paramètre de forme. Plus <span class="math inline">\(k\)</span> augmente, plus la probabilité prédite par la distribution décroît rapidement.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig270" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-fig270-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.23: Distribution de Pareto</figcaption></figure>
</div>
</div>
</div>
<p>Au-delà de la question de la répartition de la richesse, la distribution de Pareto peut également être utilisée pour décrire la répartition de la taille des villes <span class="citation" data-cites="William_pareto_ville">(<a href="references.html#ref-William_pareto_ville" role="doc-biblioref">Reed 2002</a>)</span>, <a href="https://medium.com/@worstonlinedater/tinder-experiments-ii-guys-unless-you-are-really-hot-you-are-probably-better-off-not-wasting-your-2ddf370a6e9a" target="_blank">la popularité des hommes sur Tinder</a> ou la taille des fichiers échangés sur Internet <span class="citation" data-cites="William_pareto">(<a href="references.html#ref-William_pareto" role="doc-biblioref">Reed et Jorgensen 2004</a>)</span>. Pour ces trois exemples, nous avons les situations suivantes&nbsp;: de nombreuses petites villes, profils peu attractifs, petits fichiers échangés et à l’inverse très peu de grandes villes, profils très attractifs, gros fichiers échangés.</p>
<p>La loi de Pareto est liée à la loi exponentielle. Si une variable aléatoire suit une loi de Pareto, le logarithme du quotient de cette variable et de son paramètre de localisation est une variable aléatoire qui suit une loi exponentielle.</p>
</section><section id="cas-particuliers" class="level4" data-number="2.4.3.19"><h4 data-number="2.4.3.19" class="anchored" data-anchor-id="cas-particuliers">
<span class="header-section-number">2.4.3.19</span> Cas particuliers</h4>
<p>Sachez également qu’il existe des distributions «&nbsp;plus exotiques&nbsp;» que nous n’abordons pas ici, mais auxquelles vous pourriez être confrontés un jour&nbsp;:</p>
<ul>
<li><p>Les distributions sphériques, servant à décrire des données dont le 0 est équivalent à la valeur maximale. Par exemple, des angles puisque 0 et 360 degrés sont identiques.</p></li>
<li><p>Les distributions composées (<em>mixture distributions</em>), permettant de modéliser des phénomènes issus de la superposition de plusieurs distributions. Par exemple, la distribution de la taille de l’ensemble des êtres humains est en réalité une superposition de deux distributions gaussiennes, une pour chaque sexe, puisque ces deux distributions n’ont pas la même moyenne ni le même écart-type.</p></li>
<li><p>Les distributions multivariées permettant de décrire des phénomènes multidimensionnels. Par exemple, la réussite des élèves en français et en mathématique pourrait être modélisée par une distribution gaussienne bivariée plutôt que deux distributions distinctes. Ce choix serait pertinent si nous présumons que ces deux variables sont corrélées plutôt qu’indépendantes.</p></li>
<li><p>Les distributions censurées décrivant des variables pour lesquelles les données sont issues d’un tirage «&nbsp;censuré&nbsp;». En d’autres termes, la variable étudiée varie sur une certaine étendue, mais du fait du processus de tirage (collecte des données), les valeurs au-delà de certaines limites sont censurées. Un bon exemple est la mesure de la pollution sonore avec un capteur incapable de détecter des niveaux sonores en dessous de 55 décibels. Il arrive parfois en ville que les niveaux sonores descendent plus bas que ce seuil, mais les données collectées ne le montrent pas. Dans ce contexte, il est important d’utiliser des versions censurées des distributions présentées précédemment. Les observations au-delà de la limite sont conservées dans l’analyse, mais nous ne disposons que d’une information partielle à leur égard (elles sont au-delà de la limite).</p></li>
<li><p>Les distributions tronquées, souvent confondues avec les distributions censurées, décrivent des situations où des données au-delà d’une certaine limite sont impossibles à collecter et retirées simplement de l’analyse.</p></li>
</ul></section></section><section id="conclusion-sur-les-distributions" class="level3" data-number="2.4.4"><h3 data-number="2.4.4" class="anchored" data-anchor-id="conclusion-sur-les-distributions">
<span class="header-section-number">2.4.4</span> Conclusion sur les distributions</h3>
<p>Voilà qui conclut cette exploration des principales distributions à connaître. L’idée n’est bien sûr pas de toutes les retenir par cœur (et encore moins les formules mathématiques), mais plutôt de se rappeler dans quels contextes elles peuvent être utiles. Vous aurez certainement besoin de relire cette section avant d’aborder le <a href="08-GLM.html">chapitre&nbsp;<span>8</span></a> portant sur les modèles linéaires généralisés (GLM). Wikipédia dispose d’informations très détaillées sur chaque distribution si vous avez besoin d’informations complémentaires. Pour un tour d’horizon plus exhaustif des distributions, vous pouvez aussi faire un tour sur les projets <a href="https://sites.google.com/site/probonto/home" target="_blank">ProbOnto</a> et <a href="https://blog.wolfram.com/2013/02/01/the-ultimate-univariate-probability-distribution-explorer/" target="_blank"><em>the ultimate probability distribution explorer</em></a>.</p>
</section></section><section id="sec-025" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="sec-025">
<span class="header-section-number">2.5</span> Statistiques descriptives sur des variables quantitatives</h2>
<section id="sec-0251" class="level3" data-number="2.5.1"><h3 data-number="2.5.1" class="anchored" data-anchor-id="sec-0251">
<span class="header-section-number">2.5.1</span> Paramètres de tendance centrale</h3>
<p>Trois mesures de tendance centrale permettent de résumer rapidement une variable quantitative&nbsp;:</p>
<ul>
<li><p>La <strong>moyenne arithmétique</strong> est simplement la somme des données d’une variable divisée par le nombre d’observations (<em>n</em>), soit <span class="math inline">\(\frac{\sum_{i=1}^n x_i}{n}\)</span> notée <span class="math inline">\(\mu\)</span> (prononcé <em>mu</em>) pour des données pour une population et <span class="math inline">\(\bar{x}\)</span> (prononcé <em>x barre</em>) pour un échantillon.</p></li>
<li><p>La <strong>médiane</strong> est la valeur qui coupe la distribution d’une variable d’une population ou d’un échantillon en deux parties égales. Autrement dit, 50&nbsp;% des valeurs des observations lui sont supérieures et 50&nbsp;% lui sont inférieures.</p></li>
<li><p>Le <strong>mode</strong> est la valeur la plus fréquente parmi un ensemble d’observations pour une variable. Il s’applique ainsi à des variables discrètes (avec un nombre fini de valeurs discrètes dans un intervalle donné) et non à des variables continues (avec un nombre infini de valeurs réelles dans un intervalle donné). Prenons deux variables&nbsp;: l’une discrète relative au nombre d’accidents par intersection (avec <span class="math inline">\(X \in \left[0,20\right]\)</span>) et l’autre continue relative à la distance de dépassement (en mètres) d’une personne à vélo par une personne conduisant un véhicule motorisé (avec <span class="math inline">\(X \in \left[0,5\right]\)</span>). Pour la première, le mode – la valeur la plus fréquente – est certainement 0. Pour la seconde, identifier le mode n’est pas pertinent puisqu’il peut y avoir un nombre infini de valeurs entre 0 et 5 mètres.</p></li>
</ul>
<p><strong>Il convient de ne pas confondre moyenne et médiane!</strong> Dans le <a href="#tbl-RevMoyMed">tableau&nbsp;<span>2.1</span></a>, nous avons reporté les valeurs moyennes et médianes des revenus des ménages pour les municipalités de l’île de Montréal en 2015. Par exemple, les 8685 ménages résidant à Wesmount disposaient en moyenne d’un revenu de 295&nbsp;099&nbsp;$; la moitié de ces 8685 ménages avaient un revenu inférieur à 100&nbsp;153&nbsp;$ et l’autre moitié un revenu supérieur à cette valeur (médiane). Cela démontre clairement que la moyenne peut être grandement affectée par des valeurs extrêmes (faibles ou fortes). Autrement dit, plus l’écart entre les valeurs de la moyenne et la médiane est important, plus les données de la variable sont inégalement réparties. À Westmount, soit la municipalité la plus nantie de l’île de Montréal, les valeurs extrêmes sont des ménages avec des revenus très élevés tirant fortement la moyenne vers le haut. À l’inverse, le faible écart entre les valeurs moyenne et médiane dans la municipalité de Montréal-Est (58&nbsp;594&nbsp;$ versus 50&nbsp;318&nbsp;$) souligne que les revenus des ménages sont plus également répartis. Cela explique que pour comparer les revenus totaux ou d’emploi entre différents groupes (selon le sexe, le groupe d’âge, le niveau d’éducation, la municipalité ou région métropolitaine, etc.), nous privilégions habituellement l’utilisation des revenus médians.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-RevMoyMed" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;2.1: Revenus moyens et médians des ménages en dollars, municipalités de l’île de Montréal, 2015</caption>
<colgroup>
<col style="width: 34%">
<col style="width: 26%">
<col style="width: 18%">
<col style="width: 20%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Municipalité</th>
<th style="text-align: right;">Nombre de ménages</th>
<th style="text-align: right;">Revenu moyen</th>
<th style="text-align: right;">Revenu médian</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Baie-D’Urfé</td>
<td style="text-align: right;">1 330</td>
<td style="text-align: right;">171 390</td>
<td style="text-align: right;">118 784</td>
</tr>
<tr class="even">
<td style="text-align: left;">Beaconsfield</td>
<td style="text-align: right;">6 660</td>
<td style="text-align: right;">187 173</td>
<td style="text-align: right;">123 392</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Côte-Saint-Luc</td>
<td style="text-align: right;">13 490</td>
<td style="text-align: right;">94 570</td>
<td style="text-align: right;">58 935</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dollard-Des Ormeaux</td>
<td style="text-align: right;">17 210</td>
<td style="text-align: right;">102 104</td>
<td style="text-align: right;">78 981</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dorval</td>
<td style="text-align: right;">8 390</td>
<td style="text-align: right;">89 952</td>
<td style="text-align: right;">64 689</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hampstead</td>
<td style="text-align: right;">2 470</td>
<td style="text-align: right;">250 497</td>
<td style="text-align: right;">122 496</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kirkland</td>
<td style="text-align: right;">6 685</td>
<td style="text-align: right;">144 676</td>
<td style="text-align: right;">115 381</td>
</tr>
<tr class="even">
<td style="text-align: left;">Montréal</td>
<td style="text-align: right;">779 805</td>
<td style="text-align: right;">69 047</td>
<td style="text-align: right;">50 227</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Montréal-Est</td>
<td style="text-align: right;">1 730</td>
<td style="text-align: right;">58 594</td>
<td style="text-align: right;">50 318</td>
</tr>
<tr class="even">
<td style="text-align: left;">Montréal-Ouest</td>
<td style="text-align: right;">1 850</td>
<td style="text-align: right;">159 374</td>
<td style="text-align: right;">115 029</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mont-Royal</td>
<td style="text-align: right;">7 370</td>
<td style="text-align: right;">205 309</td>
<td style="text-align: right;">109 540</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pointe-Claire</td>
<td style="text-align: right;">12 380</td>
<td style="text-align: right;">100 294</td>
<td style="text-align: right;">80 242</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sainte-Anne-de-Bellevue</td>
<td style="text-align: right;">1 960</td>
<td style="text-align: right;">102 969</td>
<td style="text-align: right;">67 200</td>
</tr>
<tr class="even">
<td style="text-align: left;">Senneville</td>
<td style="text-align: right;">345</td>
<td style="text-align: right;">203 790</td>
<td style="text-align: right;">116 224</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Westmount</td>
<td style="text-align: right;">8 685</td>
<td style="text-align: right;">295 099</td>
<td style="text-align: right;">100 153</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="sec-0252" class="level3" data-number="2.5.2"><h3 data-number="2.5.2" class="anchored" data-anchor-id="sec-0252">
<span class="header-section-number">2.5.2</span> Paramètres de position</h3>
<p>Les paramètres de position permettent de diviser une distribution en <em>n</em> parties égales.</p>
<ul>
<li>Les <strong>quartiles</strong> qui divisent une distribution en quatre parties (25&nbsp;%)&nbsp;:
<ul>
<li>Q1 (25&nbsp;%), soit le quartile inférieur ou premier quartile;</li>
<li>Q2 (50&nbsp;%), soit la médiane;</li>
<li>Q3 (75&nbsp;%), soit le quartile supérieur ou troisième quartile.</li>
</ul>
</li>
<li>Les <strong>quintiles</strong> qui divisent une distribution en cinq parties égales (20&nbsp;%).</li>
<li>Les <strong>déciles</strong> (de D1 à D9) qui divisent une distribution en dix parties égales (10&nbsp;%).</li>
<li>Les <strong>centiles</strong> (de C1 à C99) qui divisent une distribution en cent parties égales (1&nbsp;%).</li>
</ul>
<p>En cartographie, les quartiles et les quintiles sont souvent utilisés pour discrétiser une variable quantitative (continue ou discrète) en quatre ou cinq classes et plus rarement, en dix classes (déciles). Avec les quartiles, les bornes des classes qui comprennent chacune 25&nbsp;% des unités spatiales sont définies comme suit&nbsp;: [Min à Q1], [Q1 à Q2], [Q2 à Q3] et [Q3 à Max]. La méthode de discrétisation selon les quartiles ou quintiles permet de repérer, en un coup d’œil, à quelle tranche de 25&nbsp;% ou de 20&nbsp;% des données appartient chacune des unités spatiales. Cette méthode de discrétisation est aussi utile pour comparer plusieurs cartes et vérifier si deux phénomènes sont ou non colocalisés <span class="citation" data-cites="pumain1994">(<a href="references.html#ref-pumain1994" role="doc-biblioref">Pumain et Béguin 1994</a>)</span>. En guise d’exemple, les pourcentages de personnes à faible revenu et de locataires par secteur de recensement ont clairement des distributions spatiales très semblables dans la région métropolitaine de Montréal en 2016 (<a href="#fig-univarie2">figure&nbsp;<span>2.24</span></a>).</p>
<div id="fig-univarie2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap02/figure2.jpg" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.24: Exemples de cartographie avec une discrétisation selon les quantiles</figcaption></figure>
</div>
<p>Une lecture attentive des valeurs des centiles permet de repérer la présence de valeurs extrêmes, voire aberrantes, dans un jeu de données. Il n’est donc pas rare de les voir reportées dans un tableau de statistiques descriptives d’un article scientifique, et ce, afin de décrire succinctement les variables à l’étude. Par exemple, dans une étude récente comparant les niveaux d’exposition au bruit des cyclistes dans trois villes <span class="citation" data-cites="2020_1">(<a href="references.html#ref-2020_1" role="doc-biblioref">Apparicio et Gelb 2020</a>)</span>, les auteurs reportent à la fois les valeurs moyennes et celles de plusieurs centiles. Globalement, la lecture des valeurs moyennes permet de constater que, sur la base des données collectées, les cyclistes sont plus exposés au bruit à Paris qu’à Montréal et Copenhague (73,4 dB(A) contre 70,7 et 68,4, <a href="#tbl-Centiles">tableau&nbsp;<span>2.2</span></a>). Compte tenu de l’échelle logarithmique du bruit, la différence de 5 dB(A) entre les valeurs moyennes du bruit de Copenhague et de Paris peut être considérée comme une multiplication de l’énergie sonore par plus de&nbsp;3. Pour Paris, l’analyse des quartiles montre que durant 25&nbsp;% du temps des trajets à vélo (plus de 63 heures de collecte), les participantes et participants ont été exposés à des niveaux de bruit soit inférieurs à 69,1 dB(A) (premier quartile), soit supérieurs à 74&nbsp;dB(A) (troisième quartile). Quant à l’analyse des centiles, elle permet de constater que durant 5&nbsp;% et 10&nbsp;% du temps, les participantes et participants étaient exposés à des niveaux de bruit très élevés, dépassant 75&nbsp;dB(A) (C90&nbsp;=&nbsp;76 et C90&nbsp;=&nbsp;77,2).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-Centiles" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;2.2: Stastistiques descriptives de l’exposition au bruit des cyclistes par minute dans trois villes (dB(A), Laeq 1min)</caption>
<thead><tr class="header">
<th style="text-align: left;">Statistiques</th>
<th style="text-align: right;">Copenhague</th>
<th style="text-align: right;">Montréal</th>
<th style="text-align: right;">Paris</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">N</td>
<td style="text-align: right;">6 212,0</td>
<td style="text-align: right;">4 723,0</td>
<td style="text-align: right;">3 793,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Moyenne de bruit</td>
<td style="text-align: right;">68,4</td>
<td style="text-align: right;">70,7</td>
<td style="text-align: right;">73,4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Centiles</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">57,5</td>
<td style="text-align: right;">59,2</td>
<td style="text-align: right;">62,3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">59,1</td>
<td style="text-align: right;">61,1</td>
<td style="text-align: right;">65,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">60,3</td>
<td style="text-align: right;">62,3</td>
<td style="text-align: right;">66,5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">25 (premier quartile)</td>
<td style="text-align: right;">62,7</td>
<td style="text-align: right;">64,5</td>
<td style="text-align: right;">69,1</td>
</tr>
<tr class="even">
<td style="text-align: left;">50 (médiane)</td>
<td style="text-align: right;">66,0</td>
<td style="text-align: right;">67,7</td>
<td style="text-align: right;">71,6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">75 (troisième quartile)</td>
<td style="text-align: right;">69,2</td>
<td style="text-align: right;">71,0</td>
<td style="text-align: right;">74,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">90</td>
<td style="text-align: right;">71,9</td>
<td style="text-align: right;">73,7</td>
<td style="text-align: right;">76,0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">95</td>
<td style="text-align: right;">73,3</td>
<td style="text-align: right;">75,2</td>
<td style="text-align: right;">77,2</td>
</tr>
<tr class="even">
<td style="text-align: left;">99</td>
<td style="text-align: right;">76,5</td>
<td style="text-align: right;">78,9</td>
<td style="text-align: right;">81,0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="sec-0253" class="level3" data-number="2.5.3"><h3 data-number="2.5.3" class="anchored" data-anchor-id="sec-0253">
<span class="header-section-number">2.5.3</span> Paramètres de dispersion</h3>
<p>Cinq principales mesures de dispersion permettent d’évaluer la variabilité des valeurs d’une variable quantitative&nbsp;: l’étendue, l’écart interquartile, la variance, l’écart-type et le coefficient de variation. Notez d’emblée que cette dernière mesure ne s’applique pas à des variables d’intervalle (<a href="#sec-02122">section&nbsp;<span>2.1.2.2</span></a>).</p>
<ul>
<li><p><strong>L’étendue</strong> est la différence entre les valeurs minimale et maximale d’une variable, soit l’intervalle des valeurs dans lequel elle a été mesurée. Il convient d’analyser avec prudence cette mesure puisqu’elle inclut dans son calcul des valeurs potentiellement extrêmes, voire aberrantes (faibles ou fortes).</p></li>
<li><p><strong>L’intervalle ou écart interquartile</strong> est la différence entre les troisième et premier quartiles (Q3&nbsp;−&nbsp;Q1). Il représente ainsi une mesure de la dispersion des valeurs de 50&nbsp;% des observations centrales de la distribution. Plus la valeur de l’écart interquartile est élevée, plus la dispersion des 50&nbsp;% des observations centrales est forte. Contrairement à l’étendue, cette mesure élimine l’influence des valeurs extrêmes puisqu’elle ne tient pas compte des 25&nbsp;% des observations les plus faibles [Min à Q1] et des 25&nbsp;% des observations les plus fortes [Q3 à Max]. Graphiquement, l’intervalle interquartile est représenté à l’aide d’une boîte à moustaches (<em>boxplot</em> en anglais)&nbsp;: plus l’intervalle interquartile est grand, plus la boîte est allongée (<a href="#fig-univarie3">figure&nbsp;<span>2.25</span></a>).</p></li>
</ul>
<div id="fig-univarie3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap02/figure3.jpg" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.25: Graphique en violon, boîte à moustaches et intervalle interquartile</figcaption></figure>
</div>
<ul>
<li><p><strong>La variance</strong> est la somme des déviations à la moyenne au carré (numérateur) divisée par le nombre d’observations pour une population (<span class="math inline">\(\sigma^2\)</span>) ou divisée par le nombre d’observations moins une (<span class="math inline">\(s^2\)</span>) pour un échantillon (<a href="#eq-variance">équation&nbsp;<span>2.20</span></a>). Puisque les déviations à la moyenne sont mises au carré, la valeur de la variance (tout comme celle de l’écart-type) est toujours positive. Plus sa valeur est élevée, plus les observations sont dispersées autour de la moyenne. La variance représente ainsi l’écart au carré moyen des observations à la moyenne.</p></li>
<li><p><strong>L’écart-type</strong> est la racine carrée de la variance (<a href="#eq-ecartype">équation&nbsp;<span>2.21</span></a>). Rappelez-vous que la variance est calculée à partir des déviations à la moyenne mises au carré. Étant donné que l’écart-type est la racine carrée de la variance, il est donc évalué dans la même unité que la variable, contrairement à la variance. Bien entendu, comme pour la variance, plus la valeur de l’écart-type est élevée, plus la distribution des observations autour de la moyenne est dispersée.</p></li>
</ul>
<p><span id="eq-variance"><span class="math display">\[  
\sigma^2=\frac{\sum_{i=1}^n (x_{i}-\mu)^2}{n} \text{ ou } s^2=\frac{\sum_{i=1}^n (x_{i}-\bar{x})^2}{n-1}
\tag{2.20}\]</span></span></p>
<p><span id="eq-ecartype"><span class="math display">\[
\sigma=\sqrt{\sigma^2}=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\mu)^2}{n}} \text{ ou } s=\sqrt{s^2}=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\bar{x})^2}{n-1}}
\tag{2.21}\]</span></span></p>
<div class="bloc_notes">
<div class="bloc_notes-header">
<div class="bloc_notes-icon">

</div>
<p><strong>Formules des variances et des écarts-types</strong></p>
</div>
<div class="bloc_notes-body">
<p>Les formules des variances et des écarts-types pour une population et un échantillon sont très similaires&nbsp;: seul le dénominateur change avec <span class="math inline">\(n\)</span> <em>versus</em> <span class="math inline">\(n-1\)</span> observations. Par conséquent, plus le nombre d’observations de votre jeu de données est important, plus l’écart entre ces deux mesures de dispersion pour une population et un échantillon est minime.</p>
<p>Comme dans la plupart des logiciels de statistique, les fonctions de base <code>var</code> et <code>sd</code> de R calculent la variance et l’écart-type pour un échantillon (<span class="math inline">\(n-1\)</span> au dénominateur). Si vous souhaitez les calculer pour une population, adaptez la syntaxe ci-dessous dans laquelle <code>df$var1</code> représente la variable intitulée <code>var1</code> présente dans un <em>DataFrame</em> nommé <code>df</code>.</p>
<p><code>var.p &lt;- mean((df$var1 - mean(df$var1))^2)</code></p>
<p><code>sd.p &lt;- sqrt(mean((df$var1 - mean(df$var1))^2))</code></p>
</div>
</div>
<ul>
<li>
<strong>Le coefficient de variation (CV)</strong> est le rapport entre l’écart-type et la moyenne, représentant ainsi une standardisation de l’écart-type ou, en d’autres termes, une mesure de dispersion relative (<a href="#eq-cv">équation&nbsp;<span>2.22</span></a>). L’écart-type étant exprimé dans l’unité de mesure de la variable, il ne peut pas être utilisé pour comparer les dispersions de variables exprimées des unités de mesure différentes (par exemple, en pourcentage, en kilomètres, en dollars, etc.). Pour y remédier, nous utilisons le coefficient de variation&nbsp;: une variable est plus dispersée qu’une autre si la valeur de son CV est plus élevée. Certaines personnes préfèrent multiplier la valeur du CV par 100&nbsp;: l’écart-type est alors exprimé en pourcentage de la moyenne.</li>
</ul>
<p><span id="eq-cv"><span class="math display">\[
CV=\frac{\sigma}{\mu} \text{ ou } CV=\frac{s^2}{\bar{x}}
\tag{2.22}\]</span></span></p>
<p>Illustrons comment calculer les cinq mesures de dispersion précédemment décrites à partir de valeurs fictives pour huit observations (colonne intitulée <span class="math inline">\(x_i\)</span> au <a href="#tbl-datavar">tableau&nbsp;<span>2.3</span></a>). Les différentes statistiques reportées dans ce tableau sont calculées comme suit&nbsp;:</p>
<ul>
<li><p>La <strong>moyenne</strong> est la somme divisée par le nombre d’observations, soit <span class="math inline">\(\mbox{248/8}=\mbox{31}\)</span>.</p></li>
<li><p>L’<strong>étendue</strong> est la différence entre les valeurs maximale et minimale, soit <span class="math inline">\(\mbox{40}-\mbox{22}=\mbox{30}\)</span>.</p></li>
<li><p>Les quartiles coupent la distribution en quatre parties égales. Avec huit observations triées par ordre croissant, <strong>le premier quartile</strong> est égal à la valeur de la deuxième observation (soit 25), la <strong>médiane</strong> à celle de la quatrième (30), le <strong>troisième quartile</strong> à celle de la sixième (35).</p></li>
<li><p><strong>L’écart interquartile</strong> est la différence entre Q3 et Q1, soit <span class="math inline">\(\mbox{35}-\mbox{25}=\mbox{10}\)</span>.</p></li>
<li><p>La seconde colonne du tableau est l’écart à la moyenne (<span class="math inline">\(x_i-\bar{x}\)</span>), soit <span class="math inline">\(\mbox{22} - \mbox{31} = -\mbox{9}\)</span> pour l’observation <em>1</em>; la somme de ces écarts est toujours égale à 0. La troisième colonne est cette déviation mise au carré (<span class="math inline">\((x_i-\bar{x})^2\)</span>), soit <span class="math inline">\(-\mbox{9}^2 = \mbox{81}\)</span>, toujours pour l’observation <em>1</em>. La somme de ces déviations à la moyenne au carré (268) représente le numérateur de la variance (<a href="#eq-variance">équation&nbsp;<span>2.20</span></a>). En divisant cette somme par le nombre d’observations, nous obtenons la <strong>variance pour une population</strong> (<span class="math inline">\(\mbox{268}/\mbox{8}=\mbox{33,5}\)</span>) tandis que la <strong>variance d’un échantillon</strong> est égale à <span class="math inline">\(\mbox{268}/(\mbox{8}-\mbox{1})=\mbox{38,29}\)</span>.</p></li>
<li><p>L’écart-type est la racine carrée de la variance (<a href="#eq-ecartype">équation&nbsp;<span>2.21</span></a>), soit <span class="math inline">\(\sigma=\sqrt{\mbox{33,5}}=\mbox{5,79}\)</span> et <span class="math inline">\(s=\sqrt{\mbox{38,29}}=\mbox{6,19}\)</span>.</p></li>
<li><p>Finalement, les valeurs des coefficients de variation (<a href="#eq-cv">équation&nbsp;<span>2.22</span></a>) sont de <span class="math inline">\(\mbox{5,79}/\mbox{31}=\mbox{0,19}\)</span> pour une population et <span class="math inline">\(\mbox{6,19}/\mbox{31}=\mbox{0,20}\)</span> pour un échantillon.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-datavar" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;2.3: Calcul des mesures de dispersion sur des données fictives</caption>
<colgroup>
<col style="width: 51%">
<col style="width: 8%">
<col style="width: 18%">
<col style="width: 21%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Observation</th>
<th style="text-align: right;"><span class="math inline">\(x_i\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_i-\bar{x}\)</span></th>
<th style="text-align: right;"><span class="math inline">\((x_i-\bar{x})^2\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">22,00</td>
<td style="text-align: center;">-9</td>
<td style="text-align: right;">81,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">25,00</td>
<td style="text-align: center;">-6</td>
<td style="text-align: right;">36,0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">27,00</td>
<td style="text-align: center;">-4</td>
<td style="text-align: right;">16,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">30,00</td>
<td style="text-align: center;">-1</td>
<td style="text-align: right;">1,0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">32,00</td>
<td style="text-align: center;">1</td>
<td style="text-align: right;">1,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">35,00</td>
<td style="text-align: center;">4</td>
<td style="text-align: right;">16,0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">37,00</td>
<td style="text-align: center;">6</td>
<td style="text-align: right;">36,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">40,00</td>
<td style="text-align: center;">9</td>
<td style="text-align: right;">81,0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Statistique</strong></td>
<td style="text-align: right;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">N</td>
<td style="text-align: right;">8,00</td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Somme</td>
<td style="text-align: right;">248,00</td>
<td style="text-align: center;">0</td>
<td style="text-align: right;">268,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Moyenne (<span class="math inline">\(\bar{x}\)</span> ou <span class="math inline">\(\mu\)</span>)</td>
<td style="text-align: right;">31,00</td>
<td style="text-align: center;">0</td>
<td style="text-align: right;">33,5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Étendue</td>
<td style="text-align: right;">18,00</td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Premier quartile</td>
<td style="text-align: right;">25,00</td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Troisième quartile</td>
<td style="text-align: right;">35,00</td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Intervalle interquartile</td>
<td style="text-align: right;">10,00</td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Variance (population, <span class="math inline">\(\sigma^2\)</span>)</td>
<td style="text-align: right;">33,50</td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Écart-type (population, <span class="math inline">\(\sigma\)</span>)</td>
<td style="text-align: right;">5,79</td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Variance (échantillon, <span class="math inline">\(s^2\)</span>)</td>
<td style="text-align: right;">38,29</td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Écart-type (échantillon, <span class="math inline">\(s\)</span>)</td>
<td style="text-align: right;">6,19</td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Coefficient de variation (<span class="math inline">\(\sigma / \mu\)</span>)</td>
<td style="text-align: right;">0,19</td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Coefficient de variation (<span class="math inline">\(s / \bar{x}\)</span>)</td>
<td style="text-align: right;">0,20</td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Le <a href="#tbl-datavar2">tableau&nbsp;<span>2.4</span></a> vise à démontrer, à partir de trois variables, comment certaines mesures de dispersion sont sensibles à l’unité de mesure et/ou aux valeurs extrêmes.</p>
<p>Concernant <strong>l’unité de mesure</strong>, nous avons créé deux variables <em>A</em> et <em>B</em>, où <em>B</em> étant simplement <em>A</em> multipliée par 10. Pour <em>A</em>, les valeurs de la moyenne, de l’étendue et de l’intervalle interquartile sont respectivement 31, 18 et 10. Sans surprise, celles de <em>B</em> sont multipliées par 10 (310, 180, 100). La variance étant la moyenne des déviations à la moyenne au carré, elle est égale à 33,50 pour <em>A</em> et donc à <span class="math inline">\(\mbox{33,50}\times10^2=\mbox{3350}\)</span> pour <em>B</em>; l’écart-type de <em>B</em> est égal à celui de <em>A</em> multiplié par 10. Cela démontre que l’étendue, l’intervalle interquartile, la variance et l’écart-type sont des mesures de dispersion dépendantes de l’unité de mesure. Par contre, étant donné que le coefficient de variation (CV) est le rapport de l’écart-type avec la moyenne, il a la même valeur pour <em>A</em> et <em>B</em>, ce qui démontre que le CV est bien une mesure de dispersion relative permettant de comparer des variables exprimées dans des unités de mesure différentes.</p>
<p>Concernant <strong>la sensibilité aux valeurs extrêmes</strong>, nous avons créé la variable <em>C</em> pour laquelle seule la huitième observation a une valeur différente (40 pour <em>A</em> et 105 pour <em>B</em>). Cette valeur de 105 pourrait être soit une valeur extrême positive mesurée, soit une valeur aberrante (par exemple, si l’unité de mesure était un pourcentage variant de 0 à 100&nbsp;%). Cette valeur a un impact important sur la moyenne (31 contre 39,12) et l’étendue (18 contre 83) et corollairement sur la variance (33,50 contre 641,86), l’écart-type (5,79 contre 25,33) et le coefficient de variation (0,19 contre 0,65). Par contre, comme l’intervalle interquartile est calculé sur 50&nbsp;% des observations centrales (<span class="math inline">\(\mbox{Q3}-\mbox{Q1}\)</span>), il n’est pas affecté par cette valeur extrême.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-datavar2" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;2.4: Illustration de la sensibilité des mesures de dispersion à l’unité de mesure et aux valeurs extrêmes</caption>
<thead><tr class="header">
<th style="text-align: left;">Observation</th>
<th style="text-align: right;">A</th>
<th style="text-align: right;">B</th>
<th style="text-align: right;">C</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">22,00</td>
<td style="text-align: right;">220,00</td>
<td style="text-align: right;">22,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">25,00</td>
<td style="text-align: right;">250,00</td>
<td style="text-align: right;">25,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">27,00</td>
<td style="text-align: right;">270,00</td>
<td style="text-align: right;">27,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">30,00</td>
<td style="text-align: right;">300,00</td>
<td style="text-align: right;">30,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">32,00</td>
<td style="text-align: right;">320,00</td>
<td style="text-align: right;">32,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">35,00</td>
<td style="text-align: right;">350,00</td>
<td style="text-align: right;">35,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">37,00</td>
<td style="text-align: right;">370,00</td>
<td style="text-align: right;">37,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">40,00</td>
<td style="text-align: right;">400,00</td>
<td style="text-align: right;">105,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Statistique</strong></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Moyenne (<span class="math inline">\(\mu\)</span>)</td>
<td style="text-align: right;">31,00</td>
<td style="text-align: right;">310,00</td>
<td style="text-align: right;">39,12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Étendue</td>
<td style="text-align: right;">18,00</td>
<td style="text-align: right;">180,00</td>
<td style="text-align: right;">83,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Intervalle interquartile</td>
<td style="text-align: right;">10,00</td>
<td style="text-align: right;">100,00</td>
<td style="text-align: right;">10,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Variance (population, <span class="math inline">\(\sigma^2\)</span>)</td>
<td style="text-align: right;">33,50</td>
<td style="text-align: right;">3 350,00</td>
<td style="text-align: right;">641,86</td>
</tr>
<tr class="even">
<td style="text-align: left;">Écart-type (population, <span class="math inline">\(\sigma\)</span>)</td>
<td style="text-align: right;">5,79</td>
<td style="text-align: right;">57,88</td>
<td style="text-align: right;">25,33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Coefficient de variation (<span class="math inline">\(\sigma / \mu\)</span>)</td>
<td style="text-align: right;">0,19</td>
<td style="text-align: right;">0,19</td>
<td style="text-align: right;">0,65</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-resume" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;2.5: Résumé de la sensibilité de la moyenne et des mesures de dispersion</caption>
<thead><tr class="header">
<th style="text-align: left;">Statistique</th>
<th style="text-align: center;">Unité de mesure</th>
<th style="text-align: center;">Valeurs extrêmes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Moyenne</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
</tr>
<tr class="even">
<td style="text-align: left;">Étendue</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Intervalle interquartile</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Variance</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Écart-type</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
</tr>
<tr class="even">
<td style="text-align: left;">Coefficient de variation</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="sec-0254" class="level3" data-number="2.5.4"><h3 data-number="2.5.4" class="anchored" data-anchor-id="sec-0254">
<span class="header-section-number">2.5.4</span> Paramètres de forme</h3>
<section id="vérification-de-la-normalité-dune-variable-quantitative" class="level4" data-number="2.5.4.1"><h4 data-number="2.5.4.1" class="anchored" data-anchor-id="vérification-de-la-normalité-dune-variable-quantitative">
<span class="header-section-number">2.5.4.1</span> Vérification de la normalité d’une variable quantitative</h4>
<div class="bloc_objectif">
<div class="bloc_objectif-header">
<div class="bloc_objectif-icon">

</div>
<p><strong>Normalité d’une variable</strong></p>
</div>
<div class="bloc_objectif-body">
<p>De nombreuses méthodes statistiques qui sont abordées dans les chapitres suivants – entre autres, la corrélation de Pearson, les test <em>t</em> et l’analyse de variance, les régressions simple et multiple – requièrent que la variable quantitative suive une <strong>distribution normale</strong> (nommée aussi <strong>distribution gaussienne</strong>).</p>
<p>Dans cette sous-section, nous décrivons trois démarches pour vérifier si la distribution d’une variable est normale&nbsp;: les coefficients d’asymétrie et d’aplatissement (<em>skewness</em> et <em>kurtosis</em> en anglais), les graphiques (histogramme avec courbe normale et diagramme quantile-quantile), les tests de normalité (tests de Shapiro-Wilk, de Kolmogorov-Smirnov, de Lilliefors, d’Anderson-Darling et de Jarque-Bera).</p>
<p><strong>Il est vivement recommandé de réaliser les trois démarches!</strong></p>
</div>
</div>
<p>Une distribution est normale quand elle est symétrique et mésokurtique (<a href="#fig-FormeDistr">figure&nbsp;<span>2.26</span></a>).</p>
<div id="fig-FormeDistr" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap02/FormeDistribution.jpg" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.26: Formes d’une distribution et coefficients d’asymétrie et d’aplatissement</figcaption></figure>
</div>
<section id="vérification-de-la-normalité-avec-les-coefficients-dasymétrie-et-daplatissement" class="level5" data-number="2.5.4.1.1"><h5 data-number="2.5.4.1.1" class="anchored" data-anchor-id="vérification-de-la-normalité-avec-les-coefficients-dasymétrie-et-daplatissement">
<span class="header-section-number">2.5.4.1.1</span> Vérification de la normalité avec les coefficients d’asymétrie et d’aplatissement</h5>
<p><strong>Une distribution est dite symétrique</strong> quand la moyenne arithmétique est au centre de la distribution, c’est-à-dire que les observations sont bien réparties de part et d’autre de la moyenne qui est alors égale à la médiane et au mode (nous utilisons uniquement le mode pour une variable discrète et non pour une variable continue). Pour évaluer l’asymétrie, nous utilisons habituellement le coefficient d’asymétrie (<em>skewness</em> en anglais).</p>
<p>Sachez toutefois qu’il existe trois façons (formules) pour le calculer <span class="citation" data-cites="joanes1998comparing">(<a href="references.html#ref-joanes1998comparing" role="doc-biblioref">Joanes et Gill 1998</a>)</span>&nbsp;: <span class="math inline">\(g_1\)</span> est la formule classique (<a href="#eq-SkewType1">équation&nbsp;<span>2.23</span></a>), disponible dans R avec la fonction <code>skewness</code> du <em>package</em> <code>moments</code>), <span class="math inline">\(G_1\)</span> est une version ajustée (<a href="#eq-SkewType2">équation&nbsp;<span>2.24</span></a>), utilisée dans les logiciels SAS et SPSS notamment) et <span class="math inline">\(b_1\)</span> est une autre version ajustée (<a href="#eq-SkewType3">équation&nbsp;<span>2.25</span></a>), utilisée par les logiciels MINITAB et BMDP). Nous verrons qu’avec les <em>packages</em> <code>DescTools</code> ou <code>e1071</code>, il est possible de calculer ces trois méthodes. Aussi, pour de grands échantillons (<span class="math inline">\(n&gt;100\)</span>), il y a très peu de différences entre les résultats produits par ces trois formules <span class="citation" data-cites="joanes1998comparing">(<a href="references.html#ref-joanes1998comparing" role="doc-biblioref">Joanes et Gill 1998</a>)</span>. Quelle que soit la formule utilisée, le coefficient d’asymétrie s’interprète comme suit (<a href="#fig-asymetrie">figure&nbsp;<span>2.27</span></a>)&nbsp;:</p>
<ul>
<li><p>Quand la valeur du <em>skewness</em> est négative, la <strong>distribution est asymétrique négative</strong>. La distribution est alors tirée à gauche par des valeurs extrêmes faibles, mais peu nombreuses. Nous employons souvent l’expression <em>la queue de distribution</em> est étirée vers la gauche. La moyenne est alors inférieure à la médiane.</p></li>
<li><p>Quand la valeur du <em>skewness</em> est égale à 0, <strong>la distribution est symétrique</strong> (la médiane est égale à la moyenne). Pour une variable discrète, les valeurs du mode, de la moyenne et de la médiane sont égales.</p></li>
<li><p>Quand la valeur du <em>skewness</em> est positive, la <strong>distribution est symétrique positive</strong>. La distribution est alors tirée à droite par des valeurs extrêmes fortes, mais peu nombreuses. La queue de distribution est alors étirée vers la droite et la moyenne est supérieure à la médiane. En sciences sociales, les variables de revenu (totaux ou d’emploi, des individus ou des ménages) ont souvent des distributions asymétriques positives&nbsp;: la moyenne est affectée par quelques observations avec des valeurs de revenu très élevées et est ainsi supérieure à la médiane. En études urbaines, la densité de la population pour des unités géographiques d’une métropole donnée (secteur de recensement par exemple) a aussi souvent une distribution asymétrique positive&nbsp;: quelques secteurs de recensement au centre de la métropole sont caractérisés par des valeurs de densité très élevées qui tirent la distribution vers la droite.</p></li>
</ul>
<p><span id="eq-SkewType1"><span class="math display">\[
g_1=\frac{ \frac{1}{n} \sum_{i=1}^n(x_i-\bar{x})^3} { \left[\frac{1}{n}\sum_{i=1}^n(x_i-\bar{x})^2\right] ^\frac{3}{2}}
\tag{2.23}\]</span></span></p>
<p><span id="eq-SkewType2"><span class="math display">\[
G_1= \frac{\sqrt{n(n-1)}}{n-2} g_1
\tag{2.24}\]</span></span></p>
<p><span id="eq-SkewType3"><span class="math display">\[
b_1= \left( \frac{n-1}{n} \right) ^\frac{3}{2} g_1
\tag{2.25}\]</span></span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-asymetrie" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-asymetrie-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.27: Asymétrie d’une distribution</figcaption></figure>
</div>
</div>
</div>
<p><strong>Pour évaluer l’aplatissement d’une distribution</strong>, nous utilisons le coefficient d’aplatissement (<em>kurtosis</em> en anglais). Là encore, il existe trois formules pour le calculer (équations <a href="#eq-KurtType1"><span>2.26</span></a>, <a href="#eq-KurtType2"><span>2.27</span></a>, <a href="#eq-KurtType3"><span>2.28</span></a>) qui renvoient des valeurs très semblables pour de grands échantillons <span class="citation" data-cites="joanes1998comparing">(<a href="references.html#ref-joanes1998comparing" role="doc-biblioref">Joanes et Gill 1998</a>)</span>. Cette mesure s’interprète comme suit (<a href="#fig-asymetrie">figure&nbsp;<span>2.27</span></a>)&nbsp;:</p>
<ul>
<li><p>Quand la valeur du <em>kurtosis</em> est négative, la <strong>distribution est platikurtique</strong>. La distribution est dite plate, c’est-à-dire que la valeur de l’écart-type est importante (comparativement à une distribution normale), signalant une grande dispersion des valeurs de part et d’autre la moyenne. s</p></li>
<li><p>Quand la valeur du <em>kurtosis</em> est égale à 0, <strong>la distribution est mésokurtique</strong>, ce qui est typique d’une distribution normale.</p></li>
<li><p>Quand la valeur du <em>kurtosis</em> est positive, la <strong>distribution est leptokurtique</strong>, signalant que l’écart-type (la dispersion des valeurs) est plutôt faible. Autrement dit, la dispersion des valeurs autour de la moyenne est faible.</p></li>
</ul>
<p><span id="eq-KurtType1"><span class="math display">\[
g_2=\frac{\frac{1}{n}\sum_{i=1}^n(x_i-\bar{x})^4} {\left( \frac{1}{n}\sum_{i=1}^n(x_i-\bar{x})^2\right)^2}-3
\tag{2.26}\]</span></span></p>
<p><span id="eq-KurtType2"><span class="math display">\[
G_2 = \frac{n-1}{(n-2)(n-3)} \{(n+1) g_2 + 6\}
\tag{2.27}\]</span></span></p>
<p><span id="eq-KurtType3"><span class="math display">\[  
b_2 = (g_2 + 3) (1 - 1/n)^2 - 3
\tag{2.28}\]</span></span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-kurtosis" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-kurtosis-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.28: Applatissement d’une distribution</figcaption></figure>
</div>
</div>
</div>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Kurtosis normalisé</strong></p>
</div>
<div class="bloc_attention-body">
<p>Regardez attentivement les équations <a href="#eq-KurtType1"><span>2.26</span></a>, <a href="#eq-KurtType2"><span>2.27</span></a>, <a href="#eq-KurtType3"><span>2.28</span></a>; vous remarquez que pour <span class="math inline">\(g_2\)</span> et <span class="math inline">\(b_2\)</span>, il y a une soustraction de 3 et une addition 6 pour <span class="math inline">\(G_2\)</span>. Nous parlons alors de <em>kurtosis</em> normalisé (<em>excess kurtosis</em> en anglais). Pour une distribution normale, il prend la valeur de 0, comparativement à la valeur de 3 pour un <em>kurtosis</em> non normalisé. Par conséquent, avant de calculer le <em>kurtosis</em>, il convient de s’assurer que la fonction que vous utilisez implémente une méthode de calcul normalisée (donnant une valeur de 0 pour une distribution normale). Par exemple, la fonction <code>Kurt</code> du <em>package</em> <code>DescTools</code> calcule les trois formules normalisées tandis que la fonction <code>kurtosis</code> du <em>package</em> <code>moments</code> renvoie un <em>kurtosis</em> non normalisé.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://andrisignorell.github.io/DescTools/">DescTools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org">moments</a></span><span class="op">)</span></span>
<span><span class="co"># Générer une variable normalement distribuée avec 1000 observations</span></span>
<span><span class="va">Normale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1500</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Kurt</a></span><span class="op">(</span><span class="va">Normale</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.036</code></pre>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/kurtosis.html">kurtosis</a></span><span class="op">(</span><span class="va">Normale</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.968</code></pre>
</div>
</div>
</div>
</div>
</section><section id="vérification-de-la-normalité-avec-des-graphiques" class="level5" data-number="2.5.4.1.2"><h5 data-number="2.5.4.1.2" class="anchored" data-anchor-id="vérification-de-la-normalité-avec-des-graphiques">
<span class="header-section-number">2.5.4.1.2</span> Vérification de la normalité avec des graphiques</h5>
<p>Les graphiques sont un excellent moyen de vérifier visuellement si une distribution est normale ou pas. Bien entendu, les histogrammes, que nous avons déjà largement utilisés, sont un incontournable. À titre de rappel, ils permettent de représenter la forme de la distribution des données (<a href="#fig-CourbeNormale">figure&nbsp;<span>2.29</span></a>). Un autre type de graphique intéressant est le <strong>diagramme quantile-quantile</strong> (<em>Q-Q plot</em> en anglais), qui permet de comparer la distribution d’une variable avec une distribution gaussienne (normale). Trois éléments composent ce graphique comme illustré à la <a href="#fig-qqplot">figure&nbsp;<span>2.30</span></a>&nbsp;:</p>
<ul>
<li>les points, représentant les observations de la variable;</li>
<li>la distribution gaussienne (normale), représentée par une ligne;</li>
<li>l’intervalle de confiance à 95&nbsp;% de la distribution normale (en marron sur la figure).</li>
</ul>
<p>Quand la variable est normalement distribuée, les points sont situés le long de la ligne. Plus les points localisés en dehors de l’intervalle de confiance (bande marron) sont nombreux, plus la variable est alors anormalement distribuée.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-CourbeNormale" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-CourbeNormale-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.29: Histogrammes et courbe normale</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-qqplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-qqplot-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.30: Diagrammes quantile-quantile</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-025413" class="level5" data-number="2.5.4.1.3"><h5 data-number="2.5.4.1.3" class="anchored" data-anchor-id="sec-025413">
<span class="header-section-number">2.5.4.1.3</span> Vérification de la normalité avec des tests de normalité</h5>
<p>Cinq principaux tests d’hypothèse permettent de vérifier la normalité d’une variable&nbsp;: les tests de <strong>Kolmogorov-Smirnov</strong> (KS), de <strong>Lilliefors</strong> (LF), de <strong>Shapiro-Wilk</strong> (SW), d’<strong>Anderson-Darling</strong> et de <strong>Jarque-Bera</strong> (JB). Sachez toutefois qu’il y en a d’autres non discutés ici (tests d’Agostino–Pearson, de Cramer–von Mises, de Ryan-Joiner, de Shapiro–Francia, etc.). Pour les formules et une description détaillée de ces tests, vous pouvez consulter Razali et al. <span class="citation" data-cites="razali2011power">(<a href="references.html#ref-razali2011power" role="doc-biblioref">2011</a>)</span> ou Yap et Sim <span class="citation" data-cites="yap2011comparisons">(<a href="references.html#ref-yap2011comparisons" role="doc-biblioref">2011</a>)</span>. <strong>Quel test choisir?</strong> Plusieurs auteur(e)s ont comparé ces différents tests à partir de plusieurs échantillons, et ce, en faisant varier la forme de la distribution et le nombre d’observations <span class="citation" data-cites="razali2011power yap2011comparisons">(<a href="references.html#ref-razali2011power" role="doc-biblioref">Razali et Wah 2011</a>; <a href="references.html#ref-yap2011comparisons" role="doc-biblioref">Yap et Sim 2011</a>)</span>. Selon Razali et al. <span class="citation" data-cites="razali2011power">(<a href="references.html#ref-razali2011power" role="doc-biblioref">2011</a>)</span>, le meilleur test semble être celui de Shapiro-Wilk, puis ceux d’Anderson-Darling, de Lilliefors et de Kolmogorov-Smirnov. Yap et Sim <span class="citation" data-cites="yap2011comparisons">(<a href="references.html#ref-yap2011comparisons" role="doc-biblioref">2011</a>)</span> concluent aussi que le Shapiro-Wilk semble être le plus performant.</p>
<p>Quoi qu’il en soit, ces cinq tests postulent que la variable suit une distribution gaussienne (hypothèse nulle, H<sub>0</sub>).</p>
<p>Cela signifie que si la valeur de <em>p</em> associée à la valeur de chacun des tests est inférieure ou égale au seuil alpha choisi (habituellement <span class="math inline">\(\alpha=\mbox{0,05}\)</span>), la distribution est anormale. À l’inverse, si <span class="math inline">\(p&gt;\mbox{0,05}\)</span>, la distribution est normale.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-testnormalites" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;2.6: Différents tests d’hypothèse pour la normalité</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 90%">
<col style="width: 6%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Propriétés et interprétation</th>
<th style="text-align: left;">Fonction R</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Kolmogorov-Smirnov</td>
<td style="text-align: left;">Plus sa valeur est proche de zéro, plus la distribution est normale. L’avantage de ce test est qu’il peut être utilisé pour vérifier si une variable suit la distribution de n’importe quelle loi (autre que la loi normale).</td>
<td style="text-align: left;">
<code>ks.test</code> du <em>package</em> <code>stats</code>
</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lilliefors</td>
<td style="text-align: left;">Ce test est une adaptation du test de Kolmogorov-Smirnov. Plus sa valeur est proche de zéro, plus la distribution est normale.</td>
<td style="text-align: left;">
<code>lillie.test</code> du <em>package</em> <code>nortest</code>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Shapiro-Wilk</td>
<td style="text-align: left;">Si la valeur de la statistique de Shapiro-Wilk est proche de 1, alors la distribution est normale; anormale quand elle est inférieure à 1.</td>
<td style="text-align: left;">
<code>shapiro.test</code> du <em>package</em> <code>stats</code>
</td>
</tr>
<tr class="even">
<td style="text-align: left;">Anderson-Darling</td>
<td style="text-align: left;">Ce test est une modification du test de Cramer-von Mises (CVM). Il peut être aussi utilisé pour tester d’autres distributions (uniforme, log-normale, exponentielle, Weibull, distribution de Pareto généralisée, logistique, etc.).</td>
<td style="text-align: left;">
<code>ad.test</code> du <em>package</em> <code>stats</code>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jarque-Bera</td>
<td style="text-align: left;">Basé sur un test du type multiplicateur de Lagrange, ce test utilise dans son calcul les valeurs du <em>Skewness</em> et du <em>Kurtosis</em>. Plus sa valeur s’approche de 0, plus la distribution est normale. Ce test est surtout utilisé pour vérifier si les résidus d’un modèle de régression linéaire sont normalement distribués; nous y reviendrons dans le chapitre sur la régression multiple. Il s’écrit <span class="math inline">\(JB=\frac{1}{6} \left({g_1}^2+\frac{{g_1}^2}{4} \right)\)</span> avec <span class="math inline">\(g_1\)</span> et <span class="math inline">\(g_2\)</span> qui sont respectivement les valeurs du <em>skewness</em> et du <em>kurtosis</em> de la variable (voir les équations <a href="#eq-SkewType1"><span>2.23</span></a> et <a href="#eq-KurtType1"><span>2.26</span></a>.</td>
<td style="text-align: left;">
<code>JarqueBeraTest</code> du <em>package</em> <code>DescTools</code>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Dans le <a href="#tbl-calcultestnormalites">tableau&nbsp;<span>2.7</span></a> sont reportées les valeurs des différents tests pour les cinq types de distribution générés à la <a href="#fig-CourbeNormale">figure&nbsp;<span>2.29</span></a>. Sans surprise, pour l’ensemble des tests, la valeur de <em>p</em> est inférieure à 0,05 pour la distribution normale.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-calcultestnormalites" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;2.7: Tests de normalité pour différentes distributions</caption>
<colgroup>
<col style="width: 4%">
<col style="width: 23%">
<col style="width: 7%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 13%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: right;">Normale</th>
<th style="text-align: right;">Asymétrie négative</th>
<th style="text-align: right;">Asymétrie positive</th>
<th style="text-align: right;">Leptokurtique</th>
<th style="text-align: right;">Platikurtique</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">S</td>
<td style="text-align: left;">Skewness</td>
<td style="text-align: right;">-0,078</td>
<td style="text-align: right;">1,162</td>
<td style="text-align: right;">-1,199</td>
<td style="text-align: right;">-0,369</td>
<td style="text-align: right;">0,031</td>
</tr>
<tr class="even">
<td style="text-align: left;">K</td>
<td style="text-align: left;">Kurtosis</td>
<td style="text-align: right;">-0,043</td>
<td style="text-align: right;">1,495</td>
<td style="text-align: right;">1,845</td>
<td style="text-align: right;">6,540</td>
<td style="text-align: right;">-0,895</td>
</tr>
<tr class="odd">
<td style="text-align: left;">KS</td>
<td style="text-align: left;">Kolmogorov-Smirnov (KS)</td>
<td style="text-align: right;">0,026</td>
<td style="text-align: right;">0,099</td>
<td style="text-align: right;">0,088</td>
<td style="text-align: right;">0,098</td>
<td style="text-align: right;">0,041</td>
</tr>
<tr class="even">
<td style="text-align: left;">LF</td>
<td style="text-align: left;">Lilliefors (LF)</td>
<td style="text-align: right;">0,026</td>
<td style="text-align: right;">0,099</td>
<td style="text-align: right;">0,088</td>
<td style="text-align: right;">0,098</td>
<td style="text-align: right;">0,041</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SW</td>
<td style="text-align: left;">Shapiro-Wilk (SW)</td>
<td style="text-align: right;">0,998</td>
<td style="text-align: right;">0,914</td>
<td style="text-align: right;">0,916</td>
<td style="text-align: right;">0,903</td>
<td style="text-align: right;">0,976</td>
</tr>
<tr class="even">
<td style="text-align: left;">AD</td>
<td style="text-align: left;">Anderson-Darling (AD)</td>
<td style="text-align: right;">0,295</td>
<td style="text-align: right;">10,740</td>
<td style="text-align: right;">9,390</td>
<td style="text-align: right;">10,886</td>
<td style="text-align: right;">1,950</td>
</tr>
<tr class="odd">
<td style="text-align: left;">JB</td>
<td style="text-align: left;">Jarque-Bera (JB)</td>
<td style="text-align: right;">0,524</td>
<td style="text-align: right;">181,762</td>
<td style="text-align: right;">225,553</td>
<td style="text-align: right;">2 343,009</td>
<td style="text-align: right;">12,001</td>
</tr>
<tr class="even">
<td style="text-align: left;">KS.p</td>
<td style="text-align: left;">KS (valeur p)</td>
<td style="text-align: right;">0,895</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,001</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,384</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LF.p</td>
<td style="text-align: left;">LF (valeur p)</td>
<td style="text-align: right;">0,582</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,048</td>
</tr>
<tr class="even">
<td style="text-align: left;">SW.p</td>
<td style="text-align: left;">SW (valeur p)</td>
<td style="text-align: right;">0,686</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AD.p</td>
<td style="text-align: left;">AD (valeur p)</td>
<td style="text-align: right;">0,596</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,000</td>
</tr>
<tr class="even">
<td style="text-align: left;">JB.p</td>
<td style="text-align: left;">JB (valeur p)</td>
<td style="text-align: right;">0,770</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,002</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Des tests restrictifs…</strong></p>
</div>
<div class="bloc_attention-body">
<p>La plupart des auteurs s’entendent sur le fait que ces tests sont très restrictifs&nbsp;: plus la taille de votre échantillon est importante, plus les tests risquent de vous signaler que vos distributions sont anormales (à la lecture des valeurs de <em>p</em>).</p>
<p>Certains conseillent même de ne pas les utiliser quand <span class="math inline">\(n&gt;200\)</span> et de vous fier uniquement aux graphiques (histogramme et diagramme Q-Q)!</p>
</div>
</div>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>Combiner plusieurs méthodes pour vérifier la normalité d’une variable</strong></p>
</div>
<div class="bloc_astuce-body">
<p>Bref, vérifier la normalité d’une variable n’est pas une tâche si simple. De nouveau, nous vous conseillons vivement de&nbsp;:</p>
<ul>
<li><p>Construire les graphiques pour analyser visuellement la forme de la distribution (histogramme avec courbe normale et diagramme Q-Q).</p></li>
<li><p>Calculer le <em>skewness</em> et le <em>kurtosis</em>.</p></li>
<li><p>Calculer plusieurs tests (minimalement Shapiro-Wilk et Kolmogorov-Smirnov).</p></li>
<li><p>Accorder une importance particulière aux graphiques lorsque vous traitez de grands échantillons (<span class="math inline">\(n&gt;200\)</span>).</p></li>
</ul>
</div>
</div>
</section></section><section id="sec-02adjdistrib" class="level4" data-number="2.5.4.2"><h4 data-number="2.5.4.2" class="anchored" data-anchor-id="sec-02adjdistrib">
<span class="header-section-number">2.5.4.2</span> Tests pour d’autres formes de distribution</h4>
<p>Comme nous l’avons vu, la distribution normale n’est que l’une des multiples distributions existantes. Dans de nombreuses situations, elle ne sera pas adaptée pour décrire vos variables. La démarche à adopter pour trouver une distribution adaptée est la suivante&nbsp;:</p>
<ol type="1">
<li><p>Définissez la nature de votre variable&nbsp;: identifier si elle est discrète ou continue et l’intervalle dans lequel elle est définie. Une variable dont les valeurs sont positives ou négatives ne peut pas être décrite avec une distribution Gamma par exemple (à moins de la décaler).</p></li>
<li><p>Explorez votre variable&nbsp;: affichez son histogramme et son graphique de densité pour avoir une vue générale de sa morphologie.</p></li>
<li><p>Présélectionnez un ensemble de distributions candidates en tenant compte des observations précédentes. Vous pouvez également vous reporter à la littérature existante sur votre sujet d’étude pour inclure d’autres distributions. Soyez flexible! Une variable strictement positive pourrait tout de même avoir une forme normale. De même, une variable décrivant des comptages suffisamment grands pourrait être mieux décrite par une distribution normale qu’une distribution de Poisson.</p></li>
<li><p>Tentez d’ajuster chacune des distributions retenues à vos données et comparez les qualités d’ajustements pour retenir la plus adaptée.</p></li>
</ol>
<p>Pour ajuster une distribution à un jeu de données, il faut trouver les valeurs des paramètres de cette distribution qui lui permettent d’adopter une forme la plus proche possible des données. Nous appelons cette opération <strong>ajuster un modèle</strong>, puisque la distribution théorique est utilisée pour modéliser les données. L’ajustement des paramètres est un problème d’optimisation que plusieurs algorithmes sont capables de résoudre (<em>gradient descent</em>, <em>Newton-Raphson method</em>, <em>Fisher scoring</em>, etc.). Dans R, le <em>package</em> <code>fitdistrplus</code> permet d’ajuster pratiquement n’importe quelle distribution à des données en offrant plusieurs stratégies d’optimisation grâce à la fonction <code>fitdist</code>. Il suffit de disposer d’une fonction représentant la distribution de densité ou de masse de la distribution en question, généralement noté <code>dnomdeladistribution</code> (<code>dnorm</code>, <code>dgamma</code>, <code>dpoisson</code>, etc.) dans R. Notez que certains <em>packages</em> comme <code>VGAM</code> ou <code>gamlss.dist</code> ajoutent un grand nombre de fonctions de densité et de masse à celles déjà disponibles de base dans R.</p>
<p>Pour comparer l’ajustement de plusieurs distributions théoriques à des données, trois approches doivent être combinées&nbsp;:</p>
<ul>
<li><p>Observer graphiquement l’ajustement de la courbe théorique à l’histogramme des données. Cela permet d’éliminer au premier coup d’œil les distributions qui ne correspondent pas.</p></li>
<li><p>Comparer les <em>loglikelihood</em>. Le <em>loglikelihood</em> est un score d’ajustement des distributions aux données. Pour faire simple, plus le <em>loglikelihood</em> est grand, plus la distribution théorique est proche des données. Référez-vous à l’encadré suivant pour une description plus en profondeur du <em>loglikelihood</em>.</p></li>
<li><p>Utiliser le test de Kolmogorov-Smirnov pour déterminer si une distribution particulière est mieux ajustée pour les données.</p></li>
</ul>
<div class="bloc_aller_loin">
<div class="bloc_aller_loin-header">
<div class="bloc_aller_loin-icon">

</div>
<p><strong>Qu’est-ce que le <em>loglikelihood</em></strong>?</p>
</div>
<div class="bloc_aller_loin-body">
<p>Le <em>loglikelihood</em> est une mesure de l’ajustement d’un modèle à des données. Il est utilisé à peu près partout en statistique. Comprendre sa signification est donc un exercice important pour développer une meilleure intuition du fonctionnement général de nombreuses méthodes. Si les concepts de fonction de densité et de fonction de masse vous semblent encore flous, reportez-vous à la <a href="#sec-024">section&nbsp;<span>2.4</span></a> sur les distributions dans un premier temps.</p>
<p>Admettons que nous disposons d’une variable continue <em>v</em> que nous tentons de modéliser avec une distribution <em>d</em> (il peut s’agir de n’importe quelle distribution). <em>d</em> a une fonction de densité avec laquelle il est possible de calculer, pour chacune des valeurs de <em>v</em>, la probabilité d’être observée selon le modèle <em>d</em>.</p>
<p>Prenons un exemple concret dans R. Admettons que nous avons une variable comprenant 10 valeurs (oui, c’est un petit échantillon, mais c’est pour faire un exemple simple).</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">10</span>,<span class="fl">4</span>,<span class="fl">7</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">moyenne</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span>
<span><span class="va">ecart_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En calculant la moyenne et l’écart-type de la variable, nous obtenons les paramètres d’une distribution normale que nous pouvons utiliser pour représenter les données observées. En utilisant la fonction <code>dnorm</code> (la fonction de densité de la distribution normale), nous pouvons calculer la probabilité d’observer chacune des valeurs de <em>v</em> selon cette distribution normale.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">probas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">v</span>, <span class="va">moyenne</span>, <span class="va">ecart_type</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>valeur <span class="op">=</span> <span class="va">v</span>,</span>
<span>                 proba <span class="op">=</span> <span class="va">probas</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   valeur      proba
1       5 0.11203710
2       8 0.19624888
3       7 0.22228296
4       8 0.19624888
5      10 0.06009897
6       4 0.04985613
7       7 0.22228296
8       6 0.18439864
9       9 0.12689976
10      7 0.22228296</code></pre>
</div>
</div>
<p>Nous observons ainsi que les valeurs 7 et 8 sont très probables selon le modèle alors que les valeurs 4 et 10 sont très improbables.</p>
<p>Le <em>likelihood</em> est simplement le produit de toutes ces probabilités. Il s’agit donc de <strong>la probabilité conjointe</strong> d’avoir observé toutes les valeurs de <em>v</em> <strong>sous l’hypothèse</strong> que <em>d</em> est la distribution produisant ces valeurs. Si <em>d</em> décrit efficacement <em>v</em>, alors le <em>likelihood</em> est plus grand que si <em>d</em> ne décrit pas efficacement <em>v</em>. Il s’agit d’une forme de raisonnement par l’absurde&nbsp;: après avoir observé <em>v</em>, nous calculons la probabilité d’avoir observé <em>v</em> (<em>likelihood</em>) si notre modèle <em>d</em> était vrai. Si cette probabilité est très basse, alors c’est que notre modèle est mauvais puisqu’on a bien observé <em>v</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">likelihood_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html">prod</a></span><span class="op">(</span><span class="va">probas</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">likelihood_norm</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.322759e-09</code></pre>
</div>
</div>
<p>Cependant, multiplier un grand nombre de valeurs inférieures à zéro tend à produire des chiffres infiniment petits et donc à complexifier grandement le calcul. Nous préférons donc utiliser le <em>loglikelihood</em>&nbsp;: l’idée étant transformer les probabilités obtenues avec la fonction <em>log</em> puis d’additionner leurs résultats, puisque <span class="math inline">\(log(xy) = log(x)+log(y)\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">loglikelihood_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">probas</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">loglikelihood_norm</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -19.52247</code></pre>
</div>
</div>
<p>Comparons ce <em>loglikelihood</em> à celui d’un second modèle dans lequel nous utilisons toujours la distribution normale, mais avec une moyenne différente (faussée en ajoutant +3)&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">probas2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">v</span>, <span class="va">moyenne</span><span class="op">+</span><span class="fl">3</span>, <span class="va">ecart_type</span><span class="op">)</span></span>
<span><span class="va">loglikelihood_norm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">probas2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">loglikelihood_norm2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -33.53631</code></pre>
</div>
</div>
<p>Ce second <em>loglikehood</em> est plus faible, indiquant clairement que le premier modèle est plus adapté aux données.</p>
</div>
</div>
<p>Passons à la pratique avec deux exemples.</p>
<section id="temps-de-retard-des-bus-de-la-ville-de-toronto" class="level5" data-number="2.5.4.2.1"><h5 data-number="2.5.4.2.1" class="anchored" data-anchor-id="temps-de-retard-des-bus-de-la-ville-de-toronto">
<span class="header-section-number">2.5.4.2.1</span> Temps de retard des bus de la ville de Toronto</h5>
<p>Analysons les temps de retard pris par les bus de la ville de Toronto lorsqu’un évènement perturbe la circulation. Ce jeu de données est disponible sur le <a href="https://open.toronto.ca/catalogue/?search=bus%20delay&amp;sort=score%20desc" target="_blank">site des données ouvertes de la Ville de Toronto</a>. Compte tenu de la grande quantité d’observations, nous avons fait le choix de nous concentrer sur les évènements ayant eu lieu durant le mois de janvier 2019. Puisque la variable étudiée est une durée exprimée en minutes, elle est strictement positive (supérieure à 0), car un bus avec zéro minute de retard est à l’heure! Nous considérons également qu’un bus ayant plus de 150 minutes de retard (2&nbsp;heures&nbsp;30) n’est tout simplement pas passé (personne ne risque d’attendre 2&nbsp;heures&nbsp;30 pour prendre son bus). Commençons par charger les données et observer leur distribution empirique.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co"># charger le jeu de données</span></span>
<span><span class="va">data_trt_bus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">'data/univariee/bus-delay-2019_janv.csv'</span>, sep <span class="op">=</span><span class="st">';'</span><span class="op">)</span></span>
<span><span class="co"># retirer les observations aberrantes</span></span>
<span><span class="va">data_trt_bus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">data_trt_bus</span>, <span class="va">data_trt_bus</span><span class="op">$</span><span class="va">Min.Delay</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span></span>
<span>                         <span class="va">data_trt_bus</span><span class="op">$</span><span class="va">Min.Delay</span> <span class="op">&lt;</span> <span class="fl">150</span><span class="op">)</span></span>
<span><span class="co"># représenter la distribution empirique du jeu de données</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_trt_bus</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Min.Delay</span>, y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Min.Delay</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, bw <span class="op">=</span> <span class="fl">2</span>, size <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"temps de retard (en minutes)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bustrt" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-bustrt-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.31: Distribution empirique des temps de retard des bus à Toronto en janvier 2019</figcaption></figure>
</div>
</div>
</div>
<p>Compte tenu de la forme de la distribution empirique et de sa nature, quatre distributions sont envisageables&nbsp;:</p>
<ul>
<li><p>La distribution Gamma, strictement positive et asymétrique, est aussi une généralisation de la distribution exponentielle utilisée pour modéliser des temps d’attente. Pour des raisons similaires, nous pouvons aussi retenir la distribution de Weibull et la distribution log-normale. Nous écartons ici la distribution normale asymétrique puisque le jeu de données n’a clairement pas une forme normale au départ.</p></li>
<li><p>La distribution de Pareto, strictement positive et permettant de représenter ici le fait que la plupart des retards durent moins de 10 minutes, mais que quelques retards sont également beaucoup plus longs.</p></li>
</ul>
<p>Commençons par ajuster les quatre distributions avec la fonction <code>fitdist</code> du <em>package</em> <code>fitdistrplus</code> et représentons-les graphiquement pour éliminer les moins bons candidats. Nous utilisons également le <em>package</em> <code>actuar</code> pour la fonction de densité de Pareto (<code>dpareto</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lbbe.univ-lyon1.fr/fr/fitdistrplus">fitdistrplus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gitlab.com/vigou3/actuar">actuar</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span><span class="co"># ajustement des modèles</span></span>
<span><span class="va">model_gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">data_trt_bus</span><span class="op">$</span><span class="va">Min.Delay</span>, distr <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span></span>
<span><span class="va">model_weibull</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">data_trt_bus</span><span class="op">$</span><span class="va">Min.Delay</span>, distr <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span></span>
<span><span class="va">model_lognorm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">data_trt_bus</span><span class="op">$</span><span class="va">Min.Delay</span>, distr <span class="op">=</span> <span class="st">"lnorm"</span><span class="op">)</span></span>
<span><span class="va">model_pareto</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">data_trt_bus</span><span class="op">$</span><span class="va">Min.Delay</span>, distr <span class="op">=</span> <span class="st">"pareto"</span>, </span>
<span>                        start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"mse"</span><span class="op">)</span> <span class="co"># différentes méthodes d'optimisation</span></span>
<span><span class="co"># réalisation des graphiques</span></span>
<span><span class="va">plot1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_trt_bus</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Min.Delay</span>, y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dgamma</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span>                args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">model_gamma</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"temps de retard (en minutes)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">""</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Modèle Gamma"</span><span class="op">)</span></span>
<span><span class="va">plot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_trt_bus</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Min.Delay</span>, y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dweibull</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span>                args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">model_weibull</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"temps de retard (en minutes)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">""</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Modèle Weibull"</span><span class="op">)</span></span>
<span><span class="va">plot3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_trt_bus</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Min.Delay</span>, y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dlnorm</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span>                args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">model_lognorm</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"temps de retard (en minutes)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">""</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Modèle log-normal"</span><span class="op">)</span></span>
<span><span class="va">plot4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_trt_bus</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Min.Delay</span>, y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dpareto</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span>                args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">model_pareto</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"temps de retard (en minutes)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">""</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Modèle Pareto"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">plot1</span>, <span class="va">plot2</span>, <span class="va">plot3</span>, <span class="va">plot4</span><span class="op">)</span>,</span>
<span>          ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bustrt2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-bustrt2-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.32: Comparaison des distributions ajustées aux données de retard des bus</figcaption></figure>
</div>
</div>
</div>
<p>Visuellement, nous constatons que la distribution de Pareto est un mauvais choix. Pour les trois autres distributions, la comparaison des valeurs de <em>loglikelihood</em> s’impose (<a href="#tbl-distribs">tableau&nbsp;<span>2.8</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-distribs" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;2.8: Comparaison des LogLikelihood des trois distributions</caption>
<thead><tr class="header">
<th style="text-align: left;">Distribution</th>
<th style="text-align: right;">LogLikelihood</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Gamma</td>
<td style="text-align: right;">-23 062,56</td>
</tr>
<tr class="even">
<td style="text-align: left;">Weibull</td>
<td style="text-align: right;">-23 195,54</td>
</tr>
<tr class="odd">
<td style="text-align: left;">log-normal</td>
<td style="text-align: right;">-23 375,74</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Le plus grand <em>logLikelihood</em> est obtenu par la distribution Gamma qui s’ajuste donc le mieux à nos données. Pour finir, nous pouvons tester formellement, avec le test de Kolmogorov-Smirnov, si les données proviennent bien de cette distribution Gamma.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">model_gamma</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">data_trt_bus</span><span class="op">$</span><span class="va">Min.Delay</span>,</span>
<span>        y <span class="op">=</span> <span class="va">pgamma</span>, shape <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">shape</span>, rate <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">rate</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  data_trt_bus$Min.Delay
D = 0.099912, p-value &lt; 2.2e-16
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<p>Comme la valeur de <em>p</em> est inférieure à 0,05, nous ne pouvons pas accepter l’hypothèse que notre jeu de données suit effectivement une loi de Gamma. Considérant le nombre d’observations et le fait que de nombreux temps d’attente sont identiques (ce à quoi le test est très sensible), ce résultat n’est pas surprenant. La distribution Gamma reste cependant la distribution qui représente le mieux nos données. Nous pouvons estimer grâce, à cette distribution, la probabilité qu’un bus ait un retard de plus de 10 minutes de la façon suivante&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html">pgamma</a></span><span class="op">(</span><span class="fl">10</span>, shape <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">shape</span>, rate <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">rate</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5409424</code></pre>
</div>
</div>
<p>ce qui correspond à 54&nbsp;% de chance.</p>
<p>Pour moins de 10 minutes&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html">pgamma</a></span><span class="op">(</span><span class="fl">10</span>, shape <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">shape</span>, rate <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">rate</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4590576</code></pre>
</div>
</div>
<p>soit 46&nbsp;%.</p>
<p>Un dernier exemple avec la probabilité qu’un retard dépasse 45 minutes&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html">pgamma</a></span><span class="op">(</span><span class="fl">45</span>, shape <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">shape</span>, rate <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">rate</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01348194</code></pre>
</div>
</div>
<p>Soit seulement 1,3&nbsp;%.</p>
<p>Par conséquent, si un matin à Toronto votre bus a plus de 45 minutes de retard, bravo, vous êtes tombé sur une des très rares occasions où un tel retard se produit!</p>
</section><section id="accidents-de-vélo-à-montréal" class="level5" data-number="2.5.4.2.2"><h5 data-number="2.5.4.2.2" class="anchored" data-anchor-id="accidents-de-vélo-à-montréal">
<span class="header-section-number">2.5.4.2.2</span> Accidents de vélo à Montréal</h5>
<p>Le second jeu de données représente le nombre d’accidents de la route impliquant un vélo sur les intersections dans les quartiers centraux de Montréal (<a href="#fig-accmtl">figure&nbsp;<span>2.33</span></a>). Le jeu de données complet est disponible sur le site des <a href="http://donnees.ville.montreal.qc.ca/dataset/collisions-routieres" target="_blank">données ouvertes</a> de la Ville de Montréal. Puisque ces données correspondent à des comptages, la première distribution à envisager est la distribution de Poisson. Cependant, puisque nous aurons également un grand nombre d’intersections sans accident, il serait judicieux de tester la distribution de Poisson avec excès de zéro.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co"># charger le jeu de données</span></span>
<span><span class="va">data_accidents</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">'data/univariee/accidents_mtl.csv'</span>, sep <span class="op">=</span><span class="st">','</span><span class="op">)</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data_accidents</span><span class="op">$</span><span class="va">nb_accident</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">counts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"nb_accident"</span>,<span class="st">'frequence'</span><span class="op">)</span></span>
<span><span class="va">counts</span><span class="op">$</span><span class="va">nb_accident</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">counts</span><span class="op">$</span><span class="va">nb_accident</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">counts</span><span class="op">$</span><span class="va">prop</span> <span class="op">&lt;-</span> <span class="va">counts</span><span class="op">$</span><span class="va">frequence</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">counts</span><span class="op">$</span><span class="va">frequence</span><span class="op">)</span></span>
<span><span class="co"># représenter la distribution empirique du jeu de donnée</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">counts</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nb_accident</span>, weight <span class="op">=</span> <span class="va">frequence</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"nombre d'accidents"</span>,</span>
<span>      y <span class="op">=</span> <span class="st">"fréquence"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-accmtl" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-accmtl-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.33: Distribution empirique du nombre d’accidents par intersection impliquant un ou une cycliste à Montréal en 2017 dans les quartiers centraux</figcaption></figure>
</div>
</div>
</div>
<p>Nous avons effectivement de nombreux zéros, alors essayons d’ajuster nos deux distributions à ce jeu de données. Dans la <a href="#fig-accmtldist">figure&nbsp;<span>2.34</span></a>, les barres grises représentent la distribution empirique du jeu de données et les barres rouges, les distributions théoriques ajustées. Nous utilisons ici le <em>package</em> <code>gamlss.dist</code> pour avoir la fonction de masse d’une distribution de Poisson avec excès de zéros.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.gamlss.com/">gamlss.dist</a></span><span class="op">)</span></span>
<span><span class="co"># Ajuster le modèle de poisson</span></span>
<span><span class="va">model_poisson</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">data_accidents</span><span class="op">$</span><span class="va">nb_accident</span>, distr <span class="op">=</span> <span class="st">"pois"</span><span class="op">)</span></span>
<span><span class="co"># Ajuster le modèle de poisson avec excès de zéros</span></span>
<span><span class="va">model_poissonzi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html">fitdist</a></span><span class="op">(</span><span class="va">data_accidents</span><span class="op">$</span><span class="va">nb_accident</span>, <span class="st">"ZIP"</span>,</span>
<span>    start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">4</span>, sigma <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span>, <span class="co"># valeurs pour faciliter la convergence</span></span>
<span>    optim.method <span class="op">=</span> <span class="st">"L-BFGS-B"</span>, <span class="co"># méthode d'optimisation recommandée dans la documentation</span></span>
<span>    lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.00001</span>, <span class="fl">0.00001</span><span class="op">)</span>, <span class="co"># valeurs minimales des deux paramètres</span></span>
<span>    upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">Inf</span>, <span class="fl">1</span><span class="op">)</span><span class="co"># valeurs maximales des deux paramètres</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">dfpoisson</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>,</span>
<span>                        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span>, <span class="va">model_poisson</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span></span>
<span>                        <span class="op">)</span></span>
<span><span class="va">plot1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nb_accident</span>, weight <span class="op">=</span> <span class="va">prop</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.6</span>, data <span class="op">=</span> <span class="va">counts</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, weight <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.15</span>, data <span class="op">=</span> <span class="va">dfpoisson</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>,<span class="fl">7</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>subtitle <span class="op">=</span> <span class="st">"Modèle de Poisson"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"nombre d'accidents"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">dfpoissonzi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>,</span>
<span>                        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gamlss.dist/man/ZIP.html">dZIP</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span>, <span class="va">model_poissonzi</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                               <span class="va">model_poissonzi</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>                        <span class="op">)</span></span>
<span><span class="va">plot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nb_accident</span>, weight <span class="op">=</span> <span class="va">prop</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.6</span>, data <span class="op">=</span> <span class="va">counts</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, weight <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.15</span>, data <span class="op">=</span> <span class="va">dfpoissonzi</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>,<span class="fl">7</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>subtitle <span class="op">=</span> <span class="st">"Modèle de Poisson avec excès de zéro"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"nombre d'accident"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">plot1</span>, <span class="va">plot2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-accmtldist" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-accmtldist-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.34: Ajustement des distributions de Poisson et Poisson avec excès de zéros</figcaption></figure>
</div>
</div>
</div>
<p>Visuellement, comme nous pouvons l’observer à la <a href="#fig-accmtldist">figure&nbsp;<span>2.34</span></a>), le modèle avec excès de zéro semble s’imposer. Nous pouvons vérifier cette impression avec la comparaison des <em>loglikelihood</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">model_poisson</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -989.83</code></pre>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">model_poissonzi</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -931.8778</code></pre>
</div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#afficher les paramètres ajustés</span></span>
<span><span class="va">model_poisson</span><span class="op">$</span><span class="va">estimate</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   lambda 
0.1991963 </code></pre>
</div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_poissonzi</span><span class="op">$</span><span class="va">estimate</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       mu     sigma 
0.6690301 0.7022605 </code></pre>
</div>
</div>
<p>Nous avons donc la confirmation que le modèle de Poisson avec excès de zéros est mieux ajusté. Nous apprenons donc que 70&nbsp;% (sigma = 0,70) des intersections sont en fait exclues du phénomène étudié (probablement parce que très peu de cyclistes les utilisent ou parce qu’elles sont très peu accidentogènes) et que pour les autres, le taux d’accidents par année en 2017 était de 0,67 (<em>mu</em> = 0,669, <em>mu</em> signifiant <span class="math inline">\(\lambda\)</span> pour le <em>package</em> <code>gamlss</code>). À nouveau, nous pouvons effectuer un test formel avec le fonction <code>ks.test</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">model_poissonzi</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">data_accidents</span><span class="op">$</span><span class="va">nb_accident</span>,</span>
<span>        y <span class="op">=</span> <span class="va">pZIP</span>, mu <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">mu</span>, sigma <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  data_accidents$nb_accident
D = 0.85476, p-value &lt; 2.2e-16
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<p>Encore une fois, nous devons rejeter l’hypothèse selon laquelle le test suit une distribution de Poisson avec excès de zéros. Ces deux exemples montrent à quel point ce test est restrictif.</p>
</section></section></section><section id="sec-0255" class="level3" data-number="2.5.5"><h3 data-number="2.5.5" class="anchored" data-anchor-id="sec-0255">
<span class="header-section-number">2.5.5</span> Transformation des variables</h3>
<section id="sec-02551" class="level4" data-number="2.5.5.1"><h4 data-number="2.5.5.1" class="anchored" data-anchor-id="sec-02551">
<span class="header-section-number">2.5.5.1</span> Transformations visant à atteindre la normalité</h4>
<p>Comme énoncé au début de cette section, plusieurs méthodes statistiques nécessitent que la variable quantitative soit normalement distribuée. C’est notamment le cas de l’analyse de variance et des tests <em>t</em> (abordés dans les chapitres suivants) qui fournissent des résultats plus robustes lorsque la variable est normalement distribuée. Plusieurs transformations sont possibles, les plus courantes étant la racine carrée, le logarithme et l’inverse de la variable. Selon plusieurs auteur(e)s (notamment, les statisticiennes Barbara G. Tabacknick et Linda S. Fidell <span class="citation" data-cites="tabachnick2007">(<a href="references.html#ref-tabachnick2007" role="doc-biblioref">2007, 89</a>)</span>), en fonction du type (positive ou négative) et du degré d’asymétrie, les transformations suivantes sont possibles afin d’améliorer la normalité de la variable&nbsp;:</p>
<ul>
<li>Asymétrie positive modérée&nbsp;: la racine carrée de la variable <em>X</em> avec la fonction <code>sqrt(df$x)</code>.</li>
<li>Asymétrie positive importante&nbsp;: le logarithme de la variable avec <code>log10(df$x)</code>.</li>
<li>Asymétrie positive sévère&nbsp;: l’inverse de la variable avec <code>1/(df$x)</code>.</li>
</ul>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>Transformation avec des variables avec des valeurs négatives</strong></p>
</div>
<div class="bloc_astuce-body">
<p>Pour une valeur égale ou inférieure à 0, nous ne pouvons pas calculer une racine carrée ou un logarithme. Par conséquent, il convient de décaler simplement la distribution vers la droite afin de s’assurer qu’il n’y ait plus de valeurs négatives ou égales à 0&nbsp;:</p>
<ul>
<li>
<code>sqrt(df$x - min(df$x+1))</code>pour une asymétrie positive avec des valeurs négatives ou égales à 0.</li>
<li>
<code>log(df$x - min(df$x+1))</code>pour une asymétrie positive avec des valeurs négatives ou égales à 0.</li>
</ul>
<p>Par exemple, si la valeur minimale de la variable est égale à -10, la valeur minimale de variable décalée sera ainsi de 11.</p>
<ul>
<li>Asymétrie négative modérée&nbsp;: <code>sqrt(max(df$x+1) - df$x)</code>
</li>
<li>Asymétrie négative importante&nbsp;: <code>log(max(df$x+1) - df$x)</code>
</li>
<li>Asymétrie négative sévère&nbsp;: <code>1/(max(df$x+1) - df$x)</code>
</li>
</ul>
</div>
</div>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Transformation des variables pour atteindre la normalité&nbsp;: ce n’est pas toujours la panacée!</strong></p>
</div>
<div class="bloc_attention-body">
<p>La transformation des données fait et fera encore longtemps débat à la fois parmi les statisticien(ne)s, et les personnes utilisatrices débutantes ou avancées des méthodes quantitatives. Field et al. <span class="citation" data-cites="field2012discovering">(<a href="references.html#ref-field2012discovering" role="doc-biblioref">2012, 193</a>)</span> résument le tout avec humour&nbsp;: «&nbsp;to transform or not transform, that is the question&nbsp;».</p>
<p><strong>Avantages de la transformation</strong></p>
<ul>
<li><p>L’obtention de <em>résultats plus robustes</em>.</p></li>
<li><p>Dans une régression linéaire multiple, la transformation de la variable dépendante peut <em>remédier au non-respect des hypothèses de base liées à la régression</em> (linéarité et homoscédasticité des erreurs, absence de valeurs aberrantes, etc.).</p></li>
</ul>
<p><strong>Inconvénients de la transformation</strong></p>
<ul>
<li><p><em>Une variable transformée est plus difficile à interpréter</em> puisque cela change l’unité de mesure de la variable. Prenons un exemple concret&nbsp;: vous souhaitez comparer les moyennes de revenu de deux groupes <em>A</em> et <em>B</em>. Vous obtenez une différence de 15&nbsp;000&nbsp;$, soit une valeur facile à interpréter. Par contre, si la variable a été préalablement transformée en logarithme, il est possible que vous obteniez une différence de 9, ce qui est beaucoup moins parlant. Aussi, en transformant la variable en <em>log</em>, vous ne comparez plus les moyennes arithmétiques des deux groupes, mais plutôt leurs moyennes géométriques <span class="citation" data-cites="field2012discovering">(<a href="references.html#ref-field2012discovering" role="doc-biblioref">Field, Miles et Field 2012, 193</a>)</span>.</p></li>
<li><p><em>Pourquoi perdre la forme initiale de la distribution du phénomène à expliquer?</em> Il est possible, pour de nombreuses méthodes de choisir la distribution que nous souhaitons utiliser, il n’est donc pas nécessaire de toujours se limiter à la distribution normale. Par exemple, dans les modèles de régression généralisés (GLM), nous pourrions indiquer que la variable indépendante suit une distribution de Student plutôt que de vouloir à tout prix la rendre normale. De même, certains tests non paramétriques permettent d’analyser des variables ne suivant pas une distribution normale.</p></li>
</ul>
<p><strong>Démarche à suivre avant et après la transformation</strong></p>
<ul>
<li><p><em>La transformation est-elle nécessaire?</em> Ne transformez jamais une variable sans avoir analysé rigoureusement sa forme (histogramme avec courbe normale, <em>skewness</em> et <em>kurtosis</em>, tests de normalité).</p></li>
<li><p><em>D’autres options à la transformation d’une variable dépendante (VD) sont-elles envisageables?</em> Identifiez la forme de la distribution de la VD et utilisez au besoin un modèle GLM adapté à cette distribution. Autrement dit, ne transformez pas automatiquement votre VD simplement pour l’introduire dans une régression linéaire multiple.</p></li>
<li><p><em>La transformation a-t-elle un apport significatif?</em> Premièrement, vérifiez si la transformation utilisée (logarithme, racine carrée, inverse, etc.) améliore la normalité de la variable. Ce n’est pas toujours le cas, parfois c’est pire! Prenez soin de comparer les histogrammes, les valeurs de <em>skewness</em>, de <em>kurtosis</em> et des différents tests de normalité avant et après la transformation. Deuxièmement, comparez les résultats de vos analyses statistiques sans et avec transformation, et ce, dans une démarche coût-avantage. Vos résultats sont-ils bien plus robustes? Par exemple, un R<sup>2</sup> qui passe de 0,597 à 0,602 (avant et après la transformation des variables) avec des associations significatives similaires, mais qui sont plus difficiles à interpréter (du fait des transformations), n’est pas forcément un gain significatif. La modélisation en sciences sociales ne vise pas à prédire la trajectoire d’un satellite ou l’atterrissage d’un engin sur Mars! La précision à la quatrième décimale n’est pas une condition! Par conséquent, un modèle un peu moins robuste, mais plus facile à interpréter est parfois préférable.</p></li>
</ul>
</div>
</div>
</section><section id="sec-02552" class="level4" data-number="2.5.5.2"><h4 data-number="2.5.5.2" class="anchored" data-anchor-id="sec-02552">
<span class="header-section-number">2.5.5.2</span> Autres types de transformations</h4>
<p>Les trois transformations les plus couramment utilisées sont&nbsp;:</p>
<ul>
<li>
<strong>La côte <span class="math inline">\(z\)</span></strong> (<em>z score</em> en anglais) qui consiste à soustraire à chaque valeur sa moyenne (soit un centrage), puis à la diviser par son écart-type (soit une réduction) (<a href="#eq-scorez">équation&nbsp;<span>2.29</span></a>). Par conséquent, nous parlons aussi de variable centrée réduite qui a comme propriétés intéressantes une moyenne égale à 0 et un écart-type égal à 1 (la variance est aussi égale à 1 puisque 1<sup>2</sup>&nbsp;=&nbsp;1). Nous verrons que cette transformation est largement utilisée dans les méthodes de classification (<a href="13-MethodeClassification.html">chapitre&nbsp;<span>13</span></a>) et les méthodes factorielles (<a href="12-AnalysesFactorielles.html">chapitre&nbsp;<span>12</span></a>).</li>
</ul>
<p><span id="eq-scorez"><span class="math display">\[
z= \frac{x_i-\mu}{\sigma}
\tag{2.29}\]</span></span></p>
<ul>
<li><p><strong>La transformation en rang</strong> qui consiste simplement à trier une variable en ordre croissant, puis à affecter le rang de chaque observation de 1 à <span class="math inline">\(n\)</span>. Cette transformation est très utilisée quand la variable est très anormalement distribuée, notamment pour calculer le coefficient de corrélation de Spearman (<a href="04-bivarieeQuantiQuanti.html#sec-0433">section&nbsp;<span>4.3.3</span></a>) et certains tests non paramétriques (sections <a href="06-bivarieeQualiQuanti.html#sec-0612"><span>6.1.2</span></a> et <a href="06-bivarieeQualiQuanti.html#sec-0622"><span>6.2.2</span></a>).</p></li>
<li><p><strong>La transformation sur une échelle de 0 à 1</strong> (ou de 0 à 100) qui consiste à soustraite à chaque observation la valeur minimale et à diviser le tout par l’étendue (<a href="#eq-t01">équation&nbsp;<span>2.30</span></a>).</p></li>
</ul>
<p><span id="eq-t01"><span class="math display">\[
X_{\in\lbrack0-1\rbrack}= \frac{x_i-max}{max-min} \text{ ou } X_{\in\lbrack0-100\rbrack}= \frac{x_i-min}{max-min}\times100
\tag{2.30}\]</span></span></p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-AutresTransformation" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;2.9: Illustration des trois transformations</caption>
<thead><tr class="header">
<th style="text-align: left;">Observation</th>
<th style="text-align: right;"><span class="math inline">\(x_i\)</span></th>
<th style="text-align: right;">Côte <span class="math inline">\(z\)</span>
</th>
<th style="text-align: center;">Rang</th>
<th style="text-align: right;">0 à 1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">22,00</td>
<td style="text-align: right;">-1,45</td>
<td style="text-align: center;">1</td>
<td style="text-align: right;">0,00</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">27,00</td>
<td style="text-align: right;">-0,65</td>
<td style="text-align: center;">3</td>
<td style="text-align: right;">0,28</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">25,00</td>
<td style="text-align: right;">-0,97</td>
<td style="text-align: center;">2</td>
<td style="text-align: right;">0,17</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">30,00</td>
<td style="text-align: right;">-0,16</td>
<td style="text-align: center;">4</td>
<td style="text-align: right;">0,44</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">37,00</td>
<td style="text-align: right;">0,97</td>
<td style="text-align: center;">7</td>
<td style="text-align: right;">0,83</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">32,00</td>
<td style="text-align: right;">0,16</td>
<td style="text-align: center;">5</td>
<td style="text-align: right;">0,56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">35,00</td>
<td style="text-align: right;">0,65</td>
<td style="text-align: center;">6</td>
<td style="text-align: right;">0,72</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">40,00</td>
<td style="text-align: right;">1,45</td>
<td style="text-align: center;">8</td>
<td style="text-align: right;">1,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Moyenne</td>
<td style="text-align: right;">31,00</td>
<td style="text-align: right;">0,00</td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Écart-type</td>
<td style="text-align: right;">6,19</td>
<td style="text-align: right;">1,00</td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Pour un <em>DataFrame</em>, nommé <em>df</em>, comprenant une variable <em>X</em>, la syntaxe ci-dessous illustre comment obtenir quatre transformations (côte <span class="math inline">\(z\)</span>, rang, 0 à 1 et 0 à 100).</p>
<div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">22</span>,<span class="fl">27</span>,<span class="fl">25</span>,<span class="fl">30</span>,<span class="fl">37</span>,<span class="fl">32</span>,<span class="fl">35</span>,<span class="fl">40</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Transformation centrée réduite : côte Z</span></span>
<span><span class="va">df2</span><span class="op">$</span><span class="va">zX</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">X</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu">sd</span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="co"># ou encore avec la fonction scale</span></span>
<span><span class="va">df2</span><span class="op">$</span><span class="va">zX</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">X</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Transformation en rang avec la fonction rank</span></span>
<span><span class="va">df2</span><span class="op">$</span><span class="va">rX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">X</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Transformation de 0 à 1 ou de 0 à 100</span></span>
<span><span class="va">df2</span><span class="op">$</span><span class="va">X01</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">X</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">X</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df2</span><span class="op">$</span><span class="va">X0100</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">X</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">X</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-AutresTransformation2" class="cell tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p><strong>?(caption)</strong></p>
</div>
</div>
</div>
<div class="bloc_aller_loin">
<div class="bloc_aller_loin-header">
<div class="bloc_aller_loin-icon">

</div>
<p><strong>Utilité des transformations</strong></p>
</div>
<div class="bloc_aller_loin-body">
<p>Ces trois transformations sont parfois utilisées pour générer un indice composite à partir de plusieurs variables ou encore dans une analyse de sensibilité avec les indices de Sobol <span class="citation" data-cites="Sobol1993">(<a href="references.html#ref-Sobol1993" role="doc-biblioref">1993</a>)</span>.</p>
</div>
</div>
</section></section><section id="sec-0256" class="level3" data-number="2.5.6"><h3 data-number="2.5.6" class="anchored" data-anchor-id="sec-0256">
<span class="header-section-number">2.5.6</span> Mise en œuvre dans R</h3>
<p>Il existe une multitude de <em>packages</em> dédiés au calcul des statistiques descriptives univariées. Par parcimonie, nous en utiliserons uniquement trois&nbsp;: <code>DescTools</code>, <code>nortest</code> et <code>stats</code>. Libre à vous de faire vos recherches sur Internet pour utiliser d’autres <em>packages</em> au besoin. Les principales fonctions que nous utilisons ici sont&nbsp;:</p>
<ul>
<li>
<code>summary</code>&nbsp;: pour obtenir un résumé sommaire des statistiques descriptives (minimum, Q1, Q2, Q3, maximum)</li>
<li>
<code>mean</code>&nbsp;: moyenne</li>
<li>
<code>min</code>&nbsp;: minimum</li>
<li>
<code>max</code>&nbsp;: maximum</li>
<li>
<code>range</code>&nbsp;: minimum et maximum</li>
<li>
<code>quantile</code>&nbsp;: quartiles</li>
<li>
<code>quantile((x, probs = seq(.0, 1, by = .2))</code>&nbsp;: quintiles</li>
<li>
<code>quantile((x, probs = seq(.0, 1, by = .1))</code>&nbsp;: déciles</li>
<li>
<code>var</code>&nbsp;: variance</li>
<li>
<code>sd</code>&nbsp;: écart-type</li>
<li>
<code>Skew</code> du <em>package</em> <code>DescTools</code>&nbsp;: coefficient d’asymétrie</li>
<li>
<code>Kurt</code> du <em>package</em> <code>DescTools</code>&nbsp;: coefficient d’aplatissement</li>
<li>
<code>ks.test(x, "pnorm", mean=mean(x), sd=sd(x))</code> du <em>package</em> <code>nortest</code>&nbsp;: test de Kolmogorov-Smirnov</li>
<li>
<code>shapiro.test</code> du <em>package</em> <code>DescTools</code>&nbsp;: test de Shapiro-Wilk</li>
<li>
<code>lillie.test</code> du <em>package</em> <code>DescTools</code>&nbsp;: du package <code>nortest</code>&nbsp;: test de Lilliefors</li>
<li>
<code>ad.test</code> du <em>package</em> <code>DescTools</code>&nbsp;: test d’Anderson-Darling</li>
<li>
<code>JarqueBeraTest</code> du <em>package</em> <code>DescTools</code>&nbsp;: test de Jarque-Bera</li>
</ul>
<section id="sec-02561" class="level4" data-number="2.5.6.1"><h4 data-number="2.5.6.1" class="anchored" data-anchor-id="sec-02561">
<span class="header-section-number">2.5.6.1</span> Application à une seule variable</h4>
<p>Admettons que vous voulez obtenir des statistiques pour une seule variable présente dans un <em>DataFrame</em> (<code>dataMTL$PctFRev</code>)&nbsp;:</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://andrisignorell.github.io/DescTools/">DescTools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">nortest</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Importation du fichier csv dans un DataFrame</span></span>
<span><span class="va">dataMTL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/univariee/DataSR2016.csv"</span><span class="op">)</span></span>
<span><span class="co"># Tableau sommaire pour la variable PctFRev</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.846  11.242  15.471  16.822  20.229  68.927 </code></pre>
</div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># PARAMÈTRES DE TENDANCE CENTRALE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span>   <span class="co"># Moyenne</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16.82247</code></pre>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span>   <span class="co"># Médiane</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15.471</code></pre>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># PARAMÈTRES DE POSITION</span></span>
<span><span class="co"># Quartiles</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     0%     25%     50%     75%    100% 
 1.8460 11.2420 15.4710 20.2285 68.9270 </code></pre>
</div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Quintiles</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">.0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    0%    20%    40%    60%    80%   100% 
 1.846 10.294 13.626 16.918 21.756 68.927 </code></pre>
</div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Déciles</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">.0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    0%    10%    20%    30%    40%    50%    60%    70%    80%    90%   100% 
 1.846  8.402 10.294 12.172 13.626 15.471 16.918 18.868 21.756 26.854 68.927 </code></pre>
</div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Percentiles personnalisés avec apply</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">.05</span>,<span class="fl">0.10</span>,<span class="fl">.25</span>,<span class="fl">.50</span>,<span class="fl">.75</span>,<span class="fl">.90</span>,<span class="fl">.95</span>,<span class="fl">.99</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     1%      5%     10%     25%     50%     75%     90%     95%     99% 
 5.2290  7.1470  8.4020 11.2420 15.4710 20.2285 26.8540 31.7530 45.6010 </code></pre>
</div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># PARAMÈTRES DE DISPERSION</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span>  <span class="co"># Min et Max</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1.846 68.927</code></pre>
</div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Étendue</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 67.081</code></pre>
</div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Écart interquartile</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   75% 
8.9865 </code></pre>
</div>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span> <span class="co"># Variance</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 66.62482</code></pre>
</div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span>  <span class="co"># Écart-type</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.162403</code></pre>
</div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span> <span class="co"># CV</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4852083</code></pre>
</div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># PARAMÈTRES DE FORME</span></span>
<span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Skew</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span>    <span class="co"># Skewness</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.67367</code></pre>
</div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Kurt</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span>    <span class="co"># Kurtosis</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.858815</code></pre>
</div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># TESTS D'HYPOTHÈSE SUR LA NORMALITÉ</span></span>
<span><span class="co"># K-Smirnov</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span>, <span class="st">"pnorm"</span>, mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  dataMTL$PctFRev
D = 0.10487, p-value = 1.646e-09
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span> </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  dataMTL$PctFRev
W = 0.88748, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/lillie.test.html">lillie.test</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span> </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Lilliefors (Kolmogorov-Smirnov) normality test

data:  dataMTL$PctFRev
D = 0.10487, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/ad.test.html">ad.test</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span> </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Anderson-Darling normality test

data:  dataMTL$PctFRev
A = 21.072, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/JarqueBeraTest.html">JarqueBeraTest</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span> </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Robust Jarque Bera Test

data:  dataMTL$PctFRev
X-squared = 2173.1, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Pour construire un histogramme avec la courbe normale, consultez la <a href="03-magiedesgraphiques.html#sec-03213">section&nbsp;<span>3.2.1.3</span></a> ou la syntaxe ci-dessous.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">moyenne</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span></span>
<span><span class="va">ecart_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">PctFRev</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dataMTL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PctFRev</span>, y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>,</span>
<span>                 bins <span class="op">=</span> <span class="fl">30</span>, color <span class="op">=</span> <span class="st">"#343a40"</span>, fill <span class="op">=</span> <span class="st">"#a8dadc"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"personnes à faible revenu (%)"</span>, y <span class="op">=</span> <span class="st">"densité"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">moyenne</span>, sd <span class="op">=</span> <span class="va">ecart_type</span><span class="op">)</span>, </span>
<span>                color <span class="op">=</span> <span class="st">"#e63946"</span>, linewidth <span class="op">=</span> <span class="fl">1.2</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-GcourbeNormale" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-GcourbeNormale-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.35: Histogramme avec courbe normale</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-02562" class="level4" data-number="2.5.6.2"><h4 data-number="2.5.6.2" class="anchored" data-anchor-id="sec-02562">
<span class="header-section-number">2.5.6.2</span> Application à plusieurs variables</h4>
<p>Pour obtenir des sorties de statistiques descriptives pour plusieurs variables, nous vous conseillons&nbsp;:</p>
<ul>
<li>de créer un vecteur avec les noms des variables (<em>VarsSelect</em> dans la syntaxe ci-dessous);</li>
<li>d’utiliser ensuite les fonctions <code>sapply</code> et <code>apply.</code>
</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Noms des variables du DataFrame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "CTNAME"                "PopTotal"              "HabKm2"               
 [4] "PctFRev"               "TxChomage"             "PctImmigrant"         
 [7] "PctImgRecent"          "PctMenage1pers"        "PctFamilleMono"       
[10] "PctLangueMaternelleFR" "PctLangueMaternelleAN" "PctLangueMaternelleAU"</code></pre>
</div>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Vecteur pour trois variables</span></span>
<span><span class="va">VarsSelect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HabKm2"</span>, <span class="st">"TxChomage"</span>, <span class="st">"PctFRev"</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># Tableau sommaire pour les 3 variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     HabKm2        TxChomage         PctFRev      
 Min.   :   18   Min.   : 1.942   Min.   : 1.846  
 1st Qu.: 1980   1st Qu.: 5.482   1st Qu.:11.242  
 Median : 3773   Median : 7.130   Median :15.471  
 Mean   : 5513   Mean   : 7.743   Mean   :16.822  
 3rd Qu.: 7916   3rd Qu.: 9.391   3rd Qu.:20.229  
 Max.   :50282   Max.   :26.882   Max.   :68.927  </code></pre>
</div>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># PARAMÈTRES DE TENDANCE CENTRALE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">mean</span><span class="op">)</span>   <span class="co"># Moyenne</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     HabKm2   TxChomage     PctFRev 
5512.830705    7.743329   16.822470 </code></pre>
</div>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">median</span><span class="op">)</span> <span class="co"># Médiane</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   HabKm2 TxChomage   PctFRev 
 3773.000     7.130    15.471 </code></pre>
</div>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># PARAMÈTRES DE POSITION</span></span>
<span><span class="co"># Quartiles</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">quantile</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      HabKm2 TxChomage PctFRev
0%      18.0    1.9420  1.8460
25%   1980.5    5.4825 11.2420
50%   3773.0    7.1300 15.4710
75%   7915.5    9.3910 20.2285
100% 50282.0   26.8820 68.9270</code></pre>
</div>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Quintiles</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">.0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     HabKm2 TxChomage PctFRev
0%       18     1.942   1.846
20%    1525     5.116  10.294
40%    2953     6.422  13.626
60%    4971     7.973  16.918
80%    9509    10.000  21.756
100%  50282    26.882  68.927</code></pre>
</div>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Déciles</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">.0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     HabKm2 TxChomage PctFRev
0%       18     1.942   1.846
10%     455     4.369   8.402
20%    1525     5.116  10.294
30%    2298     5.780  12.172
40%    2953     6.422  13.626
50%    3773     7.130  15.471
60%    4971     7.973  16.918
70%    6918     8.909  18.868
80%    9509    10.000  21.756
90%   13055    11.749  26.854
100%  50282    26.882  68.927</code></pre>
</div>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Percentiles personnalisés avec apply</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="fl">2</span>, </span>
<span>      <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">.05</span>,<span class="fl">0.10</span>,<span class="fl">.25</span>,<span class="fl">.50</span>,<span class="fl">.75</span>,<span class="fl">.90</span>,<span class="fl">.95</span>,<span class="fl">.99</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     HabKm2 TxChomage PctFRev
1%     58.5    2.9665  5.2290
5%    178.0    3.8980  7.1470
10%   455.0    4.3690  8.4020
25%  1980.5    5.4825 11.2420
50%  3773.0    7.1300 15.4710
75%  7915.5    9.3910 20.2285
90% 13055.0   11.7490 26.8540
95% 15355.0   13.8400 31.7530
99% 18578.5   17.1920 45.6010</code></pre>
</div>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># PARAMÈTRES DE DISPERSION</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">range</span><span class="op">)</span>  <span class="co"># Min et Max</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     HabKm2 TxChomage PctFRev
[1,]     18     1.942   1.846
[2,]  50282    26.882  68.927</code></pre>
</div>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Étendue</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">max</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">min</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   HabKm2 TxChomage   PctFRev 
50264.000    24.940    67.081 </code></pre>
</div>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Écart interquartile</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">quantile</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span>,<span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">quantile</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   HabKm2 TxChomage   PctFRev 
5935.0000    3.9085    8.9865 </code></pre>
</div>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">var</span><span class="op">)</span>    <span class="co"># Variance</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      HabKm2    TxChomage      PctFRev 
2.633462e+07 9.880932e+00 6.662482e+01 </code></pre>
</div>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">sd</span><span class="op">)</span>     <span class="co"># Écart-type</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     HabKm2   TxChomage     PctFRev 
5131.726785    3.143395    8.162403 </code></pre>
</div>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Coefficient de variation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">sd</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">mean</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   HabKm2 TxChomage   PctFRev 
0.9308696 0.4059488 0.4852083 </code></pre>
</div>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># PARAMÈTRES DE FORME</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">Skew</span><span class="op">)</span>    <span class="co"># Skewness</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   HabKm2 TxChomage   PctFRev 
 1.967468  1.280216  1.673670 </code></pre>
</div>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">Kurt</span><span class="op">)</span>    <span class="co"># Kurtosis</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   HabKm2 TxChomage   PctFRev 
 8.546403  2.892443  4.858815 </code></pre>
</div>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># TESTS D'HYPOTHÈSE POUR LA NORMALITÉ</span></span>
<span><span class="co"># K-Smirnov</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"pnorm"</span>, mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$HabKm2

    Asymptotic one-sample Kolmogorov-Smirnov test

data:  x
D = 0.14899, p-value &lt; 2.2e-16
alternative hypothesis: two-sided


$TxChomage

    Asymptotic one-sample Kolmogorov-Smirnov test

data:  x
D = 0.080183, p-value = 9.778e-06
alternative hypothesis: two-sided


$PctFRev

    Asymptotic one-sample Kolmogorov-Smirnov test

data:  x
D = 0.10487, p-value = 1.646e-09
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">shapiro.test</span><span class="op">)</span>       <span class="co"># Shapiro-Wilk</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          HabKm2                        TxChomage                    
statistic 0.8385086                     0.9235146                    
p.value   5.648795e-30                  1.451222e-21                 
method    "Shapiro-Wilk normality test" "Shapiro-Wilk normality test"
data.name "X[[i]]"                      "X[[i]]"                     
          PctFRev                      
statistic 0.8874803                    
p.value   1.00278e-25                  
method    "Shapiro-Wilk normality test"
data.name "X[[i]]"                     </code></pre>
</div>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">lillie.test</span><span class="op">)</span>       <span class="co"># Lilliefors</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          HabKm2                                          
statistic 0.148988                                        
p.value   5.689619e-58                                    
method    "Lilliefors (Kolmogorov-Smirnov) normality test"
data.name "X[[i]]"                                        
          TxChomage                                       
statistic 0.0801829                                       
p.value   7.758887e-16                                    
method    "Lilliefors (Kolmogorov-Smirnov) normality test"
data.name "X[[i]]"                                        
          PctFRev                                         
statistic 0.1048704                                       
p.value   7.43257e-28                                     
method    "Lilliefors (Kolmogorov-Smirnov) normality test"
data.name "X[[i]]"                                        </code></pre>
</div>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">ad.test</span><span class="op">)</span>           <span class="co"># Anderson-Darling</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          HabKm2                            TxChomage                        
statistic 36.40276                          14.9237                          
p.value   3.7e-24                           3.7e-24                          
method    "Anderson-Darling normality test" "Anderson-Darling normality test"
data.name "X[[i]]"                          "X[[i]]"                         
          PctFRev                          
statistic 21.07194                         
p.value   3.7e-24                          
method    "Anderson-Darling normality test"
data.name "X[[i]]"                         </code></pre>
</div>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">JarqueBeraTest</span><span class="op">)</span>    <span class="co"># Jarque-Bera</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          HabKm2                    TxChomage                
statistic 4270.113                  639.2741                 
parameter 2                         2                        
p.value   0                         0                        
method    "Robust Jarque Bera Test" "Robust Jarque Bera Test"
data.name "X[[i]]"                  "X[[i]]"                 
          PctFRev                  
statistic 2173.082                 
parameter 2                        
p.value   0                        
method    "Robust Jarque Bera Test"
data.name "X[[i]]"                 </code></pre>
</div>
</div>
</section><section id="sec-02563" class="level4" data-number="2.5.6.3"><h4 data-number="2.5.6.3" class="anchored" data-anchor-id="sec-02563">
<span class="header-section-number">2.5.6.3</span> Transformation d’une variable dans R</h4>
<p>La syntaxe ci-dessous illustre trois exemples de transformation (logarithme, racine carrée et inverse de la variable). Rappelez-vous qu’il faut comparer les valeurs de <em>skewness</em> et de <em>kurtosis</em> et des tests de Shapiro-Wilk avant et après les transformations pour identifier celle qui est la plus efficace.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Importation du fichier csv dans un DataFrame</span></span>
<span><span class="va">dataMTL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/univariee/DataSR2016.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Noms des variables du DataFrame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "CTNAME"                "PopTotal"              "HabKm2"               
 [4] "PctFRev"               "TxChomage"             "PctImmigrant"         
 [7] "PctImgRecent"          "PctMenage1pers"        "PctFamilleMono"       
[10] "PctLangueMaternelleFR" "PctLangueMaternelleAN" "PctLangueMaternelleAU"</code></pre>
</div>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Transformations</span></span>
<span><span class="va">dataMTL</span><span class="op">$</span><span class="va">HabKm2_log</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">HabKm2</span><span class="op">)</span></span>
<span><span class="va">dataMTL</span><span class="op">$</span><span class="va">HabKm2_sqrt</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">HabKm2</span><span class="op">)</span></span>
<span><span class="va">dataMTL</span><span class="op">$</span><span class="va">HabKm2_inv</span> <span class="op">&lt;-</span>  <span class="fl">1</span><span class="op">/</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">HabKm2</span></span>
<span></span>
<span><span class="co"># Vecteur pour la variable et les trois transformations</span></span>
<span><span class="va">VarsSelect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HabKm2"</span>, <span class="st">"HabKm2_log"</span>, <span class="st">"HabKm2_sqrt"</span>, <span class="st">"HabKm2_inv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Paramètres de forme</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">Skew</span><span class="op">)</span>    <span class="co"># Skewness</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     HabKm2  HabKm2_log HabKm2_sqrt  HabKm2_inv 
  1.9674683  -1.2071326   0.4179037   8.2536901 </code></pre>
</div>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">Kurt</span><span class="op">)</span>    <span class="co"># Kurtosis</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     HabKm2  HabKm2_log HabKm2_sqrt  HabKm2_inv 
 8.54640302  1.55670769  0.04563433 82.85604898 </code></pre>
</div>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># TESTS D'HYPOTHÈSE SUR LA NORMALITÉ</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">[</span><span class="va">VarsSelect</span><span class="op">]</span>, <span class="va">shapiro.test</span><span class="op">)</span> </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          HabKm2                        HabKm2_log                   
statistic 0.8385086                     0.9113234                    
p.value   5.648795e-30                  4.11156e-23                  
method    "Shapiro-Wilk normality test" "Shapiro-Wilk normality test"
data.name "X[[i]]"                      "X[[i]]"                     
          HabKm2_sqrt                   HabKm2_inv                   
statistic 0.9771699                     0.2530266                    
p.value   4.638049e-11                  8.324983e-52                 
method    "Shapiro-Wilk normality test" "Shapiro-Wilk normality test"
data.name "X[[i]]"                      "X[[i]]"                     </code></pre>
</div>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Histogrammes avec courbe normale</span></span>
<span><span class="va">Graph1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dataMTL</span><span class="op">)</span> <span class="op">+</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">HabKm2</span>, y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>,</span>
<span>                 bins <span class="op">=</span> <span class="fl">30</span>, color <span class="op">=</span> <span class="st">"#343a40"</span>, fill <span class="op">=</span> <span class="st">"#a8dadc"</span><span class="op">)</span> <span class="op">+</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Habitants au km"</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>               y <span class="op">=</span> <span class="st">"densité"</span><span class="op">)</span><span class="op">+</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, </span>
<span>                        args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">HabKm2</span><span class="op">)</span>, </span>
<span>                                    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">HabKm2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                        color <span class="op">=</span> <span class="st">"#e63946"</span>, linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Graph2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dataMTL</span><span class="op">)</span> <span class="op">+</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">HabKm2_log</span>, y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>,</span>
<span>                         bins <span class="op">=</span> <span class="fl">30</span>, color <span class="op">=</span> <span class="st">"#343a40"</span>, fill <span class="op">=</span> <span class="st">"#a8dadc"</span><span class="op">)</span> <span class="op">+</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Logarithme d'habitants au km"</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="st">"densité"</span><span class="op">)</span><span class="op">+</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, </span>
<span>                        args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">HabKm2_log</span><span class="op">)</span>, </span>
<span>                                    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">HabKm2_log</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                        color <span class="op">=</span> <span class="st">"#e63946"</span>, linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Graph3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dataMTL</span><span class="op">)</span> <span class="op">+</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">HabKm2_sqrt</span>, y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>,</span>
<span>                         bins <span class="op">=</span> <span class="fl">30</span>, color <span class="op">=</span> <span class="st">"#343a40"</span>, fill <span class="op">=</span> <span class="st">"#a8dadc"</span><span class="op">)</span> <span class="op">+</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Racine carrée d'habitants au km"</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="st">"densité"</span><span class="op">)</span><span class="op">+</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, </span>
<span>                        args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">HabKm2_sqrt</span><span class="op">)</span>, </span>
<span>                                    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">HabKm2_sqrt</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                        color <span class="op">=</span> <span class="st">"#e63946"</span>, linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Graph4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dataMTL</span><span class="op">)</span> <span class="op">+</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">HabKm2_inv</span>, y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>,</span>
<span>                         bins <span class="op">=</span> <span class="fl">30</span>, color <span class="op">=</span> <span class="st">"#343a40"</span>, fill <span class="op">=</span> <span class="st">"#a8dadc"</span><span class="op">)</span> <span class="op">+</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Inverse d'habitants au km"</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="st">"densité"</span><span class="op">)</span><span class="op">+</span></span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, </span>
<span>                        args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">HabKm2_inv</span><span class="op">)</span>, </span>
<span>                                    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">dataMTL</span><span class="op">$</span><span class="va">HabKm2_inv</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                        color <span class="op">=</span> <span class="st">"#e63946"</span>, linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">Graph1</span>, <span class="va">Graph2</span>, <span class="va">Graph3</span>, <span class="va">Graph4</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-GTranf" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-GTranf-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.36: Histogramme des transformations</figcaption></figure>
</div>
</div>
</div>
<p>La variable <em>HabKm2</em> est asymétrique positive et leptokurtique. Les valeurs des statistiques de forme et du test de Shapiro-Wilk ainsi que les histogrammes semblent démontrer que la transformation la plus efficace est la racine carrée. Si la variable originale est asymétrique positive, sa transformation logarithmique est par contre asymétrique négative. Cela démontre que la transformation logarithmique n’est pas toujours la panacée.</p>
</section></section></section><section id="sec-026" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="sec-026">
<span class="header-section-number">2.6</span> Statistiques descriptives sur des variables qualitatives et semi-qualitatives</h2>
<section id="sec-0261" class="level3" data-number="2.6.1"><h3 data-number="2.6.1" class="anchored" data-anchor-id="sec-0261">
<span class="header-section-number">2.6.1</span> Fréquences</h3>
<p>En guise de rappel, les variables nominales, ordinales et semi-quantitatives comprennent plusieurs modalités pour lesquelles plusieurs types de fréquences sont généralement calculées. Pour illustrer le tout, nous avons extrait du recensement de 2016 de Statistique Canada les effectifs des modalités de la variable sur le principal mode de transport utilisé pour les déplacements domicile-travail, et ce, pour la subdivision de recensement (MRC) de l’île de Montréal (<a href="#tbl-Frequences">tableau&nbsp;<span>2.10</span></a>). Les différents types de fréquences sont les suivantes&nbsp;:</p>
<ul>
<li><p>Les fréquences absolues simples (<strong>FAS</strong>) ou fréquences observées représentent le nombre d’observations pour chacune des modalités. Par exemple, sur 857&nbsp;540 personnes réalisant des trajets domicile-travail (ligne totale), seulement 30&nbsp;645 optent pour le vélo, alors que 427&nbsp;530 conduisent un véhicule motorisé (automobile, camion ou fourgonnette) comme principal mode de transport.</p></li>
<li><p>Les fréquences relatives simples (<strong>FRS</strong>) sont les proportions de chaque modalité sur le total (<span class="math inline">\(\mbox{30 645}/\mbox{857 540}=\mbox{0,036}\)</span>); leur somme est égale à 1. Elles peuvent bien entendu être exprimées en pourcentage (<span class="math inline">\(\mbox{30 645}/\mbox{857 540} \times \mbox{100}=\mbox{3,57}\)</span>); leur somme est alors égale à 100&nbsp;%. Par exemple, 3,7&nbsp;% de ces personnes utilisent le vélo comme mode de transport principal.</p></li>
<li><p>Les fréquences absolues cumulées (<strong>FAC</strong>) représentent la fréquence observée (FAS) de la modalité à laquelle sont additionnées celles qui la précèdent. La valeur de la FAC pour la dernière est donc égale au total.</p></li>
<li><p>À partir des fréquences absolues cumulées (FAC), il est alors possible de calculer les fréquences relatives cumulées (<strong>FRC</strong>) en proportion (<span class="math inline">\(\mbox{453 930}/\mbox{857 540} = \mbox{0,529}\)</span>) et en pourcentage (<span class="math inline">\(\mbox{453 930} / \mbox{857 540} \times \mbox{100}= \mbox{52,93}\)</span>). Par exemple, plus de la moitié des personnes utilisent l’automobile comme mode de transport principal (passagère ou conductrice).</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-Frequences" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;2.10: Différents types de fréquences sur une variable qualitative ou semi-qualitative</caption>
<colgroup>
<col style="width: 46%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Mode de transport</th>
<th style="text-align: right;">FAS</th>
<th style="text-align: right;">FRS</th>
<th style="text-align: right;">FRS (%)</th>
<th style="text-align: right;">FAC</th>
<th style="text-align: right;">FRC</th>
<th style="text-align: right;">FRC (%)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Véhicule motorisé (conducteur(trice))</td>
<td style="text-align: right;">427 530</td>
<td style="text-align: right;">0,499</td>
<td style="text-align: right;">49,86</td>
<td style="text-align: right;">427 530</td>
<td style="text-align: right;">0,499</td>
<td style="text-align: right;">49,86</td>
</tr>
<tr class="even">
<td style="text-align: left;">Véhicule motorisé (passager(ère))</td>
<td style="text-align: right;">26 400</td>
<td style="text-align: right;">0,031</td>
<td style="text-align: right;">3,08</td>
<td style="text-align: right;">453 930</td>
<td style="text-align: right;">0,529</td>
<td style="text-align: right;">52,93</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Transport en commun</td>
<td style="text-align: right;">295 860</td>
<td style="text-align: right;">0,345</td>
<td style="text-align: right;">34,50</td>
<td style="text-align: right;">749 790</td>
<td style="text-align: right;">0,874</td>
<td style="text-align: right;">87,43</td>
</tr>
<tr class="even">
<td style="text-align: left;">À pied</td>
<td style="text-align: right;">69 410</td>
<td style="text-align: right;">0,081</td>
<td style="text-align: right;">8,09</td>
<td style="text-align: right;">819 200</td>
<td style="text-align: right;">0,955</td>
<td style="text-align: right;">95,53</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bicyclette</td>
<td style="text-align: right;">30 645</td>
<td style="text-align: right;">0,036</td>
<td style="text-align: right;">3,57</td>
<td style="text-align: right;">849 845</td>
<td style="text-align: right;">0,991</td>
<td style="text-align: right;">99,10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Autre moyen</td>
<td style="text-align: right;">7 695</td>
<td style="text-align: right;">0,009</td>
<td style="text-align: right;">0,90</td>
<td style="text-align: right;">857 540</td>
<td style="text-align: right;">1,000</td>
<td style="text-align: right;">100,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">857 540</td>
<td style="text-align: right;">1,000</td>
<td style="text-align: right;">100,00</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Les fréquences cumulées&nbsp;: peu pertinentes pour les variables nominales</strong></p>
</div>
<div class="bloc_attention-body">
<p>Le calcul et l’analyse des fréquences cumulées (absolues et relatives) sont très souvent inutiles pour les variables nominales.</p>
<p>Par exemple, au <a href="#tbl-Frequences">tableau&nbsp;<span>2.10</span></a>, la fréquence cumulée relative (en %) est de 87,43&nbsp;% pour la troisième ligne. Cela signifie que 87,43&nbsp;% des navetteur(ve)s se déplacent en véhicule motorisé (personne conductrice ou passagère) ou en transport en commun. Par contre, si la troisième modalité avait été <em>à pied</em>, le pourcentage aurait été de 61,02 (<span class="math inline">\(\mbox{52,93}+\mbox{8,09}\)</span>). Si vous souhaitez calculer les fréquences cumulées sur une variable nominale, assurez-vous que l’ordre des modalités vous convient et de le modifier au besoin. Sinon, abstenez-vous de les calculer!</p>
<p><strong>Les fréquences cumulées&nbsp;: très utiles pour l’analyse des variables ordinales ou semi-quantitatives</strong></p>
<p>Pour des modalités hiérarchisées (variable ordinale ou semi-quantitative), l’analyse des fréquences cumulées (absolues et relatives) est par contre très intéressante. Par exemple, au <a href="#tbl-Frequences2">tableau&nbsp;<span>2.11</span></a>, elle permet de constater rapidement que sur l’île de Montréal, plus du quart de la population à moins de 25&nbsp;ans (27,91&nbsp;%) et 83,33&nbsp;%, moins de 65&nbsp;ans.</p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-Frequences2" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;2.11: Différents types de fréquences sur une variable semi-qualitative</caption>
<thead><tr class="header">
<th style="text-align: left;">Groupes d’âge</th>
<th style="text-align: right;">FAS</th>
<th style="text-align: right;">FRS</th>
<th style="text-align: right;">FRS (%)</th>
<th style="text-align: right;">FAC</th>
<th style="text-align: right;">FRC</th>
<th style="text-align: right;">FRC (%)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0 à 14 ans</td>
<td style="text-align: right;">304 470</td>
<td style="text-align: right;">0,157</td>
<td style="text-align: right;">15,68</td>
<td style="text-align: right;">304 470</td>
<td style="text-align: right;">0,157</td>
<td style="text-align: right;">15,68</td>
</tr>
<tr class="even">
<td style="text-align: left;">15 à 24 ans</td>
<td style="text-align: right;">237 555</td>
<td style="text-align: right;">0,122</td>
<td style="text-align: right;">12,23</td>
<td style="text-align: right;">542 025</td>
<td style="text-align: right;">0,279</td>
<td style="text-align: right;">27,91</td>
</tr>
<tr class="odd">
<td style="text-align: left;">25 à 44 ans</td>
<td style="text-align: right;">582 150</td>
<td style="text-align: right;">0,300</td>
<td style="text-align: right;">29,98</td>
<td style="text-align: right;">1 124 175</td>
<td style="text-align: right;">0,579</td>
<td style="text-align: right;">57,89</td>
</tr>
<tr class="even">
<td style="text-align: left;">45 à 64 ans</td>
<td style="text-align: right;">494 205</td>
<td style="text-align: right;">0,254</td>
<td style="text-align: right;">25,45</td>
<td style="text-align: right;">1 618 380</td>
<td style="text-align: right;">0,833</td>
<td style="text-align: right;">83,33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">65 à 84 ans</td>
<td style="text-align: right;">271 560</td>
<td style="text-align: right;">0,140</td>
<td style="text-align: right;">13,98</td>
<td style="text-align: right;">1 889 940</td>
<td style="text-align: right;">0,973</td>
<td style="text-align: right;">97,32</td>
</tr>
<tr class="even">
<td style="text-align: left;">85 ans et plus</td>
<td style="text-align: right;">52 100</td>
<td style="text-align: right;">0,027</td>
<td style="text-align: right;">2,68</td>
<td style="text-align: right;">1 942 040</td>
<td style="text-align: right;">1,000</td>
<td style="text-align: right;">100,00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">1 942 040</td>
<td style="text-align: right;">1,000</td>
<td style="text-align: right;">100,00</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Différents graphiques peuvent être construits pour illustrer la répartition des observations&nbsp;: les graphiques en barres (verticales et horizontales) avec les fréquences absolues et les diagrammes circulaires ou en anneau pour les fréquences relatives (<a href="#fig-GraphiquesFreq1">figure&nbsp;<span>2.37</span></a>). Ces graphiques seront présentés plus en détail dans le chapitre suivant.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-GraphiquesFreq1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-univarie_files/figure-html/fig-GraphiquesFreq1-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.37: Différents graphiques pour représenter les fréquences absolues et relatives</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-0262" class="level3" data-number="2.6.2"><h3 data-number="2.6.2" class="anchored" data-anchor-id="sec-0262">
<span class="header-section-number">2.6.2</span> Mise en œuvre dans R</h3>
<p>La syntaxe ci-dessous permet de calculer les différentes fréquences présentées au <a href="#tbl-Frequences2">tableau&nbsp;<span>2.11</span></a>. Notez que pour les fréquences cumulées, nous utilisons la fonction <code>cumsum</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Vecteur pour les noms des modalités</span></span>
<span><span class="va">Modalite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0 à 14 ans"</span>,</span>
<span>             <span class="st">"15 à 24 ans"</span>,</span>
<span>             <span class="st">"25 à 44 ans"</span>,</span>
<span>             <span class="st">"45 à 64 ans"</span>,</span>
<span>             <span class="st">"65 à 84 ans"</span>,</span>
<span>             <span class="st">"85 ans et plus"</span><span class="op">)</span></span>
<span><span class="co"># Vecteur pour les fréquences absolues simples (FAS)</span></span>
<span><span class="va">Navetteurs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">304470</span>,<span class="fl">237555</span>,<span class="fl">582150</span>,<span class="fl">494205</span>,<span class="fl">271560</span>,<span class="fl">52100</span><span class="op">)</span></span>
<span><span class="co"># Somme des FAS</span></span>
<span><span class="va">sumFAS</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Navetteurs</span><span class="op">)</span></span>
<span><span class="co"># Construction du DataFrame avec les deux vecteurs</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  GroupeAge <span class="op">=</span> <span class="va">Modalite</span>, </span>
<span>  FAS <span class="op">=</span> <span class="va">Navetteurs</span>,</span>
<span>  FRS <span class="op">=</span> <span class="va">Navetteurs</span> <span class="op">/</span> <span class="va">sumFAS</span>, </span>
<span>  FRSpct <span class="op">=</span> <span class="va">Navetteurs</span> <span class="op">/</span> <span class="va">sumFAS</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>  FAC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">Navetteurs</span><span class="op">)</span>,</span>
<span>  FRC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">Navetteurs</span><span class="op">)</span> <span class="op">/</span> <span class="va">sumFAS</span>,</span>
<span>  FRCpct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">Navetteurs</span><span class="op">)</span> <span class="op">/</span> <span class="va">sumFAS</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">df</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       GroupeAge    FAS        FRS    FRSpct     FAC       FRC    FRCpct
1     0 à 14 ans 304470 0.15677844 15.677844  304470 0.1567784  15.67784
2    15 à 24 ans 237555 0.12232240 12.232240  542025 0.2791008  27.91008
3    25 à 44 ans 582150 0.29976211 29.976211 1124175 0.5788629  57.88629
4    45 à 64 ans 494205 0.25447725 25.447725 1618380 0.8333402  83.33402
5    65 à 84 ans 271560 0.13983234 13.983234 1889940 0.9731725  97.31725
6 85 ans et plus  52100 0.02682746  2.682746 1942040 1.0000000 100.00000</code></pre>
</div>
</div>
</section></section><section id="sec-027" class="level2" data-number="2.7"><h2 data-number="2.7" class="anchored" data-anchor-id="sec-027">
<span class="header-section-number">2.7</span> Statistiques descriptives pondérées&nbsp;: pour aller plus loin</h2>
<p>Dans la <a href="#sec-025">section&nbsp;<span>2.5</span></a>, les différentes statistiques descriptives sur des variables quantitatives – paramètres de tendance centrale, de position, de dispersion et de forme – ont été largement abordées. Il est possible de calculer ces différentes statistiques en tenant compte d’une pondération. La statistique descriptive pondérée la plus connue est certainement la moyenne arithmétique pondérée. Son calcul est très simple. Pour chaque observation, deux valeurs sont disponibles&nbsp;:</p>
<ul>
<li>
<span class="math inline">\(x_i\)</span>, soit la valeur de la variable <span class="math inline">\(X\)</span> pour l’observation <span class="math inline">\(i\)</span>
</li>
<li>
<span class="math inline">\(w_i\)</span>, soit la valeur de la pondération pour <span class="math inline">\(i\)</span>.</li>
</ul>
<p>Prenez soin de comparer les deux équations ci-dessous (à gauche, la moyenne arithmétique; à droite, la moyenne arithmétique pondérée). Vous constaterez rapidement qu’il suffit de multiplier chaque observation par sa pondération (numérateur) et de diviser ce produit par la somme des pondérations (dénominateur; et non par <span class="math inline">\(n\)</span>, soit le nombre d’observations comme pour la moyenne arithmétique non pondérée).</p>
<p><span id="eq-moypond"><span class="math display">\[  
\bar{x}=\frac{\sum_{i=1}^n x_i}{n} \text { versus } \bar{m}=\frac{\sum_{i=1}^n  w_ix_i}{\sum_{i=1}^nw_i}
\tag{2.31}\]</span></span></p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-MoyPondCalcul" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;2.12: Calcul de la moyenne pondérée</caption>
<thead><tr class="header">
<th style="text-align: left;">Observation</th>
<th style="text-align: right;"><span class="math inline">\(x_i\)</span></th>
<th style="text-align: right;"><span class="math inline">\(w_i\)</span></th>
<th style="text-align: right;"><span class="math inline">\(x_i \times w_i\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">4 000</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">225</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">18 000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">275</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">13 750</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">300</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">60 000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Somme</td>
<td style="text-align: right;">1 000</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">95 750</td>
</tr>
<tr class="even">
<td style="text-align: left;">Moyenne</td>
<td style="text-align: right;">250</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Moyenne pondérée</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">274</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="bloc_notes">
<div class="bloc_notes-header">
<div class="bloc_notes-icon">

</div>
<p><strong>Calcul d’autres statistiques descriptives pondérées</strong></p>
</div>
<div class="bloc_notes-body">
<p>Nous ne reportons pas ici les formules des versions pondérées de toutes les statistiques descriptives. Retenez toutefois le principe suivant permettant de les calculer à partir de l’exemple du <a href="#tbl-MoyPondCalcul">tableau&nbsp;<span>2.12</span></a>. Pour la variable <em>X</em>, dupliquons respectivement 20, 80, 50, 200 fois les observations 1 à 4. Si nous calculons la moyenne arithmétique sur ces valeurs dupliquées, alors cette valeur est identique à celle de la moyenne arithmétique pondérée. Le même principe reposant sur la duplication des valeurs s’applique à l’ensemble des statistiques descriptives.</p>
</div>
</div>
<p>Dans un article récent, Alvarenga et al. <span class="citation" data-cites="de2018accessibilite">(<a href="references.html#ref-de2018accessibilite" role="doc-biblioref">2018</a>)</span> évaluent l’accessibilité aux aires de jeux dans les parcs de la Communauté métropolitaine de Montréal (CMM). Pour les 881 secteurs de recensement de la CMM, ils ont calculé la distance à pied à l’aire de jeux la plus proche à travers le réseau de rues. Ce résultat, cartographié à la <a href="#fig-ParcCMM">figure&nbsp;<span>2.38</span></a>), permet d’avancer le constat suivant&nbsp;: «&nbsp;la quasi-totalité des secteurs de recensement de l’agglomération de Montréal présente des distances de l’aire de jeux la plus proche inférieures à 500 m, alors que les secteurs situés à plus d’un kilomètre d’une aire de jeux sont très majoritairement localisés dans les couronnes nord et sud de la CMM&nbsp;» <span class="citation" data-cites="de2018accessibilite">(<a href="references.html#ref-de2018accessibilite" role="doc-biblioref">De Alvarenga, Apparicio et Séguin 2018, 238</a>)</span>.</p>
<p>Pour chaque secteur de recensement, Alvarenga et al. <span class="citation" data-cites="de2018accessibilite">(<a href="references.html#ref-de2018accessibilite" role="doc-biblioref">2018</a>)</span> disposent des données suivantes&nbsp;:</p>
<ul>
<li>
<span class="math inline">\(x_i\)</span>, soit la distance à l’aire de jeux la plus proche pour le secteur de recensement <em>i</em>;</li>
<li>
<span class="math inline">\(w_i\)</span>, la pondération, soit le nombre d’enfants de moins de dix ans.</li>
</ul>
<p>Il est alors possible de calculer les statistiques descriptives de la proximité à l’aire de jeux la plus proche en tenant compte du nombre d’enfants résidant dans chaque secteur de recensement (<a href="#tbl-MoyPondParc">tableau&nbsp;<span>2.13</span></a>). Cet exercice permet de conclure que&nbsp;: «&nbsp;[…] globalement, les enfants ont une bonne accessibilité aux aires de jeux sur le territoire de la CMM. […] Les enfants sont en moyenne à un peu plus de 500 m de l’aire de jeux la plus proche (moyenne&nbsp;=&nbsp;559; médiane&nbsp;=&nbsp;512). Toutefois, les valeurs percentiles extrêmes signalent que respectivement 10&nbsp;% et 5&nbsp;% des enfants résident à près de 800&nbsp;m et à plus de 1000&nbsp;m de l’aire de jeux la plus proche&nbsp;» <span class="citation" data-cites="de2018accessibilite">(<a href="references.html#ref-de2018accessibilite" role="doc-biblioref">2018, 236</a>)</span>.</p>
<div id="fig-ParcCMM" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap02/BivarieeFigureParc.jpg" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2.38: Accessibilité aux aires de jeux par secteur de recensement, Communauté métropolitaine de Montréal, 2016</figcaption></figure>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-MoyPondParc" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;2.13: Statistiques de l’aire de jeux la plus proche, par secteur de recensement, pondérées par la population de moins de 10 ans</caption>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">N</th>
<th style="text-align: center;">Moyenne</th>
<th style="text-align: center;">P5</th>
<th style="text-align: center;">P10</th>
<th style="text-align: center;">Q1</th>
<th style="text-align: center;">Médiane</th>
<th style="text-align: center;">Q3</th>
<th style="text-align: center;">P90</th>
<th style="text-align: center;">P95</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">Parc</td>
<td style="text-align: center;">881</td>
<td style="text-align: center;">559</td>
<td style="text-align: center;">282</td>
<td style="text-align: center;">327</td>
<td style="text-align: center;">408</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">640</td>
<td style="text-align: center;">799</td>
<td style="text-align: center;">1 006</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<p>De nombreux <em>packages</em> sont disponibles pour calculer des statistiques pondérées, dont notamment <code>Weighted.Desc.Stat</code> et <code>Hmisc</code> utilisés dans la syntaxe ci-dessous.</p>
<div class="cell">
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/foreign/">foreign</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/">Hmisc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">Weighted.Desc.Stat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.dbf.html">read.dbf</a></span><span class="op">(</span><span class="st">"data/bivariee/SR_AireJeux_PopMoins10.dbf"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    SRNOM PopMoins10 AireJeux
1 0659.06        380 600.1921
2 0410.02        390 324.4396
3 0863.01        325 524.3323
4 0734.05        875 574.6682
5 0073.00        100 352.9505</code></pre>
</div>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># xi (variable) et wi (pondération)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">AireJeux</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">PopMoins10</span></span>
<span></span>
<span><span class="co"># Calcul des paramètres de position</span></span>
<span><span class="co"># Moyenne</span></span>
<span><span class="fu">Hmisc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/wtd.stats.html">wtd.mean</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 559.8026</code></pre>
</div>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">Weighted.Desc.Stat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Weighted.Desc.Stat/man/w.mean.html">w.mean</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 559.8026</code></pre>
</div>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Quartiles et percentile</span></span>
<span><span class="fu">Hmisc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/wtd.stats.html">wtd.quantile</a></span><span class="op">(</span><span class="va">x</span>, weights<span class="op">=</span><span class="va">w</span>, probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.05</span>, <span class="fl">.10</span>, <span class="fl">.25</span>, <span class="fl">.50</span>, <span class="fl">.75</span>, <span class="fl">.90</span>, <span class="fl">.95</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       5%       10%       25%       50%       75%       90%       95% 
 281.3623  327.3056  406.0759  511.5880  639.4813  798.6559 1011.5493 </code></pre>
</div>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Paramètres de dispersion avec le package Weighted.Desc.Stat</span></span>
<span><span class="co"># Variance, écart-type et coefficient de variation</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Weighted.Desc.Stat/man/w.var.html">w.var</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 82818.18</code></pre>
</div>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Weighted.Desc.Stat/man/w.sd.html">w.sd</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 287.7815</code></pre>
</div>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Weighted.Desc.Stat/man/w.cv.html">w.cv</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5140767</code></pre>
</div>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Paramètres de forme avec le package Weighted.Desc.Stat</span></span>
<span><span class="co"># Skewness et kurtosis </span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Weighted.Desc.Stat/man/w.skewness.html">w.skewness</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.735351</code></pre>
</div>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Weighted.Desc.Stat/man/w.kurtosis.html">w.kurtosis</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 41.17146</code></pre>
</div>
</div>
</section><section id="sec-028" class="level2" data-number="2.8"><h2 data-number="2.8" class="anchored" data-anchor-id="sec-028">
<span class="header-section-number">2.8</span> Quiz de révision du chapitre</h2>
<div id="Chapitre2_univariees" class="card">
<link type="text/javascript" src="libs/quizlib.1.0.1.min.js">
<script>var Quiz=function(a,b){this.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),this.unansweredQuestionText="Question sans réponse !",this.container=document.getElementById(a),this.questions=[],this.result=new QuizResult,this.answers=b;for(var c=0;c<this.container.children.length;c++)this.container.children[c].classList.contains(Quiz.Classes.QUESTION)&&this.questions.push(this.container.children[c]);if(this.answers.length!=this.questions.length)throw new Error("Number of answers does not match number of questions!")};Quiz.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),Quiz.prototype.checkAnswers=function(a){void 0===a&&(a=!0);for(var b=[],c=[],d=0;d<this.questions.length;d++){var e=this.questions[d],f=this.answers[d],g=[];this.clearHighlights(e);for(var h,i=e.getElementsByClassName(Quiz.Classes.QUESTION_ANSWERS)[0].getElementsByTagName("input"),j=0;j<i.length;j++)h=i[j],"checkbox"===h.type||"radio"===h.type?h.checked&&g.push(h.value):""!==h.value&&g.push(h.value);1!=g.length||Array.isArray(f)?0===g.length&&b.push(e):g=g[0],c.push(Utils.compare(g,f))}if(0===b.length||!a)return this.result.setResults(c),!0;for(d=0;d<b.length;d++){var k=document.createElement("span");k.appendChild(document.createTextNode(this.unansweredQuestionText)),k.className=Quiz.Classes.QUESTION_WARNING,b[d].getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].appendChild(k)}return!1},Quiz.prototype.clearHighlights=function(a){for(var b=a.getElementsByClassName(Quiz.Classes.QUESTION_WARNING);b.length>0;)b[0].parentNode.removeChild(b[0]);var c,d=[a.getElementsByClassName(Quiz.Classes.CORRECT),a.getElementsByClassName(this.Classes.INCORRECT)];for(i=0;i<d.length;i++)for(;d[i].length>0;)c=d[i][0],c.classList.remove(Quiz.Classes.CORRECT),c.classList.remove(Quiz.Classes.INCORRECT);for(var e=a.getElementsByClassName(Quiz.Classes.TEMP);e.length>0;)e[0].parentNode.removeChild(e[0])},Quiz.prototype.highlightResults=function(a){for(var b,c=0;c<this.questions.length;c++)b=this.questions[c],b.getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].classList.add(this.result.results[c]?Quiz.Classes.CORRECT:Quiz.Classes.INCORRECT),void 0!==a&&a(this,b,c,this.result.results[c])};var QuizResult=function(){this.results=[],this.totalQuestions=0,this.score=0,this.scorePercent=0,this.scorePercentFormatted=0};QuizResult.prototype.setResults=function(a){this.results=a,this.totalQuestions=this.results.length,this.score=0;for(var b=0;b<this.results.length;b++)this.results[b]&&this.score++;this.scorePercent=this.score/this.totalQuestions,this.scorePercentFormatted=Math.floor(100*this.scorePercent)};var Utils=function(){};Utils.compare=function(a,b){if(a.length!=b.length)return!1;if(Array.isArray(a)&&Array.isArray(b)){for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b};

function showResults(quiz) {
    // Check answers and continue if all questions have been answered
    if (quiz.checkAnswers()) {
        var quizScorePercent = quiz.result.scorePercentFormatted; // The unformatted percentage is a decimal in range 0 - 1
        var quizResultElement = document.getElementById('quiz-result');
        quizResultElement.style.display = 'block';
        document.getElementById('quiz-percent').innerHTML = quizScorePercent.toString();

        // Change background colour of results div according to score percent
        if (quizScorePercent > 75) quizResultElement.style.backgroundColor = '#4caf50';
        else if (quizScorePercent > 50) quizResultElement.style.backgroundColor = '#ffc107';
        else if (quizScorePercent > 25) quizResultElement.style.backgroundColor = '#ff9800';
        else if (quizScorePercent > 0) quizResultElement.style.backgroundColor = '#f44336';

        // Highlight questions according to whether they were correctly answered. The callback allows us to highlight/show the correct answer
        quiz.highlightResults(handleAnswers);
    }
}

/** Callback for Quiz.highlightResults. Highlights the correct answers of incorrectly answered questions
 * Parameters are: the quiz object, the question element, question number, correctly answered flag
 */
function handleAnswers(quiz, question, no, correct) {
    if (!correct) {
        var answers = question.getElementsByTagName('input');
        for (var i = 0; i < answers.length; i++) {
            if (answers[i].type === 'checkbox' || answers[i].type === 'radio'){
                // If the current input element is part of the correct answer, highlight it
                if (quiz.answers[no].indexOf(answers[i].value) > -1) {
                    answers[i].parentNode.classList.add(Quiz.Classes.CORRECT);
                }
            } else {
                // If the input is anything other than a checkbox or radio button, show the correct answer next to the element
                var correctAnswer = document.createElement('span');
                correctAnswer.classList.add(Quiz.Classes.CORRECT);
                correctAnswer.classList.add(Quiz.Classes.TEMP); // quiz.checkAnswers will automatically remove elements with the temp class
                correctAnswer.innerHTML = quiz.answers[no];
                correctAnswer.style.marginLeft = '10px';
                answers[i].parentNode.insertBefore(correctAnswer, answers[i].nextSibling);
            }
        }
    }
}

  var quizz_Chapitre2_univariees;
  window.onload = function() {
    quizz_Chapitre2_univariees = new Quiz('Chapitre2_univariees', ['4','1','1','2','1',['1', '2', '5'],['1', '2', '4'],['1', '2', '3', '4'],['1', '2', '3'],'1']);
  };</script><link rel="stylesheet" type="text/css" src="css/quizlib.min.css">
<div class="card quizlib-question">
<div class="quizlib-question-title">
Le mode de transport (auto, vélo, marche, transport en commun) est :
</div>
<div>
Relisez au besoin la <a href="#sec-0212">section&nbsp;<span>2.1.2</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>une variable ordinale</label>
</td>
<td>
<input type="radio" name="q1" value="1">
</td>
</tr>
<tr>
<td>
<label>une variable continue</label>
</td>
<td>
<input type="radio" name="q1" value="2">
</td>
</tr>
<tr>
<td>
<label>une variable discrète</label>
</td>
<td>
<input type="radio" name="q1" value="3">
</td>
</tr>
<tr>
<td>
<label>une variable nominale</label>
</td>
<td>
<input type="radio" name="q1" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Laquelle de ces deux options est la bonne?
</div>
<div>
Relisez au besoin le début de la <a href="01-priseenmainR.html#sec-012">section&nbsp;<span>1.2</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Variables qualitatives (nominales ou ordinales); variables quantitatives (continues et discrètes)</label>
</td>
<td>
<input type="radio" name="q2" value="1">
</td>
</tr>
<tr>
<td>
<label>Variables qualitatives (nominales ou discrètes); variables quantitatives (ordinales et discrètes)</label>
</td>
<td>
<input type="radio" name="q2" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Des données collectées sur le terrain avec un GPS sont des données primaires spatiales.
</div>
<div>
Relisez au besoin la <a href="#sec-022">section&nbsp;<span>2.2</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Vrai</label>
</td>
<td>
<input type="radio" name="q3" value="1">
</td>
</tr>
<tr>
<td>
<label>Faux</label>
</td>
<td>
<input type="radio" name="q3" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
L’erreur écologique consiste à :
</div>
<div>
Relisez au besoin la <a href="#sec-0224">section&nbsp;<span>2.2.4</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>attribuer des résultats à partir de données individuelles à des territoires</label>
</td>
<td>
<input type="radio" name="q4" value="1">
</td>
</tr>
<tr>
<td>
<label>attribuer des constats obtenus à partir de données agrégées pour un territoire aux individus</label>
</td>
<td>
<input type="radio" name="q4" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Laquelle de ces deux options est la bonne?
</div>
<div>
Relisez au besoin la <a href="#sec-024">section&nbsp;<span>2.4</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Fonctions de masse pour les distributions discrètes, fonctions de densité pour les distributions continues</label>
</td>
<td>
<input type="radio" name="q5" value="1">
</td>
</tr>
<tr>
<td>
<label>Fonctions de masse pour les distributions continues, fonctions de densité pour les distributions discrètes</label>
</td>
<td>
<input type="radio" name="q5" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quels sont les trois paramètres de tendance centrale?
</div>
<div>
Relisez au besoin la <a href="#sec-0251">section&nbsp;<span>2.5.1</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Moyenne</label>
</td>
<td>
<input type="checkbox" name="q6" value="1">
</td>
</tr>
<tr>
<td>
<label>Médiane</label>
</td>
<td>
<input type="checkbox" name="q6" value="2">
</td>
</tr>
<tr>
<td>
<label>Variance</label>
</td>
<td>
<input type="checkbox" name="q6" value="3">
</td>
</tr>
<tr>
<td>
<label>Intervalle interquartile</label>
</td>
<td>
<input type="checkbox" name="q6" value="4">
</td>
</tr>
<tr>
<td>
<label>Mode</label>
</td>
<td>
<input type="checkbox" name="q6" value="5">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quels sont les paramètres de position?
</div>
<div>
Relisez au besoin la <a href="#sec-0252">section&nbsp;<span>2.5.2</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Quartiles</label>
</td>
<td>
<input type="checkbox" name="q7" value="1">
</td>
</tr>
<tr>
<td>
<label>Déciles</label>
</td>
<td>
<input type="checkbox" name="q7" value="2">
</td>
</tr>
<tr>
<td>
<label>Variance</label>
</td>
<td>
<input type="checkbox" name="q7" value="3">
</td>
</tr>
<tr>
<td>
<label>Centiles</label>
</td>
<td>
<input type="checkbox" name="q7" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quels sont les paramètres de dispersion?
</div>
<div>
Relisez au besoin la <a href="#sec-0253">section&nbsp;<span>2.5.3</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Étendue</label>
</td>
<td>
<input type="checkbox" name="q8" value="1">
</td>
</tr>
<tr>
<td>
<label>Intervalle interquartile</label>
</td>
<td>
<input type="checkbox" name="q8" value="2">
</td>
</tr>
<tr>
<td>
<label>Variance</label>
</td>
<td>
<input type="checkbox" name="q8" value="3">
</td>
</tr>
<tr>
<td>
<label>Écart-type</label>
</td>
<td>
<input type="checkbox" name="q8" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Comment vérifie-t-on qu’une variable est normalement distribuée?
</div>
<div>
Relisez au besoin la <a href="#sec-0254">section&nbsp;<span>2.5.4</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Coefficients d’asymétrie et d’aplatissement (skewness et kurtosis)</label>
</td>
<td>
<input type="checkbox" name="q9" value="1">
</td>
</tr>
<tr>
<td>
<label>Graphiques : histogramme avec courbe normale et diagramme quantile-quantile</label>
</td>
<td>
<input type="checkbox" name="q9" value="2">
</td>
</tr>
<tr>
<td>
<label>Tests de normalité (comme celui de Shapiro-Wilk)</label>
</td>
<td>
<input type="checkbox" name="q9" value="3">
</td>
</tr>
<tr>
<td>
<label>Examen des valeurs minimale et maximale</label>
</td>
<td>
<input type="checkbox" name="q9" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Le centrage et la réduction d’une variable consistent à :
</div>
<div>
Relisez au besoin la <a href="#sec-02552">section&nbsp;<span>2.5.5.2</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>soustraire à chaque valeur sa moyenne (soit un centrage), puis à la diviser par son écart-type.</label>
</td>
<td>
<input type="radio" name="q10" value="1">
</td>
</tr>
<tr>
<td>
<label>simplement à trier une variable en ordre croissant, puis à affecter le rang de chaque observation de 1 à n</label>
</td>
<td>
<input type="radio" name="q10" value="2">
</td>
</tr>
<tr>
<td>
<label>soustraite à chaque observation la valeur minimale et à diviser le tout par l’étendue.</label>
</td>
<td>
<input type="radio" name="q10" value="3">
</td>
</tr>
</tbody></table>
</div>
</div>
<button type="button" onclick="showResults(quizz_Chapitre2_univariees);" id="buttonID">
Vérifier votre résultat
</button>
<div id="quiz-result" class="card">
<p><span id="quiz-percent"></span></p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-2020_1" class="csl-entry" role="listitem">
Apparicio, Philippe et Jérémy Gelb. 2020. <span>«&nbsp;Cyclists′ exposure to road traffic noise: A comparison of three North American and European cities.&nbsp;»</span> <em>Acoustics</em> 2 (1): 73‑86. <a href="https://doi.org/10.3390/acoustics2010006">https://doi.org/10.3390/acoustics2010006</a>.
</div>
<div id="ref-audrin2021localisation" class="csl-entry" role="listitem">
Audrin, Thomas, Philippe Apparicio et Anne-Marie Séguin. 2021. <span>«&nbsp;La localisation des <span>é</span>coles primaires et le bruit a<span>é</span>rien dans la r<span>é</span>gion m<span>é</span>tropolitaine de Toronto: un diagnostic d’<span>é</span>quit<span>é</span> environnementale et une analyse des impacts sur la r<span>é</span>ussite scolaire.&nbsp;»</span> <em>Canadian Journal of Regional Science/Revue canadienne des sciences r<span>é</span>gionales</em> 44 (1): 22‑34. <a href="https://idjs.ca/images/rcsr/archives/V44N1_5-AUDRIN-APPARICIO-SEGUIN.pdf">https://idjs.ca/images/rcsr/archives/V44N1_5-AUDRIN-APPARICIO-SEGUIN.pdf</a>.
</div>
<div id="ref-de2018accessibilite" class="csl-entry" role="listitem">
De Alvarenga, Bernardo, Philippe Apparicio et Anne-Marie Séguin. 2018. <span>«&nbsp;L’accessibilit<span>é</span> aux aires de jeux dans les parcs de la Communaut<span>é</span> m<span>é</span>tropolitaine de Montr<span>é</span>al.&nbsp;»</span> <em>Cahiers de g<span>é</span>ographie du Qu<span>é</span>bec</em> 62 (176): 229‑246. <a href="https://doi.org/10.7202/1063104ar">https://doi.org/10.7202/1063104ar</a>.
</div>
<div id="ref-field2012discovering" class="csl-entry" role="listitem">
Field, Andy P, Jeremy Miles et Zoë Field. 2012. <span>«&nbsp;Discovering statistics using R.&nbsp;»</span> Thousand Oaks.
</div>
<div id="ref-gilles1994elements" class="csl-entry" role="listitem">
Gilles, Alain et Pierre Maranda. 1994. <em><span>É</span>l<span>é</span>ments de m<span>é</span>thodologie et d’analyse statistique pour les sciences sociales</em>. McGraw-Hill.
</div>
<div id="ref-joanes1998comparing" class="csl-entry" role="listitem">
Joanes, DN et CA Gill. 1998. <span>«&nbsp;Comparing measures of sample skewness and kurtosis.&nbsp;»</span> <em>Journal of the Royal Statistical Society: Series D (The Statistician)</em> 47 (1): 183‑189. <a href="https://www.jstor.org/stable/2988433">https://www.jstor.org/stable/2988433</a>.
</div>
<div id="ref-lebart1995statistique" class="csl-entry" role="listitem">
Lebart, Ludovic, Alain Morineau et Marie Piron. 1995. <em>Statistique exploratoire multidimensionnelle</em>. Dunod.
</div>
<div id="ref-pumain1994" class="csl-entry" role="listitem">
Pumain, Denise et Michèle Béguin. 1994. <em>La représentation des données géographiques: statistique et cartographie</em>. Armand Colin.
</div>
<div id="ref-razali2011power" class="csl-entry" role="listitem">
Razali, Nornadiah Mohd et Yap Bee Wah. 2011. <span>«&nbsp;Power comparisons of Shapiro-Wilk, Kolmogorov-Smirnov, Lilliefors and Anderson-Darling tests.&nbsp;»</span> <em>Journal of statistical modeling and analytics</em> 2 (1): 21‑33.
</div>
<div id="ref-William_pareto_ville" class="csl-entry" role="listitem">
Reed, William J. 2002. <span>«&nbsp;On the rank-Size distribution for human settlements.&nbsp;»</span> <em>Journal of Regional Science</em> 42 (1): 1‑17. <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/1467-9787.00247">https://onlinelibrary.wiley.com/doi/abs/10.1111/1467-9787.00247</a>.
</div>
<div id="ref-William_pareto" class="csl-entry" role="listitem">
Reed, William J. et Murray Jorgensen. 2004. <span>«&nbsp;The souble Pareto-Lognormal sistribution: A new parametric model for size distributions.&nbsp;»</span> <em>Communications in Statistics - Theory and Methods</em> 33 (8). Taylor &amp; Francis: 1733‑1753. <a href="https://doi.org/10.1081/STA-120037438">https://doi.org/10.1081/STA-120037438</a>.
</div>
<div id="ref-SeanOwendist" class="csl-entry" role="listitem">
Sean, Owen. 2018. <span>«&nbsp;Common probability distributions.&nbsp;»</span> <a href="https://medium.com/@srowen/common-probability-distributions-347e6b945ce4">https://medium.com/@srowen/common-probability-distributions-347e6b945ce4</a>.
</div>
<div id="ref-Sobol1993" class="csl-entry" role="listitem">
Sobol, IM. 1993. <span>«&nbsp;Sensitivity estimates for nonlinear mathematical models.&nbsp;»</span> <em>Mathematics and Computers in Simulation</em> 1 (4): 407‑414.
</div>
<div id="ref-tabachnick2007" class="csl-entry" role="listitem">
Tabachnick, Barbara G, Linda S Fidell et Jodie B Ullman. 2007. <em>Using multivariate statistics</em>. Pearson.
</div>
<div id="ref-yap2011comparisons" class="csl-entry" role="listitem">
Yap, Bee Wah et Chiaw Hock Sim. 2011. <span>«&nbsp;Comparisons of various types of normality tests.&nbsp;»</span> <em>Journal of Statistical Computation and Simulation</em> 81 (12): 2141‑2155. <a href="https://doi.org/10.1080/00949655.2010.520163">https://doi.org/10.1080/00949655.2010.520163</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./01-priseenmainR.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prise en main de R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-magiedesgraphiques.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Magie des graphiques</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Méthodes quantitatives en sciences sociales : un grand bol d’R.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Ce livre a été réalisé avec <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>