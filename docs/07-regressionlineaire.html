<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Méthodes quantitatives en sciences sociales : un grand bol d’R - 7&nbsp; Régression linéaire multiple</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08-GLM.html" rel="next">
<link href="./06-bivarieeQualiQuanti.html" rel="prev">
<link href="./images/introduction/Couverture.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="css/quizlib.min.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-regressionlineaire.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Régression linéaire multiple</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Recherche" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/SerieBoldR/MethodesQuantitatives" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Préface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-auteurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">À propos des auteurs</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 1. Découverte de R</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-priseenmainR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prise en main de R</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 2. Analyses univariées et représentations graphiques</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-univarie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistiques descriptives univariées</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-magiedesgraphiques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Magie des graphiques</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 3. Analyses bivariées</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-bivarieeQuantiQuanti.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Relation linéaire entre deux variables quantitatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-bivarieeQualiQuali.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Relation entre deux variables qualitatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-bivarieeQualiQuanti.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Relation entre une variable qualitative et une variable quantitative</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 4. Modèles de régression</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-regressionlineaire.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Régression linéaire multiple</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-GLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Régressions linéaires généralisées (GLM)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-GLMM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Régressions à effets mixtes (GLMM)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Multiniveau.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Régressions multiniveaux</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-GAM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modèles généralisés additifs</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 5. Analyses exploratoires multivariées</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-AnalysesFactorielles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Méthodes factorielles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-MethodeClassification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Méthodes de classification non supervisée</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 6. Annexes et bibliographie</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-Annexes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Annexes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliographie</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table des matières</h2>
   
  <ul>
<li><a href="#sec-071" id="toc-sec-071" class="nav-link active" data-scroll-target="#sec-071"><span class="header-section-number">7.1</span> Objectifs de la régression linéaire multiple et construction d’un modèle de régression</a></li>
  <li>
<a href="#sec-072" id="toc-sec-072" class="nav-link" data-scroll-target="#sec-072"><span class="header-section-number">7.2</span> Principes de base de la régression linéaire multiple</a>
  <ul class="collapse">
<li><a href="#sec-0721" id="toc-sec-0721" class="nav-link" data-scroll-target="#sec-0721"><span class="header-section-number">7.2.1</span> Un peu d’équations…</a></li>
  <li><a href="#sec-0722" id="toc-sec-0722" class="nav-link" data-scroll-target="#sec-0722"><span class="header-section-number">7.2.2</span> Hypothèses de la régression linéaire multiple</a></li>
  </ul>
</li>
  <li>
<a href="#sec-073" id="toc-sec-073" class="nav-link" data-scroll-target="#sec-073"><span class="header-section-number">7.3</span> Évaluation de la qualité d’ajustement du modèle</a>
  <ul class="collapse">
<li><a href="#sec-0731" id="toc-sec-0731" class="nav-link" data-scroll-target="#sec-0731"><span class="header-section-number">7.3.1</span> Mesures de la qualité d’un modèle</a></li>
  <li><a href="#sec-0732" id="toc-sec-0732" class="nav-link" data-scroll-target="#sec-0732"><span class="header-section-number">7.3.2</span> Comparaison des modèles incrémentiels</a></li>
  </ul>
</li>
  <li>
<a href="#sec-074" id="toc-sec-074" class="nav-link" data-scroll-target="#sec-074"><span class="header-section-number">7.4</span> Différentes mesures pour les coefficients de régression</a>
  <ul class="collapse">
<li><a href="#sec-0741" id="toc-sec-0741" class="nav-link" data-scroll-target="#sec-0741"><span class="header-section-number">7.4.1</span> Coefficients de régression&nbsp;: évaluer l’effet des variables indépendantes</a></li>
  <li><a href="#sec-0742" id="toc-sec-0742" class="nav-link" data-scroll-target="#sec-0742"><span class="header-section-number">7.4.2</span> Coefficients de régression standardisés&nbsp;: repérer les variables les plus importantes du modèle</a></li>
  <li><a href="#sec-0743" id="toc-sec-0743" class="nav-link" data-scroll-target="#sec-0743"><span class="header-section-number">7.4.3</span> Significativité des coefficients de régression&nbsp;: valeurs de <em>t</em> et de <em>p</em></a></li>
  <li><a href="#sec-0744" id="toc-sec-0744" class="nav-link" data-scroll-target="#sec-0744"><span class="header-section-number">7.4.4</span> Intervalle de confiance des coefficients</a></li>
  </ul>
</li>
  <li>
<a href="#sec-075" id="toc-sec-075" class="nav-link" data-scroll-target="#sec-075"><span class="header-section-number">7.5</span> Introduction de variables explicatives particulières</a>
  <ul class="collapse">
<li><a href="#sec-0751" id="toc-sec-0751" class="nav-link" data-scroll-target="#sec-0751"><span class="header-section-number">7.5.1</span> Exploration des relations non linéaires</a></li>
  <li><a href="#sec-0752" id="toc-sec-0752" class="nav-link" data-scroll-target="#sec-0752"><span class="header-section-number">7.5.2</span> Variable indépendante qualitative dichotomique</a></li>
  <li><a href="#sec-0753" id="toc-sec-0753" class="nav-link" data-scroll-target="#sec-0753"><span class="header-section-number">7.5.3</span> Variable indépendante qualitative polytomique</a></li>
  <li><a href="#sec-0754" id="toc-sec-0754" class="nav-link" data-scroll-target="#sec-0754"><span class="header-section-number">7.5.4</span> Variables d’interaction</a></li>
  </ul>
</li>
  <li>
<a href="#sec-076" id="toc-sec-076" class="nav-link" data-scroll-target="#sec-076"><span class="header-section-number">7.6</span> Diagnostics de la régression</a>
  <ul class="collapse">
<li><a href="#sec-0761" id="toc-sec-0761" class="nav-link" data-scroll-target="#sec-0761"><span class="header-section-number">7.6.1</span> Nombre d’observations</a></li>
  <li><a href="#sec-0762" id="toc-sec-0762" class="nav-link" data-scroll-target="#sec-0762"><span class="header-section-number">7.6.2</span> Normalité des résidus</a></li>
  <li><a href="#sec-0763" id="toc-sec-0763" class="nav-link" data-scroll-target="#sec-0763"><span class="header-section-number">7.6.3</span> Linéarité et homoscédasticité des résidus</a></li>
  <li><a href="#sec-0764" id="toc-sec-0764" class="nav-link" data-scroll-target="#sec-0764"><span class="header-section-number">7.6.4</span> Absence de multicolinéarité excessive</a></li>
  <li><a href="#sec-0766" id="toc-sec-0766" class="nav-link" data-scroll-target="#sec-0766"><span class="header-section-number">7.6.5</span> Absence d’observations aberrantes</a></li>
  </ul>
</li>
  <li>
<a href="#sec-077" id="toc-sec-077" class="nav-link" data-scroll-target="#sec-077"><span class="header-section-number">7.7</span> Mise en œuvre dans R</a>
  <ul class="collapse">
<li><a href="#sec-0771" id="toc-sec-0771" class="nav-link" data-scroll-target="#sec-0771"><span class="header-section-number">7.7.1</span> Fonctions <code>lm</code>, <code>summary()</code> et <code>confint()</code></a></li>
  <li><a href="#sec-0772" id="toc-sec-0772" class="nav-link" data-scroll-target="#sec-0772"><span class="header-section-number">7.7.2</span> Comparaison des modèles</a></li>
  <li><a href="#sec-0773" id="toc-sec-0773" class="nav-link" data-scroll-target="#sec-0773"><span class="header-section-number">7.7.3</span> Diagnostic sur un modèle</a></li>
  <li><a href="#sec-0774" id="toc-sec-0774" class="nav-link" data-scroll-target="#sec-0774"><span class="header-section-number">7.7.4</span> Graphiques pour les effets marginaux</a></li>
  </ul>
</li>
  <li><a href="#sec-078" id="toc-sec-078" class="nav-link" data-scroll-target="#sec-078"><span class="header-section-number">7.8</span> Quiz de révision du chapitre</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/SerieBoldR/MethodesQuantitatives/issues/new" class="toc-action">Signaler un problème ou<br>formuler une suggestion</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-chap07" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Régression linéaire multiple</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Dans ce chapitre, nous présentons la méthode de régression certainement la plus utilisée en sciences sociales&nbsp;: la régression linéaire multiple. À titre de rappel, dans la <a href="04-bivarieeQuantiQuanti.html#sec-044">section&nbsp;<span>4.4</span></a>, nous avons vu que la régression linéaire simple, basée sur la méthode des moindres carrés ordinaires (MCO), permet d’expliquer et de prédire une variable continue en fonction d’une autre variable. Toutefois, quel que soit le domaine d’étude, il est rare que le recours à une seule variable explicative (<em>X</em>) permette de prédire efficacement une variable continue (<em>Y</em>). La régression linéaire multiple est simplement une extension de la régression linéaire simple&nbsp;: elle permet ainsi de prédire et d’expliquer une variable dépendante (<em>Y</em>) en fonction de plusieurs variables indépendantes (explicatives).</p>
<p>Plus spécifiquement, nous abordons ici les principes et les hypothèses de la régression linéaire multiple, comment mesurer la qualité d’ajustement du modèle, introduire des variables explicatives particulières (variable qualitative dichotomique ou polytomique, variable d’interaction, etc.), interpréter les sorties d’un modèle de régression et finalement la mettre en œuvre dans R.</p>
<div class="bloc_package">
<div class="bloc_package-header">
<div class="bloc_package-icon">

</div>
<p><strong>Liste des <em>packages</em> utilisés dans ce chapitre</strong></p>
</div>
<div class="bloc_package-body">
<ul>
<li>Pour créer des graphiques&nbsp;:
<ul>
<li>
<code>ggplot2</code>, le seul, l’unique!</li>
<li>
<code>ggpubr</code> pour combiner les graphiques</li>
</ul>
</li>
<li>Pour obtenir les coefficients standardisés&nbsp;:
<ul>
<li>
<code>QuantPsyc</code> avec la fonction <code>lm.beta</code> (<a href="#sec-0742">section&nbsp;<span>7.4.2</span></a>).</li>
</ul>
</li>
<li>Pour les effets marginaux des variables indépendantes&nbsp;:
<ul>
<li>
<code>ggeffects</code> avec la fonction <code>ggpredict</code> (<a href="#sec-0774">section&nbsp;<span>7.7.4</span></a>).</li>
</ul>
</li>
<li>Pour vérifier la normalité des résidus&nbsp;:
<ul>
<li>
<code>DescTools</code> avec les fonctions <code>Skewness</code> et <code>Kurtosis</code> et <code>JarqueBeraTest</code> (<a href="#sec-0762">section&nbsp;<span>7.6.2</span></a>).</li>
</ul>
</li>
<li>Pour vérifier l’homoscédasticité des résidus&nbsp;:
<ul>
<li>
<code>lmtest</code> avec la fonction <code>bptest</code> pour le test de Breusch-Pagan (<a href="#sec-07733">section&nbsp;<span>7.7.3.3</span></a>).</li>
</ul>
</li>
<li>Pour vérifier la multicolinéarité excessive&nbsp;:
<ul>
<li>
<code>car</code> avec la fonction <code>vif</code> (<a href="#sec-07734">section&nbsp;<span>7.7.3.4</span></a>).</li>
</ul>
</li>
<li>Autre <em>package</em>&nbsp;:
<ul>
<li>
<code>foreign</code> pour importer des fichiers externes.</li>
</ul>
</li>
</ul>
</div>
</div>
<section id="sec-071" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="sec-071">
<span class="header-section-number">7.1</span> Objectifs de la régression linéaire multiple et construction d’un modèle de régression</h2>
<p>Selon Barbara G. Tabachnich et Linda S. Fidell <span class="citation" data-cites="tabachnick2007">(<a href="references.html#ref-tabachnick2007" role="doc-biblioref">2007</a>)</span>, un modèle de régression permet de répondre à deux objectifs principaux relevant chacun d’une approche de modélisation particulière.</p>
<p>La première approche a pour objectif d’identifier les relations entre une variable dépendante (VD) et plusieurs variables indépendantes (VI). Il s’agit alors de déterminer si ces relations sont positives ou négatives, significatives ou non et d’évaluer leur ampleur. La construction du modèle de régression repose alors sur un cadre théorique et la formulation d’hypothèses, sur les relations entre chacune des VI et la VD.</p>
<p>La seconde approche est exploratoire et très utilisée en forage ou en fouille de données (<em>data mining</em> en anglais). Parmi un grand ensemble de variables disponibles dans un jeu de données, elle vise à identifier la ou les variables permettant de prédire le plus efficacement (précisément) une variable dépendante. Parfois, ce type de démarche ne repose ni sur un cadre théorique ni sur la formulation d’hypothèses entre les VI et la VD. Dans des cas extrêmes, on s’intéresse uniquement à la capacité de prédiction du modèle, et ce, sans analyser les associations entre les VI et la VD. L’objectif étant d’obtenir le modèle le plus efficace possible afin de prédire à l’avenir la valeur de la variable dépendante pour des observations pour lesquelles elle est inconnue. Pour ce faire, nous avons recours à des régressions séquentielles (<em>stepwise regressions</em>) dans lesquelles les variables peuvent être ajoutées une à une au modèle ou retirées de celui-ci; nous conserverons dans le modèle final uniquement celles qui ont un apport explicatif significatif. Signalons d’emblée que dans le reste du chapitre, comme du livre, nous ne nous étendons pas plus sur cette approche de modélisation, et ce, pour deux raisons. D’une part, cette approche met souvent en évidence des relations significatives entre des variables sans qu’il y ait une relation de causalité entre elles. D’autre part, en sciences sociales, un modèle de régression doit être basé sur un cadre théorique et conceptuel élaboré à la suite à d’une revue de littérature rigoureuse.</p>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Cadre conceptuel et élaboration d’un modèle de régression</strong></p>
</div>
<div class="bloc_attention-body">
<p>Pour bien construire un modèle de régression, il convient de définir un cadre conceptuel élaboré à la suite à une revue de littérature sur le sujet de recherche. Ce cadre conceptuel permet d’identifier les dimensions et les concepts clefs permettant d’expliquer le phénomène à l’étude. Par la suite, pour chacun de ces concepts ou les dimensions, il est alors possible 1)&nbsp;d’identifier les différentes variables indépendantes qui sont introduites dans le modèle et 2)&nbsp;de formuler une hypothèse pour chacune d’elles. Par exemple, pour telle ou telle variable explicative, on s’attendra à ce qu’elle fasse augmenter ou diminuer significativement la variable dépendante. De nouveau, la formulation de cette hypothèse doit s’appuyer sur une interprétation théorique de la relation entre la VI et la VD.</p>
<p>Prenons en guise d’exemple une étude récente portant sur la multiexposition des cyclistes au bruit et à la pollution atmosphérique <span class="citation" data-cites="2020_3">(<a href="references.html#ref-2020_3" role="doc-biblioref">Gelb et Apparicio 2020</a>)</span>. Dans cet article, les auteurs s’intéressent aux caractéristiques de l’environnement urbain qui contribuent à augmenter ou réduire l’exposition des cyclistes à la pollution de l’air et au bruit routier. Pour ce faire, une collecte de données primaires a été réalisée avec trois cyclistes dans les rues de Paris du 4 au 7 septembre 2017. Au total, 64 heures et 964 kilomètres ont ainsi été parcourus à vélo afin de maximiser la couverture de la ville de Paris et les types d’environnements urbains traversés.</p>
<p>Leur cadre conceptuel est schématisé à la <a href="#fig-cadreconcept">figure&nbsp;<span>7.1</span></a>. Les deux variables indépendantes (à expliquer) sont l’exposition au dioxyde d’azote (NO<sub>2</sub>) et l’exposition au bruit (mesurée en décibel dB(A)). Avant d’identifier les caractéristiques de l’environnement urbain affectant ces deux expositions, plusieurs facteurs, dits <strong>variables de contrôle</strong>, sont considérés. Par exemple, la concentration de NO<sub>2</sub> varie en fonction des conditions météorologiques (vent, température et humidité) et de la pollution d’arrière-plan (variant selon le moment de la journée, le jour de la semaine et la localisation géographique au sein de la ville). Ces dimensions ne sont pas le centre d’intérêt direct de l’étude. En effet, les auteurs s’intéressent aux impacts des caractéristiques locales de l’environnement urbain. Pour pouvoir les identifier sans biais, il est nécessaire de contrôler (filtrer) l’ensemble de ces autres facteurs.</p>
<p>Dans leur cadre conceptuel, les auteurs regroupent les caractéristiques locales de l’environnement urbain en trois grandes dimensions&nbsp;: les caractéristiques du segment (type de rues ou de voies cyclables empruntés, intersections traversées, pente et vitesse), celles de la forme urbaine (densité résidentielle, végétation, ouverture de la rue et occupations du sol) et celles du trafic (nombre et types de véhicules croisés, congestion et zones 30 km/h). Une fois ce cadre conceptuel construit, il reste alors à identifier les variables qui permettent d’opérationnaliser chacun de concepts retenus.</p>
<div id="fig-cadreconcept" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap07/CadreTheorique.jpg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.1: Exemple de cadre conceptuel</figcaption></figure>
</div>
<p><strong>Notion de variables de contrôle <em>versus</em> variables explicatives</strong></p>
<p>Dans un modèle de régression, nous distinguons habituellement trois types de variables&nbsp;: la variable dépendante (<em>Y</em>) que nous souhaitons prédire ou expliquer et les variables indépendantes (<em>X</em>) qui peuvent être soit des variables de contrôle (<em>covariates</em> en anglais), soit des variables explicatives. Les premières sont des facteurs qu’il faut prendre en compte (contrôler) avant d’évaluer nos variables d’intérêt (explicatives).</p>
<p>Dans l’exemple précédent, les chercheurs voulaient évaluer l’impact des caractéristiques de l’environnement urbain (variables explicatives) sur les expositions des cyclistes au dioxyde d’azote et au bruit, et ce, une fois contrôlés les effets de facteurs reconnus comme ayant un impact significatif sur la concentration de ces polluants (conditions météorologiques et la pollution d’arrière-plan). Autrement dit, si les variables de contrôle n’avaient pas été prises en compte, l’étude des variables d’intérêt serait biaisée par les effets de ces facteurs qui n’auraient pas été contrôlés. À titre d’exemple, il est possible que les zones de circulation limitées à 30 km/h soient concentrées dans les quartiers centraux et denses de Paris. Dans ces quartiers, la pollution d’arrière-plan a tendance à être supérieure. Si nous ne tenons pas compte de cette pollution d’arrière-plan, nous pourrions arriver à la conclusion que les zones de 30 km/h sont des milieux dans lesquels les cyclistes sont plus exposés à la pollution atmosphérique.</p>
<p><strong>Construction de modèles de régression imbriqués, incrémentiels</strong></p>
<p>En lien avec le cadre conceptuel du modèle, il est fréquent de construire plusieurs modèles emboîtés. Par exemple, à partir du cadre conceptuel (<a href="#fig-cadreconcept">figure&nbsp;<span>7.1</span></a>), les auteurs auraient très bien pu construire quatre modèles&nbsp;:</p>
<ul>
<li><p>un premier avec uniquement les variables de contrôle (modèle A);</p></li>
<li><p>un second incluant les variables de contrôle et les variables explicatives de la dimension des caractéristiques du segment (modèle B);</p></li>
<li><p>un troisième reprenant les variables du modèle B dans lequel sont introduites les variables explicatives relatives à la forme urbaine (modèle C);</p></li>
<li><p>un dernier modèle dans lequel sont ajoutées les variables explicatives relatives aux conditions du trafic (modèle D).</p></li>
</ul>
<p>L’intérêt d’une telle approche est qu’elle permet d’évaluer successivement l’apport explicatif de chacune des dimensions du modèle; nous y reviendrons dans la <a href="#sec-0732">section&nbsp;<span>7.3.2</span></a>.</p>
<p>Nous disons alors que deux modèles sont imbriqués lorsque le modèle avec le plus de variables comprend également <strong>toutes</strong> les variables du modèle avec le moins de variables.</p>
</div>
</div>
</section><section id="sec-072" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="sec-072">
<span class="header-section-number">7.2</span> Principes de base de la régression linéaire multiple</h2>
<section id="sec-0721" class="level3" data-number="7.2.1"><h3 data-number="7.2.1" class="anchored" data-anchor-id="sec-0721">
<span class="header-section-number">7.2.1</span> Un peu d’équations…</h3>
<p>La régression linéaire multiple vise à déterminer une équation qui résume le mieux les relations linéaires entre une variable dépendante (<em>Y</em>) et un ensemble de variables indépendantes (<em>X</em>). L’équation de régression s’écrit alors&nbsp;:</p>
<p><span id="eq-regmultiple1"><span class="math display">\[
y_i = \beta_{0} + \beta_{1}x_{1i} + \beta_{2}x_{2i} +\ldots+ \beta_{k}x_{ki} + \epsilon_{i}
\tag{7.1}\]</span></span></p>
<p>avec&nbsp;:</p>
<ul>
<li><p><span class="math inline">\(y_i\)</span>, la valeur de la variable dépendante <em>Y</em> pour l’observation <em>i</em></p></li>
<li><p><span class="math inline">\(\beta_{0}\)</span>, la constante, soit la valeur prédite pour <em>Y</em> quand toutes les variables indépendantes sont égales à 0</p></li>
<li><p><span class="math inline">\(k\)</span> le nombre de variables indépendantes</p></li>
<li><p><span class="math inline">\(\beta_{1}\)</span> à <span class="math inline">\(\beta_{k}\)</span>, les coefficients de régression pour les variables indépendantes de 1 à <em>k</em> (<span class="math inline">\(X_{1}\)</span> à <span class="math inline">\(X_{k}\)</span>)</p></li>
<li><p><span class="math inline">\(\epsilon_{i}\)</span>, le résidu pour l’observation de <em>i</em>, soit la partie de la valeur de <span class="math inline">\(y_i\)</span> qui n’est pas expliquée par le modèle de régression.</p></li>
</ul>
<p>Notez qu’il existe plusieurs écritures simplifiées de cette équation. D’une part, il est possible de ne pas indiquer l’observation <em>i</em> et de remplacer les lettres grecques <em>bêta</em> et <em>epsilon</em> (<span class="math inline">\(\beta\)</span> et <span class="math inline">\(\epsilon\)</span>) par les lettres <em>b</em> et <em>e</em>&nbsp;:</p>
<p><span id="eq-regmultiple2"><span class="math display">\[
Y = b_{0} + b_{1}X_{1} + b_{2}X_{2} +\ldots+ b_{k}X_{k} + e
\tag{7.2}\]</span></span></p>
<p>D’autre part, cette équation peut être présentée sous forme matricielle. Rappelez-vous que, pour chacune des <em>n</em> observations de l’échantillon, une équation est formulée&nbsp;:</p>
<p><span id="eq-regmultiple3"><span class="math display">\[
\left\{\begin{array}{l}
y_{1}=\beta_{0}+\beta_{1} x_{1,1}+\ldots+\beta_{p} x_{1, k}+\varepsilon_{1} \\
y_{2}=\beta_{0}+\beta_{1} x_{2,1}+\ldots+\beta_{p} x_{2, k}+\varepsilon_{2} \\
\cdots \\
y_{n}=\beta_{0}+a_{1} x_{n, 1}+\ldots+\beta_{p} x_{n, k}+\varepsilon_{n}
\end{array}\right.
\tag{7.3}\]</span></span></p>
<p>Par conséquent, sous forme matricielle, l’équation s’écrit&nbsp;:</p>
<p><span id="eq-regmultiple4"><span class="math display">\[
\left(\begin{array}{c}
y_{1} \\
\vdots \\
y_{n}
\end{array}\right)=\left(\begin{array}{cccc}
1 &amp; x_{1,1} &amp; \cdots &amp; x_{1, k} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
1 &amp; x_{n, 1} &amp; \cdots &amp; x_{n, k}
\end{array}\right)\left(\begin{array}{c}
\beta_{0} \\
\beta_{1} \\
\vdots \\
\beta_{k}
\end{array}\right)+\left(\begin{array}{c}
\varepsilon_{1} \\
\vdots \\
\varepsilon_{n}
\end{array}\right)
\tag{7.4}\]</span></span></p>
<p>ou tout simplement&nbsp;:</p>
<p><span id="eq-regmultiple5"><span class="math display">\[
Y = X\beta + \epsilon
\tag{7.5}\]</span></span></p>
<p>avec&nbsp;:</p>
<ul>
<li><p><span class="math inline">\(Y\)</span>, un vecteur de dimension <span class="math inline">\(n \times 1\)</span> pour la variable dépendante, soit une colonne avec <em>n</em> observations</p></li>
<li><p><span class="math inline">\(X\)</span>, une matrice de dimension <span class="math inline">\(n \times (k + 1)\)</span> pour les <em>k</em> variables indépendantes, incluant une autre colonne (avec la valeur de 1 pour les <em>n</em> observations) pour la constante d’où <span class="math inline">\(k + 1\)</span></p></li>
<li><p><span class="math inline">\(\beta\)</span>, un vecteur de dimension <span class="math inline">\(k + 1\)</span>, soit les coefficients de régression pour les <em>k</em> variables et la constante</p></li>
<li><p><span class="math inline">\(\epsilon\)</span>, un vecteur de dimension <span class="math inline">\(n \times 1\)</span> pour les résidus.</p></li>
</ul>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Parties expliquée et non expliquée de la régression linéaire multiple</strong></p>
</div>
<div class="bloc_attention-body">
<p>Vous aurez compris que, comme pour la régression linéaire simple (<a href="04-bivarieeQuantiQuanti.html#sec-044">section&nbsp;<span>4.4</span></a>), l’équation de la régression linéaire multiple comprend aussi une partie expliquée et une autre non expliquée (stochastique) par le modèle&nbsp;: <span id="eq-regmultiple6"><span class="math display">\[
Y  = \underbrace{\beta_{0} + \beta_{1}X_{i} + \beta_{2}X_{i} +\ldots+ \beta_{k}X_{k}}_{\mbox{partie expliquée par le modèle}}+ \underbrace{\epsilon}_{\mbox{partie non expliquée (stochastique)}}
\tag{7.6}\]</span></span></p>
<p><span id="eq-regmultiple8"><span class="math display">\[
Y  = \underbrace{X\beta}_{\mbox{partie expliquée par le modèle}}+ \underbrace{\epsilon}_{\mbox{partie non expliquée (stochastique)}}
\tag{7.7}\]</span></span></p>
</div>
</div>
</section><section id="sec-0722" class="level3" data-number="7.2.2"><h3 data-number="7.2.2" class="anchored" data-anchor-id="sec-0722">
<span class="header-section-number">7.2.2</span> Hypothèses de la régression linéaire multiple</h3>
<p>Un modèle est bien construit s’il respecte plusieurs hypothèses liées à la régression, dont les principales étant&nbsp;:</p>
<ul>
<li><p><strong>Hypothèse 1</strong>. <em>La variable dépendante doit être continue et non-bornée</em>. Quant aux variables indépendantes (VI), elles peuvent être quantitatives (discrètes ou continues) et qualitatives (nominale ou ordinale).</p></li>
<li><p><strong>Hypothèse 2</strong>. <em>La variance de chaque VI doit être supérieure à 0</em>. Autrement dit, toutes les observations ne peuvent avoir la même valeur.</p></li>
<li><p><strong>Hypothèse 3</strong>. <em>Indépendance des termes d’erreur</em>. Les résidus des observations (<span class="math inline">\(\epsilon_{1}, \epsilon_{2}, \ldots, \epsilon_{n}\)</span>) ne doivent pas être corrélés entre eux. Autrement dit, les observations doivent être indépendantes les unes des autres, ce qui n’est souvent pas le cas pour des mesures temporelles. Par exemple, l’application du cadre conceptuel sur la modélisation de l’exposition des cyclistes au bruit et à la pollution atmosphérique (<a href="#fig-cadreconcept">figure&nbsp;<span>7.1</span></a>)) est basée sur des données primaires collectées lors de trajets réalisés à vélo dans une ville donnée. Par conséquent, deux observations qui se suivent ont bien plus de chances de se ressembler – du point de vue des mesures de pollution et des caractéristiques de l’environnement urbain – que deux observations tirées au hasard dans le jeu de données. Ce problème d’autocorrélation temporelle doit être contrôlé, sinon, les coefficients de régression seront biaisés.</p></li>
<li><p><strong>Hypothèse 4</strong>. <em>Normalité des résidus</em> avec une moyenne centrée sur zéro.</p></li>
<li><p><strong>Hypothèse 5</strong>. <em>Absence de colinéarité parfaite entre les variables explicatives</em>. Par exemple, dans un modèle, nous ne pouvons pas introduire à la fois les pourcentages de locataires et de propriétaires, car pour chaque observation, la somme des deux donne 100&nbsp;%. Nous avons donc une corrélation parfaite entre ces deux variables&nbsp;: le coefficient de corrélation de Pearson entre ces deux variables est égal à 1. Par conséquent, le modèle ne peut pas être estimé avec ces deux variables et l’une des deux est automatiquement ôtée.</p></li>
<li><p><strong>Hypothèse 6</strong>. <em>Homoscédasticité des erreurs (ou absence d’hétéroscédasticité)</em>. Les résidus doivent avoir une variance constante, c’est-à-dire qu’elle doit être la même pour chaque observation. Il y a homoscédasticité lorsqu’il y a une absence de corrélation entre les résidus et les valeurs prédites. Si cette condition n’est pas respectée, nous parlons alors d’hétéroscédasticité.</p></li>
<li><p><strong>Hypothèse 7</strong>. <em>Le modèle est bien spécifié</em>. Un modèle est mal spécifié (construit) quand «&nbsp;une ou plusieurs variables non pertinentes sont incluses dans le modèle&nbsp;» ou «&nbsp;qu’une ou plusieurs variables pertinentes sont exclues du modèle&nbsp;» <span class="citation" data-cites="bressoux2010">(<a href="references.html#ref-bressoux2010" role="doc-biblioref">Bressoux 2010, 138‑139</a>)</span>. Concrètement, l’inclusion d’une variable non pertinente ou l’omission d’une variable peut entraîner une mauvaise estimation des effets des variables explicatives du modèle.</p></li>
</ul>
<p>Pour connaître les conséquences de la violation de chacune de ces hypothèses, vous pourrez notamment consulter l’excellent ouvrage de Bressoux <span class="citation" data-cites="bressoux2010">(<a href="references.html#ref-bressoux2010" role="doc-biblioref">2010, 103‑110</a>)</span>. Retenez ici que le non-respect de ces hypothèses produit des coefficients de régression biaisés.</p>
</section></section><section id="sec-073" class="level2" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="sec-073">
<span class="header-section-number">7.3</span> Évaluation de la qualité d’ajustement du modèle</h2>
<p>Pour illustrer la régression linéaire multiple, nous utilisons un jeu de données tiré d’un article portant sur la distribution spatiale de la végétation sur l’île de Montréal abordée sous l’angle de l’équité environnementale <span class="citation" data-cites="apparicio2016spatial">(<a href="references.html#ref-apparicio2016spatial" role="doc-biblioref">Apparicio et al. 2016</a>)</span>. Dans cette étude, les auteurs veulent vérifier si certains groupes de population (personnes à faible revenu, minorités visibles, personnes âgées et enfants de moins de 15 ans) ont ou non une accessibilité plus limitée à la végétation urbaine. En d’autres termes, cet article tente de répondre à la question suivante&nbsp;: une fois contrôlées les caractéristiques de la forme urbaine (densité de population et âge du bâti), est-ce que les quatre groupes de population résident dans des îlots urbains avec proportionnellement moins ou plus de végétation?</p>
<p>Dans le <a href="#tbl-datareg">tableau&nbsp;<span>7.1</span></a>, sont reportées les variables utilisées (calculées au niveau des îlots de l’île de Montréal) introduites dans le modèle de régression&nbsp;:</p>
<ul>
<li><p>le pourcentage de la superficie de l’îlot couverte par de la végétation, soit la variable indépendante (VI);</p></li>
<li><p>deux variables indépendantes de contrôle (VC) relatives à la forme urbaine;</p></li>
<li><p>les pourcentages des quatre groupes de population comme variables indépendantes explicatives (VE).</p></li>
</ul>
<p><strong>Notez que ce jeu de données est utilisé tout au long du chapitre.</strong> L’équation de départ du premier modèle de régression est donc&nbsp;:</p>
<p><code>VegPct ~ HABHA + AgeMedian + Pct_014 + Pct_65P + Pct_MV + Pct_FR</code></p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-datareg" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;7.1: Statistiques descriptives pour les variables du modèle</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 36%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Nom</th>
<th style="text-align: left;">Intitulé</th>
<th style="text-align: center;">Type</th>
<th style="text-align: right;">Moy.</th>
<th style="text-align: right;">E.-T.</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">Q2</th>
<th style="text-align: right;">Q3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">VegPct</td>
<td style="text-align: left;">VegPct</td>
<td style="text-align: left;">Végétation (%)</td>
<td style="text-align: center;">VD</td>
<td style="text-align: right;">35,1</td>
<td style="text-align: right;">18,6</td>
<td style="text-align: right;">20,3</td>
<td style="text-align: right;">33,8</td>
<td style="text-align: right;">49,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">HABHA</td>
<td style="text-align: left;">HABHA</td>
<td style="text-align: left;">Habitants au km2</td>
<td style="text-align: center;">VC</td>
<td style="text-align: right;">87,8</td>
<td style="text-align: right;">74,0</td>
<td style="text-align: right;">36,9</td>
<td style="text-align: right;">68,4</td>
<td style="text-align: right;">120,5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AgeMedian</td>
<td style="text-align: left;">AgeMedian</td>
<td style="text-align: left;">Âge médian des bâtiments</td>
<td style="text-align: center;">VC</td>
<td style="text-align: right;">52,1</td>
<td style="text-align: right;">25,2</td>
<td style="text-align: right;">37,2</td>
<td style="text-align: right;">49,0</td>
<td style="text-align: right;">61,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_014</td>
<td style="text-align: left;">Pct_014</td>
<td style="text-align: left;">Moins de 15 ans (%)</td>
<td style="text-align: center;">VE</td>
<td style="text-align: right;">15,9</td>
<td style="text-align: right;">5,3</td>
<td style="text-align: right;">12,5</td>
<td style="text-align: right;">15,9</td>
<td style="text-align: right;">19,3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_65P</td>
<td style="text-align: left;">Pct_65P</td>
<td style="text-align: left;">65 ans et plus (%)</td>
<td style="text-align: center;">VE</td>
<td style="text-align: right;">14,9</td>
<td style="text-align: right;">8,3</td>
<td style="text-align: right;">9,6</td>
<td style="text-align: right;">13,9</td>
<td style="text-align: right;">18,2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_MV</td>
<td style="text-align: left;">Pct_MV</td>
<td style="text-align: left;">Minorités visibles (%)</td>
<td style="text-align: center;">VE</td>
<td style="text-align: right;">21,0</td>
<td style="text-align: right;">16,4</td>
<td style="text-align: right;">8,3</td>
<td style="text-align: right;">17,2</td>
<td style="text-align: right;">29,6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_FR</td>
<td style="text-align: left;">Pct_FR</td>
<td style="text-align: left;">Personnes à faible revenu (%)</td>
<td style="text-align: center;">VE</td>
<td style="text-align: right;">23,6</td>
<td style="text-align: right;">16,0</td>
<td style="text-align: right;">11,1</td>
<td style="text-align: right;">21,3</td>
<td style="text-align: right;">33,7</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="sec-0731" class="level3" data-number="7.3.1"><h3 data-number="7.3.1" class="anchored" data-anchor-id="sec-0731">
<span class="header-section-number">7.3.1</span> Mesures de la qualité d’un modèle</h3>
<p>Comme pour la régression linéaire simple (<a href="04-bivarieeQuantiQuanti.html#sec-044">section&nbsp;<span>4.4</span></a>), les trois mesures les plus couramment utilisées pour évaluer la qualité d’un modèle sont&nbsp;:</p>
<ul>
<li><p>Le <strong>coefficient de détermination</strong> (R<sup>2</sup>) qui indique la proportion de la variance de la variable dépendante expliquée par les variables indépendantes du modèle (<a href="#eq-regmR2">équation&nbsp;<span>7.9</span></a>). Il varie ainsi de 0 à&nbsp;1.</p></li>
<li><p>La <strong>statistique de Fisher</strong> qui permet d’évaluer la significativité globale du modèle (<a href="#eq-regmFFisher">équation&nbsp;<span>7.10</span></a>). Dans le cas d’une régression linéaire multiple, l’hypothèse nulle du test <em>F</em> est que toutes les valeurs des coefficients de régression des variables indépendantes sont égales à 0; autrement dit, qu’aucune des variables indépendantes n’a d’effet sur la variable dépendante. Tel que décrit à la <a href="04-bivarieeQuantiQuanti.html#sec-0443">section&nbsp;<span>4.4.3</span></a>, il est possible d’obtenir une valeur de <em>p</em> rattachée à la statistique <em>F</em> avec <em>k</em> degrés de liberté au dénominateur et <em>n-k-1</em> degrés de liberté au numérateur (<em>k</em> et <em>n</em> étant respectivement le nombre de variables indépendantes et le nombre d’observations). Lorsque la valeur de <em>p</em> est inférieure à 0,05, nous pourrons en conclure que le modèle est globalement significatif, c’est-à-dire qu’au moins un coefficient de régression est significativement différent de zéro. Notez qu’il est plutôt rare qu’un modèle de régression, comprenant plusieurs variables indépendantes, soit globalement non significatif (P&nbsp;&gt;&nbsp;0,05), et ce, surtout s’il est basé sur un cadre conceptuel et théorique solide. Le test de la statistique de Fisher est donc facile à passer et ne constitue pas une preuve absolue de la pertinence du modèle.</p></li>
<li><p><strong>L’erreur quadratique moyenne (RMSE)</strong> qui indique l’erreur absolue moyenne du modèle exprimée dans l’unité de mesure de la variable dépendante, autrement dit l’écart absolu moyen entre les valeurs observées et prédites du modèle (<a href="#eq-regmRMSE">équation&nbsp;<span>7.11</span></a>). Une valeur élevée indique que le modèle se trompe largement en moyenne et inversement.</p></li>
</ul>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Rappel sur la décomposition de la variance et calcul du R<sup>2</sup>, de la statistique <em>F</em> et du RMSE</strong></p>
</div>
<div class="bloc_attention-body">
<p>Rappelez-vous que la variance totale (SCT) est égale à la somme de la variance expliquée (SCE) par le modèle et de la variance non expliquée (SCR) par le modèle.</p>
<p><span id="eq-regmVariances"><span class="math display">\[
\underbrace{\sum_{i=1}^n (y_{i}-\bar{y})^2}_{\mbox{variance de Y}} = \underbrace{\sum_{i=1}^n (\widehat{y}_i-\bar{y})^2}_{\mbox{var. expliquée}} + \underbrace{\sum_{i=1}^n (y_{i}-\widehat{y})^2}_{\mbox{var. non expliquée}} \Rightarrow
SCT = SCE + SCR
\tag{7.8}\]</span></span></p>
<p>avec&nbsp;:</p>
<ul>
<li>
<span class="math inline">\(y_{i}\)</span> est la valeur observée de la variable dépendante pour <em>i</em>;</li>
<li>
<span class="math inline">\(\bar{y}\)</span> est la valeur moyenne de la variable dépendante;</li>
<li>
<span class="math inline">\(\widehat{y}_i\)</span> est la valeur prédite de la variable dépendante pour <em>i</em>.</li>
</ul>
<p>À partir des trois variances (totale, expliquée et non expliquée), il est alors possible de calculer les trois mesures de la qualité d’ajustement du modèle.</p>
<p><span id="eq-regmR2"><span class="math display">\[
R^2 = \frac{\sum_{i=1}^n (\widehat{y}_i-\bar{y})^2}{\sum_{i=1}^n (y_{i}-\bar{y})^2} = \frac{SCE}{SCT} \mbox{ avec } R^2 \in \left[0,1\right]
\tag{7.9}\]</span></span></p>
<p><span id="eq-regmFFisher"><span class="math display">\[
F = \frac{\frac{\sum_{i=1}^n (\widehat{y}_i-\bar{y})^2}{k}}{\frac{\sum_{i=1}^n (y_{i}-\widehat{y})^2}{n-k-1}} = \frac{\frac{SCE}{k}}{\frac{SCR}{n-k-1}} = \frac{\frac{R^2}{k}} {\frac{1-R^2}{n-k-1}} = \frac{(n-k-1)R^2}{k(1-R^2)}
\tag{7.10}\]</span></span></p>
<p><span id="eq-regmRMSE"><span class="math display">\[
RMSE = \sqrt{\frac{\sum_{i=1}^n (y_{i}-\widehat{y})^2}{n}} = \sqrt{\frac{SCR}{n}}
\tag{7.11}\]</span></span></p>
</div>
</div>
<p>Globalement, plus un modèle de régression est efficace, plus les valeurs du R<sup>2</sup> et de la statistique <em>F</em> sont élevées et inversement, plus celle de RMSE est faible. En effet, remarquez qu’à l’<a href="#eq-regmFFisher">équation&nbsp;<span>7.10</span></a>, la statistique <em>F</em> peut être obtenue à partir du R<sup>2</sup>; par conséquent, plus la valeur du R<sup>2</sup> est forte (proche de 1), plus celle de <em>F</em> est aussi élevée. Notez aussi que plus un modèle est performant, plus la partie expliquée par le modèle (SCE) est importante et plus celle non expliquée (SCR) est faible; ce qui signifie que plus le R<sup>2</sup> est proche de 1 (<a href="#eq-regmR2">équation&nbsp;<span>7.9</span></a>), plus le RMSE – calculé à partir du SCR – est faible (<a href="#eq-regmRMSE">équation&nbsp;<span>7.11</span></a>).</p>
<p>La syntaxe R ci-dessous illustre comment calculer les différentes variances (SCT, SCE et SCR) à partir des valeurs observées et prédites par le modèle, puis les valeurs du R<sup>2</sup>, de <em>F</em> et du RMSE. Nous verrons par la suite qu’il est possible d’obtenir directement ces valeurs à partir de la fonction <code>summary(VotreModele)</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Chargement des données</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/lm/DataVegetation.RData"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Construction du modèle de régression</span></span>
<span><span class="va">Modele1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="va">HABHA</span><span class="op">+</span><span class="va">AgeMedian</span><span class="op">+</span><span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span>, data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Nombre d'observations </span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">)</span></span>
<span><span class="co"># Nombre de variables indépendantes (coefficients moins la constante)</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Modele1</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="co"># Vecteur pour les valeurs observées</span></span>
<span><span class="va">Yobs</span> <span class="op">&lt;-</span> <span class="va">DataFinal</span><span class="op">$</span><span class="va">VegPct</span></span>
<span><span class="co"># Vecteur pour les valeurs prédites</span></span>
<span><span class="va">Ypredit</span> <span class="op">&lt;-</span> <span class="va">Modele1</span><span class="op">$</span><span class="va">fitted.values</span></span>
<span><span class="co"># Variance totale</span></span>
<span><span class="va">SCT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Yobs</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Yobs</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># Variance expliquée</span></span>
<span><span class="va">SCE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Ypredit</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Yobs</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># Variance résidelle</span></span>
<span><span class="va">SCR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Yobs</span><span class="op">-</span><span class="va">Ypredit</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#  Calcul du coefficient de détermination (R2)</span></span>
<span><span class="va">R2</span> <span class="op">&lt;-</span> <span class="va">SCE</span> <span class="op">/</span> <span class="va">SCT</span></span>
<span><span class="co">#  Calcul de la valeur de F</span></span>
<span><span class="va">valeurF</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">R2</span> <span class="op">/</span> <span class="va">k</span><span class="op">)</span> <span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">R2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="va">k</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"R2 ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">SCE</span> <span class="op">/</span> <span class="va">SCT</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>    <span class="st">"\nF de Fisher = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">valeurF</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="st">"\nRMSE ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">SCR</span><span class="op">/</span> <span class="va">n</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R2 = 0.4182 
F de Fisher =  1223 
RMSE = 14.1575</code></pre>
</div>
</div>
</section><section id="sec-0732" class="level3" data-number="7.3.2"><h3 data-number="7.3.2" class="anchored" data-anchor-id="sec-0732">
<span class="header-section-number">7.3.2</span> Comparaison des modèles incrémentiels</h3>
<p>Tel que signalé plus haut, il est fréquent de construire plusieurs modèles de régression imbriqués. Cette démarche est très utile pour évaluer l’apport de l’introduction d’un nouveau bloc de variables dans un modèle. De manière exploratoire, cela permet également de vérifier si l’introduction d’une variable indépendante supplémentaire dans un modèle a ou non un apport significatif et ainsi de décider de la conserver, ou non, dans le modèle final selon le principe de parcimonie.</p>
<div class="bloc_notes">
<div class="bloc_notes-header">
<div class="bloc_notes-icon">

</div>
<p><strong>Le principe de parcimonie</strong></p>
</div>
<div class="bloc_notes-body">
<p>Le principe de parcimonie appliqué aux régressions correspond à l’idée qu’il est préférable de disposer d’un <strong>modèle plus simple</strong> que d’un <strong>modèle compliqué</strong> pour expliquer un phénomène si la qualité de leurs prédictions – qualité d’ajustement des deux modèles – est équivalente.</p>
<p>Une première justification de ce principe trouve son origine dans la philosophie des sciences avec le <strong>rasoir d’Ockham</strong>. Il s’agit d’un principe selon lequel il est préférable de privilégier des théories faisant appel à un plus petit nombre d’hypothèses. L’idée centrale étant d’éviter d’apporter des réponses à une question qui soulèveraient davantage de nouvelles questions. Dans le cas d’une régression, nous pourrions être tenté d’ajouter de nombreuses variables indépendantes pour améliorer la capacité de prédiction du modèle. Cette stratégie conduit généralement à observer des relations contraires à nos connaissances entre les variables du modèle, ce qui soulève de nouvelles questions de recherche (pas toujours judicieuses…). Dans notre quotidien, si une casserole tombe de son support, il est plus raisonnable d’imaginer que nous l’avions mal fixée que d’émettre l’hypothèse qu’un fantôme l’a volontairement fait tomber! Cette seconde hypothèse soulève d’autres questions (pas toujours judicieuses…) sur la nature d’un fantôme, son identité, la raison le poussant à agir, etc.</p>
<p>Une seconde justification de ce principe s’observe dans la pratique statistique&nbsp;: des modèles plus complexes ont souvent une plus faible capacité de généralisation. En effet, un modèle complexe et trop bien ajusté aux données observées est souvent incapable d’effectuer des prédictions justes pour de nouvelles données. Ce phénomène est appelé surajustement ou surinterprétation (<em>overfitting</em> en anglais). Le surajustement résultant de modèles trop complexes entre en conflit direct avec l’enjeu principal de l’inférence en statistique&nbsp;: pouvoir généraliser des observations faites sur un échantillon au reste d’une population.</p>
<p>Notez que ce principe de parcimonie ne signifie pas que vous devez systématiquement retirer toutes les variables non significatives de votre analyse. En effet, il peut y avoir un intérêt théorique à démontrer l’absence de relation entre des variables. Il s’agit plutôt d’une ligne de conduite à garder à l’esprit lors de l’élaboration du cadre théorique et de l’interprétation des résultats.</p>
</div>
</div>
<p>Mathématiquement, plus nous ajoutons de variables supplémentaires dans un modèle, plus le R<sup>2</sup> augmente. On ne peut donc pas utiliser directement le R<sup>2</sup> pour comparer deux modèles de régression ne comprenant pas le même nombre de variables indépendantes. Nous privilégions alors l’utilisation du R<sup>2</sup> ajusté qui, comme illustré dans l’<a href="#eq-R2ajuste">équation&nbsp;<span>7.12</span></a>, tient compte à la fois des nombres d’observations et des variables indépendantes utilisées pour construire le modèle.</p>
<p><span id="eq-R2ajuste"><span class="math display">\[
R^2_{\text {ajusté}}= 1 - \frac{(1-R^2)(n-1)}{n-k-1} \mbox{ avec } R^2_{\text {ajusté}} \in \left[0,1\right]
\tag{7.12}\]</span></span></p>
<p>Si le R<sup>2</sup> ajusté du second modèle est supérieur au premier modèle, cela signifie qu’il y a un gain de la variance expliquée entre le premier et le second modèle. Ce gain est-il pour autant significatif? Pour y répondre, il convient de comparer les valeurs des statistiques <em>F</em> des deux modèles. Pour ce faire, nous calculons le <em>F</em> incrémentiel et la valeur de <em>p</em> qui lui est associé avec comme degrés de liberté, le nombre de variables indépendantes ajoutées (<span class="math inline">\(k_2-k_1\)</span>) et <span class="math inline">\(n-k_2-1\)</span>. Si la valeur de <em>p</em>&nbsp;&lt;&nbsp;0,05, nous pouvons conclure que le gain de variance expliquée par le second modèle est significatif comparativement au premier modèle (au seuil de 5&nbsp;%).</p>
<p><span id="eq-Fincrementiel"><span class="math display">\[
F_{\text {incrémentiel}}= \frac{\frac{R^2_2-R^2_1}{k_2-k_1}} {\frac{1-R^2_2}{n-k_2-1}}
\tag{7.13}\]</span></span></p>
<p>avec <span class="math inline">\(R^2_1\)</span> et <span class="math inline">\(R^2_2\)</span> étant les coefficients de détermination des modèles 1 et 2 et <span class="math inline">\(k_1\)</span> et <span class="math inline">\(k_2\)</span> étant les nombres de variables indépendantes qu’ils comprennent (<span class="math inline">\(k_2 &gt; k_1\)</span>).</p>
<p>Illustrons le tout avec deux modèles. Dans la syntaxe R ci-dessous, nous avons construit un premier modèle avec uniquement les variables de contrôle (<code>modele1</code>), soit deux variables indépendantes (<code>HABHA</code> et <code>AgeMedian</code>). Puis, dans un second modèle (<code>modele2</code>), nous ajoutons comme variables indépendantes les pourcentages des quatre groupes de population (<code>Pct_014</code>, <code>Pct_65P</code>, <code>Pct_MV</code>, <code>Pct_FR</code>). Repérez comment sont calculés les R<sup>2</sup> ajustés pour les modèles et le <em>F</em> incrémentiel.</p>
<p>Le R<sup>2</sup> ajusté passe de 0,269 à 0,418 des modèles 1 à 2 signalant que l’ajout des quatre variables indépendantes augmente considérablement la variance expliquée. Autrement dit, le second modèle est bien plus performant. Le <em>F</em> incrémentiel s’élève à 653,8 et est significatif (<em>p</em> &lt; 0,001). Notez que la syntaxe ci-dessous illustre comment calculer les valeurs du R<sup>2</sup> ajusté et du <em>F</em> incrémentiel à partir des équations <a href="#eq-R2ajuste"><span>7.12</span></a> et <a href="#eq-Fincrementiel"><span>7.13</span></a>. Sachez toutefois qu’il est possible d’obtenir directement le R<sup>2</sup> ajusté avec la fonction <code>summary(VotreModele)</code> et le <em>F</em> incrémentiel avec la fonction <code>anova(modele1, modele2)</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modele1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="va">HABHA</span><span class="op">+</span><span class="va">AgeMedian</span>, data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span><span class="va">modele2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="va">HABHA</span><span class="op">+</span><span class="va">AgeMedian</span><span class="op">+</span><span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span>, data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># nombre d'observations pour les deux modèles</span></span>
<span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">modele1</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span></span>
<span><span class="va">n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">modele2</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># nombre de variables indépendantes</span></span>
<span><span class="va">k1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">modele1</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">k2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">modele2</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span></span>
<span><span class="co"># coefficient de détermination</span></span>
<span><span class="va">R2m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele1</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span></span>
<span><span class="va">R2m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele2</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span></span>
<span></span>
<span><span class="co"># coefficient de détermination ajusté</span></span>
<span><span class="va">R2ajustm1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">n1</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">R2m1</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n1</span><span class="op">-</span><span class="va">k1</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">R2ajustm2</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">n2</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">R2m2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n2</span><span class="op">-</span><span class="va">k2</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Statistique F</span></span>
<span><span class="va">Fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele1</span><span class="op">)</span><span class="op">$</span><span class="va">fstatistic</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">Fm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele2</span><span class="op">)</span><span class="op">$</span><span class="va">fstatistic</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># F incrémentiel</span></span>
<span><span class="va">Fincrementiel</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">R2m2</span><span class="op">-</span><span class="va">R2m1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">k2</span> <span class="op">-</span> <span class="va">k1</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">R2m2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">n2</span><span class="op">-</span><span class="va">k2</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pFinc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">pf</a></span><span class="op">(</span><span class="va">Fincrementiel</span>, <span class="va">k2</span><span class="op">-</span><span class="va">k1</span>, <span class="va">n2</span><span class="op">-</span><span class="va">k2</span><span class="op">-</span><span class="fl">1</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nR2 (modèle 1) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">R2m1</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>    <span class="st">"; R2 ajusté = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">R2ajustm1</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>    <span class="st">"; F ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Fm1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="st">"\nR2 (modèle 2) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">R2m2</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>    <span class="st">"; R2 ajusté = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">R2ajustm2</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>    <span class="st">"; F ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Fm2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="st">"\nF incrémentiel ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Fincrementiel</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>    <span class="st">"; p = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">pFinc</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
R2 (modèle 1) = 0.2691 ; R2 ajusté =  0.269 ; F = 1879.2 
R2 (modèle 2) = 0.4182 ; R2 ajusté =  0.4179 ; F = 1222.5 
F incrémentiel = 653.8 ; p =  0</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># F incrémentiel avec la fonction anova</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">modele1</span>, <span class="va">modele2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: VegPct ~ HABHA + AgeMedian
Model 2: VegPct ~ HABHA + AgeMedian + Pct_014 + Pct_65P + Pct_MV + Pct_FR
  Res.Df     RSS Df Sum of Sq     F    Pr(&gt;F)    
1  10207 2570964                                 
2  10203 2046427  4    524537 653.8 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section></section><section id="sec-074" class="level2" data-number="7.4"><h2 data-number="7.4" class="anchored" data-anchor-id="sec-074">
<span class="header-section-number">7.4</span> Différentes mesures pour les coefficients de régression</h2>
<p>La fonction <code>summary(nom du modèle)</code> permet d’obtenir les résultats du modèle de régression. D’emblée, signalons que le modèle est globalement significatif (<em>F</em>(6,&nbsp;10203)&nbsp;=&nbsp;1123, <em>p</em>&nbsp;=&nbsp;0,000) avec un R<sup>2</sup> de 0,4182 indiquant que les variables indépendantes du modèle expliquent 41,82&nbsp;% de la variance du pourcentage de végétation dans les îlots de l’île de Montréal.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelereg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="va">HABHA</span><span class="op">+</span><span class="va">AgeMedian</span><span class="op">+</span><span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span>, data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelereg</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VegPct ~ HABHA + AgeMedian + Pct_014 + Pct_65P + 
    Pct_MV + Pct_FR, data = DataFinal)

Residuals:
    Min      1Q  Median      3Q     Max 
-48.876  -9.757  -0.232   9.499 103.830 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 26.355774   0.882235  29.874   &lt;2e-16 ***
HABHA       -0.070401   0.002202 -31.975   &lt;2e-16 ***
AgeMedian    0.010790   0.006369   1.694   0.0902 .  
Pct_014      1.084478   0.032179  33.702   &lt;2e-16 ***
Pct_65P      0.400531   0.018835  21.265   &lt;2e-16 ***
Pct_MV      -0.031112   0.010406  -2.990   0.0028 ** 
Pct_FR      -0.348256   0.011640 -29.918   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.16 on 10203 degrees of freedom
Multiple R-squared:  0.4182,    Adjusted R-squared:  0.4179 
F-statistic:  1223 on 6 and 10203 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<section id="sec-0741" class="level3" data-number="7.4.1"><h3 data-number="7.4.1" class="anchored" data-anchor-id="sec-0741">
<span class="header-section-number">7.4.1</span> Coefficients de régression&nbsp;: évaluer l’effet des variables indépendantes</h3>
<p>Les différents résultats pour les coefficients sont reportés au <a href="#tbl-dataregmodel2">tableau&nbsp;<span>7.2</span></a>.</p>
<p><strong>La constante</strong> (<span class="math inline">\(\beta_0\)</span>) est la valeur attendue de la variable dépendante (<em>Y</em>) quand les valeurs de toutes les variables indépendantes sont égales à 0. Pour ce modèle, quand les variables indépendantes sont égales à 0, plus du quart de la superficie des îlots serait en moyenne couverte par de la végétation (<span class="math inline">\(\beta_0\)</span>&nbsp;=&nbsp;26,36). Notez que la constante n’a pas toujours une interprétation pratique. Il est par exemple très invraisemblable d’avoir un îlot avec de la population dans lequel il n’y aurait aucune personne à faible revenu, aucune personne ne déclarant appartenir à une minorité visible, aucun enfant de moins de 15 ans et aucune personne âgée de 65 ans et plus. La constante a donc avant tout un rôle mathématique dans le modèle.</p>
<p><strong>Le coefficient de régression</strong> (<span class="math inline">\(\beta_1\)</span> à <span class="math inline">\(\beta_k\)</span>) indique le changement de la variable dépendante (<em>Y</em>) lorsque la variable indépendante augmente d’une unité, toutes choses étant égales par ailleurs. Il permet ainsi d’évaluer l’effet d’une augmentation d’une unité dans laquelle est mesurée la VI sur la VD.</p>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Que signifie l’expression <em>toutes choses étant égales par ailleurs</em> pour un coefficient de régression?</strong></p>
</div>
<div class="bloc_attention-body">
<p>Après l’apprentissage du grec, grâce aux nombreuses équations intégrées au livre, passons au latin! L’expression <em>toutes choses étant égales par ailleurs</em> vient du latin <em>ceteris paribus</em>, à ne pas confondre avec <em>c’est terrible Paris en bus</em> (petite blague formulée par un étudiant ayant suivi le cours <em>Méthodes quantitatives appliquées en études urbaines</em> à l’INRS il y a quelques années)! Certains auteurs emploient encore <em>ceteris paribus</em>&nbsp;: il est donc possible que vous la retrouviez dans un article scientifique…</p>
<p>Plus sérieusement, l’expression <em>toutes choses étant égales par ailleurs</em> signifie que l’on estime l’effet de la variable indépendante sur la variable dépendante, si toutes les autres variables indépendantes restent constantes ou autrement dit, une fois contrôlés tous les autres prédicteurs.</p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-dataregmodel2" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;7.2: Différentes mesures pour les coefficients</caption>
<colgroup>
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 7%">
<col style="width: 15%">
<col style="width: 17%">
<col style="width: 5%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Coef.</th>
<th style="text-align: right;">Erreur type</th>
<th style="text-align: right;">Valeur de T</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;">coef. 2,5 %</th>
<th style="text-align: right;">coef. 97,5 %</th>
<th style="text-align: right;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Constante</td>
<td style="text-align: right;">26,356</td>
<td style="text-align: right;">0,882</td>
<td style="text-align: right;">29,870</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">24,626</td>
<td style="text-align: right;">28,085</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">HABHA</td>
<td style="text-align: right;">-0,070</td>
<td style="text-align: right;">0,002</td>
<td style="text-align: right;">-31,970</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">-0,075</td>
<td style="text-align: right;">-0,066</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AgeMedian</td>
<td style="text-align: right;">0,011</td>
<td style="text-align: right;">0,006</td>
<td style="text-align: right;">1,690</td>
<td style="text-align: right;">0,090</td>
<td style="text-align: right;">-0,002</td>
<td style="text-align: right;">0,023</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_014</td>
<td style="text-align: right;">1,084</td>
<td style="text-align: right;">0,032</td>
<td style="text-align: right;">33,700</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">1,021</td>
<td style="text-align: right;">1,148</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_65P</td>
<td style="text-align: right;">0,401</td>
<td style="text-align: right;">0,019</td>
<td style="text-align: right;">21,260</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,364</td>
<td style="text-align: right;">0,437</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_MV</td>
<td style="text-align: right;">-0,031</td>
<td style="text-align: right;">0,010</td>
<td style="text-align: right;">-2,990</td>
<td style="text-align: right;">0,003</td>
<td style="text-align: right;">-0,052</td>
<td style="text-align: right;">-0,011</td>
<td style="text-align: right;">**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_FR</td>
<td style="text-align: right;">-0,348</td>
<td style="text-align: right;">0,012</td>
<td style="text-align: right;">-29,920</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">-0,371</td>
<td style="text-align: right;">-0,325</td>
<td style="text-align: right;">***</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>À partir des coefficients du <a href="#tbl-dataregmodel2">tableau&nbsp;<span>7.2</span></a>, l’équation du modèle de régression s’écrit alors comme suit&nbsp;:</p>
<p><code>VegPct = 26,356 − 0,070 HABHA  + 0,011 AgeMedian + 1,084 Pct_014 + 0,401 Pct_65P −0,031 Pct_MV − 0,348 Pct_FR + e</code></p>
<p><strong>Comment interpréter un coefficient de régression pour une variable indépendante?</strong></p>
<p>Le signe du coefficient de régression indique si la variable indépendante est associée positivement ou négativement avec la variable dépendante. Par exemple, plus la densité de population est importante à travers les îlots de l’île de Montréal, plus la couverture végétale diminue.</p>
<p>Quant à la valeur absolue du coefficient, elle indique la taille de l’effet du prédicteur. Par exemple, 1,084 signifie que si toutes les autres variables indépendantes restent constantes, alors le pourcentage de végétation dans l’îlot augmente de 1,084 points de pourcentage pour chaque différence d’un point de pourcentage d’enfants de moins de 15&nbsp;ans. Toutes choses étant égales par ailleurs, une augmentation de 10&nbsp;% d’enfants dans un îlot entraîne alors une hausse de 10,8&nbsp;% de la couverture végétale dans l’îlot.</p>
<p>L’analyse des coefficients montre ainsi qu’une fois contrôlées les deux caractéristiques relatives à la forme urbaine (densité de population et âge médian des bâtiments), plus les pourcentages d’enfants et de personnes âgées sont élevés, plus la couverture végétale de l’îlot est importante (B&nbsp;=&nbsp;1,084 et 0,401), toutes choses étant égales par ailleurs. À l’inverse, de plus grands pourcentages de personnes à faible revenu et de minorités sont associés à une plus faible couverture végétale (B&nbsp;=&nbsp;−0,348 et −0,031).</p>
<p><strong>L’erreur type du coefficient de régression</strong></p>
<p>L’erreur type d’un coefficient permet d’évaluer son niveau de précision, soit le degré d’incertitude vis-à-vis du coefficient. Succinctement, elle correspond à l’écart-type de l’estimation (coefficient); elle est ainsi toujours positive. Plus la valeur de l’erreur type est faible, plus l’estimation du coefficient est précise. Notez toutefois qu’il n’est pas judicieux de comparer les erreurs types des coefficients pour des variables exprimées dans des unités de mesure différentes.</p>
<p>Comme nous le verrons plus loin, l’utilité principale de l’erreur type est qu’elle permet de calculer la valeur de <em>t</em> et l’intervalle de confiance du coefficient de régression.</p>
</section><section id="sec-0742" class="level3" data-number="7.4.2"><h3 data-number="7.4.2" class="anchored" data-anchor-id="sec-0742">
<span class="header-section-number">7.4.2</span> Coefficients de régression standardisés&nbsp;: repérer les variables les plus importantes du modèle</h3>
<p>Un coefficient de régression est exprimé dans les unités de mesure des variables indépendante (VI) et dépendante (VD)&nbsp;: une augmentation d’une unité de la VI a un effet de <span class="math inline">\(\beta\)</span> (valeur de coefficient) unité de mesure sur la VD, toutes choses étant égales par ailleurs. Prenons l’exemple d’un modèle fictif dans lequel une variable indépendante mesurée en mètres obtient un coefficient de régression de 0,000502. Si cette variable était exprimée en kilomètres et non en mètres, son coefficient serait alors de 0,502 (<span class="math inline">\(0,000502 \times 1000 = 0,502\)</span>). Cela explique que pour certaines variables, il est souvent préférable de modifier l’unité de mesure, particulièrement pour les variables de distance ou de revenu. Par exemple, dans un modèle de régression, nous introduisons habituellement une variable de revenu par tranche de mille dollars ou le loyer mensuel par tranche de cent dollars, puisque les coefficients du revenu ou de loyer exprimé en dollars risquent d’être extrêmement faibles. Concrètement, cela signifie que nous divisons la variable <em>revenu</em> par 1000 et celle du <em>loyer</em> par 100 avant de l’introduire dans le modèle.</p>
<p>Du fait de leur unités de mesure souvent différentes, vous aurez compris que nous ne pouvons pas comparer directement les coefficients de régression afin de repérer la ou les variables indépendantes (<em>X</em>) qui ont les effets (impacts) les plus importants sur la variable dépendante (<em>Y</em>). Pour remédier à ce problème, nous utilisons les <strong>coefficients de régression standardisés</strong>. Ces coefficients standardisés sont simplement les valeurs de coefficients de régression qui seraient obtenus si toutes les variables du modèle (VD et VI) étaient préalablement centrées réduites (soit avec une moyenne égale à 0 et un écart-type égal à 1; consultez la <a href="02-univarie.html#sec-02552">section&nbsp;<span>2.5.5.2</span></a> pour un rappel). Puisque toutes les variables du modèle sont exprimées en écarts-types, les coefficients standardisés permettent ainsi d’évaluer <strong>l’effet relatif</strong> des VI sur la VD. Cela permet ainsi de repérer la ou les variables les plus «&nbsp;importantes&nbsp;» du modèle.</p>
<p><strong>L’interprétation d’un coefficient de régression standardisé est donc la suivante&nbsp;: il indique le changement en termes d’unités d’écart-type de la variable dépendante (Y) à chaque ajout d’un écart-type de la variable indépendante, toutes choses étant égales par ailleurs</strong>.</p>
<p>Le coefficient de régression standardisé peut être aussi facilement calculé en utilisant les écarts-types des deux variables VI et VD&nbsp;:</p>
<p><span id="eq-CoefStand"><span class="math display">\[
\beta_{z}= \beta \frac{s_x}{s_y}
\tag{7.14}\]</span></span></p>
<p>La syntaxe R ci-dessous illustre trois façons d’obtenir les coefficients standardisés&nbsp;:</p>
<ul>
<li><p>en centrant et réduisant préalablement les variables avec la fonction <code>scale</code> avant de construire le modèle avec la fonction <code>lm</code>;</p></li>
<li><p>en calculant les écarts-types de VD et de VI et en appliquant l’<a href="#eq-CoefStand">équation&nbsp;<span>7.14</span></a>;</p></li>
<li><p>avec la fonction <code>lm.beta</code> du <em>package</em> <code>QuantPsyc</code>. Cette dernière méthode est moins «&nbsp;verbeuse&nbsp;» (deux lignes de code uniquement), mais nécessite de charger un <em>package</em> supplémentaire.</p></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Modèle de régression</span></span>
<span><span class="va">Modele1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="va">HABHA</span><span class="op">+</span><span class="va">AgeMedian</span><span class="op">+</span><span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span>, data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#  Méthode 1 : lm sur des variables centrées réduites</span></span>
<span><span class="va">ModeleZ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">VegPct</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">HABHA</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">AgeMedian</span><span class="op">)</span><span class="op">+</span></span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">Pct_014</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">Pct_65P</span><span class="op">)</span><span class="op">+</span></span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">Pct_MV</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">Pct_FR</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span><span class="va">coefs</span> <span class="op">&lt;-</span> <span class="va">ModeleZ</span><span class="op">$</span><span class="va">coefficients</span></span>
<span><span class="va">coefs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">coefs</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     (Intercept)     scale(HABHA) scale(AgeMedian)   scale(Pct_014) 
    3.721649e-16    -2.806891e-01     1.467299e-02     3.093456e-01 
  scale(Pct_65P)    scale(Pct_MV)    scale(Pct_FR) 
    1.788453e-01    -2.755087e-02    -3.004544e-01 </code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#  Méthode 2 : à partir de l'équation</span></span>
<span><span class="co"># Écart-type de la variable dépendante</span></span>
<span><span class="va">VDet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">VegPct</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Écart-type de Y ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">VDet</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Écart-type de Y = 18.562</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Écarts-types des variables indépendantes</span></span>
<span><span class="va">VI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HABHA"</span> , <span class="st">"AgeMedian"</span> , <span class="st">"Pct_014"</span> , <span class="st">"Pct_65P"</span> , <span class="st">"Pct_MV"</span> , <span class="st">"Pct_FR"</span><span class="op">)</span></span>
<span><span class="va">VIet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">[</span><span class="va">VI</span><span class="op">]</span>, <span class="va">sd</span><span class="op">)</span></span>
<span><span class="co"># Coefficients de régression du modèle sans la constante</span></span>
<span><span class="va">coefs</span> <span class="op">&lt;-</span> <span class="va">Modele1</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">VIet</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co"># Coefficients de régression du modèle</span></span>
<span><span class="va">coefstand</span> <span class="op">&lt;-</span> <span class="va">coefs</span> <span class="op">*</span> <span class="op">(</span><span class="va">VIet</span> <span class="op">/</span> <span class="va">VDet</span><span class="op">)</span></span>
<span><span class="va">coefstand</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      HABHA   AgeMedian     Pct_014     Pct_65P      Pct_MV      Pct_FR 
-0.28068906  0.01467299  0.30934560  0.17884535 -0.02755087 -0.30045437 </code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#  Méthode 3 : avec la fonction lm.beta du package QuantPsyc</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">QuantPsyc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/QuantPsyc/man/lm.beta.html">lm.beta</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="va">HABHA</span><span class="op">+</span><span class="va">AgeMedian</span><span class="op">+</span><span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span>, data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      HABHA   AgeMedian     Pct_014     Pct_65P      Pct_MV      Pct_FR 
-0.28068906  0.01467299  0.30934560  0.17884535 -0.02755087 -0.30045437 </code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-CoefStand2" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;7.3: Calcul des coefficients standardisés</caption>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Variable dépendante</th>
<th style="text-align: right;">Écart-type</th>
<th style="text-align: right;">Coef.</th>
<th style="text-align: right;">Coef. standardisé</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">HABHA</td>
<td style="text-align: left;">HABHA</td>
<td style="text-align: right;">74,008</td>
<td style="text-align: right;">-0,070</td>
<td style="text-align: right;">-0,281</td>
</tr>
<tr class="even">
<td style="text-align: left;">AgeMedian</td>
<td style="text-align: left;">AgeMedian</td>
<td style="text-align: right;">25,241</td>
<td style="text-align: right;">0,011</td>
<td style="text-align: right;">0,015</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_014</td>
<td style="text-align: left;">Pct_014</td>
<td style="text-align: right;">5,295</td>
<td style="text-align: right;">1,084</td>
<td style="text-align: right;">0,309</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_65P</td>
<td style="text-align: left;">Pct_65P</td>
<td style="text-align: right;">8,289</td>
<td style="text-align: right;">0,401</td>
<td style="text-align: right;">0,179</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_MV</td>
<td style="text-align: left;">Pct_MV</td>
<td style="text-align: right;">16,438</td>
<td style="text-align: right;">-0,031</td>
<td style="text-align: right;">-0,028</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_FR</td>
<td style="text-align: left;">Pct_FR</td>
<td style="text-align: right;">16,015</td>
<td style="text-align: right;">-0,348</td>
<td style="text-align: right;">-0,300</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Par exemple, pour la variable <code>Pct_014</code>, le coefficient de régression standardisé est égal à&nbsp;:</p>
<p><span id="eq-CoefStand2"><span class="math display">\[
\beta_{z}= 1,084 \times \frac{5,295}{18,562}=0,309
\tag{7.15}\]</span></span></p>
<p>avec 1,084 étant le coefficient de régression de <code>Pct_014</code>, 5,295 et 18,562 étant respectivement les écarts-types de <code>Pct_014</code> (variable indépendante) et de <code>VegPct</code> (variable dépendante).</p>
<p>Au <a href="#tbl-CoefStand2">tableau&nbsp;<span>7.3</span></a>, nous constatons que la valeur absolue du coefficient de régression pour <code>HABHA</code> est inférieure à celle de <code>Pct_65P</code> (−0,070 <em>versus</em> 0,401), ce qui n’est pas le cas pour leur coefficient standardisé (−0,281 <em>versus</em> 0,179). Rappelez-vous aussi que nous ne pouvons pas directement comparer les effets de ces deux variables à partir des coefficients de régression puisqu’elles sont exprimées dans des unités de mesure différentes&nbsp;: <code>HABHA</code> est exprimée en habitants par hectare et <code>Pct_65P</code> en pourcentage. À la lecture des coefficients standardisés, nous pouvons en conclure que la variable <code>HABHA</code> a un effet relatif plus important que <code>Pct_65P</code> (−0,281 <em>versus</em> 0,179).</p>
</section><section id="sec-0743" class="level3" data-number="7.4.3"><h3 data-number="7.4.3" class="anchored" data-anchor-id="sec-0743">
<span class="header-section-number">7.4.3</span> Significativité des coefficients de régression&nbsp;: valeurs de <em>t</em> et de <em>p</em>
</h3>
<p>Une fois les coefficients de régression obtenus, il convient de vérifier s’ils sont ou non significativement différents de 0. Si le coefficient de régression d’une variable indépendante est significativement différent de 0, nous concluons que la variable a un effet significatif sur la variable dépendante, toutes choses étant égales par ailleurs. Pour ce faire, il suffit de calculer la valeur de <em>t</em> qui est simplement le coefficient de régression divisé par son erreur type.</p>
<p><span id="eq-ValeurT"><span class="math display">\[
t=\frac{\beta_k - 0}{s(\beta_k)}  
\tag{7.16}\]</span></span></p>
<p>avec <span class="math inline">\(s(\beta_k)\)</span> étant l’erreur type du coefficient de régression. Notez que dans l’<a href="#eq-ValeurT">équation&nbsp;<span>7.16</span></a>, nous indiquons habituellement <span class="math inline">\(-0\)</span>, pour signaler que l’on veut vérifier si le coefficient est différent de 0. En guise d’exemple, au <a href="#tbl-dataregmodel2">tableau&nbsp;<span>7.2</span></a>, la valeur de <em>t</em> de la variable <code>HABHA</code> est bien égale à&nbsp;:</p>
<p><span class="math inline">\(\mbox{−0,070401 / 0,002202 = −31,975}\)</span>.</p>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Démarche pour vérifier si un coefficient est significativement différent de 0</strong></p>
</div>
<div class="bloc_attention-body">
<ol type="1">
<li><p>Poser l’hypothèse nulle (<em>H<sub>0</sub></em>) stipulant que le coefficient est égal à 0, soit <span class="math inline">\(H_0 : \beta_k = 0\)</span>. L’hypothèse alternative (<em>H<sub>1</sub></em>) est que le coefficient est différent de 0, soit <span class="math inline">\(H_1 : B_k \neq 0\)</span>.</p></li>
<li><p>Calculer la valeur de <em>t</em>, soit le coefficient de régression divisé par son erreur type (<a href="#eq-ValeurT">équation&nbsp;<span>7.16</span></a>).</p></li>
<li><p>Calculer le nombre de degrés de liberté, soit <span class="math inline">\(dl = n − k - 1\)</span>, <em>n</em> et <em>k</em> étant respectivement les nombres d’observations et de variables indépendantes.</p></li>
<li><p>Choisir un seuil de signification alpha (5&nbsp;%, 1&nbsp;% ou 0,1&nbsp;%, soit <em>p</em>&nbsp;=&nbsp;0,05, 0,01 ou 0,01).</p></li>
<li><p>Trouver la valeur critique de <em>t</em> dans la table T de Student (<a href="14-Annexes.html#sec-143">section&nbsp;<span>14.3</span></a>) avec <em>p</em> et le nombre de degrés de liberté (<em>dl</em>).</p></li>
<li><p>Valider ou réfuter l’hypothèse nulle (<em>H<sub>0</sub></em>)&nbsp;:</p></li>
</ol>
<ul>
<li><p>si la valeur de <em>t</em> est inférieure à la valeur critique de <em>t</em> avec <em>dl</em> et le seuil choisi, nous confirmons <em>H<sub>0</sub></em>&nbsp;: le coefficient n’est pas significativement différent de 0.</p></li>
<li><p>si la valeur de <em>t</em> est supérieure à la valeur critique de <em>t</em> avec <em>dl</em> et le seuil choisi, nous réfutons l’hypothèse nulle, et choisissons l’hypothèse alternative (<em>H<sub>1</sub></em>) stipulant que le coefficient est significativement différent de 0.</p></li>
</ul>
<p><strong>Valeurs critiques de la valeur de <em>t</em> à retenir!</strong></p>
<p>Lorsque le nombre de degrés de liberté (<em>n − k - 1</em>) est très important (supérieur à 2500), et donc le nombre d’observations de votre jeu de données, nous retenons habituellement les valeurs critiques suivantes&nbsp;: <strong>1,65 (<em>p</em>&nbsp;=&nbsp;0,10), 1,96 (<em>p</em>&nbsp;=&nbsp;0,05)</strong>, <strong>2,58 (<em>p</em>&nbsp;=&nbsp;0,01)</strong> et <strong>3,29 (<em>p</em>=0,001)</strong>. Concrètement, cela signifie que&nbsp;:</p>
<ul>
<li><p>une valeur de <em>t</em> supérieure à 1,96 ou inférieure à -1,96 nous informe que la relation entre la variable indépendante et la variable dépendante est significative positivement ou négativement au seuil de 5&nbsp;%. Autrement dit, vous avez moins de 5&nbsp;% de chances de vous tromper en affirmant que le coefficient de régression est bien significativement différent de 0.</p></li>
<li><p>une valeur de <em>t</em> supérieure à 2,58 ou inférieure à -2,58 nous informe que la relation entre la variable indépendante et la variable dépendante est significative positivement ou négativement au seuil de 5&nbsp;%. Autrement dit, vous avez moins de 1&nbsp;% de chances de vous tromper en affirmant que le coefficient de régression est bien significativement différent de 0.</p></li>
<li><p>une valeur de <em>t</em> supérieure à 3,29 ou inférieure à -3,29 nous informe que la relation entre la variable indépendante et la variable dépendante est significative positivement ou négativement au seuil de 5&nbsp;%. Autrement dit, vous avez moins de 0,1&nbsp;% de chances de vous tromper en affirmant que le coefficient de régression est bien significativement différent de 0.</p></li>
</ul>
<p>Concrètement, retenez et utilisez les seuils de <span class="math inline">\(\pm\mbox{1,96}\)</span>, <span class="math inline">\(\pm\mbox{2,58}\)</span> et <span class="math inline">\(\pm\mbox{3,29}\)</span> pour repérer les variables significatives positivement ou négativement aux seuils respectifs de 0,5, 0,1 et 0,001.</p>
<p><strong>Que signifient les seuils 0,10, 0,05 et 0,001?</strong></p>
<p>L’interprétation exacte des seuils de significativité des coefficients d’une régression est quelque peu alambiquée, mais mérite de s’y attarder. En effet, indiquer qu’un coefficient est significatif est souvent perçu comme un argument fort pour une théorie, il est donc nécessaire d’avoir du recul et de bien comprendre ce que l’on entend par <strong>significatif</strong>.</p>
<p>Si un coefficient est significatif au seuil de 5&nbsp;% dans notre modèle, cela signifie que si, pour l’ensemble d’une population, la valeur du coefficient est de 0 en réalité, alors nous avions moins de 5&nbsp;% de chances de collecter un échantillon (pour cette population) ayant produit un coefficient aussi fort que celui que nous observons dans notre propre échantillon. Par conséquent, il serait très invraisemblable que le coefficient soit 0 puisque nous avons effectivement collecté un tel échantillon. Il s’agit d’une forme d’argumentation par l’absurde propre à la statistique fréquentiste.</p>
<p>Notez que si 100 études étaient conduites sur le même sujet et dans les mêmes conditions, nous nous attendrions à ce que 5 d’entre elles trouvent un coefficient significatif, du fait de la variation des échantillons. Ce constat souligne le fait que la recherche est un effort collectif et qu’une seule étude n’est pas suffisante pour trancher sur un sujet. Les revues systématiques de la littérature sont donc des travaux particulièrement importants pour la construction du consensus scientifique.</p>
<p><strong>Ne pas confondre significativité et effet de la variable indépendante</strong></p>
<p>Attention, un coefficient significatif n’est pas toujours intéressant! Autrement dit, bien qu’il soit significatif à un seuil donné (par exemple, <em>p</em>&nbsp;=&nbsp;0,05), cela ne veut pas dire pour autant qu’il ait un effet important sur la variable dépendante. Il faut donc analyser simultanément les valeurs de <em>p</em> et des coefficients de régression. Afin de mieux saisir l’effet d’un coefficient significatif, il est intéressant de représenter graphiquement l’effet marginal d’une variable indépendante (VI) sur une variable dépendante (VD), une fois contrôlées les autres VI du modèle de régression (<a href="#sec-0774">section&nbsp;<span>7.7.4</span></a>).</p>
</div>
</div>
<p>Prenons deux variables indépendantes du <a href="#tbl-dataregmodel2">tableau&nbsp;<span>7.2</span></a> – <code>HABHA</code> et <code>AgeMedian</code> – et vérifions si leurs coefficients de régression respectifs (−0,070 et 0,011) sont significatifs. Appliquons la démarche décrite dans l’encadré ci-dessus&nbsp;:</p>
<ol type="1">
<li><p>Nous posons l’hypothèse nulle stipulant que la valeur de ces deux coefficients est égale à 0, soit <span class="math inline">\(H_0 : \beta_k = 0\)</span>.</p></li>
<li><p>La valeur de <em>t</em> est égale à <code>−0,070401 / 0,002202 = −31,97139</code> pour <code>HABHA</code> et à <code>0,010790 / 0,006369 = 1,694144</code> pour <code>AgeMedian</code>.</p></li>
<li><p>Le nombre de degrés de liberté est égal à <span class="math inline">\(\mbox{dl} = \mbox{n}-\mbox{k}-\mbox{1} = \mbox{10 210} − \mbox{6} - \mbox{1} = \mbox{10 203}\)</span>.</p></li>
<li><p>Nous choisissons respectivement les seuils <span class="math inline">\(\alpha\)</span> de 0,10, 0,05, 0,01 ou 0,001.</p></li>
<li><p>Avec 10210 degrés de liberté, les valeurs critiques de la table T de Student (<a href="13-MethodeClassification.html#sec-133">section&nbsp;<span>13.3</span></a>) sont de 1,65 (<em>p</em>&nbsp;=&nbsp;0,10), 1,96 (<em>p</em>&nbsp;=&nbsp;0,05), 2,58 (<em>p</em>&nbsp;=&nbsp;0,01), 3,29 (<em>p</em>&nbsp;=&nbsp;0,001).</p></li>
<li><p>Il reste à valider ou réfuter l’hypothèse nulle (<em>H<sub>0</sub></em>)&nbsp;:</p></li>
</ol>
<ul>
<li><p>pour <code>HABHA</code>, la valeur absolue de <em>t</em> (−31,975) est supérieure à la valeur critique de 3,29. Son coefficient de régression est donc significativement différent de 0. Autrement dit, ce prédicteur a un effet significatif et négatif sur la variable dépendante.</p></li>
<li><p>pour <code>AgeMedian</code>, la valeur absolue de <em>t</em> (1,694) est supérieure à 1,65 (<em>p</em>&nbsp;=&nbsp;0,10), mais inférieure à 1,96 (<em>p</em>&nbsp;=&nbsp;0,05), à 2,58 (<em>p</em>&nbsp;=&nbsp;0,01), à 3,29 (<em>p</em>&nbsp;=&nbsp;0,001). Par conséquent, ce coefficient est différent de 0 uniquement au seuil de <em>p</em>&nbsp;=&nbsp;0,10 et non au seuil de <em>p</em>&nbsp;=&nbsp;0,05. Cela signifie que bous avons un peu moins de 10&nbsp;% de chances de se tromper en affirmant que cette variable a un effet significatif sur la variable dépendante.</p></li>
</ul>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>Calculer et obtenir des valeurs de <em>p</em> dans R</strong></p>
</div>
<div class="bloc_astuce-body">
<p>Il est très rare d’utiliser la table <em>T</em> de Student pour obtenir un seuil de significativité. D’une part, il est possible de calculer directement la valeur de <em>p</em> à partir de la valeur de <em>t</em> et du nombre de degrés de liberté avec la fonction <code>pt</code> avec les paramètres suivants&nbsp;:</p>
<p><code>pt(q= abs(valeur de T), df= nombre de degrés de liberté, lower.tail = FALSE) *2</code></p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Degrés de liberté</span></span>
<span><span class="va">dl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Modele1</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Valeurs de T</span></span>
<span><span class="va">ValeurT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Modele1</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Calcul des valeurs de P</span></span>
<span><span class="va">ValeurP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span>q<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">ValeurT</span><span class="op">)</span>, df<span class="op">=</span> <span class="va">dl</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">*</span><span class="fl">2</span></span>
<span></span>
<span><span class="va">df_tp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>                ValeurT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ValeurT</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>                ValeurP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ValeurP</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df_tp</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            ValeurT ValeurP
(Intercept)  29.874   0.000
HABHA       -31.975   0.000
AgeMedian     1.694   0.090
Pct_014      33.702   0.000
Pct_65P      21.265   0.000
Pct_MV       -2.990   0.003
Pct_FR      -29.918   0.000</code></pre>
</div>
</div>
<p>D’autre part, la fonction <code>summary</code> renvoie d’emblée les valeurs de <em>t</em> et de <em>p</em>. Par convention, R, comme la plupart des logiciels d’analyses statistiques, utilise aussi des symboles pour indiquer le seuil de signification du coefficient (voir <a href="#tbl-CoefStand2">tableau&nbsp;<span>7.3</span></a>)&nbsp;:</p>
<p>’***’ <em>p</em> &lt;= 0,001</p>
<p>’**’ <em>p</em> &lt;= 0,01</p>
<p>’*’ <em>p</em> &lt;= 0,05</p>
<p>‘.’ <em>p</em> &lt;= 0,10</p>
</div>
</div>
</section><section id="sec-0744" class="level3" data-number="7.4.4"><h3 data-number="7.4.4" class="anchored" data-anchor-id="sec-0744">
<span class="header-section-number">7.4.4</span> Intervalle de confiance des coefficients</h3>
<p>Finalement, il est possible de calculer l’intervalle de confiance d’un coefficient à partir d’un niveau de signification (habituellement 0,95 ou encore 0,99). Pour ce faire, la fonction <code>confint(nom du modèle, level=.95)</code> est très utile. L’intérêt de ces intervalles de confiance pour les coefficients de régression est double&nbsp;:</p>
<ul>
<li><p>Il permet de vérifier si le coefficient est ou non significatif au seuil retenu. Pour cela, la borne inférieure et la borne supérieure du coefficient doivent être toutes deux négatives ou positives. À l’inverse, un intervalle à cheval sur 0, soit avec une borne inférieure négative et une borne supérieure positive, n’est pas significatif.</p></li>
<li><p>Il permet d’estimer la précision de l’estimation; plus l’intervalle du coefficient est réduit, plus l’estimation de l’effet de la variable indépendante est précise. Inversement, un intervalle large signale que le coefficient est incertain.</p></li>
</ul>
<p>Cela explique que de nombreux auteurs reportent les intervalles de confiance dans les articles scientifiques (habituellement à 95&nbsp;%). Dans le modèle présenté ici, il est alors possible d’écrire&nbsp;: toutes choses étant égales par ailleurs, le pourcentage d’enfants de moins de 15 ans est positivement et significativement associé avec le pourcentage de la couverture végétale dans l’îlot (B&nbsp;=&nbsp;1,084; IC 95&nbsp;% = [1,021 - 1,148], <em>p</em>&nbsp;&lt;&nbsp;0,001).</p>
<p>En guise d’exemple, à la lecture de la sortie R ci-dessous, l’estimation de l’effet de la variable indépendante <code>AgeMedian</code> sur la variable <code>VegPct</code> se situe dans l’intervalle -0,002 à 0,023 qui est à cheval sur 0. Contrairement aux autres variables, nous ne pouvons donc pas en conclure que cet effet est significatif avec <em>p</em>&nbsp;=&nbsp;0,05.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Intervalle de confiance à 95 % des coefficients</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">Modele1</span>, level<span class="op">=</span><span class="fl">.95</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             2.5 % 97.5 %
(Intercept) 24.626 28.085
HABHA       -0.075 -0.066
AgeMedian   -0.002  0.023
Pct_014      1.021  1.148
Pct_65P      0.364  0.437
Pct_MV      -0.052 -0.011
Pct_FR      -0.371 -0.325</code></pre>
</div>
</div>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>Comment est calculé un intervalle de confiance?</strong></p>
</div>
<div class="bloc_astuce-body">
<p>L’intervalle du coefficient est obtenu à partir de&nbsp;:</p>
<ol type="1">
<li><p>la valeur du coefficient (<span class="math inline">\(\beta_k\)</span>),</p></li>
<li><p>la valeur de son erreur type <span class="math inline">\(s(\beta_k)\)</span> et</p></li>
<li><p>la valeur critique de T (<span class="math inline">\(t_{\alpha/2}\)</span>) obtenue avec <span class="math inline">\(n-k-1\)</span> degrés de liberté et le niveau de significativité retenu (95&nbsp;%, 99&nbsp;% ou 99,9&nbsp;%).</p></li>
</ol>
<p><span id="eq-ICcoef"><span class="math display">\[
IC_{\beta_k}=  \left[ \beta_k - t_{\alpha/2} \times s(\beta_k) ; \beta_k + t_{\alpha/2} \times s(\beta_k)  \right]
\tag{7.17}\]</span></span></p>
<p>Autrement dit, lorsque vous disposez d’un nombre très important d’observations, les intervalles de confiance s’écrivent simplement avec les fameuses valeurs critiques de T de 1,96, 2,58, 3,29&nbsp;:</p>
<p><span id="eq-IC95"><span class="math display">\[
\mbox{Intervalle à 95 \%\: } IC_{\beta_k}=  \left[ \beta_k - 1,96 \times s(\beta_k) ; \beta_k + 1,96 \times s(\beta_k)  \right]
\tag{7.18}\]</span></span></p>
<p><span id="eq-IC99"><span class="math display">\[
\mbox{Intervalle à 99 \%\: } IC_{\beta_k}=  \left[ \beta_k - 2,58 \times s(\beta_k) ; \beta_k + 2,58 \times s(\beta_k)  \right]
\tag{7.19}\]</span></span></p>
<p><span id="eq-IC999"><span class="math display">\[
\mbox{Intervalle à 99,9 \%\: } IC_{\beta_k}=  \left[ \beta_k - 3,29 \times s(\beta_k) ; \beta_k + 3,29 \times s(\beta_k)  \right]
\tag{7.20}\]</span></span></p>
<p>La syntaxe R ci-dessous illustre comment calculer les intervalles de confiance à 95&nbsp;% à partir de l’<a href="#eq-ICcoef">équation&nbsp;<span>7.17</span></a>. Rappelez-vous toutefois qu’il est bien plus simple d’utiliser la fonction <code>confint</code>:</p>
<ul>
<li><code>round(confint(Modele1, level=.95),3)</code></li>
<li><code>round(confint(Modele1, level=.99),3)</code></li>
<li><code>round(confint(Modele1, level=.999),3)</code></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Coeffients de régression</span></span>
<span><span class="va">coefs</span> <span class="op">&lt;-</span> <span class="va">Modele1</span><span class="op">$</span><span class="va">coefficients</span></span>
<span></span>
<span><span class="co"># Erreur type des coef.</span></span>
<span><span class="va">coefs_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Modele1</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Nombre de degrés de liberté</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Modele1</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Modele1</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">dl</span> <span class="op">&lt;-</span> <span class="va">n</span><span class="op">-</span><span class="va">k</span><span class="op">-</span><span class="fl">1</span></span>
<span></span>
<span><span class="co"># valeurs critiques de T</span></span>
<span><span class="va">t95</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">0.05</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,  df<span class="op">=</span><span class="va">dl</span><span class="op">)</span></span>
<span><span class="va">t99</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">0.01</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,  df<span class="op">=</span><span class="va">dl</span><span class="op">)</span></span>
<span><span class="va">t99.9</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">0.001</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,  df<span class="op">=</span><span class="va">dl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Valeurs critiques de T en fonction du niveau de confiance"</span>,</span>
<span>    <span class="st">"\n et du nombre de degrés de liberté"</span>,</span>
<span>    <span class="st">"\n95 % : "</span>, <span class="va">t95</span>,</span>
<span>    <span class="st">"\n99 % : "</span>, <span class="va">t99</span>,</span>
<span>    <span class="st">"\n99,9 % : "</span>, <span class="va">t99.9</span></span>
<span>    <span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Valeurs critiques de T en fonction du niveau de confiance 
 et du nombre de degrés de liberté 
95 % :  1.960197 
99 % :  2.576311 
99,9 % :  3.291481</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Intervalle de confiance à 95</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  IC2.5  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">coefs</span><span class="op">-</span><span class="va">t95</span><span class="op">*</span><span class="va">coefs_se</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>  IC97.5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">coefs</span><span class="op">+</span><span class="va">t95</span><span class="op">*</span><span class="va">coefs_se</span>,<span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             IC2.5 IC97.5
(Intercept) 24.626 28.085
HABHA       -0.075 -0.066
AgeMedian   -0.002  0.023
Pct_014      1.021  1.148
Pct_65P      0.364  0.437
Pct_MV      -0.052 -0.011
Pct_FR      -0.371 -0.325</code></pre>
</div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Intervalle de confiance à 99</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  IC0.5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">coefs</span><span class="op">-</span><span class="va">t99</span><span class="op">*</span><span class="va">coefs_se</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>  IC99.5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">coefs</span><span class="op">+</span><span class="va">t99</span><span class="op">*</span><span class="va">coefs_se</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             IC0.5 IC99.5
(Intercept) 24.083 28.629
HABHA       -0.076 -0.065
AgeMedian   -0.006  0.027
Pct_014      1.002  1.167
Pct_65P      0.352  0.449
Pct_MV      -0.058 -0.004
Pct_FR      -0.378 -0.318</code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Intervalle de confiance à 99.9</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  IC0.05 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">coefs</span><span class="op">-</span><span class="va">t99.9</span><span class="op">*</span><span class="va">coefs_se</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>  IC99.95 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">coefs</span><span class="op">+</span><span class="va">t99.9</span><span class="op">*</span><span class="va">coefs_se</span>,<span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            IC0.05 IC99.95
(Intercept) 23.452  29.260
HABHA       -0.078  -0.063
AgeMedian   -0.010   0.032
Pct_014      0.979   1.190
Pct_65P      0.339   0.463
Pct_MV      -0.065   0.003
Pct_FR      -0.387  -0.310</code></pre>
</div>
</div>
</div>
</div>
</section></section><section id="sec-075" class="level2" data-number="7.5"><h2 data-number="7.5" class="anchored" data-anchor-id="sec-075">
<span class="header-section-number">7.5</span> Introduction de variables explicatives particulières</h2>
<section id="sec-0751" class="level3" data-number="7.5.1"><h3 data-number="7.5.1" class="anchored" data-anchor-id="sec-0751">
<span class="header-section-number">7.5.1</span> Exploration des relations non linéaires</h3>
<section id="sec-07511" class="level4" data-number="7.5.1.1"><h4 data-number="7.5.1.1" class="anchored" data-anchor-id="sec-07511">
<span class="header-section-number">7.5.1.1</span> Variable indépendante avec une fonction polynomiale</h4>
<p>Dans la <a href="04-bivarieeQuantiQuanti.html#sec-041">section&nbsp;<span>4.1</span></a>, nous avons vu que la relation entre deux variables continues n’est pas toujours linéaire; elle peut être aussi curvilinéaire. Pour explorer les relations curvilinéaires, nous introduisons la variable indépendante sous la forme polynomiale d’ordre 2 (voir le prochain encadré). L’équation de régression s’écrit alors&nbsp;:</p>
<p><span id="eq-regpolyordre2"><span class="math display">\[
Y = b_{0} + b_{1}X_{1} + b_{11}X_{1}^2 + b_{2}X_{2} +\ldots+ b_{k}X_{k} + e
\tag{7.21}\]</span></span></p>
<p>Dans l’<a href="#eq-regpolyordre2">équation&nbsp;<span>7.21</span></a>, la première variable indépendante est introduite dans le modèle de régression à la fois dans sa forme originelle et mise au carré&nbsp;: <span class="math inline">\(b_{1}X_{1} + b_{11}X_{1}^2\)</span>. Un coefficient différent est ajusté pour chacune de ces deux versions de la variable <span class="math inline">\(X_{1}\)</span>.</p>
<p>La démographie est probablement la discipline des sciences sociales qui a le plus recours aux régressions polynomiales. En effet, la variable <code>âge</code> est souvent introduite comme variable explicative dans sa forme originale et mise au carré. L’objectif est de vérifier si l’âge partage ou non une relation curvilinéaire avec un phénomène donné&nbsp;: par exemple, il pourrait y être associé positivement jusqu’à un certain seuil (45 ans par exemple), puis négativement à partir de ce seuil.</p>
<div class="bloc_aller_loin">
<div class="bloc_aller_loin-header">
<div class="bloc_aller_loin-icon">

</div>
<p><strong>Régression polynomiale et nombre d’ordres</strong></p>
</div>
<div class="bloc_aller_loin-body">
<p>Sachez qu’il est aussi possible de construire des régressions polynomiales avec plus de deux ordres. Par exemple, une régression polynomiale d’ordre 3 comprend une variable dans sa forme originelle, puis mise au carré et au cube. Cela a l’inconvénient d’augmenter corollairement le nombre de coefficients. Nous verrons au <a href="11-GAM.html">chapitre&nbsp;<span>11</span></a> qu’il existe une solution plus élégante et efficace&nbsp;: le recours aux modèles de régressions linéaires généralisés additifs avec des <em>splines</em>. Dans le cadre de cette section, nous nous limitons à des régressions polynomiales d’ordre 2.</p>
<p><span id="eq-regpolyordre2b"><span class="math display">\[
\mbox{Ordre 2 : } Y = b_{0} + b_{1}X_{1} + b_{11}X_{}^2 + b_{2}X_{2} +\ldots+ b_{k}X_{k} + e
\tag{7.22}\]</span></span></p>
<p><span id="eq-regpolyordre3"><span class="math display">\[
\mbox{Ordre 3 : } Y = b_{0} + b_{1}X_{1} + b_{11}X_{}^2 + b_{111}X_{}^3 + b_{2}X_{2} +\ldots+ b_{k}X_{k} + e
\tag{7.23}\]</span></span></p>
<p><span id="eq-regpolyordre4"><span class="math display">\[
\mbox{Ordre 4 : } Y = b_{0} + b_{1}X_{1} + b_{11}X_{}^2 + b_{111}X_{}^3 + b_{1111}X_{}^4 + b_{2}X_{2} +\ldots+ b_{k}X_{k} + e
\tag{7.24}\]</span></span></p>
</div>
</div>
<p>Pour construire une régression polynomiale dans R, il est possible d’utiliser deux fonctions de R&nbsp;:</p>
<ul>
<li>
<code>I(VI^2)</code> avec <code>VI</code> qui est la variable indépendante sur laquelle est appliquée la mise au carré.</li>
<li>
<code>poly(VI,2)</code> qui utilise une forme polynomiale orthogonale pour éviter les problèmes de corrélation entre les deux termes, c’est-à-dire entre <strong>VI</strong> et <strong>VI<sup>2</sup></strong>.</li>
</ul>
<p>Ces deux méthodes produisent les mêmes résultats pour les autres variables dépendantes et pour la qualité d’ajustement du modèle (R<sup>2</sup>, F, etc.). Nous privilégions la seconde fonction pour éviter de détecter à tort des problèmes de multicolinéarité excessive.</p>
<p>Appliquons cette démarche à la variable <code>AgeMedian</code> (âge médian des bâtiments) afin de vérifier si elle partage ou non une relation curvilinéaire avec la couverture végétale de l’îlot. À la lecture des résultats pour les deux modèles, les constats suivants peuvent être avancés&nbsp;:</p>
<ul>
<li><p>Le R<sup>2</sup> ajusté passe de 0,4179 à 0,4378 du modèle 1 au modèle 2, ce qui signale un gain de variance expliquée.</p></li>
<li><p>Le <em>F</em> incrémentiel entre les deux modèles s’élève à 362,64 et est significatif (<em>p</em>&nbsp;&lt;&nbsp;0,001). Nous pouvons donc en conclure que le second modèle est plus performant que le premier, ce qui signale que la forme curvilinéaire pour <code>AgeMedian</code> (modèle 2) est plus efficace que la forme linéaire (modèle 1).</p></li>
<li><p>Dans le premier modèle, le coefficient de régression pour <code>AgeMedian</code> n’est pas significatif. L’âge médian des bâtiments n’est donc pas associé linéairement avec la variable dépendante.</p></li>
<li><p>Dans le second modèle, la valeur du coefficient de <code>poly(AgeMedian, 2)1</code> est positive et celle de <code>poly(AgeMedian, 2)2</code> est négative et significative. Cela indique qu’il existe une relation linéaire en forme de U inversé. Si le premier coefficient avait été négatif et le second positif, nous aurions alors conclu que la forme curvilinéaire prend la forme d’un U.</p></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># régression linéaire</span></span>
<span><span class="va">modele1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="va">HABHA</span><span class="op">+</span><span class="va">AgeMedian</span><span class="op">+</span><span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span>, data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span><span class="co"># régression polynomiale</span></span>
<span><span class="va">modele2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="va">HABHA</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">AgeMedian</span>,<span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span>, data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span><span class="co"># affichage des résultats du modèle 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VegPct ~ HABHA + AgeMedian + Pct_014 + Pct_65P + 
    Pct_MV + Pct_FR, data = DataFinal)

Residuals:
    Min      1Q  Median      3Q     Max 
-48.876  -9.757  -0.232   9.499 103.830 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 26.355774   0.882235  29.874   &lt;2e-16 ***
HABHA       -0.070401   0.002202 -31.975   &lt;2e-16 ***
AgeMedian    0.010790   0.006369   1.694   0.0902 .  
Pct_014      1.084478   0.032179  33.702   &lt;2e-16 ***
Pct_65P      0.400531   0.018835  21.265   &lt;2e-16 ***
Pct_MV      -0.031112   0.010406  -2.990   0.0028 ** 
Pct_FR      -0.348256   0.011640 -29.918   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.16 on 10203 degrees of freedom
Multiple R-squared:  0.4182,    Adjusted R-squared:  0.4179 
F-statistic:  1223 on 6 and 10203 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># affichage des résultats du modèle 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VegPct ~ HABHA + poly(AgeMedian, 2) + Pct_014 + 
    Pct_65P + Pct_MV + Pct_FR, data = DataFinal)

Residuals:
    Min      1Q  Median      3Q     Max 
-49.659  -9.361  -0.159   9.034 105.160 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          2.968e+01  7.535e-01  39.383  &lt; 2e-16 ***
HABHA               -7.107e-02  2.164e-03 -32.839  &lt; 2e-16 ***
poly(AgeMedian, 2)1  1.134e+01  1.598e+01   0.710  0.47788    
poly(AgeMedian, 2)2 -2.721e+02  1.429e+01 -19.043  &lt; 2e-16 ***
Pct_014              9.969e-01  3.196e-02  31.198  &lt; 2e-16 ***
Pct_65P              3.219e-01  1.896e-02  16.972  &lt; 2e-16 ***
Pct_MV              -2.888e-02  1.023e-02  -2.823  0.00476 ** 
Pct_FR              -3.562e-01  1.145e-02 -31.116  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.92 on 10202 degrees of freedom
Multiple R-squared:  0.4382,    Adjusted R-squared:  0.4378 
F-statistic:  1137 on 7 and 10202 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># test de Fisher pour comparer les modèles</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">modele1</span>, <span class="va">modele2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: VegPct ~ HABHA + AgeMedian + Pct_014 + Pct_65P + Pct_MV + Pct_FR
Model 2: VegPct ~ HABHA + poly(AgeMedian, 2) + Pct_014 + Pct_65P + Pct_MV + 
    Pct_FR
  Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    
1  10203 2046427                                  
2  10202 1976182  1     70245 362.64 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Construction d’un graphique des effets marginaux</strong></p>
<p>Pour visualiser la relation linéaire et curvilinéaire, nous vous proposons de réaliser un graphique des effets marginaux à partir de la syntaxe ci-dessous.</p>
<p>Les graphiques des effets marginaux permettent de visualiser l’impact d’une variable indépendante sur la variable dépendante d’une régression. Nous nous basons pour cela sur les prédictions effectuées par le modèle. Admettons que nous nous intéressons à l’effet de la variable <em>X<sub>1</sub></em> sur la variable <em>Y</em>. Il est possible de créer de nouvelles données fictives pour lesquelles l’ensemble des autres variables <em>X</em> sont fixées à leur moyenne respective, et seule <em>X<sub>1</sub></em> est autorisée à varier. En utilisant l’équation de régression du modèle sur ces données fictives, nous pouvons observer l’évolution de la valeur prédite de <em>Y</em> quand <em>X<sub>1</sub></em> augmente ou diminue, et ce, toutes choses étant égales par ailleurs (puisque toutes les autres variables ont une valeur fixe). Cette approche est particulièrement intéressante pour décrire des effets non linéaires obtenus avec des polynomiales, mais aussi des interactions comme nous le verrons plus tard. Elle est également utilisée dans les modèles linéaires généralisés (GLM) et additifs (GAM) (chapitres <a href="08-GLM.html"><span>8</span></a> et <a href="11-GAM.html"><span>11</span></a>). Notez qu’il est aussi important de représenter, sur ce type de graphique, l’incertitude de la prédiction. Pour cela, il est possible de construire des intervalles de confiance à 95&nbsp;% autour de la prédiction en utilisant l’erreur standard de la prédiction (renvoyée par la fonction <code>predict</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co"># Statistique sur la variable AgeMedian qui varie de 0 à 226 ans</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">AgeMedian</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00   37.25   49.00   52.11   61.00  226.00 </code></pre>
</div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Création d'un DataFrame temporaire</span></span>
<span><span class="co"># remarquez que les autres variables indépendantes sont constantes :</span></span>
<span><span class="co"># nous leur avons attribué leur moyenne correspondante</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  HABHA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">HABHA</span><span class="op">)</span>,</span>
<span>  AgeMedian<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  AgeMedian2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span>,</span>
<span>  Pct_014<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">Pct_014</span><span class="op">)</span>,</span>
<span>  Pct_65P<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">Pct_65P</span><span class="op">)</span>,</span>
<span>  Pct_MV<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">Pct_MV</span><span class="op">)</span>,</span>
<span>  Pct_FR<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">Pct_FR</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcul de la valeur de t pour un intervalle à 95 %</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">modele1</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span> </span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">modele1</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">t95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">0.05</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,  df<span class="op">=</span><span class="va">n</span><span class="op">-</span><span class="va">k</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcul des valeurs prédites pour le 1er modèle</span></span>
<span><span class="co"># avec l'intervalle de confiance à 95 %</span></span>
<span><span class="va">predsM1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">modele1</span>, se <span class="op">=</span> <span class="cn">TRUE</span>, newdata <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">predM1</span> <span class="op">&lt;-</span> <span class="va">predsM1</span><span class="op">$</span><span class="va">fit</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">lowerM1</span> <span class="op">&lt;-</span> <span class="va">predsM1</span><span class="op">$</span><span class="va">fit</span> <span class="op">-</span> <span class="va">t95</span><span class="op">*</span><span class="va">predsM1</span><span class="op">$</span><span class="va">se.fit</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">upperM1</span> <span class="op">&lt;-</span> <span class="va">predsM1</span><span class="op">$</span><span class="va">fit</span> <span class="op">+</span> <span class="va">t95</span><span class="op">*</span><span class="va">predsM1</span><span class="op">$</span><span class="va">se.fit</span></span>
<span></span>
<span><span class="co"># Calcul des valeurs prédites pour le 2e modèle</span></span>
<span><span class="co"># avec l'intervalle de confiance à 95 %</span></span>
<span><span class="va">predsM2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">modele2</span>, se <span class="op">=</span> <span class="cn">TRUE</span>, newdata <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">predM2</span> <span class="op">&lt;-</span> <span class="va">predsM2</span><span class="op">$</span><span class="va">fit</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">lowerM2</span> <span class="op">&lt;-</span> <span class="va">predsM2</span><span class="op">$</span><span class="va">fit</span> <span class="op">-</span> <span class="va">t95</span><span class="op">*</span><span class="va">predsM2</span><span class="op">$</span><span class="va">se.fit</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">upperM2</span> <span class="op">&lt;-</span> <span class="va">predsM2</span><span class="op">$</span><span class="va">fit</span> <span class="op">+</span> <span class="va">t95</span><span class="op">*</span><span class="va">predsM2</span><span class="op">$</span><span class="va">se.fit</span></span>
<span></span>
<span><span class="co"># Graphique</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">AgeMedian</span>, ymin <span class="op">=</span> <span class="va">lowerM1</span>, ymax <span class="op">=</span> <span class="va">upperM1</span><span class="op">)</span>, </span>
<span>             fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">AgeMedian</span>, y <span class="op">=</span> <span class="va">predM1</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">AgeMedian</span>, ymin <span class="op">=</span> <span class="va">lowerM2</span>, ymax <span class="op">=</span> <span class="va">upperM2</span><span class="op">)</span>, </span>
<span>              fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">AgeMedian</span>, y <span class="op">=</span> <span class="va">predM2</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Effet marginal de l'âge médian des bâtiments sur la"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"couverture végétale des îlots de l'île de Montréal"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"bleu : relation linéaire; rouge : curvilinéaire"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Âge médian des bâtiments"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Couverture végétale (%)"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-calculRegPoly2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-calculRegPoly2-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.2: Relations linéaire et curvilinéaire</figcaption></figure>
</div>
</div>
</div>
<p>La <a href="#fig-calculRegPoly2">figure&nbsp;<span>7.2</span></a> démontre bien que la relation linéaire n’est pas significative&nbsp;: la pente est extrêmement faible, ce qui signale que l’effet de l’âge médian est presque nul (B&nbsp;=&nbsp;0,0108, <em>p</em>&nbsp;=&nbsp;0,0902). En revanche, la relation curvilinéaire est plus intéressante&nbsp;: la couverture végétale croît quand l’âge médian des bâtiments dans l’îlot augmente de 0 à 60&nbsp;ans environ, puis elle décroît.</p>
</section><section id="sec-07512" class="level4" data-number="7.5.1.2"><h4 data-number="7.5.1.2" class="anchored" data-anchor-id="sec-07512">
<span class="header-section-number">7.5.1.2</span> Variable indépendante sous forme logarithmique</h4>
<p>Une autre manière d’explorer une relation non linéaire est d’intégrer la variable sous forme logarithmique <span class="citation" data-cites="hanck2019introduction">(<a href="references.html#ref-hanck2019introduction" role="doc-biblioref">Hanck et al. 2019, 212‑218</a>)</span>. L’interprétation du coefficient de régression est alors plus complexe&nbsp;: 1&nbsp;% d’augmentation de la variable <span class="math inline">\(X_k\)</span> entraîne un changement de <span class="math inline">\(\mbox{0,01} \times \beta_k\)</span> de la variable dépendante. Autrement dit, il n’est plus exprimé dans les unités de mesure originales des deux variables.</p>
<p>Au <a href="#tbl-regmodeleLog">tableau&nbsp;<span>7.4</span></a>, le coefficient de <code>-6,855</code> pour la variable <code>logHABHA</code> s’interprète alors comme suit&nbsp;: un changement de 1&nbsp;% de la variable densité de population entraîne une diminution de <span class="math inline">\(\mbox{0,01} \times -\mbox{6,855 =} -\mbox{0,07}\)</span> de la couverture végétale dans l’île, toutes choses étant égales par ailleurs.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-regmodeleLog" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;7.4: Modèle avec une variable indépendante sous forme logarithmique</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 4%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Coef.</th>
<th style="text-align: right;">Erreur type</th>
<th style="text-align: right;">Valeur de T</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;">coef. 2,5 %</th>
<th style="text-align: right;">coef. 97,5 %</th>
<th style="text-align: right;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Constante</td>
<td style="text-align: right;">52,831</td>
<td style="text-align: right;">1,001</td>
<td style="text-align: right;">52,780</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">50,868</td>
<td style="text-align: right;">54,793</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">logHABHA</td>
<td style="text-align: right;">-6,855</td>
<td style="text-align: right;">0,168</td>
<td style="text-align: right;">-40,730</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">-7,185</td>
<td style="text-align: right;">-6,525</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AgeMedian ordre 1</td>
<td style="text-align: right;">11,985</td>
<td style="text-align: right;">15,586</td>
<td style="text-align: right;">0,770</td>
<td style="text-align: right;">0,442</td>
<td style="text-align: right;">-18,568</td>
<td style="text-align: right;">42,537</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">AgeMedian ordre 2</td>
<td style="text-align: right;">-286,144</td>
<td style="text-align: right;">13,942</td>
<td style="text-align: right;">-20,520</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">-313,473</td>
<td style="text-align: right;">-258,816</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_014</td>
<td style="text-align: right;">0,941</td>
<td style="text-align: right;">0,031</td>
<td style="text-align: right;">30,090</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,879</td>
<td style="text-align: right;">1,002</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_65P</td>
<td style="text-align: right;">0,306</td>
<td style="text-align: right;">0,019</td>
<td style="text-align: right;">16,550</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,270</td>
<td style="text-align: right;">0,343</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_MV</td>
<td style="text-align: right;">-0,036</td>
<td style="text-align: right;">0,010</td>
<td style="text-align: right;">-3,650</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">-0,056</td>
<td style="text-align: right;">-0,017</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_FR</td>
<td style="text-align: right;">-0,344</td>
<td style="text-align: right;">0,011</td>
<td style="text-align: right;">-31,210</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">-0,366</td>
<td style="text-align: right;">-0,323</td>
<td style="text-align: right;">***</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Puisque l’interprétation du coefficient de régression de <span class="math inline">\(log(\beta_k)\)</span> est plus complexe, il convient de s’assurer que son apport au modèle est justifié, et ce, de deux façons&nbsp;:</p>
<ul>
<li><p><strong>Comparez les mesures d’ajustement des deux modèles (surtout les R<sup>2</sup> ajustés)</strong>. Si le R<sup>2</sup> ajusté du modèle avec <span class="math inline">\(log(\beta_k)\)</span> est plus élevé que celui avec <span class="math inline">\(\beta_k\)</span>, alors la transformation logarithmique fait de votre variable indépendante un meilleur prédicteur, toutes choses étant égales par ailleurs.</p></li>
<li><p><strong>Construisez les graphiques des effets marginaux</strong> de votre variable afin de vérifier si la relation qu’elle partage avec votre VD est plutôt logarithmique que linéaire (<a href="#fig-EffetMarginalVariableLogEtNon">figure&nbsp;<span>7.3</span></a>). Notez que cette approche graphique peut aussi ne donner aucune indication lorsque vos données sont très dispersées ou que la relation est faible entre votre variable dépendante et indépendante.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/">ggeffects</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Modèles</span></span>
<span><span class="va">modele1a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="va">HABHA</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">AgeMedian</span>,<span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>              <span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span>, data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span><span class="va">modele1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">HABHA</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">AgeMedian</span>,<span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>              <span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span>, data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Valeurs prédites</span></span>
<span><span class="va">fit1a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">modele1a</span>, terms <span class="op">=</span> <span class="st">"HABHA"</span><span class="op">)</span></span>
<span><span class="va">fit1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">modele1b</span>, terms <span class="op">=</span> <span class="st">"HABHA"</span><span class="op">)</span></span>
<span><span class="co"># Graphiques</span></span>
<span><span class="va">G1a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fit1a</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DataFinal</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">HABHA</span>, y <span class="op">=</span> <span class="va">VegPct</span><span class="op">)</span>,</span>
<span>                 size <span class="op">=</span> <span class="fl">0.2</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.3</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Variable non transformée"</span>,</span>
<span>           y <span class="op">=</span> <span class="st">"VD: valeur prédite"</span>,</span>
<span>           x <span class="op">=</span> <span class="st">"Habitants km2"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">600</span><span class="op">)</span></span>
<span></span>
<span><span class="va">G1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fit1b</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DataFinal</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">HABHA</span>, y <span class="op">=</span> <span class="va">VegPct</span><span class="op">)</span>,</span>
<span>                 size <span class="op">=</span> <span class="fl">0.2</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.3</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Variable transformée (log)"</span>,</span>
<span>           y <span class="op">=</span> <span class="st">"VD: valeur prédite"</span>,</span>
<span>           x <span class="op">=</span> <span class="st">"Habitants km2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">G1aG1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">G1a</span>, <span class="va">G1b</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">G1aG1b</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-EffetMarginalVariableLogEtNon" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-EffetMarginalVariableLogEtNon-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.3: Effet marginal de la densité de population</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-0752" class="level3" data-number="7.5.2"><h3 data-number="7.5.2" class="anchored" data-anchor-id="sec-0752">
<span class="header-section-number">7.5.2</span> Variable indépendante qualitative dichotomique</h3>
<p>Il est très fréquent d’introduire une variable qualitative dichotomique comme variable explicative ou de contrôle dans un modèle. À titre de rappel, une variable dichotomique comprend deux modalités (<a href="02-univarie.html#sec-0212">section&nbsp;<span>2.1.2</span></a>).</p>
<p>Dans le modèle ci-dessous, nous voulons vérifier si un îlot situé sur le territoire de la ville de Montréal a proportionnellement moins de végétation qu’un îlot situé dans une autre municipalité de l’île de Montréal, toutes choses étant égales par ailleurs. Pour ce faire, nous créons une variable binaire dénommée <code>VilleMtl</code> qui prend la valeur de 1 pour les îlots de la ville de Montréal et 0 pour ceux d’une autre municipalité.</p>
<p>Nous obtenons ainsi un coefficient de régression pour <code>VilleMtl</code> de -7,699 (<a href="#tbl-regmodeleDich2">tableau&nbsp;<span>7.5</span></a>). Cela signifie que si toutes les autres variables indépendantes du modèle étaient constantes, alors un îlot de la ville de Montréal aurait en moyenne une valeur de -7,7&nbsp;% de moins de végétation comparativement à un îlot situé dans une autre municipalité.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Création d'une variable muette pour Montréal (0 ou 1)</span></span>
<span><span class="va">DataFinal</span><span class="op">$</span><span class="va">VilleMtl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">SDRNOM</span> <span class="op">==</span> <span class="st">"Montréal"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># Modèle avec la variable dichtonomique</span></span>
<span><span class="va">modele3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="va">VilleMtl</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">HABHA</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">AgeMedian</span>,<span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>              <span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span>, data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-regmodeleDich2" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;7.5: Modèle avec une variable dichotomique</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 4%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Coef.</th>
<th style="text-align: right;">Erreur type</th>
<th style="text-align: right;">Valeur de T</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;">coef. 2,5 %</th>
<th style="text-align: right;">coef. 97,5 %</th>
<th style="text-align: right;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Constante</td>
<td style="text-align: right;">57,676</td>
<td style="text-align: right;">1,009</td>
<td style="text-align: right;">57,140</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">55,697</td>
<td style="text-align: right;">59,654</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">VilleMtl</td>
<td style="text-align: right;">-7,699</td>
<td style="text-align: right;">0,377</td>
<td style="text-align: right;">-20,430</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">-8,438</td>
<td style="text-align: right;">-6,960</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">log(HABHA)</td>
<td style="text-align: right;">-6,174</td>
<td style="text-align: right;">0,168</td>
<td style="text-align: right;">-36,680</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">-6,504</td>
<td style="text-align: right;">-5,844</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">AgeMedian ordre 1</td>
<td style="text-align: right;">-14,871</td>
<td style="text-align: right;">15,334</td>
<td style="text-align: right;">-0,970</td>
<td style="text-align: right;">0,332</td>
<td style="text-align: right;">-44,929</td>
<td style="text-align: right;">15,186</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">AgeMedian ordre 2</td>
<td style="text-align: right;">-280,251</td>
<td style="text-align: right;">13,668</td>
<td style="text-align: right;">-20,500</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">-307,044</td>
<td style="text-align: right;">-253,459</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_014</td>
<td style="text-align: right;">0,794</td>
<td style="text-align: right;">0,031</td>
<td style="text-align: right;">25,230</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,732</td>
<td style="text-align: right;">0,856</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_65P</td>
<td style="text-align: right;">0,270</td>
<td style="text-align: right;">0,018</td>
<td style="text-align: right;">14,810</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">0,234</td>
<td style="text-align: right;">0,306</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_MV</td>
<td style="text-align: right;">-0,028</td>
<td style="text-align: right;">0,010</td>
<td style="text-align: right;">-2,890</td>
<td style="text-align: right;">0,004</td>
<td style="text-align: right;">-0,047</td>
<td style="text-align: right;">-0,009</td>
<td style="text-align: right;">**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_FR</td>
<td style="text-align: right;">-0,294</td>
<td style="text-align: right;">0,011</td>
<td style="text-align: right;">-26,550</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">-0,316</td>
<td style="text-align: right;">-0,273</td>
<td style="text-align: right;">***</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>Bien interpréter un coefficient d’une variable dichotomique</strong></p>
</div>
<div class="bloc_astuce-body">
<p>Nous avons vu que le coefficient de régression (<span class="math inline">\(\beta_k\)</span>) indique le changement de la variable dépendante (<em>Y</em>), lorsque la variable indépendante augmente d’une unité, toutes choses étant égales par ailleurs.</p>
<p>Pour une variable dichotomique, le coefficient indique le changement de <em>Y</em> quand les observations appartiennent à la modalité qui a la valeur de 1 (ici la ville de Montréal), comparativement à celle qui a la valeur de 0 (autres municipalités de l’île de Montréal), toutes choses étant égales par ailleurs.</p>
<p>La modalité qui a la valeur de 0 est alors appelée <strong>modalité ou catégorie de référence</strong>.</p>
<p>Autrement dit, si la variable avait été codée&nbsp;: 0 pour la ville de Montréal et 1 pour les autres municipalités, alors le coefficient aurait été de 7,699.</p>
<p>Pour éviter d’oublier quelle est la modalité de référence (valeur de 0), nous verrons plus tard (dans la section mise en œuvre des modèles de régression dans R (<a href="#sec-077">section&nbsp;<span>7.7</span></a>) qu’il peut être préférable de définir un facteur avec la fonction <code>as.factor</code> et d’indiquer la catégorie de référence avec la fonction <code>relevel(x, ref)</code>.</p>
</div>
</div>
<p>Comme pour une variable indépendante introduite avec une fonction polynomiale, il peut être très intéressant d’illustrer l’effet marginal de la variable dichotomique avec un graphique qui montre l’écart entre les moyennes des deux modalités, une fois contrôlées les autres variables indépendantes (<a href="#fig-EffetMarginalDich">figure&nbsp;<span>7.4</span></a>). Notez que dans ce graphique, les barres d’erreurs situées au sommet des rectangles représentent les intervalles à 95&nbsp;% des prédictions du modèle.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-EffetMarginalDich" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-EffetMarginalDich-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.4: Effet marginal d’une variable dichotomique</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-0753" class="level3" data-number="7.5.3"><h3 data-number="7.5.3" class="anchored" data-anchor-id="sec-0753">
<span class="header-section-number">7.5.3</span> Variable indépendante qualitative polytomique</h3>
<p>Il est possible d’introduire une variable qualitative polytomique comme variable explicative ou de contrôle dans un modèle. À titre de rappel, une variable polytomique comprend plus de deux modalités, qu’elle soit nominale ou ordinale (<a href="02-univarie.html#sec-0212">section&nbsp;<span>2.1.2</span></a>).</p>
<p>En guise d’exemple, une variable qualitative pourrait être&nbsp;: différents groupes de population (groupes d’âge, minorités visibles, catégories socioprofessionnelles, etc.), différents territoires ou régions (ville centrale, première couronne, deuxième couronne, etc.), une variable continue transformée en quatre ou cinq catégories ordinales selon les quartiles ou les quintiles.</p>
<section id="sec-07531" class="level4" data-number="7.5.3.1"><h4 data-number="7.5.3.1" class="anchored" data-anchor-id="sec-07531">
<span class="header-section-number">7.5.3.1</span> Comment construire un modèle de régression avec une variable explicative qualitative polytomique?</h4>
<p>Prenons l’exemple d’un modèle de régression comprenant deux variables indépendantes&nbsp;: l’une continue (<code>X1</code>), l’autre qualitative (<code>X2</code>) avec quatre modalités (A, B, C et D). L’introduction de la variable qualitative dans le modèle revient à&nbsp;:</p>
<ul>
<li><p>Transformer chaque modalité en variable muette (binaire). Nous avons ainsi quatre nouvelles variables binaires&nbsp;: <code>X2A</code>, <code>X2B</code>, <code>X2C</code> et <code>X2D</code>. Par exemple, pour <code>X2A</code>, les observations de la modalité <em>A</em> se verront affecter la valeur de 1 versus 0 pour les autres observations. La même démarche s’applique à <code>X2B</code>, <code>X2C</code> et <code>X2D</code> (voir <a href="#tbl-transfVarQMuettes">tableau&nbsp;<span>7.6</span></a>).</p></li>
<li><p>Toutes les modalités transformées en variables muettes sont introduites dans le modèle comme variables indépendantes <strong>sauf celle servant de catégorie de référence</strong>. Pourquoi sauf une? Si nous mettions toutes les modalités en variable muette, alors chaque observation serait repérée par une valeur de 1, «&nbsp;il y aurait alors une parfaite multicolinéarité et aucune solution unique pour les coefficients de régression ne pourrait être trouvée&nbsp;» <span class="citation" data-cites="bressoux2010">(<a href="references.html#ref-bressoux2010" role="doc-biblioref">Bressoux 2010, 128</a>)</span>.</p></li>
<li><p>Par exemple, si nous choisissons la modalité <em>A</em> comme catégorie de référence, l’équation de régression s’écrit alors&nbsp;:</p></li>
</ul>
<p><span id="eq-regvarpoly1"><span class="math display">\[
Y = b_{0} + b_{1}X_{1} + b_{2B}X_{2B} + b_{2C}X_{2C} + b_{2D}X_{2D}+ e
\tag{7.25}\]</span></span></p>
<ul>
<li>Vous aurez compris que choisir la modalité <em>D</em> comme catégorie de référence revient à écrire l’équation suivante&nbsp;:</li>
</ul>
<p><span id="eq-regvarpoly2"><span class="math display">\[
Y = b_{0} + b_{1}X_{1} + b_{2A}X_{2A} + b_{2B}X_{2B} + b_{2C}X_{2C} + e
\tag{7.26}\]</span></span></p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-transfVarQMuettes" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;7.6: Transformation d’une variable qualitative en variables muettes pour chaque modalité</caption>
<thead><tr class="header">
<th style="text-align: right;">obs</th>
<th style="text-align: right;">Y</th>
<th style="text-align: right;">X1</th>
<th style="text-align: center;">X2</th>
<th style="text-align: center;">X2A</th>
<th style="text-align: center;">X2B</th>
<th style="text-align: center;">X2C</th>
<th style="text-align: center;">X2D</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">48,55</td>
<td style="text-align: right;">17,37</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">39,26</td>
<td style="text-align: right;">9,55</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">43,29</td>
<td style="text-align: right;">15,42</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">43,57</td>
<td style="text-align: right;">35,52</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">58,61</td>
<td style="text-align: right;">18,73</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">64,71</td>
<td style="text-align: right;">20,92</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">50,22</td>
<td style="text-align: right;">18,10</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">40,74</td>
<td style="text-align: right;">15,88</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">54,65</td>
<td style="text-align: right;">20,12</td>
<td style="text-align: center;">D</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">26,95</td>
<td style="text-align: right;">25,60</td>
<td style="text-align: center;">D</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="sec-07532" class="level4" data-number="7.5.3.2"><h4 data-number="7.5.3.2" class="anchored" data-anchor-id="sec-07532">
<span class="header-section-number">7.5.3.2</span> Comment interpréter les coefficients des modalités d’une variable explicative qualitative polytomique</h4>
<p>Les coefficients des différentes modalités s’interprètent en fonction de la catégorie de référence. Dans l’exemple ci-dessous, nous avons inclus la ville de Montréal comme catégorie de référence (<a href="#tbl-ModeleVarPoly1">tableau&nbsp;<span>7.7</span></a>). Toutes choses étant égales par ailleurs, nous pouvons alors constater que &nbsp;:</p>
<ul>
<li><p>en moyenne, les îlots résidentiels de Senneville et de Baie-D’Urfé ont respectivement 23,235&nbsp;% et 21,400&nbsp;% plus de végétation que ceux de la ville de Montréal.</p></li>
<li><p>la seule municipalité comprenant en moyenne moins de végétation dans ses îlots résidentiels est Montréal-Est (-13,334&nbsp;%).</p></li>
<li><p>nous remarquons aussi que les îlots des municipalités de Sainte-Anne-de-Bellevue, de Montréal-Ouest et de Côte-Saint-Luc ne présentent pas significativement moins ou plus de végétation que ceux de la ville de Montréal (leurs valeurs de <em>p</em> sont supérieures à 0,05).</p></li>
</ul>
<p>Par conséquent, les valeurs de <em>t</em> et de <em>p</em> pour une modalité permettent de vérifier si elle est ou non significativement différente de la catégorie de référence.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-ModeleVarPoly1" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;7.7: Modèle avec une variable polytomique (ville de Montréal en catégorie de référence)</caption>
<colgroup>
<col style="width: 35%">
<col style="width: 13%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Coef.</th>
<th style="text-align: right;">Erreur type</th>
<th style="text-align: right;">Valeur de T</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Constante</td>
<td style="text-align: right;">48,193</td>
<td style="text-align: right;">0,992</td>
<td style="text-align: right;">48,580</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(HABHA)</td>
<td style="text-align: right;">-5,836</td>
<td style="text-align: right;">0,168</td>
<td style="text-align: right;">-34,840</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AgeMedian ordre 1</td>
<td style="text-align: right;">-11,807</td>
<td style="text-align: right;">15,648</td>
<td style="text-align: right;">-0,750</td>
<td style="text-align: right;">0,451</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">AgeMedian ordre 2</td>
<td style="text-align: right;">-266,469</td>
<td style="text-align: right;">13,613</td>
<td style="text-align: right;">-19,570</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_014</td>
<td style="text-align: right;">0,794</td>
<td style="text-align: right;">0,032</td>
<td style="text-align: right;">25,190</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_65P</td>
<td style="text-align: right;">0,277</td>
<td style="text-align: right;">0,018</td>
<td style="text-align: right;">15,130</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_MV</td>
<td style="text-align: right;">-0,036</td>
<td style="text-align: right;">0,010</td>
<td style="text-align: right;">-3,740</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_FR</td>
<td style="text-align: right;">-0,279</td>
<td style="text-align: right;">0,011</td>
<td style="text-align: right;">-25,340</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em>Municipalité</em></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">ref : Montréal</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Baie-D’Urfé</td>
<td style="text-align: right;">21,400</td>
<td style="text-align: right;">1,635</td>
<td style="text-align: right;">13,090</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Beaconsfield</td>
<td style="text-align: right;">14,112</td>
<td style="text-align: right;">0,893</td>
<td style="text-align: right;">15,810</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Côte-Saint-Luc</td>
<td style="text-align: right;">0,172</td>
<td style="text-align: right;">1,035</td>
<td style="text-align: right;">0,170</td>
<td style="text-align: right;">0,868</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Dollard-Des Ormeaux</td>
<td style="text-align: right;">7,960</td>
<td style="text-align: right;">0,748</td>
<td style="text-align: right;">10,640</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dorval</td>
<td style="text-align: right;">11,157</td>
<td style="text-align: right;">0,971</td>
<td style="text-align: right;">11,490</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hampstead</td>
<td style="text-align: right;">3,080</td>
<td style="text-align: right;">1,599</td>
<td style="text-align: right;">1,930</td>
<td style="text-align: right;">0,054</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kirkland</td>
<td style="text-align: right;">6,937</td>
<td style="text-align: right;">1,014</td>
<td style="text-align: right;">6,840</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mont-Royal</td>
<td style="text-align: right;">12,699</td>
<td style="text-align: right;">0,894</td>
<td style="text-align: right;">14,210</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Montréal-Est</td>
<td style="text-align: right;">-13,334</td>
<td style="text-align: right;">1,920</td>
<td style="text-align: right;">-6,940</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Montréal-Ouest</td>
<td style="text-align: right;">3,306</td>
<td style="text-align: right;">1,819</td>
<td style="text-align: right;">1,820</td>
<td style="text-align: right;">0,069</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pointe-Claire</td>
<td style="text-align: right;">9,896</td>
<td style="text-align: right;">0,866</td>
<td style="text-align: right;">11,430</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sainte-Anne-de-Bellevue</td>
<td style="text-align: right;">0,342</td>
<td style="text-align: right;">1,904</td>
<td style="text-align: right;">0,180</td>
<td style="text-align: right;">0,858</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Senneville</td>
<td style="text-align: right;">23,235</td>
<td style="text-align: right;">3,793</td>
<td style="text-align: right;">6,130</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Westmount</td>
<td style="text-align: right;">2,255</td>
<td style="text-align: right;">1,088</td>
<td style="text-align: right;">2,070</td>
<td style="text-align: right;">0,038</td>
<td style="text-align: right;">*</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Utilisons maintenant comme référence la municipalité qui avait le coefficient le plus fort dans le modèle précédent, soit Senneville (<a href="#tbl-ModeleVarPoly2">tableau&nbsp;<span>7.8</span></a>). Bien entendu, les coefficients des variables continues et de la constante ne changent pas. Par contre, les coefficients de toutes les municipalités sont négatifs puisque la municipalité de Senneville est celle qui a proportionnellement le plus de végétation dans ses îlots, toutes choses étant égales par ailleurs.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-ModeleVarPoly2" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;7.8: Modèle avec une variable polytomique (Senneville en catégorie de référence</caption>
<colgroup>
<col style="width: 35%">
<col style="width: 13%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Coef.</th>
<th style="text-align: right;">Erreur type</th>
<th style="text-align: right;">Valeur de T</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Constante</td>
<td style="text-align: right;">71,429</td>
<td style="text-align: right;">3,846</td>
<td style="text-align: right;">18,570</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(HABHA)</td>
<td style="text-align: right;">-5,836</td>
<td style="text-align: right;">0,168</td>
<td style="text-align: right;">-34,840</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AgeMedian ordre 1</td>
<td style="text-align: right;">-11,807</td>
<td style="text-align: right;">15,648</td>
<td style="text-align: right;">-0,750</td>
<td style="text-align: right;">0,451</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">AgeMedian ordre 2</td>
<td style="text-align: right;">-266,469</td>
<td style="text-align: right;">13,613</td>
<td style="text-align: right;">-19,570</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_014</td>
<td style="text-align: right;">0,794</td>
<td style="text-align: right;">0,032</td>
<td style="text-align: right;">25,190</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_65P</td>
<td style="text-align: right;">0,277</td>
<td style="text-align: right;">0,018</td>
<td style="text-align: right;">15,130</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_MV</td>
<td style="text-align: right;">-0,036</td>
<td style="text-align: right;">0,010</td>
<td style="text-align: right;">-3,740</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_FR</td>
<td style="text-align: right;">-0,279</td>
<td style="text-align: right;">0,011</td>
<td style="text-align: right;">-25,340</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em>Municipalité</em></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">ref : Senneville</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Baie-D’Urfé</td>
<td style="text-align: right;">-1,835</td>
<td style="text-align: right;">4,093</td>
<td style="text-align: right;">-0,450</td>
<td style="text-align: right;">0,654</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Beaconsfield</td>
<td style="text-align: right;">-9,123</td>
<td style="text-align: right;">3,866</td>
<td style="text-align: right;">-2,360</td>
<td style="text-align: right;">0,018</td>
<td style="text-align: right;">*</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Côte-Saint-Luc</td>
<td style="text-align: right;">-23,064</td>
<td style="text-align: right;">3,918</td>
<td style="text-align: right;">-5,890</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dollard-Des Ormeaux</td>
<td style="text-align: right;">-15,275</td>
<td style="text-align: right;">3,852</td>
<td style="text-align: right;">-3,970</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dorval</td>
<td style="text-align: right;">-12,078</td>
<td style="text-align: right;">3,891</td>
<td style="text-align: right;">-3,100</td>
<td style="text-align: right;">0,002</td>
<td style="text-align: right;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hampstead</td>
<td style="text-align: right;">-20,156</td>
<td style="text-align: right;">4,094</td>
<td style="text-align: right;">-4,920</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kirkland</td>
<td style="text-align: right;">-16,298</td>
<td style="text-align: right;">3,911</td>
<td style="text-align: right;">-4,170</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mont-Royal</td>
<td style="text-align: right;">-10,537</td>
<td style="text-align: right;">3,875</td>
<td style="text-align: right;">-2,720</td>
<td style="text-align: right;">0,007</td>
<td style="text-align: right;">**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Montréal</td>
<td style="text-align: right;">-23,235</td>
<td style="text-align: right;">3,793</td>
<td style="text-align: right;">-6,130</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Montréal-Est</td>
<td style="text-align: right;">-36,570</td>
<td style="text-align: right;">4,231</td>
<td style="text-align: right;">-8,640</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Montréal-Ouest</td>
<td style="text-align: right;">-19,930</td>
<td style="text-align: right;">4,187</td>
<td style="text-align: right;">-4,760</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pointe-Claire</td>
<td style="text-align: right;">-13,339</td>
<td style="text-align: right;">3,865</td>
<td style="text-align: right;">-3,450</td>
<td style="text-align: right;">0,001</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sainte-Anne-de-Bellevue</td>
<td style="text-align: right;">-22,893</td>
<td style="text-align: right;">4,225</td>
<td style="text-align: right;">-5,420</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Westmount</td>
<td style="text-align: right;">-20,980</td>
<td style="text-align: right;">3,927</td>
<td style="text-align: right;">-5,340</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>À l’inverse, si nous utilisons Montréal-Est comme modalité de référence, soit la municipalité avec le coefficient le plus faible dans le premier modèle, tous les coefficients deviendront positifs (<a href="#tbl-ModeleVarPoly3">tableau&nbsp;<span>7.9</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-ModeleVarPoly3" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;7.9: Modèle avec une variable polytomique (Montréal-Est en catégorie de référence)</caption>
<colgroup>
<col style="width: 35%">
<col style="width: 13%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Coef.</th>
<th style="text-align: right;">Erreur type</th>
<th style="text-align: right;">Valeur de T</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Constante</td>
<td style="text-align: right;">34,859</td>
<td style="text-align: right;">2,109</td>
<td style="text-align: right;">16,530</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(HABHA)</td>
<td style="text-align: right;">-5,836</td>
<td style="text-align: right;">0,168</td>
<td style="text-align: right;">-34,840</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AgeMedian ordre 1</td>
<td style="text-align: right;">-11,807</td>
<td style="text-align: right;">15,648</td>
<td style="text-align: right;">-0,750</td>
<td style="text-align: right;">0,451</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">AgeMedian ordre 2</td>
<td style="text-align: right;">-266,469</td>
<td style="text-align: right;">13,613</td>
<td style="text-align: right;">-19,570</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_014</td>
<td style="text-align: right;">0,794</td>
<td style="text-align: right;">0,032</td>
<td style="text-align: right;">25,190</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_65P</td>
<td style="text-align: right;">0,277</td>
<td style="text-align: right;">0,018</td>
<td style="text-align: right;">15,130</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_MV</td>
<td style="text-align: right;">-0,036</td>
<td style="text-align: right;">0,010</td>
<td style="text-align: right;">-3,740</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_FR</td>
<td style="text-align: right;">-0,279</td>
<td style="text-align: right;">0,011</td>
<td style="text-align: right;">-25,340</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><em>Municipalité</em></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">ref : Montréal-Est</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Baie-D’Urfé</td>
<td style="text-align: right;">34,735</td>
<td style="text-align: right;">2,495</td>
<td style="text-align: right;">13,920</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Beaconsfield</td>
<td style="text-align: right;">27,446</td>
<td style="text-align: right;">2,091</td>
<td style="text-align: right;">13,130</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Côte-Saint-Luc</td>
<td style="text-align: right;">13,506</td>
<td style="text-align: right;">2,167</td>
<td style="text-align: right;">6,230</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dollard-Des Ormeaux</td>
<td style="text-align: right;">21,294</td>
<td style="text-align: right;">2,053</td>
<td style="text-align: right;">10,370</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dorval</td>
<td style="text-align: right;">24,491</td>
<td style="text-align: right;">2,134</td>
<td style="text-align: right;">11,480</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hampstead</td>
<td style="text-align: right;">16,414</td>
<td style="text-align: right;">2,478</td>
<td style="text-align: right;">6,620</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kirkland</td>
<td style="text-align: right;">20,272</td>
<td style="text-align: right;">2,159</td>
<td style="text-align: right;">9,390</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mont-Royal</td>
<td style="text-align: right;">26,033</td>
<td style="text-align: right;">2,101</td>
<td style="text-align: right;">12,390</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Montréal</td>
<td style="text-align: right;">13,334</td>
<td style="text-align: right;">1,920</td>
<td style="text-align: right;">6,940</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Montréal-Ouest</td>
<td style="text-align: right;">16,640</td>
<td style="text-align: right;">2,628</td>
<td style="text-align: right;">6,330</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pointe-Claire</td>
<td style="text-align: right;">23,230</td>
<td style="text-align: right;">2,087</td>
<td style="text-align: right;">11,130</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sainte-Anne-de-Bellevue</td>
<td style="text-align: right;">13,676</td>
<td style="text-align: right;">2,687</td>
<td style="text-align: right;">5,090</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Senneville</td>
<td style="text-align: right;">36,570</td>
<td style="text-align: right;">4,231</td>
<td style="text-align: right;">8,640</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Westmount</td>
<td style="text-align: right;">15,590</td>
<td style="text-align: right;">2,196</td>
<td style="text-align: right;">7,100</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>Comment choisir la catégorie de référence?</strong></p>
</div>
<div class="bloc_astuce-body">
<p>Plusieurs options sont possibles. Vous pouvez retenir&nbsp;:</p>
<ul>
<li><p>la modalité comprenant le plus d’observations;</p></li>
<li><p>la modalité avec la plus forte valeur pour la variable dépendante;</p></li>
<li><p>la modalité avec la plus faible valeur pour la variable dépendante;</p></li>
<li><p>la modalité qui fait le plus de sens avec votre cadre théorique. Prenons l’exemple d’une variable qualitative comprenant plusieurs groupes d’âge (15-29 ans, 30-39 ans, 40-49 ans, 50-54 ans, 65 ans et plus). Si votre étude porte sur les jeunes et que vous souhaitez comparer leur situation comparativement aux autres groupes d’âge, toutes choses étant égales par ailleurs, sélectionnez bien évidemment la modalité des 15 à 29 ans comme catégorie de référence.</p></li>
</ul>
<p>Mais surtout, évitez de choisir une catégorie comprenant très peu d’observations.</p>
</div>
</div>
</section><section id="sec-07533" class="level4" data-number="7.5.3.3"><h4 data-number="7.5.3.3" class="anchored" data-anchor-id="sec-07533">
<span class="header-section-number">7.5.3.3</span> Effet marginal d’une variable explicative qualitative polytomique</h4>
<p>Comme pour une variable dichotomique, il est possible d’illustrer l’effet marginal de la variable qualitative dichotomique avec un graphique. Quelle que soit la catégorie de référence choisie, le graphique est le même. La <a href="#fig-EffetMarginalPoly">figure&nbsp;<span>7.5</span></a> illustre ainsi la valeur moyenne, avec son intervalle de confiance à 95&nbsp;%, de la végétation dans les îlots résidentiels de chacune des municipalités de la région de Montréal, <em>ceteris paribus</em>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-EffetMarginalPoly" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-EffetMarginalPoly-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.5: Effet marginal d’une variable polytomique</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-0754" class="level3" data-number="7.5.4"><h3 data-number="7.5.4" class="anchored" data-anchor-id="sec-0754">
<span class="header-section-number">7.5.4</span> Variables d’interaction</h3>
<section id="sec-07541" class="level4" data-number="7.5.4.1"><h4 data-number="7.5.4.1" class="anchored" data-anchor-id="sec-07541">
<span class="header-section-number">7.5.4.1</span> Variable d’interaction entre deux variables continues</h4>
<p>Une interaction entre deux variables indépendantes continues consiste à simplement les multiplier (<span class="math inline">\(X_1 \times X_2\)</span>). Le modèle s’écrit alors&nbsp;:</p>
<p><span id="eq-reginteractioncontinues"><span class="math display">\[
Y = \beta_{0} + \beta_{1}X_{1} + \beta_{2}X_{2} + \beta_{3}(X_{1}\times X_{2}) +\ldots+ \beta_{k}X_{k} + e
\tag{7.27}\]</span></span></p>
<p>Un nouveau coefficient (<span class="math inline">\(\beta_{3}\)</span>) s’ajoute pour l’interaction (la multiplication) entre les deux variables continues. <strong>Pourquoi ajouter une interaction entre deux variables?</strong> L’objectif est d’évaluer l’effet d’une augmentation de <span class="math inline">\(\beta_{1}\)</span> en fonction d’un niveau donné de <span class="math inline">\(\beta_{2}\)</span> et inversement. Cela permet ainsi de répondre à la question suivante&nbsp;: l’effet de la variable <span class="math inline">\(\beta_{1}\)</span> est-il influencé par la variable <span class="math inline">\(\beta_{2}\)</span> et inversement?</p>
<p>Prenons un exemple concret pour illustrer le tout. Premièrement, nous ajoutons <code>DistCBDkm</code> comme VI, soit la distance au centre-ville exprimée en kilomètres. Notez que pour ne pas surspécifier le modèle, les variables dichotomique <code>VilleMtl</code> ou polytomique <code>Municipalité</code> ont été préalablement ôtées. Le coefficient (B&nbsp;=&nbsp;0,659, <em>p</em>&nbsp;&lt;&nbsp;0,001) signale que plus nous nous éloignons du centre-ville, plus la couverture végétale des îlots augmente significativement. En guise d’exemple, toutes choses étant égales par ailleurs, un îlot situé à dix kilomètres du centre-ville aura en moyenne 6,59&nbsp;% plus de végétation (<a href="#tbl-ModeleInteraction1">tableau&nbsp;<span>7.10</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-ModeleInteraction1" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;7.10: Modèle avec la distance au centre-ville (km)</caption>
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Coef.</th>
<th style="text-align: right;">Erreur type</th>
<th style="text-align: right;">Valeur de T</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Constante</td>
<td style="text-align: right;">41,061</td>
<td style="text-align: right;">1,085</td>
<td style="text-align: right;">37,830</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(HABHA)</td>
<td style="text-align: right;">-5,555</td>
<td style="text-align: right;">0,172</td>
<td style="text-align: right;">-32,300</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AgeMedian ordre 1</td>
<td style="text-align: right;">176,921</td>
<td style="text-align: right;">16,582</td>
<td style="text-align: right;">10,670</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">AgeMedian ordre 2</td>
<td style="text-align: right;">-298,735</td>
<td style="text-align: right;">13,560</td>
<td style="text-align: right;">-22,030</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_014</td>
<td style="text-align: right;">0,763</td>
<td style="text-align: right;">0,031</td>
<td style="text-align: right;">24,440</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_65P</td>
<td style="text-align: right;">0,321</td>
<td style="text-align: right;">0,018</td>
<td style="text-align: right;">17,860</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_MV</td>
<td style="text-align: right;">-0,018</td>
<td style="text-align: right;">0,010</td>
<td style="text-align: right;">-1,880</td>
<td style="text-align: right;">0,060</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_FR</td>
<td style="text-align: right;">-0,288</td>
<td style="text-align: right;">0,011</td>
<td style="text-align: right;">-26,260</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DistCBDkm</td>
<td style="text-align: right;">0,659</td>
<td style="text-align: right;">0,027</td>
<td style="text-align: right;">24,460</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Dans ce modèle (<a href="#tbl-ModeleInteraction1">tableau&nbsp;<span>7.10</span></a>), les pourcentages d’enfants de moins de 15 ans et de 65 ans et plus (<code>Pct_014</code> et <code>Pct_65P</code>) sont associés positivement à la variable dépendante tandis que le pourcentage de personnes à faible revenu (<code>Pct_FR</code>) est associé négativement.</p>
<p>Que se passe-t-il si nous introduisons une variable d’interaction entre <code>DistCBDkm</code> et <code>Pct_FR</code> (<a href="#tbl-ModeleInteraction2">tableau&nbsp;<span>7.11</span></a>)? L’effet du pourcentage de personnes à faible revenu (%) est significatif et négatif lorsqu’il est mis en interaction avec la distance au centre-ville. Cela indique que plus l’îlot est éloigné du centre-ville, plus <code>Pct_FR</code> a un effet négatif sur la couverture végétale (B&nbsp;=&nbsp;−0,011, <em>p</em>&nbsp;&lt;&nbsp;0,001).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-ModeleInteraction2" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;7.11: Modèle avec une variable d’interaction entre deux VI continues</caption>
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Coef.</th>
<th style="text-align: right;">Erreur type</th>
<th style="text-align: right;">Valeur de T</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Constante</td>
<td style="text-align: right;">38,382</td>
<td style="text-align: right;">1,137</td>
<td style="text-align: right;">33,760</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(HABHA)</td>
<td style="text-align: right;">-5,505</td>
<td style="text-align: right;">0,172</td>
<td style="text-align: right;">-32,080</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AgeMedian ordre 1</td>
<td style="text-align: right;">160,523</td>
<td style="text-align: right;">16,672</td>
<td style="text-align: right;">9,630</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">AgeMedian ordre 2</td>
<td style="text-align: right;">-310,666</td>
<td style="text-align: right;">13,610</td>
<td style="text-align: right;">-22,830</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_014</td>
<td style="text-align: right;">0,786</td>
<td style="text-align: right;">0,031</td>
<td style="text-align: right;">25,130</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_65P</td>
<td style="text-align: right;">0,345</td>
<td style="text-align: right;">0,018</td>
<td style="text-align: right;">18,960</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_MV</td>
<td style="text-align: right;">-0,018</td>
<td style="text-align: right;">0,010</td>
<td style="text-align: right;">-1,820</td>
<td style="text-align: right;">0,069</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_FR</td>
<td style="text-align: right;">-0,191</td>
<td style="text-align: right;">0,017</td>
<td style="text-align: right;">-11,500</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DistCBDkm</td>
<td style="text-align: right;">0,821</td>
<td style="text-align: right;">0,034</td>
<td style="text-align: right;">24,060</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">DistCBDkmX_Pct_FR</td>
<td style="text-align: right;">-0,011</td>
<td style="text-align: right;">0,001</td>
<td style="text-align: right;">-7,700</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>À nouveau, il est possible de représenter l’effet de cette interaction à l’aide d’un graphique des effets marginaux. Notez cependant que nous devons représenter l’effet simultané de deux variables indépendantes sur notre variable dépendante, ce qu’il est possible de faire avec une carte de chaleur. La <a href="#fig-ModeleInteraction2heat">figure&nbsp;<span>7.6</span></a> représente donc l’effet moyen de l’interaction sur la prédiction dans le premier panneau, ainsi que l’intervalle de confiance à 95&nbsp;% de la prédiction dans les deuxième et troisième panneaux.</p>
<p>Nous constatons ainsi que le modèle prédit des valeurs de végétation les plus faibles lorsque le pourcentage de personnes à faible revenu est élevé et que la distance au centre-ville est élevée (en haut à droite à la <a href="#fig-ModeleInteraction2heat">figure&nbsp;<span>7.6</span></a>). En revanche, les valeurs les plus élevées de végétation sont atteintes lorsque la distance au centre-ville est élevée et que le pourcentage de personnes à faible revenu est faible (en bas à droite). Il semble donc que l’éloignement au centre-ville soit associé avec une augmentation de la densité végétale, mais que cette augmentation puisse être mitigée par l’augmentation parallèle du pourcentage de personnes à faible revenu.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ModeleInteraction2heat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-ModeleInteraction2heat-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.6: Effet marginal de l’interaction entre deux variables continues</figcaption></figure>
</div>
</div>
</div>
<p>Notez que dans la <a href="#fig-ModeleInteraction2heat">figure&nbsp;<span>7.6</span></a>, la relation entre les deux variables indépendantes et la variable dépendante apparaît non linéaire du fait de l’interaction. À titre de comparaison, si nous utilisons les prédictions du modèle 5 (sans interaction), nous obtenons les prédictions présentées à la <a href="#fig-ModeleInteraction2heat2">figure&nbsp;<span>7.7</span></a>. Vous pouvez constater sur cette figure sans interaction que les deux effets des variables indépendantes sont linéaires puisque toutes les lignes sont parallèles.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ModeleInteraction2heat2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-ModeleInteraction2heat2-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.7: Effets marginaux de deux variables continues en cas d’absence d’interaction</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-07542" class="level4" data-number="7.5.4.2"><h4 data-number="7.5.4.2" class="anchored" data-anchor-id="sec-07542">
<span class="header-section-number">7.5.4.2</span> Variable d’interaction entre une variable continue et une variable dichotomique</h4>
<p>Une interaction entre une VI continue et une VI dichotomique consiste aussi à les multiplier (<span class="math inline">\(X_1 \times D_2\)</span>); le modèle s’écrit alors&nbsp;:</p>
<p><span id="eq-reginteractioncontinuedicho"><span class="math display">\[
Y = \beta_{0} + \beta_{1}X_{1} + \beta_{2}D_{2} + \beta_{3}(X_{1}\times D_{2}) +\ldots+ \beta_{k}X_{k} + e
\tag{7.28}\]</span></span></p>
<p>Pour interpréter le coefficient <span class="math inline">\(B_3\)</span>, il convient alors de bien connaître le nom de la modalité ayant la valeur de 1 (0 étant la modalité de référence). Dans le modèle présenté au <a href="#tbl-ModeleInteractionBinaire">tableau&nbsp;<span>7.12</span></a>, nous avons multiplié la variable dichotomique ville de Montréal (<code>VilleMtl</code>) avec le pourcentage de personnes à faible revenu (<code>Pct_FR</code>). Les résultats de ce modèle démontrent que, toutes choses étant égales par ailleurs&nbsp;:</p>
<ul>
<li><p>À chaque augmentation d’une unité du pourcentage à faible revenu (<code>Pct_FR</code>), le pourcentage de la couverture végétale diminue significativement de −0,444.</p></li>
<li><p>Comparativement à un îlot situé dans une autre municipalité de l’île de Montréal, un îlot de la ville de Montréal a en moyenne −9,804 de couverture végétale.</p></li>
<li><p>À chaque augmentation d’une unité de <code>Pct_FR</code> pour un îlot de la Ville Montréal, la couverture végétale augmente de 0,166 comparativement à une autre municipalité de l’île. En d’autres termes, le <code>Pct_FR</code> sur le territoire de la ville de Montréal est associé à une diminution de la couverture végétale moins forte que les autres municipalités, comme illustré à la <a href="#fig-ModeleInteractionBinaire">figure&nbsp;<span>7.8</span></a>) (pentes en rouge et en bleu).</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-ModeleInteractionBinaire" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;7.12: Modèle avec les variables d’interaction entre une VI continue et une VI dichotomique</caption>
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Coef.</th>
<th style="text-align: right;">Erreur type</th>
<th style="text-align: right;">Valeur de T</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Constante</td>
<td style="text-align: right;">59,275</td>
<td style="text-align: right;">1,053</td>
<td style="text-align: right;">56,300</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">log(HABHA)</td>
<td style="text-align: right;">-6,160</td>
<td style="text-align: right;">0,168</td>
<td style="text-align: right;">-36,640</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AgeMedian ordre 1</td>
<td style="text-align: right;">-20,719</td>
<td style="text-align: right;">15,354</td>
<td style="text-align: right;">-1,350</td>
<td style="text-align: right;">0,177</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">AgeMedian ordre 2</td>
<td style="text-align: right;">-278,141</td>
<td style="text-align: right;">13,656</td>
<td style="text-align: right;">-20,370</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_014</td>
<td style="text-align: right;">0,789</td>
<td style="text-align: right;">0,031</td>
<td style="text-align: right;">25,100</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_65P</td>
<td style="text-align: right;">0,278</td>
<td style="text-align: right;">0,018</td>
<td style="text-align: right;">15,200</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_MV</td>
<td style="text-align: right;">-0,030</td>
<td style="text-align: right;">0,010</td>
<td style="text-align: right;">-3,030</td>
<td style="text-align: right;">0,002</td>
<td style="text-align: right;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_FR</td>
<td style="text-align: right;">-0,444</td>
<td style="text-align: right;">0,030</td>
<td style="text-align: right;">-14,550</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VilleMtl</td>
<td style="text-align: right;">-9,804</td>
<td style="text-align: right;">0,549</td>
<td style="text-align: right;">-17,850</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">VilleMtlX_Pct_FR</td>
<td style="text-align: right;">0,166</td>
<td style="text-align: right;">0,032</td>
<td style="text-align: right;">5,260</td>
<td style="text-align: right;">0,000</td>
<td style="text-align: right;">***</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>L’interaction entre une variable qualitative et une variable quantitative peut être représentée par un graphique des effets marginaux. La pente (coefficient) de la variable quantitative varie en fonction des deux catégories de la variable qualitative dichotomique (<a href="#fig-ModeleInteractionBinaire">figure&nbsp;<span>7.8</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ModeleInteractionBinaire" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-ModeleInteractionBinaire-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.8: Graphique de l’effet marginal de l’interaction entre une variable quantitative et qualitative</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-07543" class="level4" data-number="7.5.4.3"><h4 data-number="7.5.4.3" class="anchored" data-anchor-id="sec-07543">
<span class="header-section-number">7.5.4.3</span> Variable d’interaction entre deux variables dichotomiques</h4>
<div class="bloc_aller_loin">
<div class="bloc_aller_loin-header">
<div class="bloc_aller_loin-icon">

</div>
<p><strong>Variable d’interaction entre deux variables dichotomiques</strong></p>
</div>
<div class="bloc_aller_loin-body">
<p>Nous avons vu qu’il est possible d’introduire une variable d’interaction entre deux variables continues ou entre une variable continue et une autre dichotomique. Sachez qu’il est aussi possible d’introduire une interaction entre deux variables dichotomiques. Sur le sujet, vous pouvez consulter la section 8.3 de l’excellent ouvrage de Hanck et al. <span class="citation" data-cites="hanck2019introduction">(<a href="references.html#ref-hanck2019introduction" role="doc-biblioref">2019</a>)</span>.</p>
</div>
</div>
</section></section></section><section id="sec-076" class="level2" data-number="7.6"><h2 data-number="7.6" class="anchored" data-anchor-id="sec-076">
<span class="header-section-number">7.6</span> Diagnostics de la régression</h2>
<p>Pour illustrer comment vérifier si le modèle respecte ou non les hypothèses de la régression, nous utilisons le modèle suivant&nbsp;:</p>
<p><code>modele3 &lt;- lm(VegPct ~ log(HABHA)+poly(AgeMedian,2)+Pct_014+Pct_65P+Pct_MV+Pct_FR, data = DataFinal)</code></p>
<section id="sec-0761" class="level3" data-number="7.6.1"><h3 data-number="7.6.1" class="anchored" data-anchor-id="sec-0761">
<span class="header-section-number">7.6.1</span> Nombre d’observations</h3>
<p>Tous les auteurs ne s’entendent pas sur le nombre d’observations minimal que devrait comprendre une régression linéaire multiple, tant s’en faut! Parallèlement, d’autres auteurs proposent aussi des méthodes de simulation pour estimer les coefficients de régression sur un jeu de données comprenant peu d’observations. Bien qu’aucune règle ne soit bien établie, la question du nombre d’observations mérite d’être posée puisqu’un modèle basé sur trop peu d’observations risque de produire des coefficients de régression peu fiables. Par faible fiabilité des coefficients, nous entendons que la suppression d’une ou de plusieurs observations pourrait drastiquement changer l’effet et/ou la significativité d’une ou de plusieurs variables explicatives.</p>
<p>Dans un ouvrage classique intitulé <em>Using Multivariate Statistics</em>, Barbara Tabachnick et Linda Fidell <span class="citation" data-cites="tabachnick2007">(<a href="references.html#ref-tabachnick2007" role="doc-biblioref">2007, 123‑124</a>)</span> proposent deux règles de pouce (à la louche)&nbsp;:</p>
<ol type="1">
<li><p><span class="math inline">\(n \geq 50 + 8k\)</span> avec <span class="math inline">\(n\)</span> et <span class="math inline">\(k\)</span> étant respectivement les nombres d’observations et de variables indépendantes, pour tester le coefficient de corrélation multiple (R<sup>2</sup>).</p></li>
<li><p><span class="math inline">\(n \geq 104 + k\)</span> pour tester individuellement chaque variable indépendante.</p></li>
</ol>
<p>Dans le modèle, nous avons 10&nbsp;210 observations et variables indépendantes. Les deux conditions sont donc largement respectées.</p>
</section><section id="sec-0762" class="level3" data-number="7.6.2"><h3 data-number="7.6.2" class="anchored" data-anchor-id="sec-0762">
<span class="header-section-number">7.6.2</span> Normalité des résidus</h3>
<p>Pour vérifier si les résidus sont normalement distribués, trois démarches largement décrites dans la <a href="02-univarie.html#sec-0254">section&nbsp;<span>2.5.4</span></a> peuvent être utilisées&nbsp;:</p>
<ul>
<li>le calcul des coefficients d’asymétrie et d’aplatissement;</li>
<li>les tests de normalité, particulièrement celui de Jarque-Bera basé sur un test multiplicateur de Lagrange;</li>
<li>les graphiques (histogramme avec courbe normale et diagramme quantile-quantile) (<a href="#fig-VerifierNormaliteResidus">figure&nbsp;<span>7.9</span></a>).</li>
</ul>
<p>Les deux premières démarches étant parfois très restrictives, nous accordons habituellement une attention particulière aux graphiques.</p>
<p>Pour notre modèle, les coefficients d’asymétrie (−0,263) et d’aplatissement (1,149) signalent que la distribution est plutôt symétrique, mais leptokurtique, c’est-à-dire que les valeurs des résidus sont bien réparties autour de 0, mais avec une faible dispersion. Puisque la valeur de <em>p</em> associée au test de Jarque-Bera est inférieure à 0,05, nous pouvons en conclure que la distribution des résidus est anormale. La forme pointue de la distribution est d’ailleurs confirmée à la lecture de l’histogramme avec la courbe normale et du diagramme quantile-quantile.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Skewness Kurtosis 
  -0.161    1.193 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Robust Jarque Bera Test

data:  residus
X-squared = 513.15, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-VerifierNormaliteResidus" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-VerifierNormaliteResidus-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.9: Vérification de la normalité des résidus</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-0763" class="level3" data-number="7.6.3"><h3 data-number="7.6.3" class="anchored" data-anchor-id="sec-0763">
<span class="header-section-number">7.6.3</span> Linéarité et homoscédasticité des résidus</h3>
<p>Un modèle est efficace si la dispersion des résidus est homogène sur tout le spectre des valeurs prédites de la variable dépendante. Dans le cas d’une absence d’homoscédasticité – appelée problème d’hétéroscédasticité –, le nuage de points construit à partir des résidus et des valeurs prédites (<a href="#fig-VerifierHomoscedasticite">figure&nbsp;<span>7.10</span></a>) prend la forme d’une trompette ou d’un entonnoir&nbsp;: les résidus sont alors faibles quand les valeurs prédites sont faibles et sont de plus en plus élevés au fur et à mesure que les valeurs prédites augmentent.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-VerifierHomoscedasticite" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-VerifierHomoscedasticite-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.10: Distribution des résidus en fonction des valeurs prédites</figcaption></figure>
</div>
</div>
</div>
<p>Le test de Breusch-Pagan est souvent utilisé pour vérifier l’homoscédasticité des résidus. Il est construit avec les hypothèses suivantes&nbsp;:</p>
<ul>
<li><p><em>H<sub>0</sub></em>&nbsp;: homoscédasticité, c’est-à-dire que les termes d’erreur ont une variance constante à travers les valeurs prédites.</p></li>
<li><p><em>H<sub>1</sub></em>&nbsp;: hétéroscédasticité.</p></li>
</ul>
<p>Si la valeur de <em>p</em> associée à ce test est inférieure à 0,05, nous réfutons l’hypothèse nulle et nous concluons qu’il y a un problème d’hétéroscédasticité, ce qui est le cas pour notre modèle.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  modele3
BP = 1722, df = 8, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
</section><section id="sec-0764" class="level3" data-number="7.6.4"><h3 data-number="7.6.4" class="anchored" data-anchor-id="sec-0764">
<span class="header-section-number">7.6.4</span> Absence de multicolinéarité excessive</h3>
<p>Un modèle présente un problème de multicolinéarité excessive lorsque deux variables indépendantes ou plus sont très fortement corrélées entre elles. Rappelez-vous qu’un coefficient de régression estime l’effet d’une variable dépendante (<span class="math inline">\(X_k\)</span>) si toutes les autres VI restent constantes (c’est-à-dire une fois les autres VI contrôlées, toutes choses étant égales par ailleurs…).</p>
<p>Prenons deux variables indépendantes (<span class="math inline">\(X_1\)</span> et <span class="math inline">\(X_2\)</span>) fortement corrélées avec un coefficient de Pearson très élevé (0,90 par exemple). Admettons que chacune des deux VI a un effet important et significatif sur votre VD lorsqu’une seule est introduite dans le modèle. Si les deux variables sont introduites dans le même modèle, vous évaluez donc l’effet de <span class="math inline">\(X_1\)</span> une fois contrôlé <span class="math inline">\(X_2\)</span> et l’effet de <span class="math inline">\(X_2\)</span> une fois contrôlé <span class="math inline">\(X_1\)</span>. Par conséquent, l’effet de l’une des deux devient très faible, voire probablement non significatif.</p>
<section id="sec-07641" class="level4" data-number="7.6.4.1"><h4 data-number="7.6.4.1" class="anchored" data-anchor-id="sec-07641">
<span class="header-section-number">7.6.4.1</span> Comment évaluer la multicolinéarité?</h4>
<p>Pour ce faire, nous utilisons habituellement le facteur d’inflation de la variance (<em>Variance Inflation Factor – VIF</em> en anglais). Le calcul de ce facteur pour chaque VI est basé sur trois étapes.</p>
<ol type="1">
<li>Pour chaque VI, nous construisons un modèle de régression multiple où elle est expliquée par toutes les autres variables indépendantes du modèle. Par exemple, pour la première VI (<span class="math inline">\(X_1\)</span>), l’équation du modèle s’écrit&nbsp;:</li>
</ol>
<p><span id="eq-RegVIF"><span class="math display">\[
X_1 = b_0 + b_2X_2 +\ldots+ b_kX_k + e
\tag{7.29}\]</span></span></p>
<ol start="2" type="1">
<li>À partir de cette équation, nous obtenons ainsi un <span class="math inline">\(R^2\)</span> qui nous indique la proportion de la variance de <span class="math inline">\(X_1\)</span> expliquée par les autres VI. Par convention, nous calculons la tolérance (<a href="#eq-ToleranceVIF">équation&nbsp;<span>7.30</span></a>) qui indique la proportion de la variance de <span class="math inline">\(X_k\)</span> n’étant pas expliquée par les autres VI. En guise d’exemple, une valeur de tolérance égale à 0,1 signale que 90&nbsp;% de la variance de <span class="math inline">\(X_k\)</span> est expliqué par les autres variables, ce qui est un problème de multicolinéarité en soit. Concrètement, plus la valeur de la tolérance est proche de zéro, plus c’est problématique.</li>
</ol>
<p><span id="eq-ToleranceVIF"><span class="math display">\[
\mbox{Tolérance}_k=1-R_k^2=\frac{1}{VIF_k}
\tag{7.30}\]</span></span></p>
<ol start="3" type="1">
<li>Puis, nous calculons le facteur d’inflation de la variance (<a href="#eq-VIF">équation&nbsp;<span>7.31</span></a>). Là encore, des règles de pouce (à la louche) sont utilisées. Certains considéreront une valeur de VIF supérieur à 10 (soit une tolérance à 0,1 ou inférieure) comme problématique, d’autres retiendront le seuil de 5 plus conservateur (soit une tolérance à 0,2 ou inférieure).</li>
</ol>
<p><span id="eq-VIF"><span class="math display">\[
VIF_k = \frac{1}{1-R_k^2}
\tag{7.31}\]</span></span></p>
<p>Pour notre modèle, toutes les valeurs de VIF sont inférieures à 2, indiquant, sans l’ombre d’un doute, l’absence de multicolinéarité excessive.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                    GVIF Df GVIF^(1/(2*Df))
VilleMtl           1.319  1           1.149
log(HABHA)         1.342  1           1.159
poly(AgeMedian, 2) 1.399  2           1.087
Pct_014            1.601  1           1.265
Pct_65P            1.317  1           1.147
Pct_MV             1.483  1           1.218
Pct_FR             1.818  1           1.348</code></pre>
</div>
</div>
</section><section id="sec-07642" class="level4" data-number="7.6.4.2"><h4 data-number="7.6.4.2" class="anchored" data-anchor-id="sec-07642">
<span class="header-section-number">7.6.4.2</span> Comment régler un problème de multicolinéarité?</h4>
<ul>
<li><p>La prudence est de mise! Si une ou plusieurs variables présentent une valeur de VIF supérieure à 5, construisez une matrice de corrélation de Pearson (<a href="04-bivarieeQuantiQuanti.html#sec-0437">section&nbsp;<span>4.3.7</span></a>) et repérez les valeurs de corrélation supérieures à 0,8 ou inférieures à −0,8. Vous repérerez ainsi les corrélations problématiques entre deux variables indépendantes du modèle.</p></li>
<li><p>Refaites ensuite un modèle en ôtant la variable indépendante avec la plus forte valeur de VIF (7 ou 12 par exemple), et revérifiez les valeurs de VIF. Refaites cette étape si le problème de multicolinéarité excessive persiste.</p></li>
</ul>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Une multicolinéarité excessive n’est pas forcément inquiétante</strong></p>
</div>
<div class="bloc_attention-body">
<p>Nous avons vu plus haut comment introduire des variables indépendantes particulières comme des variables d’interaction (<span class="math inline">\(X_1 \times X_2\)</span>) ou des variables sous une forme polynomiale (ordre 2&nbsp;: <span class="math inline">\(X_1 + X_1^2\)</span>; ordre 3&nbsp;: <span class="math inline">\(X_1 + X_1^2 + X_1^3\)</span>, etc.). Bien entendu, ces termes composant les variables d’interaction ou d’une forme polynomiale sont habituellement fortement corrélés entre eux. Cela n’est toutefois pas problématique!</p>
<p>Dans l’exemple ci-dessous, nous obtenons deux valeurs de VIF très élevées pour la variable d’interaction <code>Pct_014:DistCBDkm</code> (16,713) et l’un des paramètres à partir duquel elle est calculée, soit <code>DistCBDkm</code> (12,526).</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                     GVIF Df GVIF^(1/(2*Df))
log(HABHA)          1.426  1           1.194
poly(AgeMedian, 2)  1.768  2           1.153
Pct_014             3.326  1           1.824
Pct_65P             1.359  1           1.166
Pct_MV              1.495  1           1.223
Pct_FR              1.810  1           1.345
DistCBDkm          12.526  1           3.539
Pct_014:DistCBDkm  16.713  1           4.088</code></pre>
</div>
</div>
</div>
</div>
</section></section><section id="sec-0766" class="level3" data-number="7.6.5"><h3 data-number="7.6.5" class="anchored" data-anchor-id="sec-0766">
<span class="header-section-number">7.6.5</span> Absence d’observations aberrantes</h3>
<section id="sec-07661" class="level4" data-number="7.6.5.1"><h4 data-number="7.6.5.1" class="anchored" data-anchor-id="sec-07661">
<span class="header-section-number">7.6.5.1</span> Détection des observations très influentes du modèle</h4>
<p>Lors de l’analyse des corrélations (<a href="04-bivarieeQuantiQuanti.html#sec-043">section&nbsp;<span>4.3</span></a>), nous avons vu que des valeurs extrêmes peuvent avoir un impact important sur le coefficient de corrélation de Pearson. Le même principe s’applique à la régression multiple, pour laquelle nous nous s’attendrions à ce que chaque observation joue un rôle équivalent dans la détermination de l’équation du modèle.</p>
<p>Autrement dit, il est possible que certaines observations avec des valeurs extrêmes – fortement dissemblables des autres – aient une influence importante, voire démesurée, dans l’estimation du modèle. Concrètement, cela signifie que si elles étaient ôtées, les coefficients de régression et la qualité d’ajustement du modèle pourraient changer drastiquement. Deux mesures sont habituellement utilisées pour évaluer l’influence de chaque observation sur le modèle&nbsp;:</p>
<ul>
<li>
<strong>La statistique de la distance de Cook</strong> qui mesure l’influence de chaque observation sur les résultats du modèle. Brièvement, la distance de Cook évalue l’influence de l’observation <em>i</em> en la supprimant du modèle (<a href="#eq-DistanceCook">équation&nbsp;<span>7.32</span></a>). Plus sa valeur est élevée, plus l’observation joue un rôle important dans la détermination de l’équation de régression.</li>
</ul>
<p><span id="eq-DistanceCook"><span class="math display">\[
D_i = \frac{\sum_{j=1}^n(\widehat{y}_i-\widehat{y}_{i(j)})^2}{ks^2}
\tag{7.32}\]</span></span></p>
<p>avec <span class="math inline">\(\widehat{y}_{i(j)}\)</span> la valeur prédite quand l’observation <em>i</em> est ôté du modèle, <em>k</em> le nombre de variables indépendantes et <span class="math inline">\(s^2\)</span> l’erreur quadratique moyenne du modèle.</p>
<ul>
<li>
<strong>La statistique de l’effet levier</strong> (<em>leverage value</em> en anglais) qui varie de 0 (aucune influence) à 1 (explique tout le modèle). La somme de toutes les valeurs de cette statistique est égale au nombre de VI dans le modèle.</li>
</ul>
<p><strong>Quel critère retenir pour détecter les observations avec potentiellement une trop grande influence sur le modèle?</strong></p>
<p>Pour les repérer, voire les supprimer, plusieurs auteur(e)s proposent les seuils suivants&nbsp;: <span class="math inline">\(4/n\)</span> ou <span class="math inline">\(8/n\)</span> ou <span class="math inline">\(16/n\)</span>. Avec 10210 observations dans le modèle, les seuils seraient les suivants&nbsp;:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Nombre d'observations = 10210 (100 %) 
 4/n = 0.00039 
 8/n = 0.00078 
 16/n = 0.00157 
Observations avec une valeur supérieure ou égale aux différents seuils 
 4/n = 605 soit 5.93 % 
 8/n = 275 soit 2.69 % 
 16/n = 133 soit 1.3 %</code></pre>
</div>
</div>
<p>Le critère de <span class="math inline">\(4/n\)</span> étant plutôt sévère, nous privilégions généralement celui de <span class="math inline">\(8/n\)</span>, voire <span class="math inline">\(16/n\)</span>. Il est aussi possible de construire un nuage de points pour les repérer (<a href="#fig-GraphCookLev">figure&nbsp;<span>7.11</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-GraphCookLev" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-GraphCookLev-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.11: Repérage graphique les valeurs influentes du modèle</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-07662" class="level4" data-number="7.6.5.2"><h4 data-number="7.6.5.2" class="anchored" data-anchor-id="sec-07662">
<span class="header-section-number">7.6.5.2</span> Quoi faire avec les observations très influentes du modèle</h4>
<p>Trois approches sont possibles&nbsp;:</p>
<ul>
<li><p><strong>Recourir à des régressions <em>boostrap</em></strong>, ce qui permet généralement de supprimer l’effet de ces observations. Brièvement, le principe général est de créer un nombre élevé d’échantillons du jeu de données initial (1000 à 2000 itérations par exemple) et de construire un modèle de régression pour chacun d’eux. On obtiendra ainsi des intervalles de confiance pour les coefficients de régression et les mesures d’ajustement du modèle.</p></li>
<li><p><strong>Supprimer les observations trop influentes</strong> (avec l’un des critères de <span class="math inline">\(4/n\)</span>, <span class="math inline">\(8/n\)</span> et <span class="math inline">\(16/n\)</span> vus plus haut). Une fois supprimées, il convient 1) de recalculer le modèle, 2) de refaire le diagnostic de la régression au complet et finalement, 3) de comparer les modèles avant et après suppression des valeurs trop influentes, notamment la qualité d’ajustement du modèle (R<sup>2</sup> ajusté) et les coefficients de régression. Des changements importants indiqueront que le premier modèle est potentiellement biaisé.</p></li>
<li><p><strong>Utiliser un modèle linéaire généralisé (GLM)</strong> permettant d’utiliser une distribution différente correspondant plus à votre jeu de données (<a href="08-GLM.html">chapitre&nbsp;<span>8</span></a>).</p></li>
</ul></section></section></section><section id="sec-077" class="level2" data-number="7.7"><h2 data-number="7.7" class="anchored" data-anchor-id="sec-077">
<span class="header-section-number">7.7</span> Mise en œuvre dans R</h2>
<section id="sec-0771" class="level3" data-number="7.7.1"><h3 data-number="7.7.1" class="anchored" data-anchor-id="sec-0771">
<span class="header-section-number">7.7.1</span> Fonctions <code>lm</code>, <code>summary()</code> et <code>confint()</code>
</h3>
<p>Les fonctions de base <code>lm</code>, <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> et <code><a href="https://rdrr.io/r/stats/confint.html">confint()</a></code> permettent respectivement 1) de construire un modèle, 2) d’afficher ces résultats et 3) d’obtenir les intervalles de confiance des coefficients de régression&nbsp;:</p>
<ul>
<li><p><code>monModele &lt;- lm(Y ~X1+X2+..+Xk)</code> avec <em>Y</em> étant la variable dépendante et les variables indépendantes (<code>X1 à Xk</code>) étant séparées par le signe +.</p></li>
<li><p><code>summary(monModele)</code></p></li>
<li><p><code>confint(monModele, level=.95)</code>.</p></li>
</ul>
<p>Dans la syntaxe ci-dessous, vous retrouverez les différents modèles abordés dans les sections précédentes; remarquez que toutes que les lignes <code>summary</code> sont mises en commentaires afin de ne pas afficher les résultats des modèles.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Chargement des données</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/lm/DataVegetation.RData"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1er modèle de régression</span></span>
<span><span class="va">modele1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="va">HABHA</span><span class="op">+</span><span class="va">AgeMedian</span><span class="op">+</span><span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span>,</span>
<span>              data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span><span class="co"># summary(Modele1)</span></span>
<span></span>
<span><span class="co"># 2e modèle de régression : fonction polynomiale d'ordre 2 (poly(AgeMedian,2))</span></span>
<span><span class="va">modele2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="va">HABHA</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">AgeMedian</span>,<span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span>,</span>
<span>              data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span><span class="co"># summary(Modele2)</span></span>
<span></span>
<span><span class="co"># 3e modèle de régression : forme logarithmique (log(HABHA))</span></span>
<span><span class="va">modele3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">HABHA</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">AgeMedian</span>,<span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span>,</span>
<span>              data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span><span class="co"># summary(Modele3)</span></span>
<span></span>
<span><span class="co"># 4e modèle de régression : VI dichotomique</span></span>
<span><span class="co"># création de la variable dichotomique (VilleMtl)</span></span>
<span><span class="va">DataFinal</span><span class="op">$</span><span class="va">VilleMtl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">SDRNOM</span> <span class="op">==</span> <span class="st">"Montréal"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">modele4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">HABHA</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">AgeMedian</span>,<span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span><span class="op">+</span></span>
<span>                       <span class="va">VilleMtl</span>, <span class="co"># variable dichotomique</span></span>
<span>              data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span><span class="co"># summary(Modele4)</span></span>
<span></span>
<span><span class="co"># 5e modèle de régression : VI polytomique</span></span>
<span><span class="co"># création de la variable polytomique (Munic)</span></span>
<span><span class="va">DataFinal</span><span class="op">$</span><span class="va">Munic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">SDRNOM</span>, ref <span class="op">=</span> <span class="st">"Montréal"</span><span class="op">)</span></span>
<span><span class="va">modele5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">HABHA</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">AgeMedian</span>,<span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span><span class="op">+</span></span>
<span>                       <span class="va">Munic</span>, data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span><span class="co"># summary(Modele5)</span></span>
<span></span>
<span></span>
<span><span class="co"># 6e modèle de régression : interaction entre deux VI continues, </span></span>
<span><span class="co"># soit DistCBDkm*Pct_014</span></span>
<span><span class="va">modele6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">HABHA</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">AgeMedian</span>,<span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span><span class="op">+</span></span>
<span>                       <span class="va">DistCBDkm</span><span class="op">+</span><span class="va">DistCBDkm</span><span class="op">*</span><span class="va">Pct_014</span>,</span>
<span>                data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span><span class="co"># summary(Modele6)</span></span>
<span></span>
<span><span class="co"># 7e modèle de régression : interaction entre une VI continue et une VI dichotomique,</span></span>
<span><span class="co"># soit VilleMtl*Pct_FR</span></span>
<span><span class="va">modele8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">HABHA</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">AgeMedian</span>,<span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span><span class="op">+</span></span>
<span>                       <span class="va">VilleMtl</span><span class="op">*</span><span class="va">Pct_FR</span>,</span>
<span>                data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span><span class="co"># summary(Modele7)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>À la <a href="#fig-OutputRegression">figure&nbsp;<span>7.12</span></a>, les résultats de la régression linéaire multiple, obtenus avec la <code>summary(monModele)</code>, sont présentés en quatre sections distinctes&nbsp;:</p>
<ol type="a">
<li><p>Le rappel de l’équation du modèle.</p></li>
<li><p>Quelques statistiques descriptives sur les résidus du modèle, soit la différence entre les valeurs observées et prédites.</p></li>
<li><p>Un tableau pour les coefficients de régression comprenant plusieurs colonnes, à savoir les coefficients de régression (<code>Estimate</code>), l’erreur type du coefficient (<code>Std. Error</code>), la valeur de <em>t</em> (<code>t value</code>) et la probabilité associée à la valeur de <em>t</em> (<code>Pr(&gt;|t|)</code>). La première ligne de ce tableau (<code>Estimate</code>) est pour la constante (<em>Intercept</em> en anglais) et celles qui suivent sont pour les variables indépendantes.</p></li>
<li><p>Les mesures d’ajustement du modèle, dont le RMSE (<code>Residual standard error</code>), les R<sup>2</sup> classique (<code>Multiple R-squared</code>) et ajusté (<code>Adjusted R-squared</code>), la statistique <em>F</em> avec le nombre de degrés de liberté en lignes (nombre d’observations) et en colonnes (<em>n-k-1</em>) ainsi que la valeur de <em>p</em> qui est lui associée (<code>F-statistic:  1223 on 6 and 10203 DF,  p-value: &lt; 2.2e-16</code>).</p></li>
</ol>
<div id="fig-OutputRegression" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap07/SortiesLM.jpg" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.12: Différentes parties obtenues avec la fonction <code>summary(Modèle)</code></figcaption></figure>
</div>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Intervalle de confiance des coefficients à 95 %</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           2.5 %        97.5 %
(Intercept)           50.8684505   54.79255157
log(HABHA)            -7.1847527   -6.52495353
poly(AgeMedian, 2)1  -18.5676034   42.53686203
poly(AgeMedian, 2)2 -313.4726002 -258.81630119
Pct_014                0.8793672    1.00190861
Pct_65P                0.2699504    0.34250907
Pct_MV                -0.0557951   -0.01681481
Pct_FR                -0.3659445   -0.32269562</code></pre>
</div>
</div>
</section><section id="sec-0772" class="level3" data-number="7.7.2"><h3 data-number="7.7.2" class="anchored" data-anchor-id="sec-0772">
<span class="header-section-number">7.7.2</span> Comparaison des modèles</h3>
<p>Tel que détaillé à la <a href="#sec-0732">section&nbsp;<span>7.3.2</span></a>, pour comparer des modèles imbriqués, il convient d’analyser les valeurs du R<sup>2</sup> ajusté et du <em>F</em> incrémentiel, ce qui peut être fait en trois étapes.</p>
<p><strong>Première étape.</strong> Il peut être judicieux d’afficher l’équation des différents modèles afin de se remémorer les VI introduites dans chacun d’eux, et ce, avec la fonction <code>MonModèle$call$formula</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Rappel des équations des huit modèles </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">modele1</span><span class="op">$</span><span class="va">call</span><span class="op">$</span><span class="va">formula</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>VegPct ~ HABHA + AgeMedian + Pct_014 + Pct_65P + Pct_MV + Pct_FR</code></pre>
</div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">modele2</span><span class="op">$</span><span class="va">call</span><span class="op">$</span><span class="va">formula</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>VegPct ~ HABHA + poly(AgeMedian, 2) + Pct_014 + Pct_65P + Pct_MV + 
    Pct_FR</code></pre>
</div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">$</span><span class="va">call</span><span class="op">$</span><span class="va">formula</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
    Pct_MV + Pct_FR</code></pre>
</div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">modele4</span><span class="op">$</span><span class="va">call</span><span class="op">$</span><span class="va">formula</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
    Pct_MV + Pct_FR + VilleMtl</code></pre>
</div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">modele5</span><span class="op">$</span><span class="va">call</span><span class="op">$</span><span class="va">formula</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
    Pct_MV + Pct_FR + Munic</code></pre>
</div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">modele6</span><span class="op">$</span><span class="va">call</span><span class="op">$</span><span class="va">formula</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
    Pct_MV + Pct_FR + DistCBDkm + DistCBDkm * Pct_014</code></pre>
</div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">modele7</span><span class="op">$</span><span class="va">call</span><span class="op">$</span><span class="va">formula</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
    Pct_MV + Pct_FR + VilleMtl + VilleMtlX_Pct_FR</code></pre>
</div>
</div>
<p><strong>Deuxième étape.</strong> La syntaxe ci-dessous vous permet de comparer les R<sup>2</sup> ajustés des différents modèles. Nous constatons ainsi que&nbsp;:</p>
<ul>
<li><p>La valeur du R<sup>2</sup> ajusté du modèle 2 est supérieure à celle du modèle 1 (0,4378 versus 0,4179), signalant que la forme polynomiale d’ordre 2 pour l’âge médian des bâtiments (<code>poly(AgeMedian, 2)</code>) améliore la prédiction comparativement à la forme originelle de (<code>AgeMedian</code>).</p></li>
<li><p>La valeur du R<sup>2</sup> ajusté du modèle 3 est supérieure à celle du modèle 2 (0,4653 versus 0,4378), signalant que la forme logarithmique pour la densité de population (<code>log(HABHA)</code>) améliore la prédiction comparativement à la forme originelle (<code>HABHA</code>).</p></li>
<li><p>La valeur du R<sup>2</sup> ajusté du modèle 4 est supérieure à celle du modèle 3 (0,4863 versus 0,4653), signalant que l’introduction de la variable dichotomique (<code>VilleMtl</code>) pour la municipalité apporte un gain de variance expliquée non négligeable.</p></li>
<li><p>La valeur du R<sup>2</sup> ajusté du modèle 5 est supérieure à celle du modèle 4 (0,5064 versus 0,4863), signalant que l’introduction de la variable polytomique pour les municipalités de l’île de Montréal (<code>Muni</code>) améliore la prédiction du modèle comparativement à la variable dichotomique (<code>VilleMtl</code>).</p></li>
<li><p>La valeur du R<sup>2</sup> ajusté du modèle 6 est supérieure à celle du modèle 2 (0,4953 versus 0,4378), signalant que l’introduction d’une variable d’interaction entre deux variables continues (<code>DistCBDkm + DistCBDkm * Pct_014</code>) apporte également un gain substantiel comparativement au modèle 2, ne comprenant pas cette variable d’interaction.</p></li>
<li><p>La valeur du R<sup>2</sup> ajusté du modèle 7 est supérieure à celle du modèle 2 (0,4877 versus 0,4378), signalant que l’introduction d’une variable d’interaction entre une variable continue et la variable dichotomique (<code>DistCBDkm + DistCBDkm * Pct_014</code>) apporte également un gain substantiel comparativement au modèle 2, ne comprenant pas cette variable d’interaction.</p></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nComparaison des R2 ajustés :"</span>,</span>
<span>    <span class="st">"\nModèle 1."</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele1</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>    <span class="st">"\nModèle 2."</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele2</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>    <span class="st">"\nModèle 3."</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>    <span class="st">"\nModèle 4."</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele4</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>    <span class="st">"\nModèle 5."</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele5</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>    <span class="st">"\nModèle 6."</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele6</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>    <span class="st">"\nModèle 7."</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele7</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Comparaison des R2 ajustés : 
Modèle 1. 0.4179 
Modèle 2. 0.4378 
Modèle 3. 0.4653 
Modèle 4. 0.4863 
Modèle 5. 0.5064 
Modèle 6. 0.4953 
Modèle 7. 0.4877</code></pre>
</div>
</div>
<p><strong>Troisième étape.</strong> La syntaxe ci-dessous permet d’obtenir le <em>F</em> incrémentiel pour des modèles ne comprenant pas le même nombre de variables dépendantes, et ce, en utilisant la fonction <code>anova(modele1, modele2, ..., modelen)</code>.</p>
<p>Par exemple, la syntaxe <code>anova(modele1, modele2)</code> permet de comparer les deux modèles et signale que le gain de variance expliquée entre les deux modèles (R<sup>2</sup> de 0,4179 et de 0,4378) est significatif (<em>F</em> incrémentiel = 362,64; <em>p</em>&nbsp;&lt;&nbsp;0,001).</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Comparaison des deux modèles uniquement (modèles 1 et 2)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">modele1</span>, <span class="va">modele2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: VegPct ~ HABHA + AgeMedian + Pct_014 + Pct_65P + Pct_MV + Pct_FR
Model 2: VegPct ~ HABHA + poly(AgeMedian, 2) + Pct_014 + Pct_65P + Pct_MV + 
    Pct_FR
  Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    
1  10203 2046427                                  
2  10202 1976182  1     70245 362.64 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Il est aussi possible de comparer plusieurs modèles simultanément. Notez que dans la syntaxe ci-dessous, le troisième modèle n’est pas inclus, car il comprend le même nombre de variables indépendantes que le second modèle; il en va de même pour le sixième modèle comparativement au cinquième. Ici aussi, l’analyse des valeurs de <em>F</em> et de <em>p</em> vous permettent de vérifier si les modèles, et donc leurs R<sup>2</sup> ajustés, sont significativement différents (quand <em>p</em>&nbsp;&lt;&nbsp;0,05).</p>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Comparaison de plusieurs modèles</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">modele1</span>, <span class="va">modele2</span>, <span class="va">modele4</span>, <span class="va">modele5</span>, <span class="va">modele7</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: VegPct ~ HABHA + AgeMedian + Pct_014 + Pct_65P + Pct_MV + Pct_FR
Model 2: VegPct ~ HABHA + poly(AgeMedian, 2) + Pct_014 + Pct_65P + Pct_MV + 
    Pct_FR
Model 3: VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
    Pct_MV + Pct_FR + VilleMtl
Model 4: VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
    Pct_MV + Pct_FR + Munic
Model 5: VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
    Pct_MV + Pct_FR + VilleMtl + VilleMtlX_Pct_FR
  Res.Df     RSS  Df Sum of Sq        F    Pr(&gt;F)    
1  10203 2046427                                     
2  10202 1976182   1     70245  412.995 &lt; 2.2e-16 ***
3  10201 1805547   1    170636 1003.224 &lt; 2.2e-16 ***
4  10188 1732849  13     72698   32.878 &lt; 2.2e-16 ***
5  10200 1800664 -12    -67815   33.226 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Quel modèle choisir?</strong></p>
</div>
<div class="bloc_attention-body">
<p>Nous avons déjà évoqué le principe de parcimonie. À titre de rappel, l’ajout de variables indépendantes qui s’avèrent significatives fait inévitablement augmenter la variance expliquée et ainsi la valeur R<sup>2</sup> ajusté. Par contre, elle peut rendre le modèle plus complexe à analyser, voire entraîner un surajustement du modèle. Nous avons vu que l’introduction des variables ditchtomique, polytomique et d’interaction avait pour effet d’augmenter la capacité de prédiction du modèle. Quoi qu’il en soit, le gain de variance expliquée s’élève à environ 4&nbsp;% entre le troisième modèle versus le cinquième et le sixième&nbsp;:</p>
<ul>
<li>Modèle 3 (R<sup>2</sup>=0,465). <code>VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + Pct_MV + Pct_FR</code>
</li>
<li>Modèle 5 (R<sup>2</sup>=0,506). <code>VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + Muni</code>
</li>
<li>Modèle 6 (R<sup>2</sup>=0,495). <code>VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + Pct_MV + Pct_FR + DistCBDkm + DistCBDkm * Pct_014</code>
</li>
</ul>
<p>Par conséquent, il est légitime de se questionner sur le bien-fondé de conserver ces variables indépendantes additionnelles&nbsp;: <code>Muni</code> pour le modèle 5 et <code>DistCBDkm + DistCBDkm * Pct_014</code> pour le modèle 6. Trois options sont alors envisageables&nbsp;:</p>
<ul>
<li><p>Bien entendu, conservez l’une ou l’autre de ces variables additionnelles si elles sont initialement reliées à votre cadre théorique.</p></li>
<li><p>Conservez l’une ou l’autre de ces variables additionnelles si elles permettent de répondre à une question spécifique (non prévue initialement) et si les associations ainsi révélées méritent, selon vous, discussion.</p></li>
<li><p>Supprimez-les si leur apport est limité et ne fait que complexifier le modèle.</p></li>
</ul>
</div>
</div>
</section><section id="sec-0773" class="level3" data-number="7.7.3"><h3 data-number="7.7.3" class="anchored" data-anchor-id="sec-0773">
<span class="header-section-number">7.7.3</span> Diagnostic sur un modèle</h3>
<section id="sec-07731" class="level4" data-number="7.7.3.1"><h4 data-number="7.7.3.1" class="anchored" data-anchor-id="sec-07731">
<span class="header-section-number">7.7.3.1</span> Vérification le nombre d’observations</h4>
<p>La syntaxe suivante permet de vérifier si le nombre d’observations est suffisant pour tester le R<sup>2</sup> et chacune des variables indépendantes.</p>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modele3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">HABHA</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">AgeMedian</span>,<span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>                       <span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span>, data <span class="op">=</span> <span class="va">DataFinal</span><span class="op">)</span></span>
<span><span class="co"># Nombre d'observation</span></span>
<span><span class="va">nobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span></span>
<span><span class="co"># Nombre de variables indépendantes (coefficients moins la constante)</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="co"># Première règle de pouce</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="va">nobs</span> <span class="op">&gt;=</span> <span class="fl">50</span><span class="op">+</span><span class="op">(</span><span class="fl">8</span><span class="op">*</span><span class="va">k</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nNombre d'observations suffisant pour tester le R2"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nAttention! Nombre d'observations insuffisant pour tester le R2"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Nombre d'observations suffisant pour tester le R2</code></pre>
</div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Deuxième règle de pouce</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="va">nobs</span> <span class="op">&gt;=</span> <span class="fl">104</span><span class="op">+</span><span class="va">k</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nNombre d'observations suffisant pour tester individuellement chaque VI"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nAttention! Nombre d'observations insuffisant"</span>,</span>
<span>  <span class="st">"\npour tester individuellement chaque VI"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Nombre d'observations suffisant pour tester individuellement chaque VI</code></pre>
</div>
</div>
</section><section id="sec-07732" class="level4" data-number="7.7.3.2"><h4 data-number="7.7.3.2" class="anchored" data-anchor-id="sec-07732">
<span class="header-section-number">7.7.3.2</span> Vérification la normalité des résidus</h4>
<p>La syntaxe suivante permet de vérifier la normalité des résidus selon les trois démarches classiques&nbsp;: 1) coefficients d’asymétrie et d’aplatissement, 2) test de normalité de Jarque-Bera (fonction <code>JarqueBeraTest</code> du <em>package</em> <code>DescTools</code>) et 3) les graphiques (histogramme avec courbe normale et diagramme quantile-quantile).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://andrisignorell.github.io/DescTools/">DescTools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Vecteur pour les résidus du modèle</span></span>
<span><span class="va">residus</span> <span class="op">&lt;-</span> <span class="va">modele3</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="co"># 1. coefficients d’asymétrie et d’aplatissement </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>Skewness<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Skew</a></span><span class="op">(</span><span class="va">residus</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>  Kurtosis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Kurt</a></span><span class="op">(</span><span class="va">residus</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Skewness Kurtosis 
  -0.263    1.149 </code></pre>
</div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. Test de normalité de Jarque-Bera</span></span>
<span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/JarqueBeraTest.html">JarqueBeraTest</a></span><span class="op">(</span><span class="va">residus</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Robust Jarque Bera Test

data:  residus
X-squared = 528.51, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3. Graphiques </span></span>
<span><span class="va">Ghisto</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">residus</span>, y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>,</span>
<span>                 bins <span class="op">=</span> <span class="fl">30</span>, color <span class="op">=</span> <span class="st">"#343a40"</span>, fill <span class="op">=</span> <span class="st">"#a8dadc"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, </span>
<span>                args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">residus</span><span class="op">)</span>,</span>
<span>                            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">residus</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                color <span class="op">=</span> <span class="st">"#e63946"</span>, size <span class="op">=</span> <span class="fl">1.2</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogramme et courbe normale"</span>,</span>
<span>      y <span class="op">=</span> <span class="st">"densité"</span>, <span class="st">"Résidus du modèle"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Gqqplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">residus</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq_line</a></span><span class="op">(</span>line.p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span><span class="op">)</span>,</span>
<span>               color <span class="op">=</span> <span class="st">"#e63946"</span>, size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Diagramme quantile-quantile"</span>,</span>
<span>     x <span class="op">=</span> <span class="st">"Valeurs théoriques"</span>,</span>
<span>     y <span class="op">=</span> <span class="st">"Résidus"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">Ghisto</span>, <span class="va">Gqqplot</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-VerifierNormaliteResidusDia" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-VerifierNormaliteResidusDia-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.13: Diagnostic : la normalité des résidus</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-07733" class="level4" data-number="7.7.3.3"><h4 data-number="7.7.3.3" class="anchored" data-anchor-id="sec-07733">
<span class="header-section-number">7.7.3.3</span> Évaluation de la linéarité et l’homoscédasticité des résidus</h4>
<p>La syntaxe suivante permet de vérifier si l’hypothèse d’homoscédasticité des résidus est respectée avec&nbsp;: 1) un nuage de points entre les valeurs prédites et des résidus, 3) les graphiques (histogramme avec courbe normale et diagramme quantile-quantile) et 2) le test de Breusch-Pagan (fonction <code>bptest</code> du <em>package</em> <code>lmtest</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 1. Test de Breusch-Pagan pour vérifier l'homoscédasticité</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  modele3
BP = 1651.5, df = 7, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nAttention : problème d'hétéroscédasticité des résidus"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nParfait : homoscédasticité des résidus"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Attention : problème d'hétéroscédasticité des résidus</code></pre>
</div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. Graphique entre les valeurs prédites et les résidus</span></span>
<span><span class="va">residus</span> <span class="op">&lt;-</span>  <span class="va">modele3</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">ypredits</span> <span class="op">&lt;-</span> <span class="va">modele3</span><span class="op">$</span><span class="va">fitted.values</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ypredits</span>, y <span class="op">=</span> <span class="va">residus</span><span class="op">)</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"#343a40"</span>, fill <span class="op">=</span> <span class="st">"#a8dadc"</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ypredits</span>, y <span class="op">=</span> <span class="va">residus</span><span class="op">)</span>, </span>
<span>              method <span class="op">=</span> <span class="va">lm</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Valeurs prédites"</span>, y <span class="op">=</span> <span class="st">"Résidus"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-DiaHomoscedasticite" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-DiaHomoscedasticite-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.14: Distribution des résidus en fonction des valeurs prédites</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-07734" class="level4" data-number="7.7.3.4"><h4 data-number="7.7.3.4" class="anchored" data-anchor-id="sec-07734">
<span class="header-section-number">7.7.3.4</span> Vérification la multicolinéarité excessive</h4>
<p>Pour vérifier la présence ou l’absence de multicolinéarité excessive, nous utilisons habituellement la fonction <code>vif</code> du <em>package</em> <code>car</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="co"># facteur d'inflation de la variance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    GVIF Df GVIF^(1/(2*Df))
log(HABHA)         1.289  1           1.136
poly(AgeMedian, 2) 1.387  2           1.085
Pct_014            1.518  1           1.232
Pct_65P            1.304  1           1.142
Pct_MV             1.480  1           1.217
Pct_FR             1.730  1           1.315</code></pre>
</div>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># problème de multicolinéarité (VIF &gt; 10)?</span></span>
<span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">10</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    GVIF    Df GVIF^(1/(2*Df))
log(HABHA)         FALSE FALSE           FALSE
poly(AgeMedian, 2) FALSE FALSE           FALSE
Pct_014            FALSE FALSE           FALSE
Pct_65P            FALSE FALSE           FALSE
Pct_MV             FALSE FALSE           FALSE
Pct_FR             FALSE FALSE           FALSE</code></pre>
</div>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># problème de multicolinéarité (VIF &gt; 5)?</span></span>
<span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">5</span> </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    GVIF    Df GVIF^(1/(2*Df))
log(HABHA)         FALSE FALSE           FALSE
poly(AgeMedian, 2) FALSE FALSE           FALSE
Pct_014            FALSE FALSE           FALSE
Pct_65P            FALSE FALSE           FALSE
Pct_MV             FALSE FALSE           FALSE
Pct_FR             FALSE FALSE           FALSE</code></pre>
</div>
</div>
</section><section id="sec-07735" class="level4" data-number="7.7.3.5"><h4 data-number="7.7.3.5" class="anchored" data-anchor-id="sec-07735">
<span class="header-section-number">7.7.3.5</span> Répérage des valeurs très influentes du modèle</h4>
<p>La syntaxe suivante permet d’évaluer le nombre de valeurs très influentes dans le modèle avec les critères de <span class="math inline">\(\mbox{4/n}\)</span>, <span class="math inline">\(\mbox{8/n}\)</span> et <span class="math inline">\(\mbox{16/n}\)</span> pour la distance de Cook.</p>
<div class="cell">
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span></span>
<span><span class="va">DistanceCook</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span></span>
<span><span class="va">n4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">DistanceCook</span><span class="op">[</span><span class="va">DistanceCook</span> <span class="op">&gt;</span> <span class="fl">4</span><span class="op">/</span><span class="va">nobs</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">n8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">DistanceCook</span><span class="op">[</span><span class="va">DistanceCook</span> <span class="op">&gt;</span> <span class="fl">8</span><span class="op">/</span><span class="va">nobs</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">n16</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">DistanceCook</span><span class="op">[</span><span class="va">DistanceCook</span> <span class="op">&gt;</span> <span class="fl">16</span><span class="op">/</span><span class="va">nobs</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Nombre d'observations ="</span>, <span class="va">nobs</span>, <span class="st">"(100 %)"</span>,</span>
<span>    <span class="st">"\n 4/n ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">/</span><span class="va">nobs</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>    <span class="st">"\n 8/n ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">8</span><span class="op">/</span><span class="va">nobs</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>    <span class="st">"\n 16/n ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">16</span><span class="op">/</span><span class="va">nobs</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span><span class="st">"\nObservations avec une valeur supérieure ou égale aux différents seuils"</span>,</span>
<span>    <span class="st">"\n 4/n ="</span>, <span class="va">n4</span>, <span class="st">"soit"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n4</span><span class="op">/</span><span class="va">nobs</span><span class="op">*</span><span class="fl">100</span>,<span class="fl">2</span><span class="op">)</span>,<span class="st">" %"</span>,</span>
<span>    <span class="st">"\n 8/n ="</span>, <span class="va">n8</span>, <span class="st">"soit"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n8</span><span class="op">/</span><span class="va">nobs</span><span class="op">*</span><span class="fl">100</span>,<span class="fl">2</span><span class="op">)</span>,<span class="st">" %"</span>,</span>
<span>    <span class="st">"\n 16/n ="</span>, <span class="va">n16</span>, <span class="st">"soit"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n16</span><span class="op">/</span><span class="va">nobs</span><span class="op">*</span><span class="fl">100</span>,<span class="fl">2</span><span class="op">)</span>, <span class="st">" %"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Nombre d'observations = 10210 (100 %) 
 4/n = 0.00039 
 8/n = 0.00078 
 16/n = 0.00157 
Observations avec une valeur supérieure ou égale aux différents seuils 
 4/n = 604 soit 5.92  % 
 8/n = 285 soit 2.79  % 
 16/n = 132 soit 1.29  %</code></pre>
</div>
</div>
<p>Vous pouvez également construire un nuage de points avec la distance de Cook et l’effet de levier (<em>leverage value</em>) pour repérer visuellement les observations très influentes (<a href="#fig-DiaGraphCookLev">figure&nbsp;<span>7.15</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span><span class="va">DistanceCook</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span></span>
<span><span class="va">LeverageValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hatvalues</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">G1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">LeverageValue</span>, y <span class="op">=</span> <span class="va">DistanceCook</span><span class="op">)</span>, </span>
<span>             alpha <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Effet levier"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Distance de Cook"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Repérer les valeurs influentes"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"(toutes les observations)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">G2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">LeverageValue</span>, y <span class="op">=</span> <span class="va">DistanceCook</span><span class="op">)</span>, </span>
<span>             alpha <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.01</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.01</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Effet levier"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Distance de Cook"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Repérer les valeurs influentes"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"(agrandissement)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">G1</span>, <span class="va">G2</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-DiaGraphCookLev" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-DiaGraphCookLev-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;7.15: Repérage graphique des valeurs influentes du modèle</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-07736" class="level4" data-number="7.7.3.6"><h4 data-number="7.7.3.6" class="anchored" data-anchor-id="sec-07736">
<span class="header-section-number">7.7.3.6</span> Construction d’un nouveau modèle en supprimant les observations très influentes du modèle</h4>
<p>Dans un premier temps, il convient de construire un nouveau modèle sans les valeurs influentes du modèle de départ.</p>
<div class="cell">
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Nombre d'observation dans le modèle 3</span></span>
<span><span class="va">nobs</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span></span>
<span><span class="co"># Distance de Cook</span></span>
<span><span class="va">cook</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span></span>
<span><span class="co"># Les observations très influentes avec le critère de 16/n</span></span>
<span><span class="va">DataSansOutliers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">DataFinal</span>, <span class="va">cook</span><span class="op">)</span></span>
<span><span class="va">DataSansOutliers</span> <span class="op">&lt;-</span> <span class="va">DataSansOutliers</span><span class="op">[</span><span class="va">DataSansOutliers</span><span class="op">$</span><span class="va">cook</span>  <span class="op">&lt;</span> <span class="fl">8</span><span class="op">/</span><span class="va">nobs</span>, <span class="op">]</span></span>
<span><span class="va">modele3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">VegPct</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">HABHA</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">AgeMedian</span>,<span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="va">Pct_014</span><span class="op">+</span><span class="va">Pct_65P</span><span class="op">+</span><span class="va">Pct_MV</span><span class="op">+</span><span class="va">Pct_FR</span>,</span>
<span>              data <span class="op">=</span> <span class="va">DataSansOutliers</span><span class="op">)</span></span>
<span><span class="va">nobsb</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">modele3b</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Comparez les valeurs du R<sup>2</sup> ajusté des deux modèles. Habituellement, la suppression des valeurs très influentes s’accompagne d’une augmentation du R<sup>2</sup> ajusté. C’est notamment le cas ici puisque sa valeur grimpe de 0,4653 à 0,5684, signalant ainsi un gain important pour la variance expliquée.</p>
<div class="cell">
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nComparaison des R2 ajustés :"</span>,</span>
<span>    <span class="st">"\nModèle de départ (n="</span>, <span class="va">nobs</span>, <span class="st">"), "</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>    <span class="st">"\nModèle sans les observations très influentes (n="</span>, <span class="va">nobsb</span>, <span class="st">"), "</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele3b</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Comparaison des R2 ajustés :
Modèle de départ (n=10210), 0.4653
Modèle sans les observations très influentes (n=9925), 0.5684</code></pre>
</div>
</div>
<p>Pour le modèle, il convient alors de refaire le diagnostic de la régression et de vérifier si la suppression des observations très influentes a amélioré&nbsp;: 1) la normalité, la linéarité et l’homoscédasticité des résidus, 2) la multicolinéarité excessive et 3) l’absence de valeurs trop influentes.</p>
<p><strong>La normalité des résidus s’est-elle ou non améliorée?</strong></p>
<p>Pour ce faire, comparez les valeurs d’asymétrie, d’aplatissement et du test de Jarque-Bera et les graphiques de normalité. À la lecture des valeurs&nbsp;:</p>
<ul>
<li><p>l’asymétrie est très similaire (-0,260 à -0,265);</p></li>
<li><p>l’aplatissement s’est amélioré (1,183 à 0,164);</p></li>
<li><p>le test de Jarque-Bera signale toujours un problème de normalité (<em>p</em>&nbsp;&lt;&nbsp;0,001), mais sa valeur a nettement diminué (548,7 à 131,24);</p></li>
<li><p>les graphiques démontrent une nette amélioration de la normalité des résidus (<a href="#fig-ResidusCompa">figure&nbsp;<span>7.16</span></a>).</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 1. coefficients d’asymétrie et d’aplatissement </span></span>
<span><span class="va">resmodele3</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstudent</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span></span>
<span><span class="va">resmodele3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstudent</a></span><span class="op">(</span><span class="va">modele3b</span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>Skewness<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Skew</a></span><span class="op">(</span><span class="va">resmodele3</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>  Kurtosis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Kurt</a></span><span class="op">(</span><span class="va">resmodele3</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Skewness Kurtosis 
  -0.260    1.183 </code></pre>
</div>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>Skewness<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Skew</a></span><span class="op">(</span><span class="va">resmodele3b</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>  Kurtosis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Skew.html">Kurt</a></span><span class="op">(</span><span class="va">resmodele3b</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Skewness Kurtosis 
  -0.265    0.164 </code></pre>
</div>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 2. Test de normalité de Jarque-Bera</span></span>
<span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/JarqueBeraTest.html">JarqueBeraTest</a></span><span class="op">(</span><span class="va">resmodele3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Robust Jarque Bera Test

data:  resmodele3
X-squared = 548.7, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/JarqueBeraTest.html">JarqueBeraTest</a></span><span class="op">(</span><span class="va">resmodele3b</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Robust Jarque Bera Test

data:  resmodele3b
X-squared = 131.24, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 3. Graphiques </span></span>
<span><span class="va">Ghisto1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">resmodele3</span>, y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>,</span>
<span>                 bins <span class="op">=</span> <span class="fl">30</span>, color <span class="op">=</span> <span class="st">"#343a40"</span>, fill <span class="op">=</span> <span class="st">"#a8dadc"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>,  args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">resmodele3</span><span class="op">)</span>,</span>
<span>                                          sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">resmodele3</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                color <span class="op">=</span> <span class="st">"#e63946"</span>, size <span class="op">=</span> <span class="fl">1.2</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Modèle de départ"</span>, y <span class="op">=</span> <span class="st">"densité"</span>, x <span class="op">=</span> <span class="st">"Résidus studentisés"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Gqqplot1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">residus</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq_line</a></span><span class="op">(</span>line.p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#e63946"</span>, size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Modèle de départ"</span>, x <span class="op">=</span> <span class="st">"Valeurs théoriques"</span>, y <span class="op">=</span> <span class="st">"Résidus studentisés"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Ghisto2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">resmodele3b</span>, y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>,</span>
<span>                 bins <span class="op">=</span> <span class="fl">30</span>, color <span class="op">=</span> <span class="st">"#343a40"</span>, fill <span class="op">=</span> <span class="st">"#a8dadc"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>,  args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">resmodele3b</span><span class="op">)</span>,</span>
<span>                                          sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">resmodele3b</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                color <span class="op">=</span> <span class="st">"#e63946"</span>, linewidth <span class="op">=</span> <span class="fl">1.2</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Modèle après suppression"</span>, x <span class="op">=</span> <span class="st">"Valeurs théoriques"</span>, y <span class="op">=</span> <span class="st">"Résidus studentisés"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Gqqplot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">resmodele3b</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq_line</a></span><span class="op">(</span>line.p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#e63946"</span>, size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Modèle après suppression"</span>,x <span class="op">=</span> <span class="st">"Valeurs théoriques"</span>, y <span class="op">=</span> <span class="st">"Résidus studentisés"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">Ghisto1</span>, <span class="va">Ghisto2</span>, <span class="va">Gqqplot1</span>, <span class="va">Gqqplot2</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ResidusCompa" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-ResidusCompa-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.16: Normalité des résidus avant et après la suppression des valeurs influentes</figcaption></figure>
</div>
</div>
</div>
<p><strong>Le problème d’hétéroscédasticité est-il corrigé?</strong></p>
<ul>
<li>la valeur du test de Breusch-Pagan est beaucoup plus faible, mais il semble persister un problème d’hétéroscédasticité.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># homoscédasticité des résidus améliorée ou non?</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  modele3
BP = 1651.5, df = 7, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">modele3b</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  modele3b
BP = 640.53, df = 7, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">resmodele3</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span></span>
<span><span class="va">resmodele3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">modele3b</span><span class="op">)</span></span>
<span><span class="va">ypredits3</span> <span class="op">&lt;-</span> <span class="va">modele3</span><span class="op">$</span><span class="va">fitted.values</span></span>
<span><span class="va">ypredits3b</span> <span class="op">&lt;-</span> <span class="va">modele3b</span><span class="op">$</span><span class="va">fitted.values</span></span>
<span></span>
<span><span class="va">G1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ypredits3</span>, y <span class="op">=</span> <span class="va">resmodele3</span><span class="op">)</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"#343a40"</span>, fill <span class="op">=</span> <span class="st">"#a8dadc"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ypredits3</span>, y <span class="op">=</span> <span class="va">resmodele3</span><span class="op">)</span>,  method <span class="op">=</span> <span class="va">lm</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Modèle de départ"</span>,x <span class="op">=</span> <span class="st">"Valeurs prédites"</span>, y <span class="op">=</span> <span class="st">"Résidus studentisés"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">G2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ypredits3b</span>, y <span class="op">=</span> <span class="va">resmodele3b</span><span class="op">)</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"#343a40"</span>, fill <span class="op">=</span> <span class="st">"#a8dadc"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ypredits3b</span>, y <span class="op">=</span> <span class="va">resmodele3b</span><span class="op">)</span>,  method <span class="op">=</span> <span class="va">lm</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Modèle après suppression"</span>,x <span class="op">=</span> <span class="st">"Valeurs prédites"</span>, y <span class="op">=</span> <span class="st">"Résidus studentisés"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">G1</span>, <span class="va">G2</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-HomosComp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-HomosComp-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.17: Amélioration de l’homoscédasticité des résidus</figcaption></figure>
</div>
</div>
</div>
<p>Finalement, il convient de comparer les coefficients de régression.</p>
<div class="cell">
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Comparaison des coefficients</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + 
    Pct_65P + Pct_MV + Pct_FR, data = DataFinal)

Residuals:
    Min      1Q  Median      3Q     Max 
-66.848  -8.660   0.381   8.961  83.269 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          5.283e+01  1.001e+00  52.781  &lt; 2e-16 ***
log(HABHA)          -6.855e+00  1.683e-01 -40.730  &lt; 2e-16 ***
poly(AgeMedian, 2)1  1.198e+01  1.559e+01   0.769 0.441958    
poly(AgeMedian, 2)2 -2.861e+02  1.394e+01 -20.525  &lt; 2e-16 ***
Pct_014              9.406e-01  3.126e-02  30.093  &lt; 2e-16 ***
Pct_65P              3.062e-01  1.851e-02  16.546  &lt; 2e-16 ***
Pct_MV              -3.630e-02  9.943e-03  -3.651 0.000262 ***
Pct_FR              -3.443e-01  1.103e-02 -31.212  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.57 on 10202 degrees of freedom
Multiple R-squared:  0.4657,    Adjusted R-squared:  0.4653 
F-statistic:  1270 on 7 and 10202 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele3b</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + 
    Pct_65P + Pct_MV + Pct_FR, data = DataSansOutliers)

Residuals:
    Min      1Q  Median      3Q     Max 
-46.417  -7.734   0.456   8.290  40.085 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          6.748e+01  9.869e-01  68.370  &lt; 2e-16 ***
log(HABHA)          -1.000e+01  1.720e-01 -58.167  &lt; 2e-16 ***
poly(AgeMedian, 2)1  4.357e+01  1.387e+01   3.142  0.00168 ** 
poly(AgeMedian, 2)2 -3.564e+02  1.250e+01 -28.510  &lt; 2e-16 ***
Pct_014              8.351e-01  2.870e-02  29.101  &lt; 2e-16 ***
Pct_65P              2.271e-01  1.807e-02  12.566  &lt; 2e-16 ***
Pct_MV              -8.517e-03  9.109e-03  -0.935  0.34976    
Pct_FR              -2.924e-01  1.028e-02 -28.440  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.96 on 9917 degrees of freedom
Multiple R-squared:  0.5687,    Adjusted R-squared:  0.5684 
F-statistic:  1868 on 7 and 9917 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section></section><section id="sec-0774" class="level3" data-number="7.7.4"><h3 data-number="7.7.4" class="anchored" data-anchor-id="sec-0774">
<span class="header-section-number">7.7.4</span> Graphiques pour les effets marginaux</h3>
<p>Tel que signalé ultérieurement, il est courant de représenter l’effet marginal d’une VI sur une VD, une fois contrôlées les autres VI. Pour ce faire, il est possible d’utiliser les <em>packages</em> <code>ggplot2</code> et <code>ggeffects</code>.</p>
<section id="sec-07741" class="level4" data-number="7.7.4.1"><h4 data-number="7.7.4.1" class="anchored" data-anchor-id="sec-07741">
<span class="header-section-number">7.7.4.1</span> Effet marginal pour une variable continue</h4>
<p>La syntaxe ci-dessous illustre comment obtenir un graphique pour nos quatre variables explicatives. Bien entendu, si le coefficient de régression est positif (comme pour les pourcentages de jeunes de moins de 15 ans et les personnes âgées), la pente est alors montante, et inversement descendante pour des coefficients négatifs (comme pour les personnes ayant déclaré appartenir à une minorité visible et les personnes à faible revenu). En outre, plus la valeur absolue du coefficient est forte, plus la pente est prononcée.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/">ggeffects</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Création d'un DataFrame pour les valeurs prédites pour chaque VI continue</span></span>
<span><span class="va">fitV1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">modele3</span>, terms <span class="op">=</span> <span class="st">"Pct_014"</span><span class="op">)</span></span>
<span><span class="va">fitV2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">modele3</span>, terms <span class="op">=</span> <span class="st">"Pct_65P"</span><span class="op">)</span></span>
<span><span class="va">fitV3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">modele3</span>, terms <span class="op">=</span> <span class="st">"Pct_MV"</span><span class="op">)</span></span>
<span><span class="va">fitV4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">modele3</span>, terms <span class="op">=</span> <span class="st">"Pct_FR"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Construction des graphiques</span></span>
<span><span class="va">G1</span> <span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fitV1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># ligne de régression</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># intervalle de confiance à 95 %</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="co">#  Titres</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"valeur prédite Y"</span>, x <span class="op">=</span> <span class="st">"Moins de 15 ans (%)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">G2</span> <span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fitV2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"valeur prédite Y"</span>, x <span class="op">=</span> <span class="st">"65 ans et plus (%)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">G3</span> <span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fitV3</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"valeur prédite Y"</span>, x <span class="op">=</span> <span class="st">"Minorités visibles (%)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">G4</span> <span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fitV4</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"valeur prédite Y"</span>, x <span class="op">=</span> <span class="st">"Personne à faible revenu (%)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assemblage des graphiques</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">G1</span>, <span class="va">G2</span>, <span class="va">G3</span>, <span class="va">G4</span>, ncol <span class="op">=</span><span class="fl">2</span>, nrow <span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-EffetMarginalVariablesContinues" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-EffetMarginalVariablesContinues-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.18: Effets marginaux pour des variables continues</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-07742" class="level4" data-number="7.7.4.2"><h4 data-number="7.7.4.2" class="anchored" data-anchor-id="sec-07742">
<span class="header-section-number">7.7.4.2</span> Effet marginal pour une variable avec une fonction polynomiale d’ordre 2</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/">ggeffects</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fitAgeMedian</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">modele3</span>, terms <span class="op">=</span> <span class="st">"AgeMedian"</span><span class="op">)</span></span>
<span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fitAgeMedian</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"green"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Variable sous forme polynomiale (ordre 2)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"VD: valeur prédite"</span>, x <span class="op">=</span> <span class="st">"Âge médian des bâtiments"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-Titi" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-Titi-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.19: Effet marginal d’une variable avec un fonction polynomiale d’ordre 2</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-07743" class="level4" data-number="7.7.4.3"><h4 data-number="7.7.4.3" class="anchored" data-anchor-id="sec-07743">
<span class="header-section-number">7.7.4.3</span> Effet marginal pour une variable transformée en logarithme</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fitHabHa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">modele3</span>, terms <span class="op">=</span> <span class="st">"HABHA"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fitHabHa</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"VD: valeur prédite"</span>, x <span class="op">=</span> <span class="st">"Habitants km2"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-EffetMarginalVariableLog" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-EffetMarginalVariableLog-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.20: Effet du logarithme de la densité</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-07744" class="level4" data-number="7.7.4.4"><h4 data-number="7.7.4.4" class="anchored" data-anchor-id="sec-07744">
<span class="header-section-number">7.7.4.4</span> Effet marginal pour une variable dichotomique</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Valeurs prédites selon le modèle avec la variable dichotomique</span></span>
<span><span class="va">fitVilleMtl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">modele4</span>, terms <span class="op">=</span> <span class="st">"VilleMtl"</span><span class="op">)</span></span>
<span><span class="co"># Graphique</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fitVilleMtl</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"wheat"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.9</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Effet marginal de la ville de Montréal sur la végétation"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Municipalités de la région de Montréal"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Couverture végétation de l'îlot (%)"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Autre municipalité"</span>, <span class="st">"Ville de Montréal"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-EffetMarginalDichCode" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-EffetMarginalDichCode-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.21: Effet marginal d’une variable dichotomique</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-07745" class="level4" data-number="7.7.4.5"><h4 data-number="7.7.4.5" class="anchored" data-anchor-id="sec-07745">
<span class="header-section-number">7.7.4.5</span> Effet marginal pour une variable polytomique</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Valeurs prédites selon le modèle avec la variable polytomique</span></span>
<span><span class="va">fitVilles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/ggpredict.html">ggpredict</a></span><span class="op">(</span><span class="va">modele5</span>, terms <span class="op">=</span> <span class="st">"Munic"</span><span class="op">)</span></span>
<span><span class="co"># Graphique</span></span>
<span><span class="va">Graphique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fitVilles</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"wheat"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.9</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Effet marginal de la ville de Montréal sur la végétation"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Municipalités de la région de Montréal"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Couverture végétation de l'îlot (%)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rotation du graphique</span></span>
<span><span class="va">Graphique</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-EffetMarginalPolyT" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-EffetMarginalPolyT-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.22: Effet marginal d’une variable polytomique</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-07746" class="level4" data-number="7.7.4.6"><h4 data-number="7.7.4.6" class="anchored" data-anchor-id="sec-07746">
<span class="header-section-number">7.7.4.6</span> Effet marginal pour une variable d’interaction (deux VI continues)</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://eliocamp.github.io/metR/">metR</a></span><span class="op">)</span> <span class="co"># pour ajouter des labels aux contours</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span></span>
<span>  DistCBDkm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">33</span>,<span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  Pct_FR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">95</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>  HABHA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">HABHA</span><span class="op">)</span>,</span>
<span>  AgeMedian <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">AgeMedian</span><span class="op">)</span>,</span>
<span>  Pct_014 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">Pct_014</span><span class="op">)</span>,</span>
<span>  Pct_65P <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">Pct_65P</span><span class="op">)</span>,</span>
<span>  Pct_MV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">Pct_MV</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">DistCBDkmX_Pct_FR</span> <span class="op">&lt;-</span>  <span class="va">df</span><span class="op">$</span><span class="va">DistCBDkm</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">Pct_FR</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">modele6</span>, newdata <span class="op">=</span> <span class="va">df</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">pred</span><span class="op">$</span><span class="va">fit</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">pred_se</span> <span class="op">&lt;-</span> <span class="va">pred</span><span class="op">$</span><span class="va">se.fit</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">lower</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">pred</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">pred_se</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">upper</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">pred</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">pred_se</span></span>
<span></span>
<span><span class="va">P1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DistCBDkm</span>, y <span class="op">=</span> <span class="va">Pct_FR</span>, fill <span class="op">=</span> <span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">stat_contour</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DistCBDkm</span>, y <span class="op">=</span> <span class="va">Pct_FR</span>, z <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>, </span>
<span>               color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://eliocamp.github.io/metR/reference/geom_text_contour.html">geom_text_contour</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DistCBDkm</span>, y <span class="op">=</span> <span class="va">Pct_FR</span>, z <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>, <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis</span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Distance au centre-ville"</span>, </span>
<span>       y <span class="op">=</span> <span class="st">"Pers à faible revenu (%)"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">""</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Prédiction"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">P2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DistCBDkm</span>, y <span class="op">=</span> <span class="va">Pct_FR</span>, fill <span class="op">=</span> <span class="va">lower</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">stat_contour</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DistCBDkm</span>, y <span class="op">=</span> <span class="va">Pct_FR</span>, z <span class="op">=</span> <span class="va">lower</span><span class="op">)</span>, </span>
<span>               color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://eliocamp.github.io/metR/reference/geom_text_contour.html">geom_text_contour</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DistCBDkm</span>, y <span class="op">=</span> <span class="va">Pct_FR</span>, z <span class="op">=</span> <span class="va">lower</span><span class="op">)</span>, <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis</span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Distance au centre-ville"</span>, </span>
<span>       y <span class="op">=</span> <span class="st">"Pers à faible revenu (%)"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">""</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"IC 2,5 %"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">P3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DistCBDkm</span>, y <span class="op">=</span> <span class="va">Pct_FR</span>, fill <span class="op">=</span> <span class="va">upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">stat_contour</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DistCBDkm</span>, y <span class="op">=</span> <span class="va">Pct_FR</span>, z <span class="op">=</span> <span class="va">upper</span><span class="op">)</span>, </span>
<span>               color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://eliocamp.github.io/metR/reference/geom_text_contour.html">geom_text_contour</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DistCBDkm</span>, y <span class="op">=</span> <span class="va">Pct_FR</span>, z <span class="op">=</span> <span class="va">upper</span><span class="op">)</span>, <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis</span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Distance au centre-ville"</span>, </span>
<span>       y <span class="op">=</span> <span class="st">"Pers à faible revenu (%)"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">""</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"IC 97,5 %"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">P1</span>, <span class="va">P2</span>, <span class="va">P3</span>, common.legend <span class="op">=</span> <span class="cn">FALSE</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ModeleInteraction2heatex" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-ModeleInteraction2heatex-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.23: Effet marginal de l’interaction entre deux variables continues</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-07747" class="level4" data-number="7.7.4.7"><h4 data-number="7.7.4.7" class="anchored" data-anchor-id="sec-07747">
<span class="header-section-number">7.7.4.7</span> Effet marginal pour une variable d’interaction (une VI continue et une VI dichotomique)</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span></span>
<span>  VilleMtl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>  Pct_FR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">95</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>  HABHA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">HABHA</span><span class="op">)</span>,</span>
<span>  AgeMedian <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">AgeMedian</span><span class="op">)</span>,</span>
<span>  Pct_014 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">Pct_014</span><span class="op">)</span>,</span>
<span>  Pct_65P <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">Pct_65P</span><span class="op">)</span>,</span>
<span>  Pct_MV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">Pct_MV</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">VilleMtlX_Pct_FR</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">VilleMtl</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">Pct_FR</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  VilleMtl Pct_FR   HABHA AgeMedian  Pct_014  Pct_65P   Pct_MV VilleMtlX_Pct_FR
1        0      0 87.7694  52.11494 15.89268 14.86761 20.96675                0
2        1      0 87.7694  52.11494 15.89268 14.86761 20.96675                0
3        0      1 87.7694  52.11494 15.89268 14.86761 20.96675                0
4        1      1 87.7694  52.11494 15.89268 14.86761 20.96675                1
5        0      2 87.7694  52.11494 15.89268 14.86761 20.96675                0</code></pre>
</div>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">modele7</span>, se <span class="op">=</span> <span class="cn">TRUE</span>, newdata <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">pred</span><span class="op">$</span><span class="va">fit</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">upper</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">pred</span> <span class="op">+</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">pred</span><span class="op">$</span><span class="va">se.fit</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">lower</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">pred</span> <span class="op">-</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">pred</span><span class="op">$</span><span class="va">se.fit</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">VilleMtl_str</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">VilleMtl</span><span class="op">==</span><span class="fl">0</span>,<span class="st">"Autre municipalité"</span> , <span class="st">"Ville de Montréal"</span><span class="op">)</span></span>
<span><span class="va">DataFinal</span><span class="op">$</span><span class="va">VilleMtl_str</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">DataFinal</span><span class="op">$</span><span class="va">VilleMtl</span><span class="op">==</span><span class="fl">0</span>,<span class="st">"Autre municipalité"</span> , <span class="st">"Ville de Montréal"</span><span class="op">)</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Autre municipalité"</span> <span class="op">=</span><span class="st">"#1d3557"</span> ,<span class="st">"Ville de Montréal"</span><span class="op">=</span><span class="st">"#e63946"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DataFinal</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Pct_FR</span>, y <span class="op">=</span> <span class="va">VegPct</span>, color <span class="op">=</span> <span class="va">VilleMtl_str</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Pct_FR</span>, ymin <span class="op">=</span> <span class="va">lower</span>, ymax <span class="op">=</span> <span class="va">upper</span>, group <span class="op">=</span> <span class="va">VilleMtl_str</span><span class="op">)</span>,</span>
<span>              fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Pct_FR</span>, y <span class="op">=</span> <span class="va">pred</span>, color <span class="op">=</span> <span class="va">VilleMtl_str</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">cols</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Personnes à faible revenu (%)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Densité de végétation prédite (%)"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ModeleInteractionBinaireeffectex" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-regressionlineaire_files/figure-html/fig-ModeleInteractionBinaireeffectex-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;7.24: Graphique de l’effet marginal de l’interaction entre une variable quantitative et qualitative</figcaption></figure>
</div>
</div>
</div>
</section></section></section><section id="sec-078" class="level2" data-number="7.8"><h2 data-number="7.8" class="anchored" data-anchor-id="sec-078">
<span class="header-section-number">7.8</span> Quiz de révision du chapitre</h2>
<div id="Chapitre7_Lm" class="card">
<link type="text/javascript" src="libs/quizlib.1.0.1.min.js">
<script>var Quiz=function(a,b){this.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),this.unansweredQuestionText="Question sans réponse !",this.container=document.getElementById(a),this.questions=[],this.result=new QuizResult,this.answers=b;for(var c=0;c<this.container.children.length;c++)this.container.children[c].classList.contains(Quiz.Classes.QUESTION)&&this.questions.push(this.container.children[c]);if(this.answers.length!=this.questions.length)throw new Error("Number of answers does not match number of questions!")};Quiz.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),Quiz.prototype.checkAnswers=function(a){void 0===a&&(a=!0);for(var b=[],c=[],d=0;d<this.questions.length;d++){var e=this.questions[d],f=this.answers[d],g=[];this.clearHighlights(e);for(var h,i=e.getElementsByClassName(Quiz.Classes.QUESTION_ANSWERS)[0].getElementsByTagName("input"),j=0;j<i.length;j++)h=i[j],"checkbox"===h.type||"radio"===h.type?h.checked&&g.push(h.value):""!==h.value&&g.push(h.value);1!=g.length||Array.isArray(f)?0===g.length&&b.push(e):g=g[0],c.push(Utils.compare(g,f))}if(0===b.length||!a)return this.result.setResults(c),!0;for(d=0;d<b.length;d++){var k=document.createElement("span");k.appendChild(document.createTextNode(this.unansweredQuestionText)),k.className=Quiz.Classes.QUESTION_WARNING,b[d].getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].appendChild(k)}return!1},Quiz.prototype.clearHighlights=function(a){for(var b=a.getElementsByClassName(Quiz.Classes.QUESTION_WARNING);b.length>0;)b[0].parentNode.removeChild(b[0]);var c,d=[a.getElementsByClassName(Quiz.Classes.CORRECT),a.getElementsByClassName(this.Classes.INCORRECT)];for(i=0;i<d.length;i++)for(;d[i].length>0;)c=d[i][0],c.classList.remove(Quiz.Classes.CORRECT),c.classList.remove(Quiz.Classes.INCORRECT);for(var e=a.getElementsByClassName(Quiz.Classes.TEMP);e.length>0;)e[0].parentNode.removeChild(e[0])},Quiz.prototype.highlightResults=function(a){for(var b,c=0;c<this.questions.length;c++)b=this.questions[c],b.getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].classList.add(this.result.results[c]?Quiz.Classes.CORRECT:Quiz.Classes.INCORRECT),void 0!==a&&a(this,b,c,this.result.results[c])};var QuizResult=function(){this.results=[],this.totalQuestions=0,this.score=0,this.scorePercent=0,this.scorePercentFormatted=0};QuizResult.prototype.setResults=function(a){this.results=a,this.totalQuestions=this.results.length,this.score=0;for(var b=0;b<this.results.length;b++)this.results[b]&&this.score++;this.scorePercent=this.score/this.totalQuestions,this.scorePercentFormatted=Math.floor(100*this.scorePercent)};var Utils=function(){};Utils.compare=function(a,b){if(a.length!=b.length)return!1;if(Array.isArray(a)&&Array.isArray(b)){for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b};

function showResults(quiz) {
    // Check answers and continue if all questions have been answered
    if (quiz.checkAnswers()) {
        var quizScorePercent = quiz.result.scorePercentFormatted; // The unformatted percentage is a decimal in range 0 - 1
        var quizResultElement = document.getElementById('quiz-result');
        quizResultElement.style.display = 'block';
        document.getElementById('quiz-percent').innerHTML = quizScorePercent.toString();

        // Change background colour of results div according to score percent
        if (quizScorePercent > 75) quizResultElement.style.backgroundColor = '#4caf50';
        else if (quizScorePercent > 50) quizResultElement.style.backgroundColor = '#ffc107';
        else if (quizScorePercent > 25) quizResultElement.style.backgroundColor = '#ff9800';
        else if (quizScorePercent > 0) quizResultElement.style.backgroundColor = '#f44336';

        // Highlight questions according to whether they were correctly answered. The callback allows us to highlight/show the correct answer
        quiz.highlightResults(handleAnswers);
    }
}

/** Callback for Quiz.highlightResults. Highlights the correct answers of incorrectly answered questions
 * Parameters are: the quiz object, the question element, question number, correctly answered flag
 */
function handleAnswers(quiz, question, no, correct) {
    if (!correct) {
        var answers = question.getElementsByTagName('input');
        for (var i = 0; i < answers.length; i++) {
            if (answers[i].type === 'checkbox' || answers[i].type === 'radio'){
                // If the current input element is part of the correct answer, highlight it
                if (quiz.answers[no].indexOf(answers[i].value) > -1) {
                    answers[i].parentNode.classList.add(Quiz.Classes.CORRECT);
                }
            } else {
                // If the input is anything other than a checkbox or radio button, show the correct answer next to the element
                var correctAnswer = document.createElement('span');
                correctAnswer.classList.add(Quiz.Classes.CORRECT);
                correctAnswer.classList.add(Quiz.Classes.TEMP); // quiz.checkAnswers will automatically remove elements with the temp class
                correctAnswer.innerHTML = quiz.answers[no];
                correctAnswer.style.marginLeft = '10px';
                answers[i].parentNode.insertBefore(correctAnswer, answers[i].nextSibling);
            }
        }
    }
}

  var quizz_Chapitre7_Lm;
  window.onload = function() {
    quizz_Chapitre7_Lm = new Quiz('Chapitre7_Lm', ['1','2','1','2',['1', '2'],'1','2',['1', '2', '3', '4', '5']]);
  };</script><link rel="stylesheet" type="text/css" src="css/quizlib.min.css">
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quels modèles sont imbriqués?
</div>
<div>
Relisez au besoin la <a href="#sec-0732">section&nbsp;<span>7.3.2</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Modèle A : Y = X1 + X2 + X3 / Modèle B : Y = X1 + X2 + X3 + X4 + X5</label>
</td>
<td>
<input type="radio" name="q1" value="1">
</td>
</tr>
<tr>
<td>
<label>Modèle A : Y = X1 + X4 + X5 / Modèle B : Y = X1 + X2 + X3 + X7 + X8</label>
</td>
<td>
<input type="radio" name="q1" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quelle mesure relative à la qualité d’ajustement du modèle indique la proportion de la variance de la variable dépendante expliquée par les variables indépendantes du modèle?
</div>
<div>
Relisez au besoin la <a href="#sec-0731">section&nbsp;<span>7.3.1</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Statistique de Fisher</label>
</td>
<td>
<input type="radio" name="q2" value="1">
</td>
</tr>
<tr>
<td>
<label>Coefficient de détermination (R2)</label>
</td>
<td>
<input type="radio" name="q2" value="2">
</td>
</tr>
<tr>
<td>
<label>L’erreur quadratique moyenne (RMSE)</label>
</td>
<td>
<input type="radio" name="q2" value="3">
</td>
</tr>
<tr>
<td>
<label>Le coefficient de régression standardisé</label>
</td>
<td>
<input type="radio" name="q2" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Le R2 ajusté permet de comparer des modèles avec des nombres de variables indépendantes et/ou d’observations différents
</div>
<div>
Relisez au besoin le début de la <a href="#sec-0732">section&nbsp;<span>7.3.2</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Vrai</label>
</td>
<td>
<input type="radio" name="q3" value="1">
</td>
</tr>
<tr>
<td>
<label>Faux</label>
</td>
<td>
<input type="radio" name="q3" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Comment repérer les variables les plus importantes du modèle?
</div>
<div>
Relisez au besoin la <a href="#sec-0742">section&nbsp;<span>7.4.2</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Coefficients de régression</label>
</td>
<td>
<input type="radio" name="q4" value="1">
</td>
</tr>
<tr>
<td>
<label>Coefficients de régression standardisés</label>
</td>
<td>
<input type="radio" name="q4" value="2">
</td>
</tr>
<tr>
<td>
<label>Erreurs types</label>
</td>
<td>
<input type="radio" name="q4" value="3">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Comment évaluer la significativité des coefficients?
</div>
<div>
Relisez au besoin la <a href="#sec-0743">section&nbsp;<span>7.4.3</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Valeur de t</label>
</td>
<td>
<input type="checkbox" name="q5" value="1">
</td>
</tr>
<tr>
<td>
<label>Valeur de p</label>
</td>
<td>
<input type="checkbox" name="q5" value="2">
</td>
</tr>
<tr>
<td>
<label>R2</label>
</td>
<td>
<input type="checkbox" name="q5" value="3">
</td>
</tr>
<tr>
<td>
<label>F de Fisher</label>
</td>
<td>
<input type="checkbox" name="q5" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Pour un nombre très élevé d’observations, quelle affirmation est vraie pour les valeurs de t et de p?
</div>
<div>
Relisez au besoin la [section <a href="#sec-0743"><span>Section&nbsp;7.4.3</span></a>).
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>1,96 (p &lt;= 0,05); 2,58 (p &lt;= 0,01); 3,29 (p &lt;= 0,001)</label>
</td>
<td>
<input type="radio" name="q6" value="1">
</td>
</tr>
<tr>
<td>
<label>1,96 (p &lt;= 0,001); 2,58 (p &lt;= 0,01); 3,29 (p &lt;= 0,05)</label>
</td>
<td>
<input type="radio" name="q6" value="2">
</td>
</tr>
<tr>
<td>
<label>2,96 (p &lt;= 0,05); 3,58 (p &lt;= 0,01); 4,29 (p &lt;= 0,001)</label>
</td>
<td>
<input type="radio" name="q6" value="3">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Une variable indépendante dont l’intervalle de confiance à 95 % du coefficient de régression est de [-15,06 ; 28,17] est-elle significatif au seuil de p = 0,05?
</div>
<div>
Relisez au besoin la <a href="#sec-0744">section&nbsp;<span>7.4.4</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Vrai</label>
</td>
<td>
<input type="radio" name="q7" value="1">
</td>
</tr>
<tr>
<td>
<label>Faux</label>
</td>
<td>
<input type="radio" name="q7" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Comment poser un diagnostic sur un modèle de régression linéaire?
</div>
<div>
Relisez le deuxième encadré à la <a href="#sec-076">section&nbsp;<span>7.6</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Nombre d’observations</label>
</td>
<td>
<input type="checkbox" name="q8" value="1">
</td>
</tr>
<tr>
<td>
<label>Normalité des résidus</label>
</td>
<td>
<input type="checkbox" name="q8" value="2">
</td>
</tr>
<tr>
<td>
<label>Linéarité et homoscédasticité des résidus</label>
</td>
<td>
<input type="checkbox" name="q8" value="3">
</td>
</tr>
<tr>
<td>
<label>Absence de multicolinéarité excessive</label>
</td>
<td>
<input type="checkbox" name="q8" value="4">
</td>
</tr>
<tr>
<td>
<label>Absence d’observations trop influentes</label>
</td>
<td>
<input type="checkbox" name="q8" value="5">
</td>
</tr>
<tr>
<td>
<label>Nombre de variables indépendantes</label>
</td>
<td>
<input type="checkbox" name="q8" value="6">
</td>
</tr>
</tbody></table>
</div>
</div>
<button type="button" onclick="showResults(quizz_Chapitre7_Lm);" id="buttonID">
Vérifier votre résultat
</button>
<div id="quiz-result" class="card">
<p><span id="quiz-percent"></span></p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-apparicio2016spatial" class="csl-entry" role="listitem">
Apparicio, Philippe, Thi-Thanh-Hien Pham, Anne-Marie Séguin et Jean Dubé. 2016. <span>«&nbsp;Spatial distribution of vegetation in and around city blocks on the Island of Montreal: A double environmental inequity?&nbsp;»</span> <em>Applied Geography</em> 76: 128‑136. <a href="http://dx.doi.org/10.1016/j.apgeog.2016.09.023">http://dx.doi.org/10.1016/j.apgeog.2016.09.023</a>.
</div>
<div id="ref-bressoux2010" class="csl-entry" role="listitem">
Bressoux, Pascal. 2010. <em>Mod<span>é</span>lisation statistique appliqu<span>é</span>e aux sciences sociales</em>. De boeck.
</div>
<div id="ref-2020_3" class="csl-entry" role="listitem">
Gelb, Jérémy et Philippe Apparicio. 2020. <span>«&nbsp;Modelling cyclists’ multi-exposure to air and noise pollution with low-cost sensors: The case of Paris.&nbsp;»</span> <em>Atmosphere</em> 11 (4): 422. <a href="https://doi.org/10.3390/atmos11040422">https://doi.org/10.3390/atmos11040422</a>.
</div>
<div id="ref-hanck2019introduction" class="csl-entry" role="listitem">
Hanck, Christoph, Martin Arnold, Alexander Gerber et Martin Schmelzer. 2019. <em>Introduction to econometrics with R</em>. s.n. <a href="https://www.econometrics-with-r.org/ITER.pdf">https://www.econometrics-with-r.org/ITER.pdf</a>.
</div>
<div id="ref-tabachnick2007" class="csl-entry" role="listitem">
Tabachnick, Barbara G, Linda S Fidell et Jodie B Ullman. 2007. <em>Using multivariate statistics</em>. Pearson.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./06-bivarieeQualiQuanti.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Relation entre une variable qualitative et une variable quantitative</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08-GLM.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Régressions linéaires généralisées (GLM)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Méthodes quantitatives en sciences sociales : un grand bol d’R.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Ce livre a été réalisé avec <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>