<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Méthodes quantitatives en sciences sociales : un grand bol d’R - 6&nbsp; Relation entre une variable qualitative et une variable quantitative</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./07-regressionlineaire.html" rel="next">
<link href="./05-bivarieeQualiQuali.html" rel="prev">
<link href="./images/introduction/Couverture.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="css/quizlib.min.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./06-bivarieeQualiQuanti.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Relation entre une variable qualitative et une variable quantitative</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Recherche" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/SerieBoldR/MethodesQuantitatives" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Préface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-auteurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">À propos des auteurs</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 1. Découverte de R</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-priseenmainR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prise en main de R</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 2. Analyses univariées et représentations graphiques</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-univarie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistiques descriptives univariées</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-magiedesgraphiques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Magie des graphiques</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 3. Analyses bivariées</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-bivarieeQuantiQuanti.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Relation linéaire entre deux variables quantitatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-bivarieeQualiQuali.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Relation entre deux variables qualitatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-bivarieeQualiQuanti.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Relation entre une variable qualitative et une variable quantitative</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 4. Modèles de régression</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-regressionlineaire.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Régression linéaire multiple</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-GLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Régressions linéaires généralisées (GLM)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-GLMM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Régressions à effets mixtes (GLMM)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Multiniveau.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Régressions multiniveaux</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-GAM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modèles généralisés additifs</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 5. Analyses exploratoires multivariées</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-AnalysesFactorielles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Méthodes factorielles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-MethodeClassification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Méthodes de classification non supervisée</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 6. Annexes et bibliographie</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-Annexes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Annexes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliographie</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table des matières</h2>
   
  <ul>
<li>
<a href="#sec-061" id="toc-sec-061" class="nav-link active" data-scroll-target="#sec-061"><span class="header-section-number">6.1</span> Relation entre une variable quantitative et une variable qualitative à deux modalités</a>
  <ul class="collapse">
<li><a href="#sec-0611" id="toc-sec-0611" class="nav-link" data-scroll-target="#sec-0611"><span class="header-section-number">6.1.1</span> Test <em>t</em> et ses différentes variantes</a></li>
  <li><a href="#sec-0612" id="toc-sec-0612" class="nav-link" data-scroll-target="#sec-0612"><span class="header-section-number">6.1.2</span> Test non paramétrique de Wilcoxon</a></li>
  </ul>
</li>
  <li>
<a href="#sec-062" id="toc-sec-062" class="nav-link" data-scroll-target="#sec-062"><span class="header-section-number">6.2</span> Relation entre une variable quantitative et une variable qualitative à plus de deux modalités</a>
  <ul class="collapse">
<li><a href="#sec-0621" id="toc-sec-0621" class="nav-link" data-scroll-target="#sec-0621"><span class="header-section-number">6.2.1</span> Analyse de variance</a></li>
  <li><a href="#sec-0622" id="toc-sec-0622" class="nav-link" data-scroll-target="#sec-0622"><span class="header-section-number">6.2.2</span> Test non paramétrique de Kruskal-Wallis</a></li>
  <li><a href="#sec-0623" id="toc-sec-0623" class="nav-link" data-scroll-target="#sec-0623"><span class="header-section-number">6.2.3</span> Mise en œuvre dans R</a></li>
  <li><a href="#sec-0624" id="toc-sec-0624" class="nav-link" data-scroll-target="#sec-0624"><span class="header-section-number">6.2.4</span> Comment rapporter les résultats d’une ANOVA et du test de Kruskal-Wallis</a></li>
  </ul>
</li>
  <li><a href="#sec-063" id="toc-sec-063" class="nav-link" data-scroll-target="#sec-063"><span class="header-section-number">6.3</span> Conclusion sur la troisième partie</a></li>
  <li><a href="#sec-064" id="toc-sec-064" class="nav-link" data-scroll-target="#sec-064"><span class="header-section-number">6.4</span> Quiz de révision du chapitre</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/SerieBoldR/MethodesQuantitatives/issues/new" class="toc-action">Signaler un problème ou<br>formuler une suggestion</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-chap06" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Relation entre une variable qualitative et une variable quantitative</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Dans le cadre de ce chapitre, nous présentons les principales méthodes permettant d’explorer les associations entre une variable quantitative et une variable qualitative avec deux modalités (tests de Student, de Welch et de Wilcoxon) ou avec plus de deux modalités (ANOVA et test de Kruskal-Wallis).</p>
<div class="bloc_package">
<div class="bloc_package-header">
<div class="bloc_package-icon">

</div>
<p><strong>Liste des <em>packages</em> utilisés dans ce chapitre</strong></p>
</div>
<div class="bloc_package-body">
<ul>
<li>Pour créer des graphiques&nbsp;:
<ul>
<li>
<code>ggplot2</code>, le seul, l’unique!</li>
<li>
<code>ggpubr</code> pour combiner des graphiques.</li>
</ul>
</li>
<li>Pour manipuler des données&nbsp;:
<ul>
<li>
<code>dplyr</code>, avec les fonctions <code>group_by</code>, <code>summarize</code> et les pipes <code>%&gt;%</code>.</li>
</ul>
</li>
<li>Pour les test <em>t</em>&nbsp;:
<ul>
<li>
<code>sjstats</code> pour réaliser des tests <em>t</em> pondérés.</li>
<li>
<code>effectsize</code> pour calculer les tailles d’effet de tests <em>t</em>.</li>
</ul>
</li>
<li>Pour la section sur les ANOVA&nbsp;:
<ul>
<li>
<code>car</code> pour les ANOVA classiques.</li>
<li>
<code>lmtest</code> pour le test de Breusch-Pagan d’homogénéité des variances.</li>
<li>
<code>rstatix</code> intégrant de nombreux tests classiques (comme le test de Shapiro) avec <code>tidyverse</code>.</li>
</ul>
</li>
<li>Autre <em>package</em>&nbsp;:
<ul>
<li>
<code>foreign</code> pour importer des fichiers externes.</li>
</ul>
</li>
</ul>
</div>
</div>
<section id="sec-061" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="sec-061">
<span class="header-section-number">6.1</span> Relation entre une variable quantitative et une variable qualitative à deux modalités</h2>
<div class="bloc_objectif">
<div class="bloc_objectif-header">
<div class="bloc_objectif-icon">

</div>
<p><strong>Les moyennes de deux groupes de population sont-elles significativement différentes?</strong></p>
</div>
<div class="bloc_objectif-body">
<p>Nous souhaitons ici comparer deux groupes de population en fonction d’une variable continue. Par exemple, pour deux échantillons respectivement d’hommes et de femmes travaillant dans le même secteur d’activité, nous pourrions souhaiter vérifier si les moyennes des salaires des hommes et des femmes sont différentes et ainsi vérifier la présence ou l’absence d’une iniquité systématique. En études urbaines, dans le cadre d’une étude sur un espace public, nous pourrions vouloir vérifier si la différence des moyennes du sentiment de sécurité des femmes et des hommes est significative (c’est-à-dire différente de 0).</p>
<p><strong>Pour un même groupe, la moyenne de la différence d’un phénomène donné mesuré à deux moments est-elle ou non égale à zéro?</strong></p>
<p>Autrement dit, nous cherchons à comparer un même groupe d’individus avant et après une expérimentation ou dans deux contextes différents. Prenons un exemple d’application en études urbaines. Dans le cadre d’une étude sur la perception des risques associés à la pratique du vélo en ville, 50&nbsp;personnes utilisant habituellement l’automobile pour se rendre au travail sont recrutées. L’expérimentation pourrait consister à leur donner une formation sur la pratique du vélo en ville et à les accompagner quelques jours durant leurs déplacements domicile-travail. Nous évaluerons la différence de leurs perceptions des risques associés à la pratique du vélo sur une échelle de 0 à 100 avant et après l’expérimentation. Nous pourrions supposer que la moyenne des différences est significativement négative, ce qui indiquerait que la perception du risque a diminué après l’expérimentation; autrement dit, la perception du risque serait plus faible en fin de période.</p>
</div>
</div>
<section id="sec-0611" class="level3" data-number="6.1.1"><h3 data-number="6.1.1" class="anchored" data-anchor-id="sec-0611">
<span class="header-section-number">6.1.1</span> Test <em>t</em> et ses différentes variantes</h3>
<p>Le <strong>t de Student</strong>, appelé aussi <strong>test <em>t</em></strong> (<em>t-test</em> en anglais), est un test paramétrique permettant de comparer les moyennes de deux groupes (échantillons), qui peuvent être indépendantes ou non&nbsp;:</p>
<ul>
<li><p><strong>Échantillons indépendants (dits non appariés)</strong>&nbsp;: les observations de deux groupes qui n’ont aucun lien entre eux. Par exemple, nous souhaitons vérifier si les moyennes du sentiment de sécurité des hommes et des femmes, ou encore si, les moyennes des loyers entre deux villes sont statistiquement différentes. Ainsi, les tailles des deux échantillons peuvent être différentes (<span class="math inline">\(n_a \neq n_b\)</span>).</p></li>
<li><p><strong>Échantillons dépendants (dits appariés)</strong>&nbsp;: les individus des deux groupes sont les mêmes et sont donc associés par paires. Autrement dit, nous avons deux séries de valeurs de taille identique <span class="math inline">\(n_a = n_b\)</span> et <span class="math inline">\(n_{ai}\)</span> est le même individu que <span class="math inline">\(n_{bi}\)</span>. Ce type d’analyse est souvent utilisée en études cliniques&nbsp;: pour <span class="math inline">\(n\)</span> individus, nous disposons d’une mesure quantitative de leur état de santé pour deux séries (l’une avant le traitement, l’autre une fois le traitement terminé). Cela permet de comparer les mêmes individus avant et après un traitement; nous parlons alors d’étude, d’expérience ou d’analyse pré-post. Concrètement, nous cherchons à savoir si la moyenne des différences des observations avant et après est significativement différente de 0. Si c’est le cas, nous pouvons conclure que l’expérimentation a eu un impact sur le phénomène mesuré (variable continue). Ce type d’analyse pré-post peut aussi être utilisé pour évaluer l’impact du réaménagement d’un espace public (rue commerciale, place publique, parc, etc.). Par exemple, nous pourrions questionner le même échantillon de commerçant(e)s ou personnes l’utilisant avant et après le réaménagement d’une artère commerciale.</p></li>
</ul>
<p><strong>Condition d’application</strong>. Pour utiliser les tests de Student et de Welch, la variable continue doit être normalement distribuée. Si elle est fortement anormale, nous utiliserons le test non paramétrique de Wilcoxon (<a href="#sec-0612">section&nbsp;<span>6.1.2</span></a>). Il existe trois principaux tests pour comparer les moyennes de deux groupes&nbsp;:</p>
<ul>
<li><p>Test de Student (test <em>t</em>) avec échantillons indépendants et variances similaires (méthode <em>pooled</em>). Les variances de deux groupes sont semblables quand leur ratio varie de 0,5 à 2, soit <span class="math inline">\(\mbox{0,5}&lt; (S^2_{X_A}/S^2_{X_B})&lt;\mbox{2}\)</span>.</p></li>
<li><p>Test de Welch (appelé aussi Satterthwaite) avec échantillons indépendants quand les variances des deux groupes sont dissemblables.</p></li>
<li><p>Test de Student (test <em>t</em>) avec échantillons dépendants.</p></li>
</ul>
<p>Il s’agit de vérifier si les moyennes des deux groupes sont statistiquement différentes avec les étapes suivantes&nbsp;:</p>
<ul>
<li><p>Nous posons l’hypothèse nulle (<em>H<sub>0</sub></em>), soit que les moyennes des deux groupes <em>A</em> et <em>B</em> ne sont pas différentes (<span class="math inline">\(\bar{X}_{A}=\bar{X}_{B}\)</span>) ou, autrement dit, la différence des deux moyennes est nulle (<span class="math inline">\(\bar{X}_{A}-\bar{X}_{B}=0\)</span>). L’hypothèse alternative (<em>H<sub>1</sub></em>) est donc <span class="math inline">\(\bar{X}_{A}\ne\bar{X}_{B}\)</span>.</p></li>
<li><p>Nous calculons la valeur de <em>t</em> et le nombre de degrés de liberté. La valeur de <em>t</em> est négative quand la moyenne du groupe A est inférieure au groupe B et inversement.</p></li>
<li><p>Nous comparons la valeur absolue de <em>t</em> (<span class="math inline">\(\mbox{|t|}\)</span>) avec celle issue de la table des valeurs critiques de T (<a href="13-MethodeClassification.html#sec-132">section&nbsp;<span>13.2</span></a>) avec le bon nombre de degrés de liberté et en choisissant un degré de signification (habituellement, <em>p</em>&nbsp;=&nbsp;0,05). Si <span class="math inline">\(\mbox{|t|}\)</span> est supérieure à la valeur <em>t</em> critique, alors les moyennes sont statistiquement différentes au degré de signification retenu.</p></li>
<li><p>Si les moyennes sont statistiquement différentes, nous pouvons calculer la taille de l’effet.</p></li>
</ul>
<p><strong>Cas 1. Test de Student pour des échantillons indépendants avec des variances similaires (méthode <em>pooled</em>).</strong> La valeur de <em>t</em> est le ratio entre la différence des moyennes des deux groupes (numérateur) et l’erreur type groupée des deux échantillons (dénominateur)&nbsp;:</p>
<p><span id="eq-cas1pooled"><span class="math display">\[
t = \frac{\bar{X}_{A}-\bar{X}_{B}}{\sqrt{\frac{S^2_p}{n_A}+\frac{S^2_p}{n_B}}}\mbox{ avec } S^2_p = \frac{(n_A-1)S^2_{X_A}+(n_B-1)S^2_{X_B}}{n_A+n_B-2}
\tag{6.1}\]</span></span></p>
<p>avec <span class="math inline">\(n_A\)</span>,<span class="math inline">\(n_B\)</span>, <span class="math inline">\(S^2_{X_A}\)</span> et <span class="math inline">\(S^2_{X_B}\)</span> étant respectivement les nombres d’observations et les variances pour les groupes <em>A</em> et <em>B</em>, <span class="math inline">\(S^2_p\)</span> étant la variance groupée des deux échantillons et <span class="math inline">\(n_A+n_B-2\)</span> étant le nombre de degrés de liberté.</p>
<p><strong>Cas 2. Test de Welch pour des échantillons indépendants (avec variances dissemblables).</strong> Le test de Welch est très similaire au test de Student; seul le calcul de la valeur de <em>t</em> est différent, pour tenir compte des variances respectives des groupes&nbsp;:</p>
<p><span id="eq-cas2welch"><span class="math display">\[
t = \frac{\bar{X}_{A}-\bar{X}_{B}}{\sqrt{\frac{S^2_{X_A}}{n_A}+\frac{S^2_{X_B}}{n_B}}} \mbox{ et } dl = \frac{ \left( \frac{S^2_{X_A}}{n_A}+\frac{S^2_{X_B}}{n_B} \right)^2} {\frac{S^4_{X_A}}{n^2_A(n_A-1)}+\frac{S^4_{X_B}}{n^2_B(n_B-1)}}
\tag{6.2}\]</span></span></p>
<p>Dans la syntaxe ci-dessous, nous avons écrit une fonction dénommée <code>test_independants</code> permettant de calculer les deux tests pour des échantillons indépendants. Dans cette fonction, vous pouvez repérer comment sont calculés les moyennes, les nombres d’observations et les variances pour les deux groupes, le nombre de degrés de liberté et les valeurs de <em>t</em> et de <em>p</em> pour les deux tests. Puis, nous avons créé aléatoirement deux jeux de données relativement à la vitesse de déplacement de cyclistes utilisant un vélo personnel ou un vélo en libre-service (généralement plus lourd)&nbsp;:</p>
<ul>
<li><p>Au cas 1, 60&nbsp;cyclistes utilisant un vélo personnel roulant en moyenne à 18&nbsp;km/h (écart-type de 1,5) et 50&nbsp;autres utilisant un système de vélopartage avec une vitesse moyenne de 15&nbsp;km/h (écart-type de 1,5).</p></li>
<li><p>Au cas 2, 60&nbsp;cyclistes utilisant un vélo personnel roulant en moyenne à 16&nbsp;km/h (écart-type de 3) et 50&nbsp;autres utilisant un système de vélopartage avec une vitesse moyenne de 15 km/h (écart-type de 1,5). Ce faible écart des moyennes, combiné à une plus forte variance réduit la significativité de la différence entre les deux groupes.</p></li>
</ul>
<p>D’emblée, l’analyse visuelle des boîtes à moustaches (<a href="#fig-ttest1">figure&nbsp;<span>6.1</span></a>) signale qu’au cas 1, contrairement au cas 2, les groupes sont plus homogènes (boîtes plus compactes) et les moyennes semblent différentes (les boîtes sont centrées différemment sur l’axe des ordonnées). Cela est confirmé par les résultats des tests.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/ggpubr/">"ggpubr"</a></span><span class="op">)</span></span>
<span><span class="co"># fonction ------------------</span></span>
<span><span class="va">tstudent_independants</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">x_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>           <span class="co"># Moyenne du groupe A</span></span>
<span>    <span class="va">x_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span>           <span class="co"># Moyenne du groupe B</span></span>
<span>    <span class="va">var_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>          <span class="co"># Variance du groupe A</span></span>
<span>    <span class="va">var_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span>          <span class="co"># Variance du groupe B</span></span>
<span>    <span class="va">sd_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">var_a</span><span class="op">)</span>      <span class="co"># Écart-type du groupe A</span></span>
<span>    <span class="va">sd_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">var_b</span><span class="op">)</span>      <span class="co"># Écart-type du groupe B</span></span>
<span>    <span class="va">ratio_v</span> <span class="op">&lt;-</span> <span class="va">var_a</span> <span class="op">/</span> <span class="va">var_b</span> <span class="co"># ratio des variances</span></span>
<span>    <span class="va">n_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>         <span class="co"># nombre d'observation du groupe A</span></span>
<span>    <span class="va">n_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span>         <span class="co"># nombre d'observation du groupe B</span></span>
<span>    </span>
<span>    <span class="co"># T-test (variances égales)</span></span>
<span>    <span class="va">dl_test</span> <span class="op">&lt;-</span> <span class="va">n_a</span><span class="op">+</span><span class="va">n_b</span><span class="op">-</span><span class="fl">2</span>       <span class="co"># degrés de liberté</span></span>
<span>    <span class="va">PooledVar</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">n_a</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">var_a</span><span class="op">)</span><span class="op">+</span><span class="op">(</span><span class="op">(</span><span class="va">n_b</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">var_b</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">dl_test</span></span>
<span>    <span class="va">t_test</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x_a</span><span class="op">-</span><span class="va">x_b</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">PooledVar</span><span class="op">/</span><span class="va">n_a</span><span class="op">)</span><span class="op">+</span><span class="op">(</span><span class="va">PooledVar</span><span class="op">/</span><span class="va">n_b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">p_test</span> <span class="op">&lt;-</span>  <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">t_test</span><span class="op">)</span>, <span class="va">dl_test</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>     </span>
<span>    <span class="co"># Test Welch-Sattherwaite (variances inégales)</span></span>
<span>    <span class="va">t_welch</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x_a</span><span class="op">-</span><span class="va">x_b</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="op">(</span><span class="va">var_a</span><span class="op">/</span><span class="va">n_a</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">var_b</span><span class="op">/</span><span class="va">n_b</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">dl_num</span> <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">var_a</span><span class="op">/</span><span class="va">n_a</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">var_b</span><span class="op">/</span><span class="va">n_b</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>    <span class="va">dl_dem</span> <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">var_a</span><span class="op">/</span><span class="va">n_a</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="va">n_a</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span> <span class="op">(</span><span class="op">(</span><span class="va">var_b</span><span class="op">/</span><span class="va">n_b</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="va">n_b</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">dl_welch</span> <span class="op">=</span> <span class="va">dl_num</span> <span class="op">/</span> <span class="va">dl_dem</span> <span class="co"># degrés de liberté</span></span>
<span>    <span class="va">p_welch</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">t_welch</span><span class="op">)</span>, <span class="va">dl_welch</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>     </span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n groupe A (n = "</span>, <span class="va">n_a</span>,<span class="st">"), moy = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">x_a</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">", </span></span>
<span><span class="st">           variance = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">var_a</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">", écart-type = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">sd_a</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>        <span class="st">"\n groupe B (n = "</span>, <span class="va">n_b</span>,<span class="st">"), moy = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">x_b</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">", </span></span>
<span><span class="st">          variance = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">var_b</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">", écart-type = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">sd_b</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>        <span class="st">"\n ratio variance = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ratio_v</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>        <span class="st">"\n t-test (variances égales): t(dl = "</span>, <span class="va">dl_test</span>, <span class="st">") = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">t_test</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>         <span class="st">", p = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">p_test</span>,<span class="fl">6</span><span class="op">)</span>,</span>
<span>         <span class="st">"\n t-Welch (variances inégales): t(dl = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">dl_welch</span>,<span class="fl">3</span><span class="op">)</span>, <span class="st">") = "</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">t_welch</span>,<span class="fl">4</span><span class="op">)</span>, <span class="st">", p = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">p_welch</span>,<span class="fl">6</span><span class="op">)</span>,  sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>    </span>
<span>  </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">ratio_v</span> <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="op">&amp;&amp;</span> <span class="va">ratio_v</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span>  <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n Variances semblables. Utilisez le test de Student!"</span><span class="op">)</span></span>
<span>      <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p_test</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n Variances dissemblables. Utilisez le test de Welch-Satterwaithe!"</span><span class="op">)</span></span>
<span>      <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p_welch</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">p</span> <span class="op">&lt;=</span><span class="fl">.05</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n Les moyennes des deux groupes sont significativement différentes."</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n Les moyennes des deux groupes ne sont pas significativement différentes."</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># CAS 1 : données fictives ------------------</span></span>
<span><span class="co"># Création du groupe A : 60 observations avec une vitesse moyenne de 18 et un écart-type de 1,5</span></span>
<span><span class="va">Velo1A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">60</span>,<span class="fl">18</span>,<span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="co"># Création du groupe B : 50 observations avec une vitesse moyenne de 15 et un écart-type de 1,5</span></span>
<span><span class="va">Velo1B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">15</span>,<span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  vitesse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Velo1A</span>,<span class="va">Velo1B</span><span class="op">)</span>, </span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Vélo personnel"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Velo1A</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Vélopartage"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Velo1B</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">boxplot1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df1</span>, mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">type</span>, y <span class="op">=</span> <span class="va">vitesse</span>, colour <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Données fictives (cas 1)"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Type de vélo"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Vitesse de déplacement (km/h)"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="co"># CAS 2 : données fictives ------------------</span></span>
<span><span class="co"># Création du groupe A : 60 observations avec une vitesse moyenne de 18 et un écart-type de 3</span></span>
<span><span class="va">Velo2A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">60</span>,<span class="fl">16</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="co"># Création du groupe B : 50 observations avec une vitesse moyenne de 15 et un écart-type de 1,5</span></span>
<span><span class="va">Velo2B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">15</span>,<span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  vitesse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Velo2A</span>,<span class="va">Velo2B</span><span class="op">)</span>, </span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Vélo personnel"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Velo2A</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Vélopartage"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Velo2B</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">boxplot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df2</span>, mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">type</span>, y <span class="op">=</span> <span class="va">vitesse</span>, colour <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Données fictives (cas 2)"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Type de vélo"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Vitesse de déplacement (km/h)"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">boxplot1</span>, <span class="va">boxplot2</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Appel de la fonction pour le cas 1</span></span>
<span><span class="fu">tstudent_independants</span><span class="op">(</span><span class="va">Velo1A</span>, <span class="va">Velo1B</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 groupe A (n = 60), moy = 17.9, 
           variance = 2.7, écart-type = 1.7
 groupe B (n = 50), moy = 15.1, 
          variance = 2.5, écart-type = 1.6
 ratio variance = 1.08
 t-test (variances égales): t(dl = 108) = 8.9846, p = 0
 t-Welch (variances inégales): t(dl = 105.744) = 9.0162, p = 0
 Variances semblables. Utilisez le test de Student!
 Les moyennes des deux groupes sont significativement différentes.</code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Appel de la fonction pour le cas 2</span></span>
<span><span class="fu">tstudent_independants</span><span class="op">(</span><span class="va">Velo2A</span>, <span class="va">Velo2B</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 groupe A (n = 60), moy = 16.2, 
           variance = 5.3, écart-type = 2.3
 groupe B (n = 50), moy = 15.2, 
          variance = 2.3, écart-type = 1.5
 ratio variance = 2.3
 t-test (variances égales): t(dl = 108) = 2.5702, p = 0.011527
 t-Welch (variances inégales): t(dl = 102.859) = 2.665, p = 0.008941
 Variances dissemblables. Utilisez le test de Welch-Satterwaithe!
 Les moyennes des deux groupes sont significativement différentes.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-ttest1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="06-bivarieeQualiQuanti_files/figure-html/fig-ttest1-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;6.1: Boîtes à moustaches sur des échantillons fictifs non appariés</figcaption></figure>
</div>
</div>
</div>
<section id="sec-06111" class="level4" data-number="6.1.1.1"><h4 data-number="6.1.1.1" class="anchored" data-anchor-id="sec-06111">
<span class="header-section-number">6.1.1.1</span> Principe de base et formulation pour des échantillons dépendants (appariés)</h4>
<p>Nous disposons de plusieurs personnes pour lesquelles nous avons mesuré un phénomène (variable continue) à deux temps différents&nbsp;: généralement avant et après une expérimentation (analyse pré-post). Il s’agit de vérifier si la moyenne des différences des observations avant et après la période est différente de 0. Pour ce faire, nous réalisons les étapes suivantes&nbsp;:</p>
<ul>
<li><p>Nous posons l’hypothèse nulle (<em>H<sub>0</sub></em>), soit que la moyenne des différences entre les deux séries est égale à 0 (<span class="math inline">\(\bar{D} = 0\)</span> avec <span class="math inline">\(d = {x}_{t_1}- {x}_{t_2}\)</span>). L’hypothèse alternative (<em>H<sub>1</sub></em>) est donc <span class="math inline">\(\bar{D} \ne 0\)</span>. Notez que nous pouvons tester une autre valeur que 0.</p></li>
<li><p>Nous calculons la valeur de <em>t</em> et le nombre de degrés de liberté. La valeur de <em>t</em> est négative quand la moyenne des différences entre <span class="math inline">\({X}_{t_1}\)</span> et <span class="math inline">\({X}_{t_2}\)</span> est négative et inversement.</p></li>
<li><p>Nous comparons la valeur absolue de <em>t</em> (<span class="math inline">\(\mbox{|t|}\)</span>) avec celle issue de la table des valeurs critiques de T avec le nombre de degrés de liberté et en choisissant un degré de signification (habituellement, <em>p</em>&nbsp;=&nbsp;0,05). Si <span class="math inline">\(\mbox{|t|}\)</span> est supérieure à la valeur <em>t</em> critique, alors les moyennes sont statistiquement différentes au degré de signification retenu.</p></li>
</ul>
<p>Pour le test de Student avec des échantillons appariés, la valeur de <em>t</em> se calcule comme suit&nbsp;:</p>
<p><span id="eq-ttestapparie"><span class="math display">\[
t = \frac{\bar{D}-\mu_0}{\sigma_D / \sqrt{n}}
\tag{6.3}\]</span></span></p>
<p>avec <span class="math inline">\(\bar{D}\)</span> étant la moyenne des différences entre les observations appariées de la série A et de la série B, <span class="math inline">\(\sigma_D\)</span> l’écart des différences, <em>n</em> le nombre d’observations, et finalement <span class="math inline">\(\mu_0\)</span> la valeur de l’hypothèse nulle que nous voulons tester (habituellement 0). Bien entendu, il est possible de fixer une autre valeur pour <span class="math inline">\(\mu_0\)</span>&nbsp;: par exemple, avec <span class="math inline">\(\mu_0 = 10\)</span>, nous chercherions ainsi à vérifier si la moyenne des différences est significativement différente de 10. Le nombre de degrés de liberté est égal à <span class="math inline">\(n-1\)</span>.</p>
<p>Dans la syntaxe ci-dessous, nous avons écrit une fonction dénommée <code>tstudent_dependants</code> permettant de réaliser le test de Student pour des échantillons appariés. Dans cette fonction, vous pouvez repérer comment sont calculés la différence entre les observations pairées, la moyenne et l’écart-type de cette différence, puis le nombre de degrés de liberté, les valeurs de <em>t</em> et de <em>p</em> pour les deux tests.</p>
<p>Pour illustrer l’utilisation de la fonction, nous avons créé aléatoirement deux jeux de données. Imaginons que ces données décrivent 50 personnes utilisant habituellement l’automobile pour se rendre au travail. Pour ces personnes, nous avons généré des valeurs du risque perçu de l’utilisation du vélo (de 0 à 100), et ce, avant et après une période de 20 jours ouvrables durant lesquels elles devaient impérativement se rendre au travail à vélo.</p>
<ul>
<li><p>Au cas 1, les valeurs de risque ont une moyenne de 70 avant l’expérimentation et de 50 après l’expérimentation, avec des écarts-types de 5.</p></li>
<li><p>Au cas 2, les valeurs de risque ont une moyenne de 70 avant et de 66 après, avec des écarts-types de 5.</p></li>
</ul>
<p>D’emblée, l’analyse visuelle des boîtes à moustaches (<a href="#fig-ttest2">figure&nbsp;<span>6.2</span></a>) pairées montre que la perception du risque semble avoir nettement diminué après l’expérimentation pour le cas 1, mais pas pour le cas 2. Cela est confirmé par les résultats des tests.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/ggpubr/">"ggpubr"</a></span><span class="op">)</span></span>
<span><span class="va">tstudent_dependants</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span>, <span class="va">mu</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">A</span><span class="op">-</span><span class="va">B</span>           <span class="co"># différences entre les observations pairées</span></span>
<span>  <span class="va">moy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>     <span class="co"># Moyenne des différences</span></span>
<span>  <span class="va">e_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>       <span class="co"># Écart-type des différences</span></span>
<span>  <span class="va">n</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>   <span class="co"># nombre d'observations</span></span>
<span>  <span class="va">dl</span>  <span class="op">&lt;-</span> <span class="va">n</span><span class="op">-</span><span class="fl">1</span>         <span class="co"># nombre de degrés de liberté (variances égales)</span></span>
<span>  </span>
<span>  <span class="va">t</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">moy</span><span class="op">-</span> <span class="va">mu</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">e_t</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="co"># valeur de t</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span>  <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>, <span class="va">dl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n groupe A : moy = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">", var = "</span>, </span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">", sd = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>      <span class="st">"\n groupe B : moy = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">", var = "</span>, </span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">", sd = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>      <span class="st">"\n Moyenne des différences = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">moy</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>      <span class="st">"\n Ecart-type des différences = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">e_t</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>      <span class="st">"\n t(dl = "</span>, <span class="va">dl</span>, <span class="st">") = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">t</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>      <span class="st">", p = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">p</span>,<span class="fl">3</span><span class="op">)</span>,  sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">p</span> <span class="op">&lt;=</span><span class="fl">.05</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n La moyenne des différences entre les échantillons est significative"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n La moyenne des différences entre les échantillons n'est pas significative"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># CAS 1 : données fictives ------------------</span></span>
<span><span class="va">Avant1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">70</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">Apres1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">50</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Avant<span class="op">=</span><span class="va">Avant1</span>, Apres<span class="op">=</span><span class="va">Apres1</span><span class="op">)</span></span>
<span><span class="va">boxplot1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggpaired.html">ggpaired</a></span><span class="op">(</span><span class="va">df1</span>, cond1 <span class="op">=</span> <span class="st">"Avant"</span>, cond2 <span class="op">=</span> <span class="st">"Apres"</span>, fill <span class="op">=</span> <span class="st">"condition"</span>, </span>
<span>                     palette <span class="op">=</span> <span class="st">"jco"</span>, </span>
<span>                     xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">"Sentiment de sécurité"</span>, </span>
<span>                     title <span class="op">=</span> <span class="st">"Données fictives (cas 1)"</span><span class="op">)</span></span>
<span><span class="co"># CAS 2 : données fictives ------------------</span></span>
<span><span class="va">Avant2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">70</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">Apres2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">66</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Avant<span class="op">=</span><span class="va">Avant2</span>, Apres<span class="op">=</span><span class="va">Apres2</span><span class="op">)</span></span>
<span><span class="va">boxplot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggpaired.html">ggpaired</a></span><span class="op">(</span><span class="va">df2</span>, cond1 <span class="op">=</span> <span class="st">"Avant"</span>, cond2 <span class="op">=</span> <span class="st">"Apres"</span>, fill <span class="op">=</span> <span class="st">"condition"</span>,</span>
<span>                     palette <span class="op">=</span> <span class="st">"jco"</span>, </span>
<span>                     xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">"Sentiment de sécurité"</span>, </span>
<span>                     title <span class="op">=</span> <span class="st">"Données fictives (cas 2)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">boxplot1</span>, <span class="va">boxplot2</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Test t : appel de la fonction tstudent_dependants</span></span>
<span><span class="fu">tstudent_dependants</span><span class="op">(</span><span class="va">Avant1</span>, <span class="va">Apres1</span>, mu <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 groupe A : moy = 70.5, var = 29.6, sd = 5.4
 groupe B : moy = 49.8, var = 30.6, sd = 5.5
 Moyenne des différences = 20.7
 Ecart-type des différences = 7.9
 t(dl = 49) = 18.6, p = 0
 La moyenne des différences entre les échantillons est significative</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tstudent_dependants</span><span class="op">(</span><span class="va">Avant2</span>, <span class="va">Apres2</span>, mu <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 groupe A : moy = 68.9, var = 28, sd = 5.3
 groupe B : moy = 66.2, var = 22.6, sd = 4.8
 Moyenne des différences = 2.7
 Ecart-type des différences = 7.2
 t(dl = 49) = 2.64, p = 0.011
 La moyenne des différences entre les échantillons est significative</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-ttest2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="06-bivarieeQualiQuanti_files/figure-html/fig-ttest2-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;6.2: Boites à moustaches sur des échantillons fictifs appariés</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-06112" class="level4" data-number="6.1.1.2"><h4 data-number="6.1.1.2" class="anchored" data-anchor-id="sec-06112">
<span class="header-section-number">6.1.1.2</span> Mesure de la taille de l’effet</h4>
<p>La taille de l’effet permet d’évaluer la magnitude (force) de l’effet d’une variable (ici la variable qualitative à deux modalités) sur une autre (ici la variable continue). Dans le cas d’une comparaison de moyennes (avec des échantillons pairés ou non), pour mesurer la taille de l’effet, nous utilisons habituellement le <em>d</em> de Cohen ou encore le <em>g</em> de Hedges; le second étant un ajustement du premier. Notez que nous analysons la taille de l’effet uniquement si le test de Student ou de Welch s’est révélé significatif (p&nbsp;&lt;&nbsp;0,05).</p>
<p><strong>Pourquoi utiliser le <em>d</em> de Cohen?</strong> Deux propriétés en font une mesure particulièrement intéressante. Premièrement, elle est facile à calculer puisque <em>d</em> est le ratio entre la différence de deux moyennes de groupes (A, B) et l’écart-type combiné des deux groupes. Deuxièmement, <em>d</em> représente ainsi une mesure standardisée de la taille de l’effet; elle permet ainsi l’évaluation de la taille de l’effet indépendamment de l’unité de mesure de la variable continue. Concrètement, cela signifie que, quelle que soit l’unité de mesure de la variable continue <em>X</em>, <em>d</em> est toujours exprimée en unité d’écart-type de <em>X</em>. Cette propriété facilite ainsi grandement les comparaisons entre des valeurs de <em>d</em> calculées sur différentes combinaisons de variables (au même titre que le coefficient de variation ou le coefficient de corrélation, par exemple). Pour des échantillons indépendants de tailles différentes, le <em>d</em> de Cohen s’écrit&nbsp;:</p>
<p><span id="eq-dcohen"><span class="math display">\[
\frac{\bar{X}_{A}-\bar{X}_{B}}{\sqrt{\frac{(n_A-1)S^2_A+(n_B-1)S^2_B}{n_A+n_B-2}}}
\tag{6.4}\]</span></span></p>
<p>avec <span class="math inline">\(n_A\)</span>, <span class="math inline">\(n_B\)</span>, <span class="math inline">\(S^2_{X_A}\)</span> et <span class="math inline">\(S^2_{X_B}\)</span> étant respectivement les nombres d’observations et les variances pour les groupes <em>A</em> et <em>B</em>, <span class="math inline">\(S^2_p\)</span>.</p>
<p>Si les échantillons sont de tailles identiques (<span class="math inline">\(n_A=n_B\)</span>), alors <em>d</em> s’écrit&nbsp;:</p>
<p><span id="eq-dcohen2"><span class="math display">\[
d = \frac{\bar{X}_{A}-\bar{X}_{B}}{\sqrt{(S^2_A+\S^2_B)/2}} = \frac{\bar{X}_{A}-\bar{X}_{B}}{(\sigma_A+\sigma_B)/2}
\tag{6.5}\]</span></span></p>
<p>avec <span class="math inline">\(\sigma_A\)</span> et <span class="math inline">\(\sigma_B\)</span> étant les écarts-types des deux groupes (rappel&nbsp;: l’écart-type est la racine carrée de la variance).</p>
<p>Le <em>g</em> de Hedge est simplement une correction de <em>d</em>, particulièrement importante quand les échantillons sont de taille réduite.</p>
<p><span id="eq-ghedge"><span class="math display">\[
g = d- \left(1- \frac{3}{4(n_A+n_B)-9} \right)
\tag{6.6}\]</span></span></p>
<p>Moins utilisé en sciences sociales, mais surtout en études cliniques, le delta de Glass est simplement la différence des moyennes des deux groupes indépendants (numérateur) sur l’écart-type du deuxième groupe (dénominateur). Dans une étude clinique, nous avons habituellement un groupe qui subit un traitement (groupe de traitement) et un groupe qui reçoit un placebo (groupe de contrôle ou groupe témoin). L’effet de taille est ainsi évalué par rapport au groupe de contrôle&nbsp;:</p>
<p><span id="eq-dDelta"><span class="math display">\[
\Delta = \frac{\bar{X}_{A}-\bar{X}_{B}}{\sigma_B}
\tag{6.7}\]</span></span></p>
<p>Finalement, pour des échantillons dépendants (pairés), le delta de Glass s’écrit&nbsp;: <span class="math inline">\(d = \bar{D}/{\sigma_D}\)</span> avec <span class="math inline">\(\bar{D}\)</span> et <span class="math inline">\(\sigma_D\)</span> étant la moyenne et l’écart-type des différences entre les observations.</p>
<p><strong>Comment interpréter le <em>d</em> de Cohen?</strong> Un effet est considéré comme faible avec <span class="math inline">\(\lvert d \rvert\)</span> à 0,2, modéré à 0,50 et fort à 0,80 <span class="citation" data-cites="cohen1992">(<a href="references.html#ref-cohen1992" role="doc-biblioref">Cohen 1992</a>)</span>. Notez que ces seuils ne sont que des conventions pour vous guider à interpréter la mesure de Cohen. D’ailleurs, dans son livre intitulé <em>Statistical power analysis for the behavioral sciences</em>, il écrit&nbsp;: «&nbsp;all conventions are arbitrary. One can only demand of them that they not be unreasonable&nbsp;» <span class="citation" data-cites="cohen2013">(<a href="references.html#ref-cohen2013" role="doc-biblioref">Cohen 2013</a>)</span>. Plus récemment, Sawilowsky <span class="citation" data-cites="sawilowsky2009">(<a href="references.html#ref-sawilowsky2009" role="doc-biblioref">2009</a>)</span> a ajouté d’autres seuils à ceux proposés par Cohen (<a href="#tbl-convcohen">tableau&nbsp;<span>6.1</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-convcohen" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;6.1: Conventions pour l’interprétation du <em>d</em> de Cohen</caption>
<thead><tr class="header">
<th style="text-align: left;">Sawilowsky</th>
<th style="text-align: left;">Cohen</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0,1 : Très faible</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">0,2 : Faible</td>
<td style="text-align: left;">0,2 : Faible</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0,5 : Moyen</td>
<td style="text-align: left;">0,5 : Moyen</td>
</tr>
<tr class="even">
<td style="text-align: left;">0,8 : Fort</td>
<td style="text-align: left;">0,8 : Fort</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1,2 : Très fort</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">2,0 : Énorme</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="sec-06113" class="level4" data-number="6.1.1.3"><h4 data-number="6.1.1.3" class="anchored" data-anchor-id="sec-06113">
<span class="header-section-number">6.1.1.3</span> Mise en œuvre dans R</h4>
<p>Nous avons écrit précédemment les fonctions <code>tstudent_independants</code> et <code>tstudent_dependants</code> uniquement pour décomposer les différentes étapes de calcul des tests de Student et de Welch. Heureusement, il existe des fonctions de base (<code>t.test</code> et <code>var.test</code>) qui permettent de réaliser l’un ou l’autre de ces deux tests avec une seule ligne de code.</p>
<p>La fonction <code>t.test</code> permet ainsi de calculer les tests de Student et de Welch&nbsp;:</p>
<ul>
<li><p><code>t.test(x ~ y, data=, mu = 0, paired = FALSE, var.equal = FALSE,  conf.level = 0.95)</code> ou <code>t.test(x =, y =, mu = 0, paired = FALSE, var.equal = FALSE,  conf.level = 0.95)</code>.</p></li>
<li><p>Le paramètre <code>paired</code> est utilisé pour spécifier si les échantillons sont dépendants (<code>paired = TRUE</code>) ou indépendants (<code>paired = FALSE</code>).</p></li>
<li><p>Le paramètre <code>var.equal</code> est utilisé pour spécifier si les variances sont égales pour le test de Student (<code>var.equal = TRUE</code>) ou dissemblables pour le test de Welch (<code>var.equal = FALSE</code>).</p></li>
<li><p><code>var.test(x, y)</code> ou <code>var.test(x ~ y, data=)</code> pour vérifier au préalable si les variances sont égales ou non et choisir ainsi un <em>t</em> de Student ou un <em>t</em> de Welch.</p></li>
</ul>
<p>Les fonctions <code>cohens_d</code> et <code>hedges_g</code> du <em>package</em> <code>effectsize</code> renvoient respectivement les mesures de <em>d</em> de Cohen et du <em>g</em> de Hedge&nbsp;:</p>
<ul>
<li><p><code>cohens_d(x ~ y, data = DataFrame, paired = FALSE, pooled_sd = TRUE)</code> ou <code>cohens_d(x, y, data = DataFrame, paired = FALSE, pooled_sd = TRUE)</code></p></li>
<li><p><code>hedges_g(x ~ y, data = DataFrame, paired = FALSE, pooled_sd = TRUE)</code> ou <code>hedges_g(x, y, data = DataFrame, paired = FALSE, pooled_sd = TRUE)</code></p></li>
<li><p><code>glass_delta(x ~ y, data = DataFrame, paired = FALSE, pooled_sd = TRUE)</code> ou <code>glass_delta(x, y, data = DataFrame, paired = FALSE, pooled_sd = TRUE)</code></p></li>
</ul>
<p>Notez que pour toutes ces fonctions, deux écritures sont possibles&nbsp;:</p>
<ul>
<li><p><code>x ~ y, data=</code> avec un <code>DataFrame</code> dans lequel <code>x</code> est une variable continue et <code>y</code> et un facteur binaire</p></li>
<li><p><code>x, y</code> qui sont tous deux des vecteurs numériques (variable continue).</p></li>
</ul>
<p><strong>Exemple de test pour des échantillons indépendants</strong></p>
<p>La <a href="#fig-locataires">figure&nbsp;<span>6.3</span></a> représente la cartographie du pourcentage de locataires par secteur de recensement (SR) pour la région métropolitaine de recensement de Montréal (RMR) en 2016, soit une variable continue. L’objectif est de vérifier si la moyenne de ce pourcentage des SR de l’agglomération de Montréal est significativement différente de celles de SR hors de l’agglomération.</p>
<div id="fig-locataires" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap06/FigureLocataires.jpg" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;6.3: Pourcentage de locataires par secteur de recensement, région métropolitaine de recensement de Montréal, 2016</figcaption></figure>
</div>
<p>Les résultats de la syntaxe ci-dessous signalent que le pourcentage de locataires par SR est bien supérieur dans l’agglomération (moyenne = 59,7&nbsp;%; écart-type = 21,4&nbsp;%) qu’en dehors de l’agglomération de Montréal (moyenne = 27,3&nbsp;%; écart-type = 20,1&nbsp;%). Cette différence de 32,5 points de pourcentage est d’ailleurs significative et très forte (<em>t</em>&nbsp;=&nbsp;-23,95; <em>p</em>&nbsp;&lt;&nbsp;0,001, d de Cohen&nbsp;=&nbsp;1,54).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://svn.r-project.org/R-packages/trunk/foreign/">"foreign"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://easystats.github.io/effectsize/">"effectsize"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org">"dplyr"</a></span><span class="op">)</span></span>
<span><span class="co"># Importation du fichier</span></span>
<span><span class="va">dfRMR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.dbf.html">read.dbf</a></span><span class="op">(</span><span class="st">"data/bivariee/SRRMRMTL2016.dbf"</span><span class="op">)</span></span>
<span><span class="co"># Définition d'un facteur binaire                  </span></span>
<span><span class="va">dfRMR</span><span class="op">$</span><span class="va">Montreal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dfRMR</span><span class="op">$</span><span class="va">Montreal</span>, </span>
<span>                           levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>                           labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hors de Montréal"</span> , <span class="st">"Montréal"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Comparaison des moyennes ------------------------</span></span>
<span><span class="co"># Boites à moustaches (boxplot)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dfRMR</span>, mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Montreal</span>, y <span class="op">=</span> <span class="va">Locataire</span>, colour <span class="op">=</span> <span class="va">Montreal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Zone"</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Pourcentage de locataires"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Locataires par secteur de recensement"</span>, </span>
<span>          subtitle <span class="op">=</span> <span class="st">"région métropolitaine de recensement de Montréal, 2016"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="06-bivarieeQualiQuanti_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Nombre d'observations, moyennes et écarts-types pour les deux échantillons</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">dfRMR</span>, <span class="va">Montreal</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    moy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Locataire</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    ecarttype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Locataire</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  Montreal             n   moy ecarttype
  &lt;fct&gt;            &lt;int&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 Hors de Montréal   430  27.3      20.1
2 Montréal           521  59.7      21.4</code></pre>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Nous vérifions si les variances sont égales avec la fonction var.test</span></span>
<span><span class="co"># quand la valeur de P est inférieure à 0,05 alors les variances diffèrent</span></span>
<span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/var.test.html">var.test</a></span><span class="op">(</span><span class="va">Locataire</span> <span class="op">~</span> <span class="va">Montreal</span>, alternative <span class="op">=</span> <span class="st">'two.sided'</span>, conf.level <span class="op">=</span> <span class="fl">.95</span>, data <span class="op">=</span> <span class="va">dfRMR</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  Locataire by Montreal
F = 0.88156, num df = 429, denom df = 520, p-value = 0.1739
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.7361821 1.0573195
sample estimates:
ratio of variances 
         0.8815563 </code></pre>
</div>
</div>
<p>Le test indique que nous n’avons aucune raison de rejeter l’hypothèse nulle selon laquelle les variances sont égales. Pour l’île de Montréal, l’écart-type est de 21,4; il est de 20,1 hors de l’île, soit une différence négligeable.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcul du T de Student ou du T de Welch</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">$</span><span class="va">p.value</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="va">p</span> <span class="op">&gt;=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n Les variances ne diffèrent pas!"</span>,</span>
<span>     <span class="st">"\n Nous utilisons le test de Student avec l'option var.equal = TRUE"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Locataire</span> <span class="op">~</span> <span class="va">Montreal</span>,  <span class="co"># variable continue ~ facteur binaire </span></span>
<span>           data <span class="op">=</span> <span class="va">dfRMR</span>,            <span class="co"># nom du DataFrame</span></span>
<span>           conf.level <span class="op">=</span> <span class="fl">.95</span>,       <span class="co"># intervalle de confiance pour la valeur de t</span></span>
<span>           var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>        <span class="co"># variances égales</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n Les variances diffèrent!"</span>,</span>
<span>      <span class="st">"\n Nous utilisons le test de Welch avec l'option var.equal = FALSE"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Locataire</span> <span class="op">~</span> <span class="va">Montreal</span>,   <span class="co"># variable continue ~ facteur binaire </span></span>
<span>         data <span class="op">=</span> <span class="va">dfRMR</span>,           <span class="co"># nom du DataFrame</span></span>
<span>         conf.level <span class="op">=</span> <span class="fl">.95</span>,       <span class="co"># intervalle de confiance pour la valeur de t</span></span>
<span>         var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>        <span class="co"># variances différentes</span></span>
<span><span class="op">}</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Les variances ne diffèrent pas!
 Nous utilisons le test de Student avec l'option var.equal = TRUE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  Locataire by Montreal
t = -23.95, df = 949, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group Hors de Montréal and group Montréal is not equal to 0
95 percent confidence interval:
 -35.11182 -29.79341
sample estimates:
mean in group Hors de Montréal         mean in group Montréal 
                      27.27340                       59.72601 </code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Effet de taille à analyser uniquement si le test est significatif</span></span>
<span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">cohens_d</a></span><span class="op">(</span><span class="va">Locataire</span> <span class="op">~</span> <span class="va">Montreal</span>, data <span class="op">=</span> <span class="va">dfRMR</span>, paired <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cohen's d |         95% CI
--------------------------
-1.56     | [-1.71, -1.41]

- Estimated using pooled SD.</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">hedges_g</a></span><span class="op">(</span><span class="va">Locataire</span> <span class="op">~</span> <span class="va">Montreal</span>, data <span class="op">=</span> <span class="va">dfRMR</span>, paired <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hedges' g |         95% CI
--------------------------
-1.56     | [-1.70, -1.41]

- Estimated using pooled SD.</code></pre>
</div>
</div>
<p>Notez que les valeurs du <em>d</em> de Cohen et du <em>g</em> de Hedge sont très semblables; rappelons que le second est une correction du premier pour des échantillons de taille réduite. Avec 951 observations, nous disposons d’un échantillon suffisamment grand pour que cette correction soit négligeable.</p>
<p><strong>Exemple de syntaxe pour un test de Student pour des échantillons dépendants</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/ggpubr/">"ggpubr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org">"dplyr"</a></span><span class="op">)</span></span>
<span><span class="va">Pre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">79</span>,<span class="fl">71</span>,<span class="fl">81</span>,<span class="fl">83</span>,<span class="fl">77</span>,<span class="fl">74</span>,<span class="fl">76</span>,<span class="fl">74</span>,<span class="fl">79</span>,<span class="fl">70</span>,<span class="fl">66</span>,<span class="fl">85</span>,<span class="fl">69</span>,<span class="fl">69</span>,<span class="fl">82</span>,</span>
<span>         <span class="fl">69</span>,<span class="fl">81</span>,<span class="fl">70</span>,<span class="fl">83</span>,<span class="fl">68</span>,<span class="fl">77</span>,<span class="fl">76</span>,<span class="fl">77</span>,<span class="fl">70</span>,<span class="fl">68</span>,<span class="fl">80</span>,<span class="fl">65</span>,<span class="fl">65</span>,<span class="fl">75</span>,<span class="fl">84</span><span class="op">)</span></span>
<span><span class="va">Post</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">56</span>,<span class="fl">47</span>,<span class="fl">40</span>,<span class="fl">45</span>,<span class="fl">49</span>,<span class="fl">51</span>,<span class="fl">54</span>,<span class="fl">47</span>,<span class="fl">44</span>,<span class="fl">54</span>,<span class="fl">42</span>,<span class="fl">56</span>,<span class="fl">45</span>,<span class="fl">45</span>,<span class="fl">48</span>,</span>
<span>          <span class="fl">55</span>,<span class="fl">59</span>,<span class="fl">58</span>,<span class="fl">56</span>,<span class="fl">41</span>,<span class="fl">56</span>,<span class="fl">51</span>,<span class="fl">45</span>,<span class="fl">55</span>,<span class="fl">49</span>,<span class="fl">49</span>,<span class="fl">48</span>,<span class="fl">43</span>,<span class="fl">60</span>,<span class="fl">50</span><span class="op">)</span></span>
<span><span class="co"># Première façon de faire un tableau : avec deux colonnes Avant et Après</span></span>
<span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Avant<span class="op">=</span><span class="va">Pre</span>, Apres<span class="op">=</span><span class="va">Post</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Avant Apres
1    79    56
2    71    47
3    81    40
4    83    45
5    77    49
6    74    51</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggpaired.html">ggpaired</a></span><span class="op">(</span><span class="va">df1</span>, cond1 <span class="op">=</span> <span class="st">"Avant"</span>, cond2 <span class="op">=</span> <span class="st">"Apres"</span>, fill <span class="op">=</span> <span class="st">"condition"</span>, palette <span class="op">=</span> <span class="st">"jco"</span>,</span>
<span>         xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">"Variable continue"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="06-bivarieeQualiQuanti_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Nombre d'observations, moyennes et écart-types</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span>, <span class="st">" observations"</span>,</span>
<span>    <span class="st">"\nPOST. moy = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df1</span><span class="op">$</span><span class="va">Avant</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">", e.t. = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">df1</span><span class="op">$</span><span class="va">Avant</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="st">"\nPRE.  moy = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df1</span><span class="op">$</span><span class="va">Apres</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">", e.t. = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">df1</span><span class="op">$</span><span class="va">Apres</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>30 observations
POST. moy = 74.8, e.t. = 6.1
PRE.  moy = 49.9, e.t. = 5.7</code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Pre</span>, <span class="va">Post</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  Pre and Post
t = 18.701, df = 29, p-value &lt; 2.2e-16
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 22.11740 27.54926
sample estimates:
mean difference 
       24.83333 </code></pre>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Deuxième façon de faire un tableau : avec une colonne pour la variable continue</span></span>
<span><span class="co"># et une autre pour la variable qualitative</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Pre</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>       id<span class="op">=</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span>,</span>
<span>       participant<span class="op">=</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Pre</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       risque<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Pre</span>, <span class="va">Post</span><span class="op">)</span></span>
<span>       <span class="op">)</span></span>
<span><span class="va">df2</span><span class="op">$</span><span class="va">periode</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Pre</span><span class="op">)</span>, <span class="st">"Pré"</span>, <span class="st">"Post"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id participant risque periode
1  1           1     79     Pré
2  2           2     71     Pré
3  3           3     81     Pré
4  4           4     83     Pré
5  5           5     77     Pré
6  6           6     74     Pré</code></pre>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># nombre d'observations, moyennes et écarts-types pour les deux échantillons</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">df2</span>, <span class="va">periode</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    moy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">risque</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    et <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">risque</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  periode     n   moy    et
  &lt;chr&gt;   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Post       30  49.9  5.67
2 Pré        30  74.8  6.10</code></pre>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggpaired.html">ggpaired</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df2</span>, x <span class="op">=</span> <span class="st">"periode"</span>, y <span class="op">=</span> <span class="st">"risque"</span>, fill <span class="op">=</span> <span class="st">"periode"</span>,</span>
<span>         xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">"Variable continue"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="06-bivarieeQualiQuanti_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Pre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df2</span>, <span class="va">periode</span> <span class="op">==</span> <span class="st">"Pré"</span><span class="op">)</span><span class="op">$</span><span class="va">risque</span></span>
<span><span class="va">Post</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df2</span>, <span class="va">periode</span> <span class="op">==</span> <span class="st">"Post"</span><span class="op">)</span><span class="op">$</span><span class="va">risque</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Pre</span>, <span class="va">Post</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  Pre and Post
t = 18.701, df = 29, p-value &lt; 2.2e-16
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 22.11740 27.54926
sample estimates:
mean difference 
       24.83333 </code></pre>
</div>
</div>
</section><section id="sec-06114" class="level4" data-number="6.1.1.4"><h4 data-number="6.1.1.4" class="anchored" data-anchor-id="sec-06114">
<span class="header-section-number">6.1.1.4</span> Comparaison des moyennes pondérées</h4>
<div class="bloc_objectif">
<div class="bloc_objectif-header">
<div class="bloc_objectif-icon">

</div>
<p><strong>Moyennes pondérées</strong></p>
</div>
<div class="bloc_objectif-body">
<p>En études urbaines et en géographie, le recours aux données agrégées (non individuelles) est fréquent, par exemple au niveau des secteurs de recensement (comprenant généralement entre 2500 à 8000 habitants). Dans ce contexte, un secteur de recensement plus peuplé devrait avoir un poids plus important dans l’analyse. Il est possible d’utiliser les versions pondérées des tests présentés précédemment. Prenons deux exemples pour illustrer le tout&nbsp;:</p>
<ul>
<li><p>Pour chaque secteur de recensement des îles de Montréal et de Laval, nous avons calculé la distance au parc le plus proche à travers le réseau de rues avec un système d’information géographique (SIG). Nous souhaitons vérifier si les personnes âgées de moins de 15 ans résidant sur l’île de Montréal bénéficient en moyenne d’une meilleure accessibilité au parc.</p></li>
<li><p>Dans une étude sur la concentration de polluants atmosphériques dans l’environnement autour des écoles primaires montréalaises, Carrier <em>et al.</em> <span class="citation" data-cites="carrier2014">(<a href="references.html#ref-carrier2014" role="doc-biblioref">2014</a>)</span> souhaitaient vérifier si les élèves fréquentant les écoles les plus défavorisées sont plus exposé(e)s au dioxyde d’azote (NO<sub>2</sub>) dans leur milieu scolaire. Pour ce faire, ils ont réalisé un test <em>t</em> sur un tableau avec comme observations les écoles primaires et trois variables&nbsp;: la moyenne de NO<sub>2</sub> (variable continue), les quintiles extrêmes d’un indice de défavorisation (premier et dernier quintiles, variable qualitative) et le nombre d’élèves par école (variable pour la pondération).</p></li>
</ul>
<p>Pour réaliser un test <em>t</em> pondéré, nous pouvons utiliser la fonction <code>t_test</code> du package <code>sjstats</code>.</p>
</div>
</div>
<p>En guise d’exemple appliqué, dans la syntaxe ci-dessous, nous avons refait le même test <em>t</em> que précédemment (<code>Locataire ~ Montreal</code>) en pondérant chaque secteur de recensement par le nombre de logements qu’il comprend.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://strengejacke.github.io/sjstats/">"sjstats"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org">"dplyr"</a></span><span class="op">)</span></span>
<span><span class="co"># Calcul des statistiques pondérées</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">dfRMR</span>, <span class="va">Montreal</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Logement</span><span class="op">)</span>,</span>
<span>    MoyPond <span class="op">=</span> <span class="fu"><a href="https://easystats.github.io/datawizard/reference/weighted_mean.html">weighted_mean</a></span><span class="op">(</span><span class="va">Locataire</span>, <span class="va">Logement</span><span class="op">)</span>,</span>
<span>    ecarttypePond <span class="op">=</span> <span class="fu"><a href="https://easystats.github.io/datawizard/reference/weighted_mean.html">weighted_sd</a></span><span class="op">(</span><span class="va">Locataire</span>, <span class="va">Logement</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  Montreal              n MoyPond ecarttypePond
  &lt;fct&gt;             &lt;int&gt;   &lt;dbl&gt;         &lt;dbl&gt;
1 Hors de Montréal 856928    28.4          19.9
2 Montréal         870354    60.0          20.8</code></pre>
</div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Test t non pondéré</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Locataire</span> <span class="op">~</span> <span class="va">Montreal</span>, <span class="va">dfRMR</span>, </span>
<span>       var.equal <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  Locataire by Montreal
t = -23.95, df = 949, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group Hors de Montréal and group Montréal is not equal to 0
95 percent confidence interval:
 -35.11182 -29.79341
sample estimates:
mean in group Hors de Montréal         mean in group Montréal 
                      27.27340                       59.72601 </code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Test t pondérée</span></span>
<span><span class="fu">sjstats</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/sjstats/reference/t_test.html">t_test</a></span><span class="op">(</span><span class="va">dfRMR</span>, </span>
<span>                select  <span class="op">=</span> <span class="st">"Locataire"</span>, </span>
<span>                by <span class="op">=</span> <span class="st">"Montreal"</span>, </span>
<span>                weights <span class="op">=</span> <span class="st">"Logement"</span>,</span>
<span>                mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                paired <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Two-Sample t-test (weighted)

  Data: Locataire by Montreal
  Group 1: Hors de Montréal (n = 856928, mean = 28.40)
  Group 2: Montréal         (n = 870354, mean = 60.00)
  Alternative hypothesis: true difference in means is not equal to 0

  t = -23.88, Cohen's d = -0.81 (large effect), df = 928.3, p &lt; .001</code></pre>
</div>
</div>
</section><section id="sec-06115" class="level4" data-number="6.1.1.5"><h4 data-number="6.1.1.5" class="anchored" data-anchor-id="sec-06115">
<span class="header-section-number">6.1.1.5</span> Comment rapporter un test de Student ou de Welch?</h4>
<p>Pour les différentes versions du test, il est important de rapporter les valeurs de <em>t</em> et de <em>p</em>, les moyennes et écarts-types des groupes. Voici quelques exemples.</p>
<p><strong>Test de Student ou de Welch pour échantillons indépendants</strong></p>
<ul>
<li><p>Dans la région métropolitaine de Montréal en 2005, le revenu total des femmes (moyenne = 29&nbsp;117 dollars; écart-type = 258&nbsp;022) est bien inférieur à celui des hommes (moyenne = 44&nbsp;463; écart-type&nbsp;=&nbsp;588&nbsp;081). La différence entre les moyennes des deux sexes (-15&nbsp;345) en faveur des hommes est d’ailleurs significative (<em>t</em>&nbsp;=&nbsp;-27,09; <em>p</em>&nbsp;&lt;&nbsp;0,001).</p></li>
<li><p>Il y un effet significatif selon le sexe (<em>t</em>&nbsp;=&nbsp;-27,09; <em>p</em>&nbsp;&lt;&nbsp;0,001), le revenu total des hommes (moyenne&nbsp;=&nbsp;44&nbsp;463; écart-type&nbsp;=&nbsp;588&nbsp;081) étant bien supérieur à celui des femmes (moyenne = 29&nbsp;117; écart-type = 258&nbsp;022).</p></li>
<li><p>50 personnes se rendent au travail à vélo (moyenne&nbsp;=&nbsp;33,7; écart-type =&nbsp;8,5) contre 60 en automobile (moyenne&nbsp;=&nbsp;34; écart-type&nbsp;=&nbsp;8,7). Il n’y a pas de différence significative entre les moyennes d’âge des deux groupes (<em>t</em>(108)&nbsp;=&nbsp;-0,79; <em>p</em>&nbsp;=&nbsp;0,427).</p></li>
</ul>
<p><strong>Test de Student échantillons dépendants (pairés)</strong></p>
<ul>
<li><p>Nous constatons une diminution significative de la perception du risque après l’activité (moyenne = 49,9; écart-type = 5,7) comparativement à avant (moyenne&nbsp;=&nbsp;74,8; écart-type&nbsp;=&nbsp;6,1), avec une différence de -24,8 (<em>t</em>(29)&nbsp;=&nbsp;-18,7; <em>p</em>&nbsp;&lt;&nbsp;0,001).</p></li>
<li><p>Les résultats du pré-test (moyenne&nbsp;=&nbsp;49,9; écart-type&nbsp;=&nbsp;5,7) et du post-test (moyenne&nbsp;=&nbsp;74,8; écart-type&nbsp;=&nbsp;6,1) montrent qu’il y une diminution significative de la perception du risque (<em>t</em>(29)&nbsp;=&nbsp;-18,7; <em>p</em>&nbsp;&lt;&nbsp;0,001).</p></li>
</ul>
<p>Pour un texte en anglais, consultez <a href="https://www.socscistatistics.com/tutorials/ttest/default.aspx" target="_blank">https://www.socscistatistics.com/tutorials/ttest/default.aspx</a>.</p>
</section></section><section id="sec-0612" class="level3" data-number="6.1.2"><h3 data-number="6.1.2" class="anchored" data-anchor-id="sec-0612">
<span class="header-section-number">6.1.2</span> Test non paramétrique de Wilcoxon</h3>
<div class="bloc_objectif">
<div class="bloc_objectif-header">
<div class="bloc_objectif-icon">

</div>
<p><strong>Test non paramétrique de Wilcoxon</strong></p>
</div>
<div class="bloc_objectif-body">
<p>Si la variable continue est fortement anormalement distribuée, il est déconseillé d’utiliser les tests de Student et de Welch. Nous privilégions le test des rangs signés de Wilcoxon (<em>Wilcoxon rank-sum test</em> en anglais). Attention, il est aussi appelé test U de Mann-Whitney. Ce test permet alors de vérifier si les deux groupes présentent des médianes différentes.</p>
<p>Pour ce faire, nous utilisons la fonction <code>wilcox.test</code> dans laquelle le paramètre <code>paired</code> permet de spécifier si les échantillons sont indépendants ou non (<code>FALSE</code> ou <code>TRUE</code>).</p>
</div>
</div>
<p>Dans l’exemple suivant, nous analysons le pourcentage de locataires dans les secteurs de recensement de la région métropolitaine de Montréal. Plus spécifiquement, nous comparons ce pourcentage entre les secteurs présents sur l’île et les secteurs hors de l’île. Il s’agit donc d’un test avec des échantillons indépendants.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://svn.r-project.org/R-packages/trunk/foreign/">"foreign"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org">"dplyr"</a></span><span class="op">)</span></span>
<span><span class="co">###############################</span></span>
<span><span class="co"># Échantillons indépendants</span></span>
<span><span class="co">###############################</span></span>
<span><span class="va">dfRMR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.dbf.html">read.dbf</a></span><span class="op">(</span><span class="st">"data/bivariee/SRRMRMTL2016.dbf"</span><span class="op">)</span></span>
<span><span class="co"># Définition d'un facteur binaire                  </span></span>
<span><span class="va">dfRMR</span><span class="op">$</span><span class="va">Montreal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dfRMR</span><span class="op">$</span><span class="va">Montreal</span>, </span>
<span>                           levels <span class="op">=</span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>                           labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hors de Montréal"</span> , <span class="st">"Montréal"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Calcul du nombre d'observations, des moyennes et </span></span>
<span><span class="co"># des écarts-types des rangs pour les deux échantillons</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">dfRMR</span>, <span class="va">Montreal</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    moy_rang <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">Locataire</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    med_rang <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">Locataire</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    ecarttype_rang <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">Locataire</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  Montreal             n moy_rang med_rang ecarttype_rang
  &lt;fct&gt;            &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;
1 Hors de Montréal   430     216.     216.           124.
2 Montréal           521     261      261            151.</code></pre>
</div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Test des rangs signés de Wilcoxon sur des échantillons indépendants</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">Locataire</span> <span class="op">~</span> <span class="va">Montreal</span>, <span class="va">dfRMR</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  Locataire by Montreal
W = 33716, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>Nous observons bien ici une différence significative entre le pourcentage de locataires des secteurs de recensement sur l’île (rang médian = 216) et ceux en dehors de l’île (rang médian = 261).</p>
<p>Pour le second exemple, nous générons deux jeux de données au hasard représentant une mesure d’une variable pré-traitement (<em>pre</em>) et post-traitement (<em>post</em>) pour un même échantillon.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">###############################</span></span>
<span><span class="co"># Échantillons dépendants</span></span>
<span><span class="co">###############################</span></span>
<span><span class="va">pre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">60</span><span class="op">:</span><span class="fl">80</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">post</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">30</span><span class="op">:</span><span class="fl">65</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Avant<span class="op">=</span><span class="va">pre</span>, Apres<span class="op">=</span><span class="va">post</span><span class="op">)</span></span>
<span><span class="co"># Nombre d'observations, moyennes et écart-types</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span>, <span class="st">" observations"</span>,</span>
<span>    <span class="st">"\nPOST. median = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">df1</span><span class="op">$</span><span class="va">Avant</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>             <span class="st">", moy = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df1</span><span class="op">$</span><span class="va">Avant</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="st">"\nPRE.  median = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">df1</span><span class="op">$</span><span class="va">Apres</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>             <span class="st">", moy = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df1</span><span class="op">$</span><span class="va">Apres</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>50 observations
POST. median = 71, moy = 70.1
PRE.  median = 48, moy = 47.5</code></pre>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">df1</span><span class="op">$</span><span class="va">Avant</span>, <span class="va">df1</span><span class="op">$</span><span class="va">Apres</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  df1$Avant and df1$Apres
V = 1275, p-value = 7.722e-10
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>À nouveau, nous obtenons une différence significative entre les deux variables.</p>
<p><strong>Comment rapporter un test de Wilcoxon?</strong></p>
<p>Lorsque nous rapportons les résultats d’un test de Wilcoxon, il est important de signaler la valeur du test (<em>W</em>), le degré de signification (valeur de <em>p</em>) et éventuellement la médiane des rangs ou de la variable originale pour les deux groupes. Voici quelques exemples&nbsp;:</p>
<ul>
<li><p>Les résultats du test des rangs signés de Wilcoxon signalent que les rangs de l’île de Montréal sont significativement plus élevés que ceux de l’île de Laval (<em>W</em> = 1223, <em>p</em> &lt; 0,001).</p></li>
<li><p>Les résultats du test de Wilcoxon signalent que les rangs post-tests sont significativement plus faibles que ceux du pré-test (<em>W</em> = 1273,5, <em>p</em> &lt; 0,001).</p></li>
<li><p>Les résultats du test de Wilcoxon signalent que la médiane des rangs pré-tests (médiane = 69) est significativement plus forte que celle du post-test (médiane = 50,5) (<em>W</em> = 1273,5, <em>p</em> &lt; 0,001).</p></li>
</ul></section></section><section id="sec-062" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="sec-062">
<span class="header-section-number">6.2</span> Relation entre une variable quantitative et une variable qualitative à plus de deux modalités</h2>
<div class="bloc_objectif">
<div class="bloc_objectif-header">
<div class="bloc_objectif-icon">

</div>
<p><strong>Existe-t-il une relation entre une variable continue et une variable qualitative comprenant plus de deux modalités?</strong></p>
</div>
<div class="bloc_objectif-body">
<p>Pour répondre à cette question, nous avons recours à deux méthodes&nbsp;: l’analyse de variance – <strong>ANOVA</strong>, <em><strong>AN</strong>alysis <strong>O</strong>f <strong>VA</strong>riance</em> en anglais – et le test non paramétrique de Kruskal-Wallis. La première permet de vérifier si les moyennes de plusieurs groupes d’une population donnée sont ou non significativement différentes; la seconde, si leurs médianes sont différentes.</p>
</div>
</div>
<section id="sec-0621" class="level3" data-number="6.2.1"><h3 data-number="6.2.1" class="anchored" data-anchor-id="sec-0621">
<span class="header-section-number">6.2.1</span> Analyse de variance</h3>
<p>L’analyse de variance (ANOVA) est largement utilisée en psychologie, en médecine et en pharmacologie. Prenons un exemple classique en pharmacologie pour tester l’efficacité d’un médicament. Quatre groupes de population sont constitués&nbsp;:</p>
<ul>
<li><p>un premier groupe d’individus pour lequel nous administrons un placebo (un médicament sans substance active), soit le groupe de contrôle ou le groupe témoin;</p></li>
<li><p>un second groupe auquel nous administrons le médicament avec un faible dosage;</p></li>
<li><p>un troisième avec un dosage moyen;</p></li>
<li><p>un quatrième avec un dosage élevé.</p></li>
</ul>
<p>La variable continue permet d’évaluer l’évolution de l’état de santé des individus (par exemple, la variation du taux de globules rouges dans le sang avant et après le traitement). Si le traitement est efficace, nous nous attendons alors à ce que les moyennes des deuxième, troisième et quatrième groupes soient plus élevées que celle du groupe de contrôle. Les différences de moyennes entre les second, troisième et quatrième groupes permettent aussi de repérer le dosage le plus efficace. Si nous n’observons aucune différence significative entre les groupes, cela signifie que l’effet du médicament ne diffère pas de l’effet d’un placébo.</p>
<p>L’ANOVA est aussi très utilisée en études urbaines, principalement pour vérifier si un phénomène urbain varie selon plusieurs groupes d’une population donnée ou de régions géographiques. En guise d’exemple, le recours à l’ANOVA permet de répondre aux questions suivantes&nbsp;:</p>
<ul>
<li><p>Les moyennes des niveaux d’exposition à un polluant atmosphérique (variable continue) varient-elles significativement selon le mode de transport utilisé (automobile, vélo, transport en commun) pour des trajets similaires en heures de pointe?</p></li>
<li><p>Pour une métropole donnée, les moyennes des loyers (variable continue) sont-elles différentes entre les logements de la ville centre versus ceux localisés dans la première couronne et ceux de la seconde couronne?</p></li>
</ul>
<section id="sec-06211" class="level4" data-number="6.2.1.1"><h4 data-number="6.2.1.1" class="anchored" data-anchor-id="sec-06211">
<span class="header-section-number">6.2.1.1</span> Calcul des trois variances pour l’ANOVA</h4>
<p>L’ANOVA repose sur le calcul de trois variances&nbsp;:</p>
<ul>
<li><p><strong>la variance totale</strong> (<em>VT</em>) de la variable dépendante continue, soit la somme des carrés des écarts à la moyenne de l’ensemble de la population (<a href="#eq-anova1">équation&nbsp;<span>6.8</span></a>);</p></li>
<li><p>la <strong>variance intergroupe</strong> (<em>Var<sub>inter</sub></em>) ou variance expliquée (<em>VE</em>), soit la somme des carrés des écarts entre la moyenne de chaque groupe et la moyenne de l’ensemble du jeu de données multipliées par le nombre d’individus appartenant à chacun des groupes (<a href="#eq-anova2">équation&nbsp;<span>6.9</span></a>);</p></li>
<li><p>la <strong>variance intragroupe</strong> (<em>Var<sub>intra</sub></em>) ou variance non expliquée (<em>VNE</em>), soit la somme des variances des groupes de la variable indépendante (<a href="#eq-anova3">équation&nbsp;<span>6.10</span></a>).</p></li>
</ul>
<p><span id="eq-anova1"><span class="math display">\[
VT=\sum_{i=1}^n (y_{i}-\overline{y})^2
\tag{6.8}\]</span></span></p>
<p><span id="eq-anova2"><span class="math display">\[
Var_{inter} \mbox{ ou } VE=n_{g_1}\sum_{i\in{g_1}}(\overline{y_{g_1}}-\overline{y})^2 + n_{g_2}\sum_{i\in{g_2}}(\overline{y_{g_2}}-\overline{y})^2 + ... + n_{g_k}\sum_{i\in{g_n}}(\overline{y_{g_k}}-\overline{y})^2
\tag{6.9}\]</span></span></p>
<p><span id="eq-anova3"><span class="math display">\[
Var_{intra} \mbox{ ou } VNE=\sum_{i\in{g_1}}(y_{i}-\overline{y_{g_1}})^2 + \sum_{i\in{g_2}}(y_{i}-\overline{y_{g_2}})^2 + ... + \sum_{i\in{g_n}}(y_{i}-\overline{y_{g_k}})^2
\tag{6.10}\]</span></span></p>
<p>où <span class="math inline">\(\overline{y}\)</span> est la moyenne de l’ensemble de la population; <span class="math inline">\(\overline{y_{g_1}}\)</span>, <span class="math inline">\(\overline{y_{g_2}}\)</span>, <span class="math inline">\(\overline{y_{g_k}}\)</span> sont respectivement les moyennes des groupes 1 à <em>k</em> (<em>k</em> étant le nombre de modalités de la variable qualitative) et <span class="math inline">\(n_{g_1}\)</span>,<span class="math inline">\(n_{g_2}\)</span> et <span class="math inline">\(n_{g_k}\)</span> sont les nombres d’observations dans les groupes 1 à <em>k</em>.</p>
<p>La variance totale (<em>VT</em>) est égale à la somme de la variance intergroupe (expliquée) et la variance intragroupe (non expliquée) (<a href="#eq-anova5">équation&nbsp;<span>6.11</span></a>). Le ratio entre la variance intergroupe (expliquée) et la variance totale est dénommé <em>Eta<sup>2</sup></em> (<a href="#eq-anova6">équation&nbsp;<span>6.12</span></a>). Il varie de 0 à 1 et exprime la proportion de la variance de la variable continue qui est expliquée par les différentes modalités de la variable qualitative.</p>
<p><span id="eq-anova5"><span class="math display">\[
VT = Var_{inter} + Var_{intra} \mbox{ ou } VT = VNE + VE
\tag{6.11}\]</span></span></p>
<p><span id="eq-anova6"><span class="math display">\[
\eta^2= \frac{Var_{inter}}{VT} \mbox{ ou }  \eta^2= \frac{VE}{VT}
\tag{6.12}\]</span></span></p>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>La décomposition de la variance totale : une notion fondamentale en statistique</strong></p>
</div>
<div class="bloc_astuce-body">
<p>La <strong>variance totale</strong> est égale à la somme des variances intragroupe et intergroupe. Nous verrons qu’elle est aussi utilisée pour évaluer la qualité d’une partition d’une population en plusieurs groupes dans le chapitre sur les méthodes de classification (<a href="13-MethodeClassification.html">chapitre&nbsp;<span>13</span></a>). En ANOVA, nous retenons que&nbsp;:</p>
<ul>
<li><p>plus la variance intragroupe est faible, plus les différents groupes sont homogènes;</p></li>
<li><p>plus la variance intergroupe est forte, plus les moyennes des groupes sont différentes et donc plus les groupes sont dissemblables.</p></li>
</ul>
<p>Autrement dit, plus la variance intergroupe (<strong>dissimilarité</strong> des groupes) est maximisée et corollairement plus la variance intragroupe (<strong>homogénéité</strong> de chacun des groupes) est minimisée, plus les groupes sont clairement distincts et plus l’ANOVA est performante.</p>
</div>
</div>
<p>Examinons un premier jeu de données fictives sur la vitesse de déplacement de cyclistes (variable continue exprimée en km/h) et une variable qualitative comprenant trois groupes de cyclistes utilisant soit un vélo personnel (<em>n<sub>A</sub></em> = 5), soit en libre-service (<em>n<sub>B</sub></em> = 7), soit électrique (<em>n<sub>C</sub></em> = 6) (<a href="#tbl-aovfictive1">tableau&nbsp;<span>6.2</span></a>). D’emblée, nous notons que les moyennes de vitesse des trois groupes sont différentes&nbsp;: 17,6&nbsp;km/h pour les cyclistes avec leur vélo personnel, 12,3&nbsp;km/h celles et ceux avec des vélos en libre-service et 23,1 km/h pour les cyclistes avec un vélo électrique. Pour chaque observation, la troisième colonne du tableau représente les écarts à la moyenne globale mis au carré, tandis que les colonnes suivantes représentent la déviation au carré de chaque observation à la moyenne de son groupe d’appartenance. Ainsi, pour la première observation, nous avons <span class="math inline">\((\mbox{16,900} - \mbox{17,339})^2 = \mbox{0,193}\)</span> et <span class="math inline">\((\mbox{16,900} - \mbox{17,580})^2~ = \mbox{0,462}\)</span>. Les valeurs des trois variances sont les suivantes&nbsp;:</p>
<ul>
<li>la <strong>variance totale</strong> (<em>VT</em>) est donc égale à la somme de la troisième colonne (<span class="math inline">\(\mbox{424,663}\)</span>).</li>
<li>la <strong>variance intergroupe</strong> (expliquée, <em>VE</em>), elle est égale à <span class="math inline">\(\mbox{5}\times(\mbox{17,580-17,339})^2+\mbox{7}\times(\mbox{12,257-17,339})^2+\mbox{6}\times(\mbox{23,067-17,339})^2 = \mbox{377,904}\)</span>.</li>
<li>la <strong>variance intragroupe</strong> (non expliquée, <em>VNE</em>) est égale à <span class="math inline">\(\mbox{11,228+21,537+13,993=46,758}\)</span>.</li>
</ul>
<p>Nous avons donc <span class="math inline">\(VT = Var_{inter} + Var_{intra}\)</span>, soit <span class="math inline">\(\mbox{424,663 = 377,904 + 46,758}\)</span> et <span class="math inline">\(\eta_2 = \mbox{377,904 / 424,663 = 0,89}\)</span>. Cela signale que 89&nbsp;% de la variance de la vitesse des cyclistes est expliquée par le type de vélo utilisé.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">VeloA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16.9</span>, <span class="fl">20.4</span>, <span class="fl">16.1</span>, <span class="fl">17.7</span>, <span class="fl">16.8</span><span class="op">)</span></span>
<span><span class="va">VeloB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">13.4</span>, <span class="fl">11.3</span>, <span class="fl">14.0</span>, <span class="fl">12.4</span>, <span class="fl">13.7</span>, <span class="fl">8.5</span>, <span class="fl">12.5</span><span class="op">)</span></span>
<span><span class="va">VeloC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">22.9</span>, <span class="fl">26.0</span>, <span class="fl">23.6</span>, <span class="fl">21.0</span>, <span class="fl">22.3</span>, <span class="fl">22.6</span><span class="op">)</span></span>
<span><span class="va">moyA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">VeloA</span><span class="op">)</span></span>
<span><span class="va">moyB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">VeloB</span><span class="op">)</span></span>
<span><span class="va">moyC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">VeloC</span><span class="op">)</span></span>
<span><span class="va">grandmoy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">VeloA</span>,<span class="va">VeloB</span>,<span class="va">VeloC</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">VeloA</span><span class="op">)</span></span>
<span><span class="va">nB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">VeloB</span><span class="op">)</span></span>
<span><span class="va">nC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">VeloC</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="va">nA</span> <span class="op">+</span> <span class="va">nB</span> <span class="op">+</span> <span class="va">nC</span></span>
<span><span class="va">VT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">VeloA</span>,<span class="va">VeloB</span>, <span class="va">VeloC</span><span class="op">)</span><span class="op">-</span><span class="va">grandmoy</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">VNE_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">VeloA</span><span class="op">-</span><span class="va">moyA</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">VNE_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">VeloB</span><span class="op">-</span><span class="va">moyB</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">VNE_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">VeloC</span><span class="op">-</span><span class="va">moyC</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">VNE</span> <span class="op">&lt;-</span> <span class="va">VNE_A</span> <span class="op">+</span> <span class="va">VNE_B</span> <span class="op">+</span> <span class="va">VNE_C</span></span>
<span><span class="va">VE</span> <span class="op">&lt;-</span> <span class="va">nA</span><span class="op">*</span><span class="op">(</span><span class="va">moyA</span><span class="op">-</span><span class="va">grandmoy</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">nB</span><span class="op">*</span><span class="op">(</span><span class="va">moyB</span><span class="op">-</span><span class="va">grandmoy</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">nC</span><span class="op">*</span><span class="op">(</span><span class="va">moyC</span><span class="op">-</span><span class="va">grandmoy</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">Eta2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">VE</span> <span class="op">/</span> <span class="va">VT</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  velo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"A. personnel"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">VeloA</span><span class="op">)</span><span class="op">)</span>, </span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"B. libre-service"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">VeloB</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"C. électrique"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">VeloC</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  kmh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">VeloA</span>,<span class="va">VeloB</span>, <span class="va">VeloC</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">VT</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">kmh</span> <span class="op">-</span> <span class="va">grandmoy</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">VNE_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">velo</span> <span class="op">==</span> <span class="st">"A. personnel"</span>, <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">kmh</span> <span class="op">-</span> <span class="va">moyA</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">VNE_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">velo</span> <span class="op">==</span> <span class="st">"B. libre-service"</span>, <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">kmh</span> <span class="op">-</span> <span class="va">moyB</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">VNE_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">velo</span> <span class="op">==</span> <span class="st">"C. électrique"</span>, <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">kmh</span> <span class="op">-</span> <span class="va">moyC</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">df_cas1</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span><span class="va">tabl</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span><span class="va">tabl</span><span class="op">$</span><span class="va">velo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">tabl</span><span class="op">$</span><span class="va">velo</span><span class="op">)</span></span>
<span><span class="va">tabl</span><span class="op">[</span><span class="fl">19</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"grande moyenne"</span></span>
<span><span class="va">tabl</span><span class="op">[</span><span class="fl">20</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"moyenne groupe A"</span></span>
<span><span class="va">tabl</span><span class="op">[</span><span class="fl">21</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"moyenne groupe B"</span></span>
<span><span class="va">tabl</span><span class="op">[</span><span class="fl">22</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"moyenne groupe C "</span></span>
<span><span class="va">tabl</span><span class="op">[</span><span class="fl">19</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">grandmoy</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">tabl</span><span class="op">[</span><span class="fl">20</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">moyA</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">tabl</span><span class="op">[</span><span class="fl">21</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">moyB</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">tabl</span><span class="op">[</span><span class="fl">22</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">moyC</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">tabl</span><span class="op">[</span><span class="fl">23</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Variance totale"</span></span>
<span><span class="va">tabl</span><span class="op">[</span><span class="fl">24</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Variance intragroupe"</span></span>
<span><span class="va">tabl</span><span class="op">[</span><span class="fl">23</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">tabl</span><span class="op">$</span><span class="va">VT</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">tabl</span><span class="op">[</span><span class="fl">24</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">tabl</span><span class="op">$</span><span class="va">VNE_A</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">tabl</span><span class="op">[</span><span class="fl">24</span>,<span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">tabl</span><span class="op">$</span><span class="va">VNE_B</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">tabl</span><span class="op">[</span><span class="fl">24</span>,<span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">tabl</span><span class="op">$</span><span class="va">VNE_C</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">tabl</span><span class="op">$</span><span class="va">VT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">tabl</span><span class="op">$</span><span class="va">VT</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">tabl</span><span class="op">$</span><span class="va">VNE_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">tabl</span><span class="op">$</span><span class="va">VNE_A</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">tabl</span><span class="op">$</span><span class="va">VNE_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">tabl</span><span class="op">$</span><span class="va">VNE_B</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">tabl</span><span class="op">$</span><span class="va">VNE_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">tabl</span><span class="op">$</span><span class="va">VNE_C</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">opts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>knitr.kable.NA <span class="op">=</span> <span class="st">"--"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">tabl</span>, </span>
<span>           caption <span class="op">=</span> <span class="st">"Données fictives et calcul des trois variances (cas 1)"</span>,</span>
<span>           format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>decimal.mark <span class="op">=</span> <span class="st">','</span>, big.mark <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Type de vélo"</span>,</span>
<span>                <span class="st">"km/h"</span>,</span>
<span>                <span class="st">"$(y_{i}-\\overline{y})^2$"</span>,</span>
<span>                <span class="st">"$(y_{i}-\\overline{y_{A}})^2$"</span>,</span>
<span>                <span class="st">"$(y_{i}-\\overline{y_{B}})^2$"</span>,</span>
<span>                <span class="st">"$(y_{i}-\\overline{y_{C}})^2$"</span></span>
<span>                <span class="op">)</span>,</span>
<span>                align<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-aovfictive1" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;6.2: Données fictives et calcul des trois variances (cas 1)</caption>
<colgroup>
<col style="width: 14%">
<col style="width: 5%">
<col style="width: 17%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Type de vélo</th>
<th style="text-align: center;">km/h</th>
<th style="text-align: right;"><span class="math inline">\((y_{i}-\overline{y})^2\)</span></th>
<th style="text-align: right;"><span class="math inline">\((y_{i}-\overline{y_{A}})^2\)</span></th>
<th style="text-align: right;"><span class="math inline">\((y_{i}-\overline{y_{B}})^2\)</span></th>
<th style="text-align: right;"><span class="math inline">\((y_{i}-\overline{y_{C}})^2\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A. personnel</td>
<td style="text-align: center;">16,900</td>
<td style="text-align: right;">0,193</td>
<td style="text-align: right;">0,462</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">A. personnel</td>
<td style="text-align: center;">20,400</td>
<td style="text-align: right;">9,370</td>
<td style="text-align: right;">7,952</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A. personnel</td>
<td style="text-align: center;">16,100</td>
<td style="text-align: right;">1,535</td>
<td style="text-align: right;">2,190</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">A. personnel</td>
<td style="text-align: center;">17,700</td>
<td style="text-align: right;">0,130</td>
<td style="text-align: right;">0,014</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A. personnel</td>
<td style="text-align: center;">16,800</td>
<td style="text-align: right;">0,290</td>
<td style="text-align: right;">0,608</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">B. libre-service</td>
<td style="text-align: center;">13,400</td>
<td style="text-align: right;">15,515</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">1,306</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B. libre-service</td>
<td style="text-align: center;">11,300</td>
<td style="text-align: right;">36,468</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">0,916</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">B. libre-service</td>
<td style="text-align: center;">14,000</td>
<td style="text-align: right;">11,148</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">3,038</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B. libre-service</td>
<td style="text-align: center;">12,400</td>
<td style="text-align: right;">24,393</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">0,020</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">B. libre-service</td>
<td style="text-align: center;">13,700</td>
<td style="text-align: right;">13,242</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">2,082</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B. libre-service</td>
<td style="text-align: center;">8,500</td>
<td style="text-align: right;">78,126</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">14,116</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">B. libre-service</td>
<td style="text-align: center;">12,500</td>
<td style="text-align: right;">23,415</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">0,059</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C. électrique</td>
<td style="text-align: center;">22,900</td>
<td style="text-align: right;">30,926</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">0,028</td>
</tr>
<tr class="even">
<td style="text-align: left;">C. électrique</td>
<td style="text-align: center;">26,000</td>
<td style="text-align: right;">75,015</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">8,604</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C. électrique</td>
<td style="text-align: center;">23,600</td>
<td style="text-align: right;">39,202</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">0,284</td>
</tr>
<tr class="even">
<td style="text-align: left;">C. électrique</td>
<td style="text-align: center;">21,000</td>
<td style="text-align: right;">13,404</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">4,271</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C. électrique</td>
<td style="text-align: center;">22,300</td>
<td style="text-align: right;">24,613</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">0,588</td>
</tr>
<tr class="even">
<td style="text-align: left;">C. électrique</td>
<td style="text-align: center;">22,600</td>
<td style="text-align: right;">27,679</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">0,218</td>
</tr>
<tr class="odd">
<td style="text-align: left;">grande moyenne</td>
<td style="text-align: center;">17,339</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">moyenne groupe A</td>
<td style="text-align: center;">17,580</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moyenne groupe B</td>
<td style="text-align: center;">12,257</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">moyenne groupe C</td>
<td style="text-align: center;">23,067</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Variance totale</td>
<td style="text-align: center;">–</td>
<td style="text-align: right;">424,663</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">Variance intragroupe</td>
<td style="text-align: center;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">11,228</td>
<td style="text-align: right;">21,537</td>
<td style="text-align: right;">13,993</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Examinons un deuxième jeu de données fictives pour lequel le type de vélo utilisé n’aurait que peu d’effet sur la vitesse des cyclistes (<a href="#tbl-aovfictive2">tableau&nbsp;<span>6.3</span></a>). D’emblée, les moyennes des trois groupes semblent très similaires (19,3, 17,9 et 18,7). Les valeurs des trois variances sont les suivantes&nbsp;:</p>
<ul>
<li>la <strong>variance totale</strong> (<em>VT</em>) est égale à <span class="math inline">\(\mbox{121,756}\)</span>.</li>
<li>la <strong>variance intergroupe</strong> (expliquée, <em>VE</em>) est égale à <span class="math inline">\(\mbox{5}\times(\mbox{19,300-18,528})^2+\mbox{7}\times(\mbox{17,871-18,528})^2+\mbox{6}\times(\mbox{18,650-18,528})^2 = \mbox{6,087}\)</span>.</li>
<li>la <strong>variance intragroupe</strong> (non expliquée, <em>VNE</em>) est égale à <span class="math inline">\(\mbox{9,140+50,254+56,275 = 115,669}\)</span>.</li>
</ul>
<p>Nous avons donc <span class="math inline">\(VT = Var_{inter} + Var_{intra}\)</span>, soit <span class="math inline">\(\mbox{121,756 = 6,087 + 115,669}\)</span> et <span class="math inline">\(\eta_2 = \mbox{6,087 / 121,756 = 0,05}\)</span>. Cela signale que 5&nbsp;% de la variance de la vitesse des cyclistes est uniquement expliquée par le type de vélo utilisé.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-aovfictive2" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;6.3: Données fictives et calcul des trois variances (cas 2)</caption>
<colgroup>
<col style="width: 14%">
<col style="width: 5%">
<col style="width: 17%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Type de vélo</th>
<th style="text-align: center;">km/h</th>
<th style="text-align: right;"><span class="math inline">\((y_{i}-\overline{y})^2\)</span></th>
<th style="text-align: right;"><span class="math inline">\((y_{i}-\overline{y_{A}})^2\)</span></th>
<th style="text-align: right;"><span class="math inline">\((y_{i}-\overline{y_{B}})^2\)</span></th>
<th style="text-align: right;"><span class="math inline">\((y_{i}-\overline{y_{C}})^2\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A. personnel</td>
<td style="text-align: center;">17,500</td>
<td style="text-align: right;">1,056</td>
<td style="text-align: right;">3,24</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">A. personnel</td>
<td style="text-align: center;">19,000</td>
<td style="text-align: right;">0,223</td>
<td style="text-align: right;">0,09</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A. personnel</td>
<td style="text-align: center;">19,700</td>
<td style="text-align: right;">1,374</td>
<td style="text-align: right;">0,16</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">A. personnel</td>
<td style="text-align: center;">18,700</td>
<td style="text-align: right;">0,030</td>
<td style="text-align: right;">0,36</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A. personnel</td>
<td style="text-align: center;">21,600</td>
<td style="text-align: right;">9,439</td>
<td style="text-align: right;">5,29</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">B. libre-service</td>
<td style="text-align: center;">13,700</td>
<td style="text-align: right;">23,307</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">17,401</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B. libre-service</td>
<td style="text-align: center;">20,800</td>
<td style="text-align: right;">5,163</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">8,577</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">B. libre-service</td>
<td style="text-align: center;">15,100</td>
<td style="text-align: right;">11,750</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">7,681</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B. libre-service</td>
<td style="text-align: center;">18,800</td>
<td style="text-align: right;">0,074</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">0,862</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">B. libre-service</td>
<td style="text-align: center;">21,500</td>
<td style="text-align: right;">8,834</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">13,167</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B. libre-service</td>
<td style="text-align: center;">16,500</td>
<td style="text-align: right;">4,112</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">1,881</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">B. libre-service</td>
<td style="text-align: center;">18,700</td>
<td style="text-align: right;">0,030</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">0,687</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C. électrique</td>
<td style="text-align: center;">16,600</td>
<td style="text-align: right;">3,716</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">4,203</td>
</tr>
<tr class="even">
<td style="text-align: left;">C. électrique</td>
<td style="text-align: center;">16,300</td>
<td style="text-align: right;">4,963</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">5,523</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C. électrique</td>
<td style="text-align: center;">15,600</td>
<td style="text-align: right;">8,572</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">9,303</td>
</tr>
<tr class="even">
<td style="text-align: left;">C. électrique</td>
<td style="text-align: center;">20,000</td>
<td style="text-align: right;">2,167</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">1,822</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C. électrique</td>
<td style="text-align: center;">24,600</td>
<td style="text-align: right;">36,872</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">35,402</td>
</tr>
<tr class="even">
<td style="text-align: left;">C. électrique</td>
<td style="text-align: center;">18,800</td>
<td style="text-align: right;">0,074</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">0,022</td>
</tr>
<tr class="odd">
<td style="text-align: left;">grande moyenne</td>
<td style="text-align: center;">18,528</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">moyenne groupe A</td>
<td style="text-align: center;">19,300</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moyenne groupe B</td>
<td style="text-align: center;">17,871</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">moyenne groupe C</td>
<td style="text-align: center;">18,650</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Variance totale</td>
<td style="text-align: center;">–</td>
<td style="text-align: right;">121,756</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">–</td>
</tr>
<tr class="even">
<td style="text-align: left;">Variance intragroupe</td>
<td style="text-align: center;">–</td>
<td style="text-align: right;">–</td>
<td style="text-align: right;">9,14</td>
<td style="text-align: right;">50,254</td>
<td style="text-align: right;">56,275</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="sec-06212" class="level4" data-number="6.2.1.2"><h4 data-number="6.2.1.2" class="anchored" data-anchor-id="sec-06212">
<span class="header-section-number">6.2.1.2</span> Test de Fisher</h4>
<p>Pour vérifier si les moyennes sont statistiquement différentes (autrement dit, si leur différence est significativement différente de 0), nous avons recours au test <em>F</em> de Fisher. Pour ce faire, nous posons l’hypothèse nulle (<em>H<sub>0</sub></em>), soit que les moyennes des groupes sont égales; autrement dit que la variable qualitative n’a pas d’effet sur la variable continue (indépendance entre les deux variables). L’hypothèse alternative (<em>H<sub>1</sub></em>) est donc que les moyennes sont différentes. Pour nos deux jeux de données fictives ci-dessus comprenant trois groupes, <em>H<sub>0</sub></em> signifie que <span class="math inline">\(\overline{y_{A}}=\overline{y_{B}}=\overline{y_{C}}\)</span>. La statistique <em>F</em> se calcule comme suit&nbsp;:</p>
<p><span id="eq-anovaF"><span class="math display">\[
F = \frac{\frac{Var{inter}}{k-1}}{\frac{Var{intra}}{n-k}}\mbox{ ou } F = \frac{\frac{VE}{k-1}}{\frac{VNE}{n-k}}
\tag{6.13}\]</span></span></p>
<p>où <span class="math inline">\(n\)</span> et <span class="math inline">\(k\)</span> sont respectivement les nombres d’observations et de modalités de la variable qualitative. L’hypothèse nulle (les moyennes sont égales) est rejetée si la valeur du <em>F</em> calculé est supérieure à la valeur critique de la table <em>F</em> avec les degrés de liberté <em>(k-1, n-k)</em> et un seuil <span class="math inline">\(\alpha\)</span> (<em>p</em>=0,05 habituellement) (voir la table des valeurs critiques de <em>F</em>, <a href="13-MethodeClassification.html#sec-132">section&nbsp;<span>13.2</span></a>). Notez que nous utilisons rarement la table <em>F</em> puisqu’avec la fonction <code>aov</code>, nous obtenons directement la valeur <em>F</em> et celle de <em>p</em> qui lui est associée. Concrètement, si le test <em>F</em> est significatif (avec <em>p</em> &lt; 0,05), plus la valeur de <em>F</em> est élevée, plus la différence entre les moyennes est élevée.</p>
<p>Appliquons rapidement la démarche du test <em>F</em> à nos deux jeux de données fictives qui comprennent 3&nbsp;modalités pour la variable qualitative et 18 observations. Avec <span class="math inline">\(\alpha\)</span> = 0,05, 2&nbsp;degrés de liberté (3-1) au numérateur et 15 au dénominateur (18-3), la valeur critique de F est de 3,68. Nous en concluons alors que&nbsp;:</p>
<ul>
<li><p>Pour le cas A, le <em>F</em> calculé est égal à <span class="math inline">\(\mbox{(377,904 / 2) / (46,758 / 15) = 60,62}\)</span>. Il est supérieur à la valeur <em>F</em> critique; les moyennes sont donc statistiquement différentes au seuil 0,05. Autrement dit, nous aurions eu moins de 5&nbsp;% de chance d’obtenir un échantillon produisant ces résultats si en réalité la différence entre les moyennes était de 0.</p></li>
<li><p>Pour le cas B, le <em>F</em> calculé est égal à <span class="math inline">\(\mbox{(6,087 / 2) / (115,669 / 15) = 0,39}\)</span>. Il est inférieur à la valeur <em>F</em> critique; les moyennes ne sont donc pas statistiquement différentes au seuil de 0,05.</p></li>
</ul></section><section id="sec-06213" class="level4" data-number="6.2.1.3"><h4 data-number="6.2.1.3" class="anchored" data-anchor-id="sec-06213">
<span class="header-section-number">6.2.1.3</span> Conditions d’application de l’ANOVA et solutions de rechange</h4>
<p>Trois conditions d’application doivent être vérifiées avant d’effectuer une analyse de variance sur un jeu de données&nbsp;:</p>
<ul>
<li><p><strong>Normalité des groupes.</strong> Le test de Fisher repose sur le postulat que les échantillons (groupes) sont normalement distribués. Pour le vérifier, nous avons recours au test de normalité de Shapiro–Wilk (<a href="02-univarie.html#sec-025413">section&nbsp;<span>2.5.4.1.3</span></a>). Rappelez-vous toutefois que ce test est très restrictif, surtout pour de grands échantillons.</p></li>
<li><p><strong>Homoscédasticité</strong>. La variance dans les échantillons doit être la même (homogénéité des variances). Pour vérifier cette condition, nous utilisons les tests de Levene, de Bartlett ou de Breusch-Pagan.</p></li>
<li><p><strong>Indépendance des observations (pseudo-réplication).</strong> Chaque individu doit appartenir à un et un seul groupe. En d’autres termes, les observations ne sont pas indépendantes si plusieurs mesures (variable continue) sont faites sur un même individu. Si c’est le cas, nous utiliserons alors une analyse de variance sur des mesures répétées (voir le bloc à la fin du chapitre).</p></li>
</ul>
<p><strong>Quelles sont les conséquences si les conditions d’application ne sont pas respectées?</strong> La non-vérification des conditions d’application cause deux problèmes distincts&nbsp;: elle affecte la puissance du test (sa capacité à détecter un effet, si celui-ci existe réellement) et le taux d’erreur de type 1 (la probabilité de trouver un résultat significatif alors qu’aucune relation n’existe réellement, soit un faux positif) <span class="citation" data-cites="glass1972consequences lix1996consequences">(<a href="references.html#ref-glass1972consequences" role="doc-biblioref">Glass, Peckham et Sanders 1972</a>; <a href="references.html#ref-lix1996consequences" role="doc-biblioref">Lix, Keselman et Keselman 1996</a>)</span>.</p>
<ul>
<li><p>Si la distribution est asymétrique plutôt que centrée (comme pour une distribution normale), la puissance et le taux d’erreur de type 1 sont tous les deux peu affectés, car le test est non orienté (la différence de moyennes peut être négative ou positive).</p></li>
<li><p>Si la distribution est leptocurtique (pointue, avec des extrémités de la distribution plus importantes), le taux d’erreur de type 1 est peu affecté; en revanche, la puissance du test est réduite. L’inverse s’observe si la distribution est platicurtique (aplatie, c’est-à-dire avec des extrémités de la distribution plus réduites.</p></li>
<li><p>Si les groupes ont des variances différentes, le taux d’erreur de type 1 augmente légèrement.</p></li>
<li><p>Si les observations ne sont pas indépendantes, à la fois le taux d’erreur de type 1 et la puissance du test sont fortement affectés.</p></li>
<li><p>Si les échantillons sont petits, les effets présentés ci-dessus sont démultipliés.</p></li>
<li><p>Si plusieurs conditions ne sont pas respectées, les conséquences présentées ci-dessus s’additionnent, voire se combinent.</p></li>
</ul>
<p><strong>Que faire quand les conditions d’application relatives à la normalité ou à l’homoscédasticité ne sont vraiment pas respectées?</strong> Signalons d’emblée que le non-respect de ces conditions ne change rien à la décomposition de la variance (<em>VT = V<sub>intra</sub>+V<sub>inter</sub></em>). Cela signifie que vous pouvez toujours calculer <em>Eta<sup>2</sup></em>. Par contre, le test de Fisher ne peut pas être utilisé, car il est biaisé comme décrit précédemment. Quatre solutions sont envisageables&nbsp;:</p>
<ul>
<li><p>Lorsque les échantillons sont fortement anormalement distribués, certains auteurs vont simplement transformer leur variable en appliquant une fonction logarithme (le plus souvent) ou racine carrée, inverse ou exponentielle, et reporter le test de Fisher calculé sur cette transformation. Attention toutefois! Transformer une variable ne va pas systématiquement la rapprocher d’une distribution normale et complique l’interprétation finale des résultats. Par conséquent, avant de recalculer votre test <em>F</em>, il convient de réaliser un test de normalité de Shapiro–Wilk et un test d’homoscédasticité (Levene, Bartlett ou Breusch-Pagan) sur la variable continue transformée.</p></li>
<li><p>Détecter les observations qui contribuent le plus à l’anormalité et à l’hétéroscédasticité (valeurs aberrantes ou extrêmes). Supprimez-les et refaites votre ANOVA en vous assurant que les conditions sont désormais respectées. Notez que supprimer des observations peut être une pratique éthiquement questionnable en statistique. Si vos échantillons sont bien constitués et que la mesure collectée n’est pas erronée, pourquoi donc la supprimer? Si vous optez pour cette solution, prenez soin de comparer les résultats avant et après la suppression des observations. Si les conditions sont respectées après la suppression et que les résultats de l’ANOVA (<em>Eta<sup>2</sup></em> et test <em>F</em> de Fisher) sont très semblables, conservez donc les résultats de l’ANOVA initiale et signalez que vous avez procédé aux deux tests.</p></li>
<li><p>Lorsque les variances des groupes sont dissemblables, vous pouvez utiliser le test de Welch pour l’ANOVA au lieu du test <em>F</em> de Fisher.</p></li>
<li><p>Dernière solution, lorsque les deux conditions ne sont vraiment pas respectées, utilisez le test non paramétrique de Kruskal-Wallis. Par analogie au <em>t</em> de Student, il correspond au test des rangs signés de Wilcoxon. Ce test est décrit dans la section suivante.</p></li>
</ul>
<p>Vous l’aurez compris, dans de nombreux cas en statistique, les choix méthodologiques dépendent en partie de la subjectivité des chercheur(se)s. Il faut s’adapter au jeu de données et à la culture statistique en vigueur dans votre champ d’études. N’hésitez pas à réaliser plusieurs tests différents pour évaluer la robustesse de vos conclusions et fiez-vous en premier lieu à ceux pour lesquels votre jeu de données est le plus adapté.</p>
</section></section><section id="sec-0622" class="level3" data-number="6.2.2"><h3 data-number="6.2.2" class="anchored" data-anchor-id="sec-0622">
<span class="header-section-number">6.2.2</span> Test non paramétrique de Kruskal-Wallis</h3>
<p>Le test non paramétrique de Kruskal-Wallis est une solution de rechange à l’ANOVA classique lorsque le jeu de données présente de graves problèmes de normalité et d’hétéroscédasticité. Cette méthode représente une ANOVA appliquée à une variable continue transformée préalablement en rangs. Du fait de la transformation en rangs, nous ne vérifions plus si les moyennes sont différentes, mais bel et bien si les médianes de la variable continue sont différentes. Pour ce faire, nous utiliserons la fonction <code>kruskal.test</code>.</p>
</section><section id="sec-0623" class="level3" data-number="6.2.3"><h3 data-number="6.2.3" class="anchored" data-anchor-id="sec-0623">
<span class="header-section-number">6.2.3</span> Mise en œuvre dans R</h3>
<p>Dans une étude récente, Apparicio <em>et al.</em> <span class="citation" data-cites="2018_1">(<a href="references.html#ref-2018_1" role="doc-biblioref">2018</a>)</span> ont comparé les expositions au bruit et à la pollution atmosphérique aux heures de pointe à Montréal en fonction du mode de transport utilisé. Pour ce faire, trois équipes de trois personnes ont été constituées&nbsp;: une personne à vélo, une autre en automobile et une dernière se déplaçant en transport en commun, équipées de capteurs de pollution, de sonomètres, de vêtements biométriques et d’une montre GPS. Chaque matin, à huit heures précises, les membres de chaque équipe ont réalisé un trajet d’un quartier périphérique de Montréal vers un pôle d’enseignement (université) ou d’emploi localisé au centre-ville. Le trajet inverse était réalisé le soir à 17&nbsp;h. Au total, une centaine de trajets ont ainsi été réalisés. Des analyses de variance ont ainsi permis de comparer les trois modes (automobile, vélo et transport en commun) en fonction des temps de déplacement, des niveaux d’exposition au bruit, des niveaux d’exposition au dioxyde d’azote et de la dose totale inhalée de dioxyde d’azote. Nous vous proposons ici d’analyser une partie de ces données.</p>
<section id="sec-06231" class="level4" data-number="6.2.3.1"><h4 data-number="6.2.3.1" class="anchored" data-anchor-id="sec-06231">
<span class="header-section-number">6.2.3.1</span> Première ANOVA&nbsp;: différences entre les temps de déplacement</h4>
<p>Comme première analyse de variance, nous vérifions si les moyennes des temps de déplacement sont différentes entre les trois modes de transport.</p>
<p>Dans un premier temps, nous calculons les moyennes des différents groupes. Nous pouvons alors constater que les moyennes sont très semblables&nbsp;: 37,7&nbsp;minutes pour l’automobile versus 38,4 et 41,6 pour le vélo et le transport en commun. Aussi, les variances des trois groupes sont relativement similaires.</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/rstatix/">"rstatix"</a></span><span class="op">)</span></span>
<span><span class="co"># chargement des DataFrames</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/bivariee/dataPollution.RData"</span><span class="op">)</span></span>
<span><span class="co"># Statistiques descriptives pour les groupes (moyenne et écart-type)</span></span>
<span><span class="va">df_TrajetsDuree</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                                 <span class="co"># Nom du DataFrame</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Mode</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                                <span class="co"># Variable qualitative</span></span>
<span>    <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/get_summary_stats.html">get_summary_stats</a></span><span class="op">(</span><span class="va">DureeMinute</span>, type <span class="op">=</span> <span class="st">"mean_sd"</span><span class="op">)</span>  <span class="co"># Variable continue </span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Mode    variable        n  mean    sd
  &lt;chr&gt;   &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 1. Auto DureeMinute    33  37.7  12.8
2 2. Velo DureeMinute    33  38.4  15.2
3 3. TC   DureeMinute    33  41.6  11.4</code></pre>
</div>
</div>
<p>Pour visualiser la distribution des données pour les trois groupes, vous pouvez créer des graphiques de densité et en violon (<a href="#fig-Anova1a">figure&nbsp;<span>6.4</span></a>). La juxtaposition des trois distributions montre que les distributions des valeurs pour les trois groupes sont globalement similaires. Cela est corroboré par le fait que les boîtes du graphique en violon sont situées à la même hauteur. Autrement dit, à la lecture des deux graphiques, il ne semble pas y avoir de différences significatives entre les trois groupes en termes de temps de déplacement.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/ggpubr/">"ggpubr"</a></span><span class="op">)</span></span>
<span><span class="co"># Graphique de densité</span></span>
<span><span class="va">GraphDens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_TrajetsDuree</span>, </span>
<span>  mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DureeMinute</span>, colour <span class="op">=</span> <span class="va">Mode</span>, fill <span class="op">=</span> <span class="va">Mode</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.55</span>, mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">..scaled..</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"a. Graphique de densité"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Densité"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Durée du trajet (en minutes)"</span><span class="op">)</span></span>
<span><span class="co"># Graphique en violon</span></span>
<span><span class="va">GraphViolon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_TrajetsDuree</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Mode</span>, y <span class="op">=</span> <span class="va">DureeMinute</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Mode</span>, y <span class="op">=</span> <span class="va">DureeMinute</span>, fill <span class="op">=</span> <span class="va">Mode</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"b. Graphique en violon"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Mode de transport"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Durée du trajet (en minutes)"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">GraphDens</span>, <span class="va">GraphViolon</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-Anova1a" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="06-bivarieeQualiQuanti_files/figure-html/fig-Anova1a-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;6.4: Graphiques de densité et en violon</figcaption></figure>
</div>
</div>
</div>
<p>Nous pouvons vérifier si les échantillons sont normalement distribués avec la fonction <code>shapiro_test</code> du package <code>rstatix</code>. À titre de rappel, l’hypothèse nulle (<em>H<sub>0</sub></em>) de ce test est que la distribution est normale. Par conséquent, quand la valeur de <em>p</em> associée à la statistique de Shapiro est supérieure à 0,05, alors nous ne pouvons rejeter l’hypothèse d’une distribution normale (autrement dit, la distribution est anormale). À la lecture des résultats ci-dessous, seul le groupe utilisant le transport en commun présente une distribution proche de la normalité (<em>p</em>&nbsp;=&nbsp;0,0504). Ce test étant très restrictif, il est fortement conseillé de visualiser le diagramme quantile-quantile pour chaque groupe (graphique QQ plot) (<a href="#fig-Qqplot">figure&nbsp;<span>6.5</span></a>). Ces graphiques sont utilisés pour déterminer visuellement si une distribution empirique (observée sur des données), s’approche d’une distribution théorique (ici la loi normale). Si effectivement les deux distributions sont proches, les points du diagramme devraient tous tomber sur une ligne droite parfaite. Un intervalle de confiance (représenté ici en gris) peut être construit pour obtenir une interprétation plus nuancée. Dans notre cas, seules deux observations pour le vélo et deux autres pour l’automobile s’éloignent vraiment de la ligne droite. Nous pouvons considérer que ces trois distributions s’approchent d’une distribution normale.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org">"dplyr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/ggpubr/">"ggpubr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/rstatix/">"rstatix"</a></span><span class="op">)</span></span>
<span><span class="co"># Condition 1 : normalité des échantillons</span></span>
<span><span class="co"># Test pour la normalité des échantillons (groupes) : test de Shapiro</span></span>
<span> <span class="va">df_TrajetsDuree</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>          <span class="co"># Nom du DataFrame</span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Mode</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>         <span class="co"># Variable qualitative</span></span>
<span>   <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/shapiro_test.html">shapiro_test</a></span><span class="op">(</span><span class="va">DureeMinute</span><span class="op">)</span>  <span class="co"># Variable continue </span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  Mode    variable    statistic         p
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;
1 1. Auto DureeMinute     0.905 0.00729  
2 2. Velo DureeMinute     0.797 0.0000288
3 3. TC   DureeMinute     0.936 0.0504   </code></pre>
</div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Graphiques qqplot pour les groupes</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggqqplot.html">ggqqplot</a></span><span class="op">(</span><span class="va">df_TrajetsDuree</span>, <span class="st">"DureeMinute"</span>, facet.by <span class="op">=</span> <span class="st">"Mode"</span>, </span>
<span>         xlab <span class="op">=</span> <span class="st">"Théorique"</span>, ylab <span class="op">=</span> <span class="st">"Échantillon"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-Qqplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="06-bivarieeQualiQuanti_files/figure-html/fig-Qqplot-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;6.5: QQ Plot pour les groupes</figcaption></figure>
</div>
</div>
</div>
<p>Pour vérifier l’hypothèse d’homogénéité des variances, vous pouvez utiliser les tests de Levene, de Bartlett ou de Breusch-Pagan. Les valeurs de <em>p</em>, toutes supérieures à 0,05, signalent que la condition d’homogénéité des variances est respectée.</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/rstatix/">"rstatix"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"lmtest"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://r-forge.r-project.org/projects/car/">"car"</a></span><span class="op">)</span></span>
<span><span class="co"># Condition 2 : homogénéité des variances (homocédasticité)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/leveneTest.html">leveneTest</a></span><span class="op">(</span><span class="va">DureeMinute</span> <span class="op">~</span> <span class="va">Mode</span>, data <span class="op">=</span> <span class="va">df_TrajetsDuree</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  2  0.2418 0.7857
      96               </code></pre>
</div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">DureeMinute</span> <span class="op">~</span> <span class="va">Mode</span>, data <span class="op">=</span> <span class="va">df_TrajetsDuree</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  DureeMinute by Mode
Bartlett's K-squared = 2.6718, df = 2, p-value = 0.2629</code></pre>
</div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">DureeMinute</span> <span class="op">~</span> <span class="va">Mode</span>, data <span class="op">=</span> <span class="va">df_TrajetsDuree</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  DureeMinute ~ Mode
BP = 1.3322, df = 2, p-value = 0.5137</code></pre>
</div>
</div>
<p>Deux fonctions peuvent être utilisées pour calculer l’analyse de variance&nbsp;: la fonction de base <code>aov(variable continue ~ variable qualitative, data = votre DataFrame)</code> ou bien la fonction <code>anova_test(variable continue ~ variable qualitative, data = votre DataFrame)</code> du package <code>rstatix</code>. Comparativement à <code>aov</code>, l’avantage de la fonction <code>anova_test</code> est qu’elle calcule aussi le <em>Eta<sup>2</sup></em>.</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/rstatix/">"rstatix"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://r-forge.r-project.org/projects/car/">"car"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://easystats.github.io/effectsize/">"effectsize"</a></span><span class="op">)</span></span>
<span><span class="co"># ANOVA avec la fonction aov</span></span>
<span><span class="va">aov1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">DureeMinute</span> <span class="op">~</span> <span class="va">Mode</span>, data <span class="op">=</span> <span class="va">df_TrajetsDuree</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
Mode         2    287   143.2    0.82  0.444
Residuals   96  16781   174.8               </code></pre>
</div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calcul de Eta2 avec la fonction eta_squared du package effectsize</span></span>
<span><span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/eta_squared.html">eta_squared</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA

Parameter | Eta2 |       95% CI
-------------------------------
Mode      | 0.02 | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ANOVA avec la fonction anova_test du package rstatix</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">anova_test</a></span><span class="op">(</span><span class="va">DureeMinute</span> <span class="op">~</span> <span class="va">Mode</span>, data <span class="op">=</span> <span class="va">df_TrajetsDuree</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type II tests)

  Effect DFn DFd    F     p p&lt;.05   ges
1   Mode   2  96 0.82 0.444       0.017</code></pre>
</div>
</div>
<p>La valeur de <em>p</em> associée à la statistique <em>F</em> (0,444) nous permet de conclure qu’il n’y a pas de différences significatives entre les moyennes des temps de déplacement des trois modes de transport.</p>
</section><section id="sec-06232" class="level4" data-number="6.2.3.2"><h4 data-number="6.2.3.2" class="anchored" data-anchor-id="sec-06232">
<span class="header-section-number">6.2.3.2</span> Deuxième ANOVA&nbsp;: différences entre les niveaux d’exposition au bruit</h4>
<p>Dans ce second exercice, nous analysons les différences d’exposition au bruit. D’emblée, les statistiques descriptives révèlent que les moyennes sont dissemblables&nbsp;: 66,8 dB(A) pour l’automobile versus 68,8 et 74 pour le vélo et le transport en commun. Aussi, la variance du transport en commun est très différente des autres.</p>
<div class="cell">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/rstatix/">"rstatix"</a></span><span class="op">)</span></span>
<span><span class="co"># chargement des DataFrames</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/bivariee/dataPollution.RData"</span><span class="op">)</span></span>
<span><span class="co"># Statistiques descriptives pour les groupes (moyenne et écart-type)</span></span>
<span> <span class="va">df_Bruit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                                 <span class="co"># Nom du DataFrame</span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Mode</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                                <span class="co"># Variable qualitative</span></span>
<span>   <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/get_summary_stats.html">get_summary_stats</a></span><span class="op">(</span><span class="va">laeq</span>, type <span class="op">=</span> <span class="st">"mean_sd"</span><span class="op">)</span>  <span class="co"># Variable continue </span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Mode    variable     n  mean    sd
  &lt;chr&gt;   &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 1. Auto laeq      1094  66.8  4.56
2 2. Velo laeq      1124  68.8  4.29
3 3. TC   laeq      1207  74.0  6.79</code></pre>
</div>
</div>
<p>À la lecture des graphiques de densité et en violon (<a href="#fig-Anova1b">figure&nbsp;<span>6.6</span></a>), il semble clair que les niveaux d’exposition au bruit sont plus faibles pour les automobilistes et plus élevés pour les cyclistes et surtout les personnes en transport en commun. En outre, la distribution des valeurs d’exposition au bruit dans le transport en commun semble bimodale. Cela s’explique par le fait que les niveaux de bruit sont beaucoup plus élevés dans le métro que dans les autobus.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/ggpubr/">"ggpubr"</a></span><span class="op">)</span></span>
<span><span class="co"># Graphique en densité</span></span>
<span><span class="va">GraphDens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_Bruit</span>, </span>
<span>  mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">laeq</span>, colour <span class="op">=</span> <span class="va">Mode</span>, fill <span class="op">=</span> <span class="va">Mode</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.55</span>, mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">..scaled..</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"a. graphique de densité"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Exposition au bruit (dB(A))"</span><span class="op">)</span></span>
<span><span class="co"># Graphique en violon</span></span>
<span><span class="va">GraphViolon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_Bruit</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Mode</span>, y <span class="op">=</span> <span class="va">laeq</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Mode</span>, y <span class="op">=</span> <span class="va">laeq</span>, fill <span class="op">=</span> <span class="va">Mode</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"b. Graphique en violon"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Mode de transport"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Exposition au bruit (dB(A))"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">GraphDens</span>, <span class="va">GraphViolon</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-Anova1b" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="06-bivarieeQualiQuanti_files/figure-html/fig-Anova1b-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;6.6: Graphique de densité et en violon</figcaption></figure>
</div>
</div>
</div>
<p>Le test de Shapiro et les graphiques QQ plot (<a href="#fig-Qqplot2">figure&nbsp;<span>6.7</span></a>) révèlent que les distributions des trois groupes sont anormales. Ce résultat n’est pas surprenant si l’on tient compte de la nature logarithmique de l’échelle décibel.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org">"dplyr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/ggpubr/">"ggpubr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/rstatix/">"rstatix"</a></span><span class="op">)</span></span>
<span><span class="co"># Condition 1 : normalité des échantillons</span></span>
<span><span class="co"># Test pour la normalité des échantillons (groupes) : test de Shapiro</span></span>
<span><span class="va">df_Bruit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>          <span class="co"># Nom du DataFrame</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Mode</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>         <span class="co"># Variable qualitative</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/shapiro_test.html">shapiro_test</a></span><span class="op">(</span><span class="va">laeq</span><span class="op">)</span>  <span class="co"># Variable continue </span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  Mode    variable statistic        p
  &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;
1 1. Auto laeq         0.971 4.92e-14
2 2. Velo laeq         0.992 5.12e- 6
3 3. TC   laeq         0.966 3.34e-16</code></pre>
</div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Graphiques qqplot pour les groupes</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggqqplot.html">ggqqplot</a></span><span class="op">(</span><span class="va">df_Bruit</span>, <span class="st">"laeq"</span>, facet.by <span class="op">=</span> <span class="st">"Mode"</span>, xlab <span class="op">=</span> <span class="st">"Théorique"</span>, ylab <span class="op">=</span> <span class="st">"Échantillon"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-Qqplot2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="06-bivarieeQualiQuanti_files/figure-html/fig-Qqplot2-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;6.7: QQ Plot pour les groupes</figcaption></figure>
</div>
</div>
</div>
<p>En outre, selon les valeurs des tests de Levene, de Bartlett ou de Breusch-Pagan, les variances ne sont pas égales.</p>
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/rstatix/">"rstatix"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"lmtest"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://r-forge.r-project.org/projects/car/">"car"</a></span><span class="op">)</span></span>
<span><span class="co"># Condition 2 : homogénéité des variances (homocédasticité)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/leveneTest.html">leveneTest</a></span><span class="op">(</span><span class="va">laeq</span> <span class="op">~</span> <span class="va">Mode</span>, data <span class="op">=</span> <span class="va">df_Bruit</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
        Df F value    Pr(&gt;F)    
group    2   190.3 &lt; 2.2e-16 ***
      3422                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">laeq</span> <span class="op">~</span> <span class="va">Mode</span>, data <span class="op">=</span> <span class="va">df_Bruit</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  laeq by Mode
Bartlett's K-squared = 306.64, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">laeq</span> <span class="op">~</span> <span class="va">Mode</span>, data <span class="op">=</span> <span class="va">df_Bruit</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  laeq ~ Mode
BP = 279.85, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Étant donné que les deux conditions (normalité et homogénéité des variances) ne sont pas respectées, il est préférable d’utiliser un test non paramétrique de Kruskal-Wallis. Calculons toutefois préalablement l’ANOVA classique et l’ANOVA de Welch puisque les variances ne sont pas égales. Les valeurs de <em>p</em> des deux tests (Fisher et Welch) signalent que les moyennes d’exposition au bruit sont statistiquement différentes entre les trois modes de transport.</p>
<div class="cell">
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/rstatix/">"rstatix"</a></span><span class="op">)</span></span>
<span><span class="co"># ANOVA avec la fonction anova_test du package rstatix</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">anova_test</a></span><span class="op">(</span><span class="va">laeq</span> <span class="op">~</span> <span class="va">Mode</span>, data <span class="op">=</span> <span class="va">df_Bruit</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type II tests)

  Effect DFn  DFd       F         p p&lt;.05   ges
1   Mode   2 3422 544.214 6.12e-206     * 0.241</code></pre>
</div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ANOVA avec le test de Welch puisque les variances ne sont pas égales</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/welch_anova_test.html">welch_anova_test</a></span><span class="op">(</span><span class="va">laeq</span> <span class="op">~</span> <span class="va">Mode</span>, data <span class="op">=</span> <span class="va">df_Bruit</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  .y.       n statistic   DFn   DFd         p method     
* &lt;chr&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      
1 laeq   3425      446.     2 2248. 9.47e-164 Welch ANOVA</code></pre>
</div>
</div>
<p>Une fois démontré que les moyennes sont différentes, le test de Tukey est particulièrement intéressant puisqu’il nous permet de repérer les différences de moyennes significatives deux à deux, tout en ajustant les valeurs de <em>p</em> obtenues en fonction du nombre de comparaisons effectuées. Ci-dessous, nous constatons que toutes les paires sont statistiquement différentes et que la différence de moyennes entre les automobilistes et les cyclistes est de 1,9 dB(A) et surtout de 7,1 dB(A) entre les automobilistes et les personnes ayant pris le transport en commun.</p>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">aov2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">laeq</span> <span class="op">~</span> <span class="va">Mode</span>, data <span class="op">=</span> <span class="va">df_Bruit</span><span class="op">)</span></span>
<span><span class="co"># Test de Tukey pour comparer les moyennes entre elles</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">aov2</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = laeq ~ Mode, data = df_Bruit)

$Mode
                    diff      lwr      upr p adj
2. Velo-1. Auto 1.941698 1.406343 2.477053     0
3. TC-1. Auto   7.113506 6.587309 7.639703     0
3. TC-2. Velo   5.171808 4.649307 5.694309     0</code></pre>
</div>
</div>
<p>Le calcul du test non paramétrique de Kruskal-Wallis avec la fonction <code>kruskal.test</code> démontre aussi que les médianes des groupes sont différentes (<em>p</em> &lt; 0,001). De manière comparable au test de Tukey, la fonction <code>pairwise.wilcox.test</code> permet aussi de repérer les différences significatives entre les paires de groupes. Pour conclure, tant l’ANOVA que le test non paramétrique de Kruskal-Wallis indiquent que les trois modes de transport sont significativement différents quant à l’exposition au bruit, avec des valeurs plus faibles pour les automobilistes comparativement aux cyclistes et aux personnes ayant pris le transport en commun.</p>
<div class="cell">
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Test de Kruskal-Wallis</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span><span class="op">(</span><span class="va">laeq</span> <span class="op">~</span> <span class="va">Mode</span>, data <span class="op">=</span> <span class="va">df_Bruit</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  laeq by Mode
Kruskal-Wallis chi-squared = 784.74, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcul de la moyenne des rangs pour les trois groupes</span></span>
<span><span class="va">df_Bruit</span><span class="op">$</span><span class="va">laeqRank</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">df_Bruit</span><span class="op">$</span><span class="va">laeq</span><span class="op">)</span></span>
<span><span class="va">df_Bruit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Mode</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/get_summary_stats.html">get_summary_stats</a></span><span class="op">(</span><span class="va">laeqRank</span>, type <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  Mode    variable     n  mean
  &lt;chr&gt;   &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt;
1 1. Auto laeqRank  1094 1188.
2 2. Velo laeqRank  1124 1572.
3 3. TC   laeqRank  1207 2320.</code></pre>
</div>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Comparaison des groupes avec la fonction pairwise.wilcox.test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html">pairwise.wilcox.test</a></span><span class="op">(</span><span class="va">df_Bruit</span><span class="op">$</span><span class="va">laeq</span>, <span class="va">df_Bruit</span><span class="op">$</span><span class="va">Mode</span>, p.adjust.method <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum test with continuity correction 

data:  df_Bruit$laeq and df_Bruit$Mode 

        1. Auto 2. Velo
2. Velo &lt;2e-16  -      
3. TC   &lt;2e-16  &lt;2e-16 

P value adjustment method: BH </code></pre>
</div>
</div>
</section></section><section id="sec-0624" class="level3" data-number="6.2.4"><h3 data-number="6.2.4" class="anchored" data-anchor-id="sec-0624">
<span class="header-section-number">6.2.4</span> Comment rapporter les résultats d’une ANOVA et du test de Kruskal-Wallis</h3>
<p>Plusieurs éléments doivent être reportés pour détailler les résultats d’une ANOVA ou d’un test de Kruskal-Wallis&nbsp;: la valeur de <em>F</em>, de <em>W</em> (dans le cas d’une ANOVA de Welch) ou du χ2 (Kruskal-Wallis), les valeurs de <em>p</em>, les moyennes ou médianes respectives des groupes et éventuellement un tableau détaillant les écarts intergroupes obtenus avec les tests de Tukey ou Wilcoxon par paires.</p>
<ul>
<li><p>Les résultats de l’analyse de variance à un facteur démontrent que le mode de transport utilisé n’a pas d’effet significatif sur le temps de déplacement en heures de pointe à Montréal (<em>F</em>(2,96)&nbsp;=&nbsp;0,82, <em>p</em>&nbsp;=&nbsp;0,444). En effet, pour des trajets de dix kilomètres entre un quartier périphérique et le centre-ville, les cyclistes (Moy&nbsp;=&nbsp;38,4, ET&nbsp;=&nbsp;15,2) arrivent en moyenne moins d’une minute après les automobilistes (Moy&nbsp;=&nbsp;37,7, ET&nbsp;=&nbsp;12,8) et moins de quatre minutes comparativement aux personnes ayant pris le transport en commun (Moy&nbsp;=&nbsp;41,6, ET&nbsp;=&nbsp;11,4).</p></li>
<li><p>Les résultats de l’analyse de variance à un facteur démontrent que le mode de transport utilisé a un impact significatif sur le niveau d’exposition en heures de pointe à Montréal (<em>F</em>(2,96)&nbsp;=&nbsp;544, <em>p</em>&nbsp;&lt;&nbsp;0,001 et <em>Welch</em>(2,96)&nbsp;=&nbsp;446, <em>p</em>&nbsp;&lt;&nbsp;0,001). En effet, les personnes en transport en commun (Moy&nbsp;=&nbsp;74,0, ET&nbsp;=&nbsp;6,79) et les cyclistes (Moy&nbsp;=&nbsp;68,8, ET&nbsp;=&nbsp;4,3) ont des niveaux d’exposition au bruit significativement plus élevés que les automobilistes (Moy&nbsp;=&nbsp;66,8, ET&nbsp;=&nbsp;4,56).</p></li>
<li><p>Les résultats du test de Kruskal-Wallis démontrent qu’il existe des différences significatives d’exposition au bruit entre les trois modes de transport (χ2(2)&nbsp;=&nbsp;784,74, <em>p</em>&nbsp;&lt;&nbsp;0,001) avec des moyennes de rangs de 1094 pour l’automobile, de 1124 pour le vélo et de 1207 pour le transport en commun.</p></li>
</ul>
<div class="bloc_aller_loin">
<div class="bloc_aller_loin-header">
<div class="bloc_aller_loin-icon">

</div>
<p><strong>Autres extensions de l’ANOVA</strong></p>
</div>
<div class="bloc_aller_loin-body">
<p>Nous avons vu que l’ANOVA permet de comparer les moyennes d’une variable continue à partir d’une variable qualitative comprenant plusieurs modalités (facteur) pour des observations indépendantes. Il y a donc une seule variable dépendante (continue) et une seule variable indépendante. Sachez qu’il existe de nombreuses extensions de l’ANOVA classique&nbsp;:</p>
<ul>
<li><p><strong>Une ANOVA à deux facteurs</strong>, soit avec une variable dépendante continue et deux variables indépendantes qualitatives (<em>two-way ANOVA</em> en anglais). Nous évaluons ainsi les effets des deux variables (<em>a</em>, <em>b</em>) et de leur interaction (<em>ab</em>) sur une variable continue.</p></li>
<li><p><strong>Une ANOVA multifacteur</strong> avec une variable dépendante continue et plus de deux variables indépendantes qualitatives. Par exemple, avec trois variables qualitatives pour expliquer la variable continue, nous incluons les effets de chaque variable qualitative (<em>a</em>, <em>b</em>, <em>c</em>), ainsi que de leurs interactions (<em>ab</em>, <em>ac</em>, <em>bc</em>, <em>abc</em>).</p></li>
<li><p><strong>L’analyse de covariance</strong> (<strong>ANCOVA</strong>, <em><strong>AN</strong>alysis of <strong>COVA</strong>riance</em> en anglais) comprend une variable dépendante continue, une variable indépendante qualitative (facteur) et plusieurs variables indépendantes continues dites covariables. L’objectif est alors de vérifier si les moyennes d’une variable dépendante sont différentes pour plusieurs groupes d’une population donnée, après avoir contrôlé l’effet d’une ou de plusieurs variables continues. Par exemple, pour une métropole donnée, nous pourrions vouloir comparer les moyennes de loyers entre la ville-centre et ceux des première et seconde couronnes (facteur), une fois contrôlée la taille de ces derniers (variable covariée continue). En effet, une partie de la variance des loyers s’explique certainement par la taille des logements.</p></li>
<li><p><strong>L’analyse de variance multivariée</strong> (<strong>MANOVA</strong>, <em><strong>M</strong>ultivariate <strong>AN</strong>alysis <strong>O</strong>f <strong>VA</strong>riance</em> en anglais) comprend deux variables dépendantes continues ou plus et une variable indépendante qualitative (facteur). Par exemple, nous souhaiterions comparer les moyennes d’exposition au bruit et à différents polluants (dioxyde d’azote, particules fines, ozone) (variables dépendantes continues) selon le mode de transport utilisé (automobile, vélo, transport en commun), soit le facteur.</p></li>
<li><p><strong>L’analyse de covariance multivariée</strong> (<strong>MANCOVA</strong>, <em><strong>M</strong>ultivariate <strong>AN</strong>alysis of <strong>COVA</strong>riance</em> en anglais), soit une analyse qui comprend deux variables dépendantes continues ou plus (comme la MANOVA) et une variable qualitative comme variable indépendante (facteur) et une covariable continue ou plus.</p></li>
</ul>
<p>Pour le test <em>t</em>, nous avons vu qu’il peut s’appliquer soit à deux échantillons indépendants (non appariés), soit à deux échantillons dépendants (appariés). Notez qu’il existe aussi des extensions de l’ANOVA pour des échantillons pairés. Nous parlons alors d’<strong>analyse de variance sur des mesures répétées</strong>. Par exemple, nous pourrions évaluer la perception du sentiment de sécurité relativement à la pratique du vélo d’hiver pour un échantillon de cyclistes ayant décidé de l’adopter récemment, et ce, à plusieurs moments&nbsp;: avant leur première saison, à la fin de leur premier hiver, à la fin de leur second hiver. Autre exemple, nous pourrions sélectionner un échantillon d’individus (100, par exemple) pour lesquels nous évaluerions leurs perceptions de l’environnement sonore dans différents lieux de la ville. Comme pour l’ANOVA classique (échantillons non appariés), il existe des extensions de l’ANOVA sur des mesures répétées permettant d’inclure plusieurs facteurs (groupes de population); nous mesurons alors une variable continue pour plusieurs groupes d’individus à différents moments ou pour des conditions différentes. Il est aussi possible de réaliser une ANOVA pour des mesures répétées avec une ou plusieurs covariables continues.</p>
<p>Bref, si l’ANOVA était un roman, elle serait certainement «&nbsp;un monde sans fin&nbsp;» de Ken Follett! Notez toutefois que la SUPERNOVA, la BOSSA-NOVA et le CASANOVA ne sont pas des variantes de l’ANOVA!</p>
</div>
</div>
</section></section><section id="sec-063" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="sec-063">
<span class="header-section-number">6.3</span> Conclusion sur la troisième partie</h2>
<p>Dans le cadre de cette troisième partie du livre, nous avons abordé les principales méthodes exploratoires et confirmatoires bivariées permettant d’évaluer la relation entre deux variables. La <a href="#fig-PrincipalesAnalysesBivariees">figure&nbsp;<span>6.8</span></a> propose un résumé de ces méthodes.</p>
<div id="fig-PrincipalesAnalysesBivariees" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap06/PrincipalesMethoBivariees.jpg" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;6.8: Principales méthodes bivariées</figcaption></figure>
</div>
</section><section id="sec-064" class="level2" data-number="6.4"><h2 data-number="6.4" class="anchored" data-anchor-id="sec-064">
<span class="header-section-number">6.4</span> Quiz de révision du chapitre</h2>
<div id="Chapitre6_QualiQuanti" class="card">
<link type="text/javascript" src="libs/quizlib.1.0.1.min.js">
<script>var Quiz=function(a,b){this.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),this.unansweredQuestionText="Question sans réponse !",this.container=document.getElementById(a),this.questions=[],this.result=new QuizResult,this.answers=b;for(var c=0;c<this.container.children.length;c++)this.container.children[c].classList.contains(Quiz.Classes.QUESTION)&&this.questions.push(this.container.children[c]);if(this.answers.length!=this.questions.length)throw new Error("Number of answers does not match number of questions!")};Quiz.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),Quiz.prototype.checkAnswers=function(a){void 0===a&&(a=!0);for(var b=[],c=[],d=0;d<this.questions.length;d++){var e=this.questions[d],f=this.answers[d],g=[];this.clearHighlights(e);for(var h,i=e.getElementsByClassName(Quiz.Classes.QUESTION_ANSWERS)[0].getElementsByTagName("input"),j=0;j<i.length;j++)h=i[j],"checkbox"===h.type||"radio"===h.type?h.checked&&g.push(h.value):""!==h.value&&g.push(h.value);1!=g.length||Array.isArray(f)?0===g.length&&b.push(e):g=g[0],c.push(Utils.compare(g,f))}if(0===b.length||!a)return this.result.setResults(c),!0;for(d=0;d<b.length;d++){var k=document.createElement("span");k.appendChild(document.createTextNode(this.unansweredQuestionText)),k.className=Quiz.Classes.QUESTION_WARNING,b[d].getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].appendChild(k)}return!1},Quiz.prototype.clearHighlights=function(a){for(var b=a.getElementsByClassName(Quiz.Classes.QUESTION_WARNING);b.length>0;)b[0].parentNode.removeChild(b[0]);var c,d=[a.getElementsByClassName(Quiz.Classes.CORRECT),a.getElementsByClassName(this.Classes.INCORRECT)];for(i=0;i<d.length;i++)for(;d[i].length>0;)c=d[i][0],c.classList.remove(Quiz.Classes.CORRECT),c.classList.remove(Quiz.Classes.INCORRECT);for(var e=a.getElementsByClassName(Quiz.Classes.TEMP);e.length>0;)e[0].parentNode.removeChild(e[0])},Quiz.prototype.highlightResults=function(a){for(var b,c=0;c<this.questions.length;c++)b=this.questions[c],b.getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].classList.add(this.result.results[c]?Quiz.Classes.CORRECT:Quiz.Classes.INCORRECT),void 0!==a&&a(this,b,c,this.result.results[c])};var QuizResult=function(){this.results=[],this.totalQuestions=0,this.score=0,this.scorePercent=0,this.scorePercentFormatted=0};QuizResult.prototype.setResults=function(a){this.results=a,this.totalQuestions=this.results.length,this.score=0;for(var b=0;b<this.results.length;b++)this.results[b]&&this.score++;this.scorePercent=this.score/this.totalQuestions,this.scorePercentFormatted=Math.floor(100*this.scorePercent)};var Utils=function(){};Utils.compare=function(a,b){if(a.length!=b.length)return!1;if(Array.isArray(a)&&Array.isArray(b)){for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b};

function showResults(quiz) {
    // Check answers and continue if all questions have been answered
    if (quiz.checkAnswers()) {
        var quizScorePercent = quiz.result.scorePercentFormatted; // The unformatted percentage is a decimal in range 0 - 1
        var quizResultElement = document.getElementById('quiz-result');
        quizResultElement.style.display = 'block';
        document.getElementById('quiz-percent').innerHTML = quizScorePercent.toString();

        // Change background colour of results div according to score percent
        if (quizScorePercent > 75) quizResultElement.style.backgroundColor = '#4caf50';
        else if (quizScorePercent > 50) quizResultElement.style.backgroundColor = '#ffc107';
        else if (quizScorePercent > 25) quizResultElement.style.backgroundColor = '#ff9800';
        else if (quizScorePercent > 0) quizResultElement.style.backgroundColor = '#f44336';

        // Highlight questions according to whether they were correctly answered. The callback allows us to highlight/show the correct answer
        quiz.highlightResults(handleAnswers);
    }
}

/** Callback for Quiz.highlightResults. Highlights the correct answers of incorrectly answered questions
 * Parameters are: the quiz object, the question element, question number, correctly answered flag
 */
function handleAnswers(quiz, question, no, correct) {
    if (!correct) {
        var answers = question.getElementsByTagName('input');
        for (var i = 0; i < answers.length; i++) {
            if (answers[i].type === 'checkbox' || answers[i].type === 'radio'){
                // If the current input element is part of the correct answer, highlight it
                if (quiz.answers[no].indexOf(answers[i].value) > -1) {
                    answers[i].parentNode.classList.add(Quiz.Classes.CORRECT);
                }
            } else {
                // If the input is anything other than a checkbox or radio button, show the correct answer next to the element
                var correctAnswer = document.createElement('span');
                correctAnswer.classList.add(Quiz.Classes.CORRECT);
                correctAnswer.classList.add(Quiz.Classes.TEMP); // quiz.checkAnswers will automatically remove elements with the temp class
                correctAnswer.innerHTML = quiz.answers[no];
                correctAnswer.style.marginLeft = '10px';
                answers[i].parentNode.insertBefore(correctAnswer, answers[i].nextSibling);
            }
        }
    }
}

  var quizz_Chapitre6_QualiQuanti;
  window.onload = function() {
    quizz_Chapitre6_QualiQuanti = new Quiz('Chapitre6_QualiQuanti', ['1','4','1','2','1','2',['1', '2', '3'],'1',['1', '2', '3'],['1', '2', '3', '4', '5']]);
  };</script><link rel="stylesheet" type="text/css" src="css/quizlib.min.css">
<div class="card quizlib-question">
<div class="quizlib-question-title">
Comment comparer les moyennes de deux groupes?
</div>
<div>
Relisez au besoin la <a href="#sec-0611">section&nbsp;<span>6.1.1</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>t de Student (test t)</label>
</td>
<td>
<input type="radio" name="q1" value="1">
</td>
</tr>
<tr>
<td>
<label>Analyse de variance (ANOVA)</label>
</td>
<td>
<input type="radio" name="q1" value="2">
</td>
</tr>
<tr>
<td>
<label>Covariance et corrélation</label>
</td>
<td>
<input type="radio" name="q1" value="3">
</td>
</tr>
<tr>
<td>
<label>Test de Kruskal-Wallis</label>
</td>
<td>
<input type="radio" name="q1" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Comment comparer les médianes de plus de deux groupes?
</div>
<div>
Relisez au besoin la <a href="#sec-0612">section&nbsp;<span>6.1.2</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>t de Student (test t)</label>
</td>
<td>
<input type="radio" name="q2" value="1">
</td>
</tr>
<tr>
<td>
<label>Analyse de variance (ANOVA)</label>
</td>
<td>
<input type="radio" name="q2" value="2">
</td>
</tr>
<tr>
<td>
<label>Test de Kruskal-Wallis</label>
</td>
<td>
<input type="radio" name="q2" value="3">
</td>
</tr>
<tr>
<td>
<label>Test de Wilcoxon</label>
</td>
<td>
<input type="radio" name="q2" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Les observations de deux groupes qui n’ont aucun lien entre eux; les tailles des deux échantillons peuvent être différentes. Cette affirmation s’applique à des
</div>
<div>
Relisez au besoin le début de la <a href="#sec-0611">section&nbsp;<span>6.1.1</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>échantillons indépendants (dits non appariés)</label>
</td>
<td>
<input type="radio" name="q3" value="1">
</td>
</tr>
<tr>
<td>
<label>échantillons dépendants (dits appariés)</label>
</td>
<td>
<input type="radio" name="q3" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Lorsque les variances des deux groupes sont dissemblables, quel test utilisez-vous?
</div>
<div>
Relisez au besoin la <a href="#sec-0611">section&nbsp;<span>6.1.1</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Test de Student (test t)</label>
</td>
<td>
<input type="radio" name="q4" value="1">
</td>
</tr>
<tr>
<td>
<label>Test de Welch (appelé aussi Satterthwaite)</label>
</td>
<td>
<input type="radio" name="q4" value="2">
</td>
</tr>
<tr>
<td>
<label>Analyse de variance (ANOVA)</label>
</td>
<td>
<input type="radio" name="q4" value="3">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Ces boîtes à moustaches s’appliquent à des :
</div>
<img src="images/quiz/Quiz_Chap06_Question_05.jpg" alt="" style="width: 50%;display: block;margin-left: auto;margin-right: auto;margin-bottom: 0.5em;margin-top: 0.5em;"><div>
Relisez au besoin la <a href="#sec-06111">section&nbsp;<span>6.1.1.1</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>échantillons dépendants (dits appariés)</label>
</td>
<td>
<input type="radio" name="q5" value="1">
</td>
</tr>
<tr>
<td>
<label>échantillons indépendants (dits non appariés)</label>
</td>
<td>
<input type="radio" name="q5" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Plus la variance intergroupe (dissimilarité des groupes) est maximisée et corollairement plus la variance intragroupe (homogénéité de chacun des groupes) est minimisée, plus les groupes sont clairement distincts et plus l’ANOVA est performante. Selon vous, à la lecture de ces graphiques, l’ANOVA risque-t-elle d’être très performante?
</div>
<img src="images/quiz/Quiz_Chap06_Question_06.jpg" alt="" style="width: 50%;display: block;margin-left: auto;margin-right: auto;margin-bottom: 0.5em;margin-top: 0.5em;"><div>
Relisez au besoin la <a href="#sec-06211">section&nbsp;<span>6.2.1.1</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Oui</label>
</td>
<td>
<input type="radio" name="q6" value="1">
</td>
</tr>
<tr>
<td>
<label>Non</label>
</td>
<td>
<input type="radio" name="q6" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quelles sont les trois conditions d’application de l’ANOVA?
</div>
<div>
Relisez au besoin la <a href="#sec-06213">section&nbsp;<span>6.2.1.3</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Normalité des groupes</label>
</td>
<td>
<input type="checkbox" name="q7" value="1">
</td>
</tr>
<tr>
<td>
<label>Homogénéité des variances des groupes (homoscédasticité)</label>
</td>
<td>
<input type="checkbox" name="q7" value="2">
</td>
</tr>
<tr>
<td>
<label>Indépendance des observations (pseudo-réplication)</label>
</td>
<td>
<input type="checkbox" name="q7" value="3">
</td>
</tr>
<tr>
<td>
<label>Il faut deux groupes</label>
</td>
<td>
<input type="checkbox" name="q7" value="4">
</td>
</tr>
<tr>
<td>
<label>Les groupes doivent être de taille égale</label>
</td>
<td>
<input type="checkbox" name="q7" value="5">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Le test non paramétrique de Kruskal-Wallis permet de comparer les médianes de plus de deux groupes.
</div>
<div>
Relisez au besoin la <a href="#sec-0622">section&nbsp;<span>6.2.2</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Vrai</label>
</td>
<td>
<input type="radio" name="q8" value="1">
</td>
</tr>
<tr>
<td>
<label>Faux</label>
</td>
<td>
<input type="radio" name="q8" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Sur quelle(s) variances est basée l’ANOVA?
</div>
<div>
Relire le deuxième encadré à la <a href="#sec-06211">section&nbsp;<span>6.2.1.1</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>La variance totale</label>
</td>
<td>
<input type="checkbox" name="q9" value="1">
</td>
</tr>
<tr>
<td>
<label>La variance intragroupe</label>
</td>
<td>
<input type="checkbox" name="q9" value="2">
</td>
</tr>
<tr>
<td>
<label>La variance intergroupe</label>
</td>
<td>
<input type="checkbox" name="q9" value="3">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quelles sont les variantes de l’ANOVA?
</div>
<div>
Relire le deuxième encadré à la <a href="#sec-0624">section&nbsp;<span>6.2.4</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Une ANOVA à deux facteurs</label>
</td>
<td>
<input type="checkbox" name="q10" value="1">
</td>
</tr>
<tr>
<td>
<label>Une ANOVA multifacteur</label>
</td>
<td>
<input type="checkbox" name="q10" value="2">
</td>
</tr>
<tr>
<td>
<label>L’analyse de covariance (ANCOVA)</label>
</td>
<td>
<input type="checkbox" name="q10" value="3">
</td>
</tr>
<tr>
<td>
<label>L’analyse de variance multivariée (MANOVA)</label>
</td>
<td>
<input type="checkbox" name="q10" value="4">
</td>
</tr>
<tr>
<td>
<label>L’analyse de covariance multivariée (MANCOVA)</label>
</td>
<td>
<input type="checkbox" name="q10" value="5">
</td>
</tr>
<tr>
<td>
<label>La SUPERNOVA</label>
</td>
<td>
<input type="checkbox" name="q10" value="6">
</td>
</tr>
<tr>
<td>
<label>La BOSSANOVA</label>
</td>
<td>
<input type="checkbox" name="q10" value="7">
</td>
</tr>
<tr>
<td>
<label>Le CASANOVA</label>
</td>
<td>
<input type="checkbox" name="q10" value="8">
</td>
</tr>
</tbody></table>
</div>
</div>
<button type="button" onclick="showResults(quizz_Chapitre6_QualiQuanti);" id="buttonID">
Vérifier votre résultat
</button>
<div id="quiz-result" class="card">
<p><span id="quiz-percent"></span></p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-2018_1" class="csl-entry" role="listitem">
Apparicio, Philippe, Jérémy Gelb, Mathieu Carrier, Marie-Ève Mathieu et Simon Kingham. 2018. <span>«&nbsp;Exposure to noise and air pollution by mode of transportation during rush hours in Montreal.&nbsp;»</span> <em>Journal of Transport Geography</em> 70: 182‑192. <a href="https://doi.org/10.1016/j.jtrangeo.2018.06.007">https://doi.org/10.1016/j.jtrangeo.2018.06.007</a>.
</div>
<div id="ref-carrier2014" class="csl-entry" role="listitem">
Carrier, Mathieu, Philippe Apparicio, Anne-Marie Séguin et Dan Crouse. 2014. <span>«&nbsp;Ambient air pollution concentration in Montreal and environmental equity: Are children at risk at school?&nbsp;»</span> <em>Case Studies on Transport Policy</em> 2 (2): 61‑69. <a href="https://doi.org/10.1016/j.cstp.2014.06.003">https://doi.org/10.1016/j.cstp.2014.06.003</a>.
</div>
<div id="ref-cohen1992" class="csl-entry" role="listitem">
Cohen, Jacob. 1992. <span>«&nbsp;A power primer.&nbsp;»</span> <em>Psychological bulletin</em> 112 (1): 155‑159. <a href="https://doi.org/10.1037/0033-2909.112.1.155">https://doi.org/10.1037/0033-2909.112.1.155</a>.
</div>
<div id="ref-cohen2013" class="csl-entry" role="listitem">
———. 2013. <em>Statistical power analysis for the behavioral sciences</em>. Academic press.
</div>
<div id="ref-glass1972consequences" class="csl-entry" role="listitem">
Glass, Gene V, Percy D Peckham et James R Sanders. 1972. <span>«&nbsp;Consequences of failure to meet assumptions underlying the fixed effects analyses of variance and covariance.&nbsp;»</span> <em>Review of educational research</em> 42 (3): 237‑288.
</div>
<div id="ref-lix1996consequences" class="csl-entry" role="listitem">
Lix, Lisa M, Joanne C Keselman et HJ Keselman. 1996. <span>«&nbsp;Consequences of assumption violations revisited: A quantitative review of alternatives to the one-way analysis of variance F test.&nbsp;»</span> <em>Review of educational research</em> 66 (4): 579‑619. <a href="https://doi.org/10.3102/00346543066004579">https://doi.org/10.3102/00346543066004579</a>.
</div>
<div id="ref-sawilowsky2009" class="csl-entry" role="listitem">
Sawilowsky, Shlomo S. 2009. <span>«&nbsp;New effect size rules of thumb.&nbsp;»</span> <em>Journal of Modern Applied Statistical Methods</em> 8 (2): 467‑474. <a href="https://doi.org/10.22237/jmasm/1257035100">https://doi.org/10.22237/jmasm/1257035100</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./05-bivarieeQualiQuali.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Relation entre deux variables qualitatives</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./07-regressionlineaire.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Régression linéaire multiple</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Méthodes quantitatives en sciences sociales : un grand bol d’R.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Ce livre a été réalisé avec <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>