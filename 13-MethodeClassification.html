<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Méthodes quantitatives en sciences sociales : un grand bol d’R - 13&nbsp; Méthodes de classification non supervisée</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./14-Annexes.html" rel="next">
<link href="./12-AnalysesFactorielles.html" rel="prev">
<link href="./images/introduction/Couverture.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer"
  }
}</script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="css/quizlib.min.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./13-MethodeClassification.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Méthodes de classification non supervisée</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Recherche" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/SerieBoldR/MethodesQuantitatives" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Préface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-auteurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">À propos des auteurs</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 1. Découverte de R</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-priseenmainR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prise en main de R</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 2. Analyses univariées et représentations graphiques</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-univarie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistiques descriptives univariées</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-magiedesgraphiques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Magie des graphiques</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 3. Analyses bivariées</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-bivarieeQuantiQuanti.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Relation linéaire entre deux variables quantitatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-bivarieeQualiQuali.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Relation entre deux variables qualitatives</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-bivarieeQualiQuanti.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Relation entre une variable qualitative et une variable quantitative</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 4. Modèles de régression</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-regressionlineaire.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Régression linéaire multiple</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-GLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Régressions linéaires généralisées (GLM)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-GLMM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Régressions à effets mixtes (GLMM)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Multiniveau.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Régressions multiniveaux</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-GAM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modèles généralisés additifs</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 5. Analyses exploratoires multivariées</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-AnalysesFactorielles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Méthodes factorielles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-MethodeClassification.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Méthodes de classification non supervisée</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 6. Annexes et bibliographie</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-Annexes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Annexes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliographie</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table des matières</h2>
   
  <ul>
<li><a href="#sec-131" id="toc-sec-131" class="nav-link active" data-scroll-target="#sec-131"><span class="header-section-number">13.1</span> Méthodes de classification : un aperçu</a></li>
  <li>
<a href="#sec-132" id="toc-sec-132" class="nav-link" data-scroll-target="#sec-132"><span class="header-section-number">13.2</span> Notions essentielles en classification</a>
  <ul class="collapse">
<li><a href="#sec-1321" id="toc-sec-1321" class="nav-link" data-scroll-target="#sec-1321"><span class="header-section-number">13.2.1</span> Distance</a></li>
  <li><a href="#sec-1322" id="toc-sec-1322" class="nav-link" data-scroll-target="#sec-1322"><span class="header-section-number">13.2.2</span> Inertie</a></li>
  </ul>
</li>
  <li>
<a href="#sec-133" id="toc-sec-133" class="nav-link" data-scroll-target="#sec-133"><span class="header-section-number">13.3</span> Classification ascendante hiérarchique</a>
  <ul class="collapse">
<li><a href="#sec-1331" id="toc-sec-1331" class="nav-link" data-scroll-target="#sec-1331"><span class="header-section-number">13.3.1</span> Fonctionnement de l’algorithme</a></li>
  <li><a href="#sec-1332" id="toc-sec-1332" class="nav-link" data-scroll-target="#sec-1332"><span class="header-section-number">13.3.2</span> Choisir le bon nombre de groupes</a></li>
  <li><a href="#sec-1333" id="toc-sec-1333" class="nav-link" data-scroll-target="#sec-1333"><span class="header-section-number">13.3.3</span> Limites de la classification ascendante hiérarchique</a></li>
  <li><a href="#sec-1334" id="toc-sec-1334" class="nav-link" data-scroll-target="#sec-1334"><span class="header-section-number">13.3.4</span> Mise en œuvre dans R</a></li>
  </ul>
</li>
  <li>
<a href="#sec-134" id="toc-sec-134" class="nav-link" data-scroll-target="#sec-134"><span class="header-section-number">13.4</span> Nuées dynamiques</a>
  <ul class="collapse">
<li><a href="#sec-1341" id="toc-sec-1341" class="nav-link" data-scroll-target="#sec-1341"><span class="header-section-number">13.4.1</span> <em>K-means</em></a></li>
  <li><a href="#sec-1342" id="toc-sec-1342" class="nav-link" data-scroll-target="#sec-1342"><span class="header-section-number">13.4.2</span> K-médianes</a></li>
  <li><a href="#sec-1343" id="toc-sec-1343" class="nav-link" data-scroll-target="#sec-1343"><span class="header-section-number">13.4.3</span> K-médoïds</a></li>
  <li><a href="#sec-1344" id="toc-sec-1344" class="nav-link" data-scroll-target="#sec-1344"><span class="header-section-number">13.4.4</span> Mise en œuvre dans R</a></li>
  <li><a href="#sec-1346" id="toc-sec-1346" class="nav-link" data-scroll-target="#sec-1346"><span class="header-section-number">13.4.5</span> Extensions en logique floue : <em>c-means</em>, <em>c-medoids</em></a></li>
  </ul>
</li>
  <li><a href="#sec-135" id="toc-sec-135" class="nav-link" data-scroll-target="#sec-135"><span class="header-section-number">13.5</span> Conclusion sur la cinquième partie</a></li>
  <li><a href="#sec-136" id="toc-sec-136" class="nav-link" data-scroll-target="#sec-136"><span class="header-section-number">13.6</span> Quiz de révision du chapitre</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/SerieBoldR/MethodesQuantitatives/issues/new" class="toc-action">Signaler un problème ou<br>formuler une suggestion</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-chap13" class="quarto-section-identifier"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Méthodes de classification non supervisée</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Dans le cadre de ce chapitre, nous présentons les méthodes les plus utilisées en sciences sociales pour explorer la présence de groupes homogènes au sein d’un jeu de données, soit les méthodes de classification non supervisée. Le qualificatif <em>non supervisé</em> signifie que ces classes/groupes ne sont pas connus a priori et doivent être identifiés à partir des données. Autrement dit, nous cherchons à regrouper les observations partageant des caractéristiques similaires sur la base de plusieurs variables. Ces méthodes descriptives et exploratoires multivariées peuvent être vues comme une façon de réduire le nombre d’observations d’un jeu de données à un ensemble d’observations synthétiques, représentant le mieux possible la population à l’étude.</p>
<div class="bloc_package">
<div class="bloc_package-header">
<div class="bloc_package-icon">

</div>
<p><strong>Liste des <em>packages</em> utilisés dans ce chapitre</strong></p>
</div>
<div class="bloc_package-body">
<ul>
<li>Pour créer des graphiques&nbsp;:
<ul>
<li>
<code>ggplot2</code> le seul, l’unique!</li>
<li>
<code>ggpubr</code> pour combiner des graphiques et réaliser des diagrammes.</li>
</ul>
</li>
<li>Outils généraux pour faciliter les classifications&nbsp;:
<ul>
<li>
<code>clusterCrit</code> pour calculer des indicateurs de qualité de classification.</li>
<li>
<code>NbClust</code> pour trouver le bon nombre de groupe dans une classification.</li>
<li>
<code>cluster</code> pour appliquer la méthode GAP.</li>
<li>
<code>proxy</code> pour calculer plusieurs types de distances.</li>
<li>
<code>Gmedian</code> pour calculer le k-médianes.</li>
<li>
<code>geocmeans</code> pour explorer les résultats de classifications floues.</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="bloc_objectif">
<div class="bloc_objectif-header">
<div class="bloc_objectif-icon">

</div>
<p><strong>Pourquoi recourir à des méthodes de classification non supervisée en sciences sociales?</strong></p>
</div>
<div class="bloc_objectif-body">
<p>Les méthodes de classification sont très utilisées en sciences sociales. Elles visent à identifier des groupes cohérents au sein d’un ensemble d’observations sur la base de plusieurs variables (<a href="#fig-ClassifNonNSuperv">figure&nbsp;<span class="quarto-unresolved-ref">fig-ClassifNonNSuperv</span></a>). Ces groupes peuvent ensuite être analysés et nous renseigner sur les caractéristiques communes partagées par les individus qui les composent.</p>
<div id="fig-ClassifNonNSuperv" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap13/ClassifNonNSuperv.png" class="img-fluid figure-img" style="width:40.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.1: Principe de base des méthodes de classification non supervisée</figcaption></figure>
</div>
<p>Un exemple classique est l’identification de profils d’individus ayant répondu à un sondage, en fonction de plusieurs caractéristiques (par exemple, l’âge, le sexe, la situation de famille, le revenu, etc.). En identifiant ces groupes homogènes, il est ensuite possible d’explorer les associations entre ces profils et d’autres variables.</p>
<p>Un second exemple serait de regrouper les secteurs d’une ville selon leurs caractéristiques environnementales (végétation, niveau de bruit, pollution atmosphérique, etc.) et socioéconomiques (revenu médian des ménages, pourcentage d’immigrants, pourcentage de personnes à faible scolarité, taux de chômage, etc.).</p>
</div>
</div>
<section id="sec-131" class="level2" data-number="13.1"><h2 data-number="13.1" class="anchored" data-anchor-id="sec-131">
<span class="header-section-number">13.1</span> Méthodes de classification : un aperçu</h2>
<p>Il existe une multitude de méthodes de classification généralement regroupées dans plusieurs familles imbriquées à partir de deux distinctions importantes.</p>
<p>La première distinction vise à séparer les méthodes <strong>supervisées</strong> des <strong>non supervisées</strong>. Pour les premières, les catégories/groupes/classes des observations sont connues à l’avance. L’enjeu n’est pas de trouver les catégories puisqu’elles sont connues, mais <strong>de déterminer des règles ou un modèle permettant d’attribuer des observations à ces catégories</strong>. Parmi les méthodes de classification supervisée, les plus connues sont les forêts d’arbres décisionnels, les réseaux de neurones artificiels ou encore l’analyse factorielle discriminante. Nous n’abordons pas ces méthodes dans ce chapitre dédié uniquement aux méthodes de classification non supervisée. Pour ces dernières, les catégories ne sont pas connues à l’avance et l’enjeu est de <strong>faire ressortir les structures des groupes propres aux données</strong>. Ainsi, les méthodes de classification non supervisée «&nbsp;relèvent de la statistique exploratoire multidimensionnelle et permettent de classifier automatiquement les observations sans connaissance a priori sur la nature des classes présentes dans le jeu de données; les plus connues sont sans conteste les algorithmes de classification ascendante hiérarchique (CAH) et du <em>k-means</em> (k-moyennes)&nbsp;» <span class="citation" data-cites="2021_4">(<a href="#ref-2021_4" role="doc-biblioref">Gelb et Apparicio 2021, 1</a>)</span>. Notez également qu’à la frontière entre ces deux familles, se situent les méthodes de classification semi-supervisée. Il s’agit de cas spécifiques où des informations partielles sont connues sur les groupes à détecter&nbsp;: seulement le groupe final de certaines observations est connu, certaines observations sont supposées appartenir à un même groupe même s’il est indéfini en lui-même <span class="citation" data-cites="bair2013semi">(<a href="#ref-bair2013semi" role="doc-biblioref">Bair 2013</a>)</span>.</p>
<p>La seconde distinction vise à séparer les méthodes <strong>strictes</strong> des <strong>floues</strong>. Les premières ont pour objectif d’assigner chaque observation à une et une seule catégorie, alors que les secondes décrivent le degré d’appartenance de chaque observation à chaque catégorie. Autrement dit, «&nbsp;dans une classification stricte, chaque observation appartient à une seule classe. Mathématiquement parlant, l’appartenance à une classe donnée est binaire (0 ou 1) tandis que dans une classification floue, chaque observation a une probabilité d’appartenance variant de 0 à 1 à chacune des classes&nbsp;» <span class="citation" data-cites="2021_4">(<a href="#ref-2021_4" role="doc-biblioref">Gelb et Apparicio 2021, 1</a>)</span>. Bien entendu, pour chaque observation, la somme des degrés d’appartenance à chacune des classes est égale à 1 (<a href="#fig-floueVSstrict">figure&nbsp;<span class="quarto-unresolved-ref">fig-floueVSstrict</span></a>). En termes de données, cela signifie que pour les méthodes strictes, le groupe d’appartenance d’une observation est contenu dans une seule variable nominale (une colonne d’un <em>DataFrame</em>). Pour les méthodes floues, il est nécessaire de disposer d’autant de variables continues (plusieurs colonnes numériques d’un <em>DataFrame</em>), soit une par groupe, dans lesquelles sont enregistrées le degré d’appartenance de chaque observation à chacun des groupes. Parmi les méthodes de classification supervisée floue, notez que nous avons déjà abordé la régression logistique multinomiale dans le chapitre sur les GLM (<a href="#sec-0824">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-0824</span></a>).</p>
<div id="fig-floueVSstrict" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap13/floueVSstricte.png" class="img-fluid figure-img" style="width:35.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.2: Classifications stricte et floue</figcaption></figure>
</div>
<p>En résumé, le croisement de ces deux distinctions permet ainsi de différencier les méthodes <strong>supervisées strictes</strong>, <strong>supervisées floues</strong>, <strong>non supervisées strictes</strong> et <strong>non supervisées floues</strong> (<a href="#fig-methoClassif">figure&nbsp;<span class="quarto-unresolved-ref">fig-methoClassif</span></a>), auxquelles s’ajoutent les méthodes semi-supervisées discutées brièvement.</p>
<div id="fig-methoClassif" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap13/syntheseClassif.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.3: Synthèse des principales méthodes de classification (Gelb et Apparicio 2021)</figcaption></figure>
</div>
<p>Dans ce chapitre, nous décrivons les trois méthodes de classification non supervisée les plus utilisées et faciles à mettre en œuvre&nbsp;: la classification ascendante hiérarchique, les nuées dynamiques strictes (<em>k-means</em> et <em>k-medians</em>) et nuées dynamiques floues (<em>c-means</em> et <em>c-medians</em>).</p>
</section><section id="sec-132" class="level2" data-number="13.2"><h2 data-number="13.2" class="anchored" data-anchor-id="sec-132">
<span class="header-section-number">13.2</span> Notions essentielles en classification</h2>
<p>Avant de décrire différentes méthodes de classification non supervisées, il convient de définir deux notions centrales, soit la <strong>distance</strong> et l’<strong>inertie</strong>.</p>
<section id="sec-1321" class="level3" data-number="13.2.1"><h3 data-number="13.2.1" class="anchored" data-anchor-id="sec-1321">
<span class="header-section-number">13.2.1</span> Distance</h3>
<p>La distance en analyse de données est définie comme une fonction (<em>d</em>) permettant de déterminer à quel point deux observations sont semblables ou différentes l’une de l’autre. Elle doit respecter les conditions suivantes&nbsp;:</p>
<ul>
<li><p><strong>la non-négativité</strong>&nbsp;: la distance minimale entre deux objets est égale à 0; <span class="math inline">\(d(x,y) \geq 0\)</span>.</p></li>
<li><p><strong>le principe d’identité des indiscernables</strong>&nbsp;: la distance entre deux objets <span class="math inline">\(x\)</span> et <span class="math inline">\(y\)</span> est égale à 0, si <span class="math inline">\(x = y\)</span>; <span class="math inline">\(d(x,y)=0\text{ si et seulement si }x=y\)</span>.</p></li>
<li><p><strong>la symétrie</strong>&nbsp;: la distance entre <span class="math inline">\(x\)</span> et <span class="math inline">\(y\)</span> est la même qu’entre <span class="math inline">\(y\)</span> et <span class="math inline">\(x\)</span>; <span class="math inline">\(d(x,y) = d(y,x)\)</span>.</p></li>
<li><p><strong>le triangle d’inégalité</strong>&nbsp;: passer d’un point <span class="math inline">\(x\)</span> à un point <span class="math inline">\(z\)</span> est toujours plus court ou égal que de passer par <span class="math inline">\(y\)</span> entre <span class="math inline">\(x\)</span> et <span class="math inline">\(z\)</span>; <span class="math inline">\(d(x,z)\leq d(x,y)+d(y,z)\)</span>.</p></li>
</ul>
<p>Il existe un grand nombre de types de distance qui peuvent être utilisés pour déterminer le degré de similarité entre les observations. Nous présentons ici les six types les plus fréquemment utilisés en sciences sociales, mais retenez qu’il en existe bien d’autres.</p>
<section id="sec-13211" class="level4" data-number="13.2.1.1"><h4 data-number="13.2.1.1" class="anchored" data-anchor-id="sec-13211">
<span class="header-section-number">13.2.1.1</span> Distance euclidienne</h4>
<p>Il s’agit vraisemblablement de la distance la plus couramment utilisée, soit la longueur de la ligne droite la plus courte entre les deux objets considérés. Pour la représenter, admettons que nous nous intéressons à trois classes d’étudiants et d’étudiantes A, B et C pour lesquelles nous avons calculé la moyenne de leurs notes dans les cours de méthodes quantitatives et qualitatives. Ces deux variables sont mesurées dans la même unité et varient de 0 à 100. Le nuage de points à la <a href="#fig-dist0">figure&nbsp;<span class="quarto-unresolved-ref">fig-dist0</span></a> illustre cette situation avec des données fictives.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-dist0" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-dist0-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.4: Situation de base pour le calcul de distance</figcaption></figure>
</div>
</div>
</div>
<p>Les distances euclidiennes entre les classes B et C et les classes C et A sont représentées par les lignes noires à la <a href="#fig-dist1">figure&nbsp;<span class="quarto-unresolved-ref">fig-dist1</span></a>. Nous pouvons constater que la distance entre les classes C et B est plus petite que celle entre les classes A et C, ce qui signale que les deux premières se ressemblent davantage.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-dist1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-dist1-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.5: Représentation de la distance euclidienne</figcaption></figure>
</div>
</div>
</div>
<p>La formule de la distance euclidienne (<a href="#eq-euclideandist">équation&nbsp;<span class="quarto-unresolved-ref">eq-euclideandist</span></a>) est simplement la racine carrée de la somme des écarts au carré pour chacune des variables décrivant les observations <em>a</em> et <em>b</em>.</p>
<p><span id="eq-euclideandist"><span class="math display">\[
d(a,b) = \sqrt{\sum{}^v_{i=1}(a_i-b_i)^2}
\tag{13.1}\]</span></span></p>
<p>avec <em>v</em> le nombre de variables décrivant les observations <em>a</em> et <em>b</em>.</p>
<p>Nous pouvons facilement calculer la distance euclidienne pour notre jeu de données&nbsp;:</p>
<ul>
<li><span class="math inline">\(d(A,B)=\sqrt{(\mbox{85}-\mbox{80})^2+(\mbox{80}-\mbox{77})^2} = \mbox{5,83}\)</span></li>
<li><span class="math inline">\(d(B, c)=\sqrt{(\mbox{80}-\mbox{83})^2+(\mbox{79}-\mbox{77})^2} = \mbox{3,60}\)</span></li>
</ul>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Distance et unité de mesure&nbsp;</strong></p>
</div>
<div class="bloc_attention-body">
<p>Il est très important de garder à l’esprit que la distance entre deux observations dépend directement des unités de mesure utilisées. Cela est très souvent problématique, car il est rare que toutes les variables utilisées pour décrire des observations soient mesurées dans la même unité. Ainsi, une variable dont les valeurs numériques sont plus grandes risque de déséquilibrer les calculs de distance. À titre d’exemple, une variable mesurée en mètres plutôt qu’en kilomètres produit des distances euclidiennes 1000 fois plus grandes.</p>
<p>Il est donc nécessaire de standardiser les variables utilisées avant de calculer des distances. Cette opération permet de transformer les variables originales vers une échelle commune. Plusieurs types de transformations peuvent être utilisés tels que décrits à la <a href="#sec-02552">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-02552</span></a>&nbsp;:</p>
<ul>
<li><p><strong>Le centrage et la réduction</strong> qui consistent à soustraire de chaque valeur sa moyenne, puis à la diviser par son écart-type. La nouvelle variable obtenue s’exprime alors en écart-type (appelé aussi score-z). La formule de la transformation est <span class="math inline">\(f(x) = \frac{x - \bar{x}}{\sigma_x}\)</span>, avec <span class="math inline">\(\bar{x}\)</span> la moyenne de <span class="math inline">\(x\)</span> et <span class="math inline">\(\sigma_x\)</span> l’écart-type de <span class="math inline">\(x\)</span>.</p></li>
<li><p><strong>La transformation sur une mise à l’échelle de 0 à 1</strong> qui permet de modifier l’étendue d’une variable afin que sa valeur maximale soit de 1 et sa valeur minimale soit de 0. La formule de cette transformation est <span class="math inline">\(f(x) = \frac{x-min(x)}{max(x)-min(x)}\)</span>.</p></li>
<li><p><strong>La transformation en rang</strong> qui consiste à remplacer les valeurs d’une variable par leur rang. La valeur la plus faible est remplacée par 1, et la plus forte par <em>n</em> (nombre d’observations). Notez que cette transformation modifie la distribution de la variable originale contrairement aux deux transformations précédentes. Cette propriété peut être désirable si les écarts absolus entre les valeurs ont peu d’importance, si la variable n’a pas été mesurée avec précision ou encore si des valeurs extrêmes sont présentes.</p></li>
<li><p><strong>La transformation en percentile</strong> qui consiste à remplacer les valeurs d’une variable par leur percentile correspondant. Elle peut être vue comme une standardisation de la transformation en rang, car elle ne dépend pas du nombre d’observations.</p></li>
</ul>
<p>La <a href="#fig-impactTransform">figure&nbsp;<span class="quarto-unresolved-ref">fig-impactTransform</span></a> montre l’effet de ces transformations sur l’histogramme d’une variable.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-impactTransform" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-impactTransform-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.6: Effets de différentes transformations sur la distribution d’une variable</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
</section><section id="sec-13212" class="level4" data-number="13.2.1.2"><h4 data-number="13.2.1.2" class="anchored" data-anchor-id="sec-13212">
<span class="header-section-number">13.2.1.2</span> Distance de Manhattan</h4>
<p>Cette seconde distance est également couramment utilisée. Elle doit son nom au réseau de rue de l’île de Manhattan qui suit un plan quadrillé. La distance de Manhattan correspond à la somme des écarts absolus entre les valeurs des différentes variables décrivant les observations (<a href="#eq-manhattandist">équation&nbsp;<span class="quarto-unresolved-ref">eq-manhattandist</span></a>). La <a href="#fig-dist2">figure&nbsp;<span class="quarto-unresolved-ref">fig-dist2</span></a> illustre que la distance Manhattan (lignes noires) représente les deux côtés opposés de l’hypoténuse d’un triangle rectangle; l’hypoténuse représentant quant à elle la distance euclidienne.</p>
<p><span id="eq-manhattandist"><span class="math display">\[
d(a,b) = \sum{}^v_{i=1}(|a_i-b_i|)
\tag{13.2}\]</span></span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-dist2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-dist2-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.7: Représentation de la distance de Manhattan</figcaption></figure>
</div>
</div>
</div>
<p>La distance de Manhattan doit être privilégiée à la distance euclidienne lorsque les données considérées ont un très grand nombre de dimensions (variables). En effet, lorsque le nombre de variables est important (supérieur à 30), la distance euclidienne tend à être grande pour toutes les paires d’observations et à moins bien discriminer les observations proches et lointaines les unes des autres. Du fait de sa nature additive, la distance de Manhattan est moins sujette à ce problème <span class="citation" data-cites="aggarwal2001surprising">(<a href="#ref-aggarwal2001surprising" role="doc-biblioref">Aggarwal, Hinneburg et Keim 2001</a>)</span>.</p>
<p>Calculons la distance de Manhattan pour nos deux paires d’observations&nbsp;:</p>
<ul>
<li><span class="math inline">\(d(A,B)=|85-80|+|80-77| = 8\)</span></li>
<li><span class="math inline">\(d(B, c)=|80-83|+|79-77| = 5\)</span></li>
</ul></section><section id="sec-13213" class="level4" data-number="13.2.1.3"><h4 data-number="13.2.1.3" class="anchored" data-anchor-id="sec-13213">
<span class="header-section-number">13.2.1.3</span> Distance du khi-deux</h4>
<p>La distance du khi-deux est basée sur le test du khi-deux (<a href="#sec-chap05">chapitre&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-chap05</span></a>) et est généralement utilisée pour calculer la distance entre deux histogrammes, deux images ou deux ensembles de mots. Plus précisément, elle permet de mesure la distance entre deux observations A et B, pour lesquelles nous disposons d’un ensemble de variables étant toutes des variables de comptage.</p>
<p>Prenons un exemple concret en générant trois histogrammes A, B et C sur l’intervalle [0,50] à partir des distributions normale, log-normale et Gamma, puis comptons le nombre de valeurs de chaque unité (1, 2, 3, 4, etc.). Ces histogrammes sont représentés à la <a href="#fig-dist3">figure&nbsp;<span class="quarto-unresolved-ref">fig-dist3</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-dist3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-dist3-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.8: Trois histogrammes pour illustrer le calcul de la distance du khi-deux</figcaption></figure>
</div>
</div>
</div>
<p>Nous pouvons calculer les distances du khi-deux entre les paires d’histogrammes (<a href="#tbl-tabdist3">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-tabdist3</span></a>). Nous constatons ainsi que les histogrammes B et C sont les plus semblables.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-tabdist3" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;13.1: Distance du khi-deux entre trois histogrammes</caption>
<thead><tr class="header">
<th style="text-align: left;">Histogrammes</th>
<th style="text-align: right;">Distance du khi-deux</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A-B</td>
<td style="text-align: right;">284,8375</td>
</tr>
<tr class="even">
<td style="text-align: left;">A-C</td>
<td style="text-align: right;">376,7862</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B-C</td>
<td style="text-align: right;">219,5133</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>La formule de cette distance est la suivante&nbsp;:</p>
<p><span id="eq-chi2dist"><span class="math display">\[
d_{\chi^2}(a,b) = \frac{1}{2}\sum^n_{i=1}\frac{(a_i-b_i)^2}{(a_i+b_i)}
\tag{13.3}\]</span></span></p>
<p>avec <span class="math inline">\(a_i\)</span> et <span class="math inline">\(b_i\)</span> les comptages pour les histogrammes. Notez que si <span class="math inline">\(a_i\)</span> et <span class="math inline">\(b_i\)</span> valent tous les deux 0, il faut retirer ces valeurs avant le calcul, car cela provoquerait une division par 0.</p>
<p>À première vue, cette distance peut paraître moins utile que les deux précédentes. Pourtant, de nombreuses données sont collectées comme des histogrammes. Un premier exemple serait des images que nous pouvons représenter sous forme de trois histogrammes, un pour chaque canal de couleur (rouge, vert et bleu). Un second exemple serait des données sonores, souvent synthétisées sous forme d’histogrammes des fréquences sonores enregistrées (octaves ou tiers d’octaves). Un dernier exemple pourrait être le nombre d’accidents de la route enregistré à diverses intersections d’une ville chaque heure. Dans ce contexte, un histogramme serait formé par l’intersection avec les heures de la journée comme limites des bandes et le nombre d’accidents comme hauteur des bandes.</p>
</section><section id="sec-13214" class="level4" data-number="13.2.1.4"><h4 data-number="13.2.1.4" class="anchored" data-anchor-id="sec-13214">
<span class="header-section-number">13.2.1.4</span> Distance de Mahalanobis</h4>
<p>Proposée dans les années 1930 par le statisticien indien Prasanta Chandra Mahalanobis <span class="citation" data-cites="chandra1936generalised">(<a href="#ref-chandra1936generalised" role="doc-biblioref">1936</a>)</span>, cette distance se base sur la matrice de covariance des variables analysées. Plus spécifiquement, elle est utilisée pour calculer la distance entre un point et une distribution normale multivariée. Elle permet notamment de tenir compte du fait que certaines variables sont corrélées et ainsi d’éviter de surestimer les distances entre des observations dans des jeux de données comprenant des variables corrélées entre elles.</p>
<p>La formule permettant de calculer cette distance est la suivante&nbsp;:</p>
<p><span id="eq-mahalanobis"><span class="math display">\[
d(a,b) = \sqrt{(a-b)^TS^{-1}(a-b)}
\tag{13.4}\]</span></span></p>
<p>avec <em>S</em> étant la matrice de covariance.</p>
</section><section id="sec-13215" class="level4" data-number="13.2.1.5"><h4 data-number="13.2.1.5" class="anchored" data-anchor-id="sec-13215">
<span class="header-section-number">13.2.1.5</span> Distance de Hamming</h4>
<p>Cette distance est utilisée quand les écarts entre les variables de deux observations sont uniquement binaires. Un bon exemple serait un jeu de données ne comprenant que des variables qualitatives pouvant avoir une valeur identique pour deux observations (distance&nbsp;=&nbsp;0) ou différente (distance&nbsp;=&nbsp;1). La distance de Hamming est la simple addition de ces écarts.</p>
<p>Prenons un exemple très simple en prenant trois maisons pour lesquelles nous connaissons cinq caractéristiques (<a href="#tbl-dist4">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dist4</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-dist4" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;13.2: Exemple de données pour la distance de Hamming</caption>
<thead><tr class="header">
<th style="text-align: left;">couleur</th>
<th style="text-align: left;">jardin</th>
<th style="text-align: left;">garage</th>
<th style="text-align: left;">cheminée</th>
<th style="text-align: left;">sous-sol</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">blanc</td>
<td style="text-align: left;">non</td>
<td style="text-align: left;">oui</td>
<td style="text-align: left;">oui</td>
<td style="text-align: left;">non</td>
</tr>
<tr class="even">
<td style="text-align: left;">blanc</td>
<td style="text-align: left;">non</td>
<td style="text-align: left;">non</td>
<td style="text-align: left;">oui</td>
<td style="text-align: left;">non</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rouge</td>
<td style="text-align: left;">oui</td>
<td style="text-align: left;">oui</td>
<td style="text-align: left;">non</td>
<td style="text-align: left;">oui</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Nous pouvons utiliser la distance de Hamming pour estimer le niveau de dissimilarité entre ces différentes maisons et l’organiser dans une matrice de distances. À la lecture du <a href="#tbl-dist5">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-dist5</span></a>), les maisons&nbsp;2 et&nbsp;3 sont les plus dissimilaires (distance de Hamming&nbsp;=&nbsp;5), et les maisons&nbsp;1 et&nbsp;2 les plus similaires (distance de Hamming&nbsp;=&nbsp;1).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-dist5" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;13.3: Distance de Hamming entre les maisons</caption>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">maison 1</th>
<th style="text-align: center;">maison 2</th>
<th style="text-align: center;">maison 3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">maison 1</td>
<td style="text-align: left;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">maison 2</td>
<td style="text-align: left;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">maison 3</td>
<td style="text-align: left;">4</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="sec-13216" class="level4" data-number="13.2.1.6"><h4 data-number="13.2.1.6" class="anchored" data-anchor-id="sec-13216">
<span class="header-section-number">13.2.1.6</span> Distance de Gower</h4>
<p>La distance de Gower <span class="citation" data-cites="gower1971general">(<a href="#ref-gower1971general" role="doc-biblioref">1971</a>)</span> peut être utilisée pour mesurer la distance entre deux observations lorsque les données sont à la fois qualitatives et quantitatives. Cette distance est comprise dans un intervalle de 0 à 1, 0 signifiant que les deux observations sont identiques et 1, que les observations sont radicalement différentes.</p>
<p>Elle se calcule de la façon suivante&nbsp;:</p>
<p><span id="eq-gower"><span class="math display">\[
\begin{aligned}
&amp;d(a,b) = 1-\frac{1}{p}\sum^p_{j=1}s_{12j}\\
&amp;\left\{\begin{array}{c}
s_{xyj} = 1 \text{ si } x_j = y_j \text{, 0 autrement pour une variable qualitative} \\
s_{xyj} =  1 - \frac{|x_j-y_j|}{max(j)-min(j)} \text{ pour une variable quantitative}
\end{array}\right.
\end{aligned}
\tag{13.5}\]</span></span></p>
<p>avec <em>p</em> le nombre de variables, <em>x</em> et <em>y</em> deux observations et <em>j</em> une variable.</p>
<p>Autrement dit, si la valeur d’une variable qualitative diffère entre deux observations, la distance entre ces deux observations augmente de <span class="math inline">\(1/p\)</span>. Pour une variable quantitative, la distance augmente selon la différence absolue entre les valeurs de la variable divisée par l’étendue totale de la variable, le tout à nouveau divisé par <em>p</em>.</p>
<p>Si cette mesure semble intéressante puisqu’elle permet de combiner des variables quantitatives et qualitatives, elle souffre de deux limites importantes&nbsp;:</p>
<ul>
<li><p>Elle ne prend pas en compte le fait que certaines modalités des variables qualitatives sont moins fréquentes ni que certaines combinaisons sont également moins fréquentes.</p></li>
<li><p>Les variables qualitatives tendent à affecter bien plus la distance que les variables quantitatives. En effet, pour obtenir un écart de 1 sur une variable quantitative, il faut que les deux valeurs soient respectivement le maximum et le minimum de cette variable.</p></li>
</ul>
<div class="bloc_aller_loin">
<div class="bloc_aller_loin-header">
<div class="bloc_aller_loin-icon">

</div>
<p><strong>D’autres distances pour des données mixtes</strong></p>
</div>
<div class="bloc_aller_loin-body">
<p>Il existe bien d’autres distances qui peuvent être utilisées dans le cas de données mixtes. Le <em>package</em> <code>kmed</code> en implémente cinq (auxquelles s’ajoute la distance de Gower) dans sa fonction <code>distmix</code>&nbsp;: les distances de Wishart, de Podani, d’Huang, d’Harikumar et d’Ahmad. Ces différentes distances ont toutes leurs avantages et leurs défauts respectifs; pour plus d’information, référez-vous à la documentation de la fonction <code>distmix</code>.</p>
</div>
</div>
</section><section id="sec-13217" class="level4" data-number="13.2.1.7"><h4 data-number="13.2.1.7" class="anchored" data-anchor-id="sec-13217">
<span class="header-section-number">13.2.1.7</span> Distance du Phi<sup>2</sup>
</h4>
<p>La distance du <span class="math inline">\(\Phi^2\)</span> (Phi<sup>2</sup>) est une variante de la distance du <span class="math inline">\(\chi^2\)</span>. Il s’agit donc d’une distance à utiliser lorsque les données à analyser sont uniquement qualitatives. Elle calcule la distance entre deux observations en additionnant les différences entre les valeurs de chaque variable (1 si différentes, 0 si identiques, pour chaque variable), divisées respectivement par la fréquence totale d’occurrences de chaque modalité dans le jeu de données. En d’autres termes, cette distance tient compte du fait que certaines valeurs pour des variables qualitatives peuvent être observées plus fréquemment que d’autres et qu’une distance plus grande devrait être obtenue entre deux observations si l’une des deux présente des modalités rares comparativement au reste du jeu de données.</p>
<p>Elle peut être calculée de la façon suivante&nbsp;:</p>
<p><span id="eq-phidist"><span class="math display">\[
d_{\Phi^2}(i,j) = \frac{1}{Q}\sum_k\frac{(\delta_{ik} - \delta_{jk})^2}{f_k}
\tag{13.6}\]</span></span></p>
<p>avec <em>i</em> et <em>j</em> deux observations, <em>k</em> une modalité d’une variable qualitative, <em>Q</em> le nombre total de modalités des variables qualitatives, <span class="math inline">\(\delta_{ik} = 1\)</span> si l’observation i a la modalité <em>k</em>, 0 sinon et <span class="math inline">\(f_k\)</span> la fréquence de la modalité <em>k</em> dans le jeu de données.</p>
<p>La distance du <span class="math inline">\(\Phi^2\)</span> est très utile pour analyser les résultats de questionnaires.</p>
</section></section><section id="sec-1322" class="level3" data-number="13.2.2"><h3 data-number="13.2.2" class="anchored" data-anchor-id="sec-1322">
<span class="header-section-number">13.2.2</span> Inertie</h3>
<p>Une notion importante à saisir dans le cadre des méthodes de classification non supervisée est celui celle l’<strong>inertie</strong> d’un jeu de données. Elle est proche de la notion de variance qui a été présentée dans le chapitre sur la statistique univariée (<a href="#sec-0253">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-0253</span></a>).</p>
<p>L’inertie est une quantité permettant de décrire la dispersion des observations d’un jeu de données. Cette mesure dépend à la fois des données (nombres d’observations et de variables, échelle des variables) et de la mesure de distance retenue entre deux observations. Plus spécifiquement, l’inertie correspond à la somme des distances entre chaque observation et le centre du jeu de données.</p>
<p><span id="eq-inertia"><span class="math display">\[
inertie= \sum{}^n_{i=1} d(c,x_i)
\tag{13.7}\]</span></span></p>
<p>avec <em>c</em> le centre du jeu de données, <em>n</em> le nombre d’observations, <em>x</em> une observation et <em>d</em> la fonction calculant la distance entre deux observations.</p>
<p>L’enjeu est de définir <em>c</em> dans un contexte où la distance euclidienne est utilisée. Il s’agit simplement d’une observation fictive dont les coordonnées sont les moyennes des différentes variables du jeu de données. Dans le cas d’autres distances, il peut s’agir de l’observation minimisant la distance à toutes les autres observations.</p>
<p>Pour bien visualiser la notion d’inertie, prenons une fois encore le jeu de données <code>IRIS</code> comme exemple. Admettons que nous ne nous intéressons qu’à deux variables de ce jeu de données&nbsp;: <code>sepal.Length</code> et <code>sepal.Width</code>. Nous pouvons représenter l’inertie totale du jeu de données à la <a href="#fig-dist6">figure&nbsp;<span class="quarto-unresolved-ref">fig-dist6</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-dist6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-dist6-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.9: Représentation de l’inertie du jeu de données IRIS</figcaption></figure>
</div>
</div>
</div>
<p>Chaque ligne bleue représente la contribution de chaque point à l’inertie totale du jeu de données. Pour chaque iris, nous connaissons son espèce (Setosa, Versicolor ou Virginica). Nous pouvons donc attribuer chaque point de ce jeu de données à un groupe (une espèce dans notre cas). Il devient alors possible de calculer l’inertie de chacun des sous-groupes de notre jeu de données. Pour cela, nous devons calculer le centre de chaque groupe (généralement les moyennes des variables des observations au sein d’un groupe) et ensuite calculer l’inertie entre chaque observation et le centre de son groupe. Nous représentons cette situation à la <a href="#fig-dist7">figure&nbsp;<span class="quarto-unresolved-ref">fig-dist7</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-dist7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-dist7-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.10: Représentation de l’inertie par groupe pour le jeu de données IRIS</figcaption></figure>
</div>
</div>
</div>
<p>Cette inertie propre aux groupes est toujours inférieure ou égale à l’inertie totale du jeu de données. Il s’agit en réalité de l’inertie que la structure de groupe n’est pas en mesure d’expliquer. En utilisant ces concepts, il est possible de calculer la part de l’inertie totale expliquée par les groupes (<a href="#eq-explainedinertia">équation&nbsp;<span class="quarto-unresolved-ref">eq-explainedinertia</span></a>)&nbsp;:</p>
<p><span id="eq-explainedinertia"><span class="math display">\[
\text{inertie expliquée} = 1-\frac{\text{inertie totale}}{\text{inertie restante}}
\tag{13.8}\]</span></span></p>
<p>Cette valeur nous renseigne sur la capacité d’une classification à bien réduire l’inertie totale d’un jeu de données. Elle est comprise entre 0 et 1. Si l’inertie expliquée est à 0, c’est que la classification n’explique absolument aucune part de l’inertie totale. Si l’inertie expliquée est à 1, la classification utilisée explique l’intégralité de l’inertie, ce qui en pratique n’est atteignable que si le nombre de groupes de la classification est égal au nombre d’observations. En d’autres termes, chaque observation est attribuée à un groupe dont elle est la seule représentante. Un telle situation n’a aucun intérêt puisque l’objectif d’une classification est bien de réduire la complexité d’un jeu de données en regroupant les observations.</p>
</section></section><section id="sec-133" class="level2" data-number="13.3"><h2 data-number="13.3" class="anchored" data-anchor-id="sec-133">
<span class="header-section-number">13.3</span> Classification ascendante hiérarchique</h2>
<p>La classification ascendante hiérarchique (CAH) est un algorithme de classification non supervisée dont l’objectif est de créer un arbre de classification des observations. Cet arbre est ensuite utilisé pour déterminer le nombre de groupes à former et à quel groupe appartient chaque observation.</p>
<section id="sec-1331" class="level3" data-number="13.3.1"><h3 data-number="13.3.1" class="anchored" data-anchor-id="sec-1331">
<span class="header-section-number">13.3.1</span> Fonctionnement de l’algorithme</h3>
<p>La classification ascendante hiérarchique est un algorithme permettant de regrouper les observations d’un jeu de données de façon itérative. À chaque itération, deux observations similaires sont agrégées en un groupe représenté par le point central entre les deux observations. Le processus est ensuite répété en considérant le nouveau point comme une observation jusqu’à ce que toutes les observations soient fusionnées en un seul groupe.</p>
<p>Ces regroupements successifs créent un arbre de classification appelé dendrogramme. La racine de cet arbre est le groupe unique fusionnant toutes les observations, et ses branches correspondent aux différentes agrégations effectuées jusqu’aux observations individuelles. Cet arbre peut être vu comme une hiérarchie de classification. Chaque niveau de l’arbre est un regroupement de plus en plus généraliste au fur et à mesure que nous nous approchons de sa racine.</p>
<p>Pour appliquer cette méthode, il est nécessaire de sélectionner une <strong>fonction de distance</strong> pour mesurer la dissimilarité ou la ressemblance entre deux observations. L’algorithme fonctionne avec n’importe quelle fonction de distance, ce qui permet de l’appliquer aussi bien à des données qualitatives que quantitatives. En effet, l’opération de regroupement des observations se base sur une matrice de distance, soit un tableau de taille <em>n x n</em> indiquant pour chaque paire d’observations leur degré de dissimilarité. La <a href="#fig-tablvsmat">figure&nbsp;<span class="quarto-unresolved-ref">fig-tablvsmat</span></a> illustre cette transformation en appliquant la distance du <span class="math inline">\(\Phi^2\)</span> à un jeu de données comprenant cinq observations et 5 variables qualitatives.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-tablvsmat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-tablvsmat-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.11: Du tableau de données à la matrice de distance</figcaption></figure>
</div>
</div>
</div>
<p>En plus de la fonction de distance, il est également nécessaire de sélectionner un <strong>critère d’agrégation</strong>, soit la règle permettant de décider à chaque itération quelles observations doivent être regroupées. Les méthodes les plus courantes sont&nbsp;:</p>
<ul>
<li><p>Le critère de Ward <span class="citation" data-cites="ward1963hierarchical">(<a href="#ref-ward1963hierarchical" role="doc-biblioref">1963</a>)</span>&nbsp;: cette méthode consiste à agréger à chaque itération les deux observations permettant de minimiser la variance (ou l’inertie) intra-groupe, ce qui revient à maximiser l’inertie inter-groupe (autrement dit, à rendre les groupes les plus homogènes possibles et les plus dissemblables entre eux). Ainsi, l’enjeu est de fusionner les deux observations permettant d’avoir les groupes les plus dissimilaires possible après fusion.</p></li>
<li><p>Le lien complet&nbsp;: à chaque itération, les deux groupes d’observations associés sont ceux pour lesquels la distance maximale entre les observations les composant est la plus petite parmi tous les groupes.</p></li>
<li><p>Le lien simple&nbsp;: à chaque itération, les deux groupes d’observations associés sont ceux pour lesquels la distance minimum entre les observations les composant est la plus petite parmi tous les groupes.</p></li>
</ul>
<p>La plus utilisée est de loin la méthode de Ward. La méthode du lien complet produit généralement des résultats similaires. En revanche, la méthode du lien simple peut produire des groupes non sphériques (non centrés sur leur moyenne) plus difficile à interpréter.</p>
<p>Prenons un instant pour visualiser cet algorithme (<a href="#fig-animhclust">figure&nbsp;<span class="quarto-unresolved-ref">fig-animhclust</span></a>). Cette animation a été réalisée par David Sheehan et est également accessible sur son <a href="https://dashee87.github.io/data%20science/general/Clustering-with-Scikit-with-GIFs/">blog</a>. Elle présente bien le processus d’agglomération de la classification ascendante hiérarchique et la construction progressive du dendrogramme.</p>
<div id="fig-animhclust" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap13/CAH.gif" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.12: Principe de fonctionnement de la classification ascendante hiérarchique (auteur : David Sheehan)</figcaption></figure>
</div>
</section><section id="sec-1332" class="level3" data-number="13.3.2"><h3 data-number="13.3.2" class="anchored" data-anchor-id="sec-1332">
<span class="header-section-number">13.3.2</span> Choisir le bon nombre de groupes</h3>
<p>Une fois que l’algorithme a été appliqué aux données et le dendrogramme obtenu, il faut encore choisir le nombre optimal de groupes pour la classification finale. Chaque embranchement du dendrogramme constitue une classification possible, allant de la plus complexe (chaque observation appartient à un groupe formé d’elle seule) à la plus simple (toutes les observations appartiennent au même groupe). Si le nombre de groupes n’est pas connu à l’avance et qu’aucune forte justification théorique n’existe, il est possible d’utiliser plusieurs techniques pour déterminer un nombre de groupes judicieux à partir des données. Nous en présentons ici trois, mais il convient de ne pas s’en tenir uniquement à ses critères arbitraires. Il est important d’explorer les résultats de la classification obtenue pour plusieurs valeurs de <em>k</em> candidates et de tenir compte de la qualité des informations qu’elles fournissent. Au final, il est pertinent de retenir la classification dont les résultats offrent l’interprétation la plus claire avec un nombre de groupes réduit (principe de parcimonie).</p>
<section id="sec-13321" class="level4" data-number="13.3.2.1"><h4 data-number="13.3.2.1" class="anchored" data-anchor-id="sec-13321">
<span class="header-section-number">13.3.2.1</span> Méthode du coude</h4>
<p>Cette première approche est la plus simple à mettre en œuvre. Il s’agit simplement de produire plusieurs classifications à partir du dendrogramme avec différentes valeurs de <em>k</em> (nombre de groupes) et de calculer à chaque fois la part de l’inertie expliquée. Chaque groupe supplémentaire ne peut qu’améliorer l’inertie expliquée, car pour rappel, si <span class="math inline">\(k=n\)</span>, alors nous expliquons 100&nbsp;% de l’inertie totale. L’objectif est de déterminer à quel moment l’ajout d’un groupe supplémentaire ne contribue que de façon marginale à améliorer l’inertie expliquée. Si nous représentons les valeurs d’inertie expliquée pour les différentes valeurs de <em>k</em> dans un graphique, une rupture (un coude) indiquerait le point au-delà duquel les groupes supplémentaires ne captent finalement que du bruit et non plus de l’information.</p>
<p>Si nous reprenons l’exemple du jeu de données <code>IRIS</code>, nous pouvons créer ce graphique avec <em>k</em> allant de 2 à 8 (<a href="#fig-kmeans2">figure&nbsp;<span class="quarto-unresolved-ref">fig-kmeans2</span></a>). Un premier coude très net est observable pour <span class="math inline">\(k = 3\)</span> et un second plus faible, mais tout de même marqué pour <span class="math inline">\(k = 4\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-kmeans2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-kmeans2-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.13: Méthode du coude</figcaption></figure>
</div>
</div>
</div>
<div class="bloc_notes">
<div class="bloc_notes-header">
<div class="bloc_notes-icon">

</div>
<p><strong>Inertie expliquée et centre de groupe</strong></p>
</div>
<div class="bloc_notes-body">
<p>Pour calculer l’inertie expliquée, il est nécessaire de pouvoir déterminer pour le centre de gravité (ou centroïde) chaque groupe. Lorsque la distance euclidienne est utilisée, il s’agit simplement de calculer pour chaque groupe la valeur moyenne des différentes colonnes des observations. Cependant, lorsque d’autres distances sont utilisées, il peut être plus difficile de déterminer le centre d’un groupe. Avec la distance de Manhattan, il est par exemple recommandé d’utiliser la médiane des colonnes plutôt que la moyenne. Pour la distance de Hamming, la moyenne peut aussi être utilisée, car elle représente pour cette distance la fréquence d’occurrence des différentes modalités des variables qualitatives. Pour d’autres distances plus complexes, il est préférable de définir le centre d’un groupe comme le point de ce groupe minimisant les distances à tous les autres points du groupe. Il s’agit du médoïde du groupe.</p>
</div>
</div>
</section><section id="sec-13322" class="level4" data-number="13.3.2.2"><h4 data-number="13.3.2.2" class="anchored" data-anchor-id="sec-13322">
<span class="header-section-number">13.3.2.2</span> Indicateur de silhouette</h4>
<p>Si un coude net ne s’observe pas pour la méthode précédente, il est possible d’utiliser l’indicateur de silhouette. Il permet de mesurer pour une classification à quel point une observation est similaire à celles dans son propre groupe (cohésion) comparativement aux observations des autres groupes. Elle se calcule de la façon suivante&nbsp;:</p>
<p><span id="eq-silhouetteidx"><span class="math display">\[
\begin{aligned}
s(i) &amp;= \frac{b(i)-a(i)}{\max \{a(i), b(i)\}} \\
a(i) &amp;= \frac{1}{|C_i|-1}\sum_{j \in C_i,i \neq j}d(i,j) \\
b(i) &amp;= min_{i \neq j}\frac{1}{|C_j|}\sum_{j \in C_j}d(i,j)
\end{aligned}
\tag{13.9}\]</span></span></p>
<p>avec <span class="math inline">\(s(i)\)</span> la valeur de l’indice de silhouette pour l’observation <em>i</em>, <span class="math inline">\(a(i)\)</span> la distance moyenne entre l’observation <em>i</em> et son groupe <span class="math inline">\(C_i\)</span> et <span class="math inline">\(b(i)\)</span> la distance minimale entre l’observation <em>i</em> et le centre de chaque autre groupe <span class="math inline">\(C_j\)</span>.</p>
<p>La valeur totale de l’indice est simplement la moyenne des valeurs moyennes des indices de silhouette au sein de chaque groupe. Une valeur plus élevée indique une meilleure classification. Il est nécessaire de déterminer le centre des groupes pour calculer cet indicateur, ce qui peut être un exercice difficile quand une distance autre que la distance euclidienne est utilisée. Référez-vous à la note de la section précédente pour plus d’informations. L’indice de silhouette semble indiquer que seulement trois groupes serait un choix optimal, soit la valeur la plus haute (<a href="#fig-kmeans3">figure&nbsp;<span class="quarto-unresolved-ref">fig-kmeans3</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-kmeans3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-kmeans3-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.14: Méthode de l’indice de silhouette</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-13323" class="level4" data-number="13.3.2.3"><h4 data-number="13.3.2.3" class="anchored" data-anchor-id="sec-13323">
<span class="header-section-number">13.3.2.3</span> Méthode GAP</h4>
<p>Cette méthode, proposée par <span class="citation" data-cites="tibshirani2001estimating">Tibshirani, Walther et Hastie (<a href="#ref-tibshirani2001estimating" role="doc-biblioref">2001</a>)</span>, consiste à comparer l’inertie intra-groupe (inexpliquée) avec l’inertie observée pour un jeu de données généré aléatoirement (distribution uniforme des valeurs entre le minimum et le maximum de chaque variable) pour différentes valeurs successives de <em>k</em>. Une fois ces calculs effectués, l’objectif est de trouver la valeur de <em>k</em> telle que la valeur de GAP à <em>k&nbsp;+&nbsp;1</em> n’est pas plus grande qu’un écart type pour GAP à <em>k&nbsp;+&nbsp;1</em>.</p>
<p>La statistique GAP est calculée ainsi&nbsp;:</p>
<p><span id="eq-gapidx"><span class="math display">\[
\begin{aligned}
GAP(k) = \frac{1}{\text{nsim}} \sum^{\text{nsim}}_{\text{sim} = 1} log(W_{ksim}) - log(W_k)
\end{aligned}
\tag{13.10}\]</span></span></p>
<p>avec <span class="math inline">\(W_k\)</span> l’inertie non expliquée (intra-groupe), <span class="math inline">\(W_{ksim}\)</span> l’inertie non expliquée (intra-groupe) obtenue pour un jeu de données simulé et <em>k</em> le nombre de groupes.</p>
<p>L’idée est qu’une bonne classification doit produire des résultats plus structurés que ce que nous pourrions attendre du hasard. Chaque groupe supplémentaire permet de réduire l’inertie, mais lorsque l’ajout d’un groupe ne permet pas un gain significatif comparativement au hasard, alors l’ajout de ce groupe ne se justifie pas. À nouveau, il est possible de visualiser la situation avec un simple graphique (<a href="#fig-kmeans4">figure&nbsp;<span class="quarto-unresolved-ref">fig-kmeans4</span></a>). Selon cette méthode, il faudrait sélectionner quatre groupes, car il s’agit de la première valeur de <em>k</em> validant le critère de cette méthode. La seconde valeur retenue par cette méthode est 6.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-kmeans4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-kmeans4-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.15: Méthode GAP</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-1333" class="level3" data-number="13.3.3"><h3 data-number="13.3.3" class="anchored" data-anchor-id="sec-1333">
<span class="header-section-number">13.3.3</span> Limites de la classification ascendante hiérarchique</h3>
<p>Bien que très flexible (choix de la fonction de distance et du critère d’agrégation), la CAH fait face à un enjeu majeur&nbsp;: la vitesse d’exécution et la consommation de mémoire lorsque de grands jeux de données sont utilisés. En effet, il est nécessaire de calculer à chaque étape une matrice de distance entre les groupes. Si un jeu de données comprend 1000 observations, cette matrice comprend donc 1000&nbsp;x&nbsp;1000 cases, soit un million de distances. Même en divisant ce nombre par deux (les éléments de la matrice sont symétriques, donc <span class="math inline">\(d(ij) = d(ji)\)</span>), ce nombre augmente avec le carré du nombre d’observations. Pour de grands jeux de données, la CAH peut donc échouer à cause des limites de l’ordinateur utilisé. Il existe des versions plus performantes de l’algorithme réduisant cette limite, mais il convient de la garder en mémoire. Quand un très grand jeu de données doit être analysé, les méthodes des nuées dynamiques sont une solution à considérer.</p>
</section><section id="sec-1334" class="level3" data-number="13.3.4"><h3 data-number="13.3.4" class="anchored" data-anchor-id="sec-1334">
<span class="header-section-number">13.3.4</span> Mise en œuvre dans R</h3>
<p>Nous proposons ici un exemple issu d’un article portant sur les parcs urbains de Montréal <span class="citation" data-cites="apparicio2010accessibilite">(<a href="#ref-apparicio2010accessibilite" role="doc-biblioref">Apparicio et al. 2010</a>)</span>, dont l’objectif était notamment de classifier ces parcs en fonction de leur superficie et des équipements qu’ils comprennent, et ce, en utilisant la classification ascendante hiérarchique. Nous proposons ici de reproduire l’étape de classification effectuée dans cet article. La base de données comporte 653 parcs pour lesquels la présence de 18 équipements est codée comme un ensemble de variables binaires (0 signifiant absence et 1 présence). Nous disposons également de la taille de ces parcs, recodée en cinq catégories&nbsp;: moins d’un hectare, de 1 à 5 hectares, de 5 à 10 hectares, de 10 à 20 hectares et 20 hectares et plus. Le <a href="#tbl-exampleHclust1DF">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-exampleHclust1DF</span></a> indique le nombre d’équipements recensés dans les parcs.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-exampleHclust1DF" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;13.4: Équipements recensés dans les différents parcs de Montréal</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Équipements</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N</th>
</tr></thead>
<tbody>
<tr class="odd" data-grouplength="3">
<td colspan="2" style="border-bottom: 1px solid"><strong>Équipements pour les 0 à 4 ans</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Aire de jeux</td>
<td style="text-align: right;">601</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Pataugeoire</td>
<td style="text-align: right;">161</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Jeux d’eau</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="odd" data-grouplength="7">
<td colspan="2" style="border-bottom: 1px solid"><strong>Terrains de sport</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Baseball</td>
<td style="text-align: right;">188</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Soccer (football)</td>
<td style="text-align: right;">169</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Basketball</td>
<td style="text-align: right;">144</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Tennis</td>
<td style="text-align: right;">125</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Football</td>
<td style="text-align: right;">36</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Volleyball</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Athlétisme</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="odd" data-grouplength="4">
<td colspan="2" style="border-bottom: 1px solid"><strong>Équipements d'hiver</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Patinoire extérieure</td>
<td style="text-align: right;">241</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Glissade</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Piste de ski de fond</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Piste de raquette</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even" data-grouplength="2">
<td colspan="2" style="border-bottom: 1px solid"><strong>Équipements spécialisés</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Parc de planches à roulettes</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Patins à roues alignées</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd" data-grouplength="2">
<td colspan="2" style="border-bottom: 1px solid"><strong>Autres équipements</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Piscine intérieure</td>
<td style="text-align: right;">92</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Chemin de randonnée</td>
<td style="text-align: right;">15</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Puisque notre jeu de données ne comporte que des variables qualitatives, nous utilisons la distance du <span class="math inline">\(\Phi^2\)</span> pour construire notre matrice de distance entre les parcs. Notons que, dans l’article original, la distance euclidienne au carré avait été utilisée, alors nous n’obtiendrons probablement pas les mêmes résultats, car la distance du <span class="math inline">\(\Phi^2\)</span> tient compte des fréquences d’occurrence des modalités des variables qualitatives.</p>
<section id="sec-13341" class="level4" data-number="13.3.4.1"><h4 data-number="13.3.4.1" class="anchored" data-anchor-id="sec-13341">
<span class="header-section-number">13.3.4.1</span> Calcul de la matrice de distance</h4>
<p>La première étape consiste donc à charger notre jeu de données et à calculer la matrice de distance.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># chargement du jeu de données et sélection des colonnes pour l'analyse</span></span>
<span><span class="va">parcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/classification/Parcs.txt"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">parcs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">22</span>, <span class="fl">27</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pour calculer la distance du <span class="math inline">\(\Phi^2\)</span>, nous utilisons la fonction <code>dist</code> du <em>package</em> <code>proxy</code> avec le paramètre <code>method = "Phi-squared"</code>. Elle requiert que l’ensemble des variables catégorielles soient converties en variables binaires. Pour cela, nous pouvons utiliser la fonction <code>dummy_cols</code> du <em>package</em> <code>fastDummies</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jacobkap/fastDummies">fastDummies</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">proxy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://jacobkap.github.io/fastDummies/reference/dummy_cols.html">dummy_cols</a></span><span class="op">(</span><span class="va">X</span>, select_columns <span class="op">=</span> <span class="st">"HaTypo"</span>, remove_selected_columns <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">parc_distances</span> <span class="op">&lt;-</span> <span class="fu">dist</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html">as.matrix</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"Phi-squared"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-13342" class="level4" data-number="13.3.4.2"><h4 data-number="13.3.4.2" class="anchored" data-anchor-id="sec-13342">
<span class="header-section-number">13.3.4.2</span> Application de l’algorithme de classification ascendante hiérarchique</h4>
<p>Une fois la matrice obtenue, il ne reste plus qu’à appliquer la fonction <code>hclust</code> disponible de base dans R pour obtenir le dendrogramme. Comme dans l’article, nous utilisons le critère d’agrégation de Ward pour la création des groupes.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dendogramme_parcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">parc_distances</span>, method <span class="op">=</span> <span class="st">"ward.D"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Puisque nous n’utilisons pas la distance euclidienne, nous optons ici pour l’indice de silhouette pour déterminer le nombre adéquat de groupes à former. Nous testons toutes les valeurs comprises entre 2 et&nbsp;10.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/cluster/">cluster</a></span><span class="op">)</span></span>
<span><span class="va">ks</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span></span>
<span></span>
<span><span class="co"># Calcul des indices de silhouette pour les différentes valeurs de k</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">ks</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># découpage du dendrogramme</span></span>
<span>  <span class="va">groupes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">dendogramme_parcs</span>, k <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="co"># calcul des valeurs de silhouette</span></span>
<span>  <span class="va">sil</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/silhouette.html">silhouette</a></span><span class="op">(</span><span class="va">groupes</span>, dist <span class="op">=</span> <span class="va">parc_distances</span><span class="op">)</span></span>
<span>  <span class="co"># extraction de l'indice global (moyenne des moyennes)</span></span>
<span>  <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sil</span><span class="op">)</span><span class="op">$</span><span class="va">clus.avg.widths</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">idx</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Création d'un graphique avec les résultats</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>k <span class="op">=</span> <span class="va">ks</span>,  silhouette <span class="op">=</span> <span class="va">values</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">silhouette</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">silhouette</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"nombre de groupes"</span>, y <span class="op">=</span> <span class="st">"indice global de silhouette"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-exampleHclust4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-exampleHclust4-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.16: Valeur de l’indice de silhouette pour différents nombres de groupes</figcaption></figure>
</div>
</div>
</div>
<p>Si nous écartons d’emblée les résultats pour k&nbsp;=&nbsp;2 et k&nbsp;=&nbsp;3 (trop peu de groupes pour l’interprétation), nous constatons que la solution optimale selon ce critère est k&nbsp;=&nbsp;5. Dans l’article original, la solution k&nbsp;=&nbsp;6 avait été retenue en examinant le dendrogramme. Comparons les résultats pour k&nbsp;=&nbsp;5 et k&nbsp;=&nbsp;6.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">resk5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">dendogramme_parcs</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">resk6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">dendogramme_parcs</span>, k <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">sil5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/silhouette.html">silhouette</a></span><span class="op">(</span><span class="va">resk5</span>, dist <span class="op">=</span> <span class="va">parc_distances</span><span class="op">)</span></span>
<span><span class="va">sil6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/silhouette.html">silhouette</a></span><span class="op">(</span><span class="va">resk6</span>, dist <span class="op">=</span> <span class="va">parc_distances</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># résumé pour l'indice de silhouette pour k = 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sil5</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Silhouette of 693 units in 5 clusters from silhouette.default(x = resk5, dist = parc_distances) :
 Cluster sizes and average silhouette widths:
        116         212         246          84          35 
 0.07029553  1.00000000 -0.11827930 -0.19969707  1.00000000 
Individual silhouette widths:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.62041 -0.08502  0.09814  0.30200  1.00000  1.00000 </code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># résumé pour l'indice de silhouette pour k = 6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sil6</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Silhouette of 693 units in 6 clusters from silhouette.default(x = resk6, dist = parc_distances) :
 Cluster sizes and average silhouette widths:
        116         212         197          49          84          35 
 0.05906553  1.00000000 -0.10289391  0.07935325 -0.19969707  1.00000000 
Individual silhouette widths:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.62041 -0.06414  0.10998  0.31846  1.00000  1.00000 </code></pre>
</div>
</div>
<p>Nous constatons que le groupe supplémentaire vient séparer le groupe trois comprenant 246 parcs dans la solution avec k&nbsp;=&nbsp;5. Ce dernier ne comprend plus que 197&nbsp;parcs pour la solution k = 6 et le nouveau groupe en compte 49. Ce nouveau groupe à un indice de silhouette moyen relativement faible (0,079), et le fait de découper le groupe trois améliore très peu sa propre valeur (passant de -0,12 à -0,10). Nous retenons cependant ici la solution avec k = 6 afin de tenter de reproduire les résultats de l’article.</p>
</section><section id="sec-13343" class="level4" data-number="13.3.4.3"><h4 data-number="13.3.4.3" class="anchored" data-anchor-id="sec-13343">
<span class="header-section-number">13.3.4.3</span> Interprétation des résultats</h4>
<p>La dernière étape consiste à identifier les groupes obtenus et leur attribuer un intitulé en fonction de leurs caractéristiques. Dans notre cas, la classification ne comporte que des variables binaires, nous pouvons donc calculer le pourcentage de valeurs à&nbsp;1 (présence d’un équipement) dans chacun des groupes.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calcul du nombre de fois où chaque modalité est observée dans un groupe</span></span>
<span><span class="va">X</span><span class="op">$</span><span class="va">groupe</span> <span class="op">&lt;-</span> <span class="va">resk6</span></span>
<span><span class="va">df_groupes</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">groupe</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarise_all</span><span class="op">(</span>.funs <span class="op">=</span> <span class="va">sum</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calcul du nombre d'observations par groupe</span></span>
<span><span class="va">nb_gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">resk6</span><span class="op">)</span></span>
<span><span class="va">groupe_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html">as.matrix</a></span><span class="op">(</span><span class="va">df_groupes</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df_groupes</span><span class="op">)</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">nb_gp</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">groupe_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">groupe_ratios</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">groupe_ratios</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"groupe "</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">groupe_ratios</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calcul du nombre moyen d'équipements par catégorie par parc</span></span>
<span><span class="va">equip_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AIRE_JEUX"</span>, <span class="st">"JEUX_EAU"</span>, <span class="st">"PATAUGEOIRE"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ATHLETISME"</span>, <span class="st">"BASEBALL_S"</span>, <span class="st">"BASKETBALL"</span>, <span class="st">"FOOTBALL"</span>, <span class="st">"SOCCER"</span>, <span class="st">"TENNIS"</span>, <span class="st">"VOLLEY_BALL"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TOBBOGAN_G"</span>, <span class="st">"PATINOIRE_E"</span>, <span class="st">"RAQUETTES"</span>, <span class="st">"SKI_FOND"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PATIN_ROUE"</span>, <span class="st">"ROULI_ROUL"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PISC_EXT"</span>, <span class="st">"RANDONNEE"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_compte</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">equip_class</span>, <span class="kw">function</span><span class="op">(</span><span class="va">equip</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="va">equip</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">class_compte</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"enfants"</span>, <span class="st">"terrain_sport"</span>, <span class="st">"hiver"</span>, <span class="st">"specialise"</span>, <span class="st">"autre"</span><span class="op">)</span></span>
<span><span class="va">class_compte</span><span class="op">$</span><span class="va">groupe</span> <span class="op">&lt;-</span> <span class="va">resk6</span></span>
<span><span class="va">df_class_equip</span> <span class="op">&lt;-</span> <span class="va">class_compte</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">groupe</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise_all</span><span class="op">(</span><span class="va">mean</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_class_equip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">df_class_equip</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df_class_equip</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df_class_equip</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"groupe "</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df_class_equip</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># comptage du nombre moyen total d'équipements</span></span>
<span><span class="va">df_equip_tot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  nb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">18</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  groupe <span class="op">=</span> <span class="va">resk6</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df_equip_tot_mean</span> <span class="op">&lt;-</span> <span class="va">df_equip_tot</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">groupe</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize_all</span><span class="op">(</span><span class="va">mean</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># mise dans l'ordre de la première partie du tableau</span></span>
<span><span class="va">all_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">equip_class</span><span class="op">)</span></span>
<span><span class="va">idxs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">all_types</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">groupe_ratios</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">all_types</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">groupe_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">groupe_ratios</span><span class="op">[</span><span class="va">idxs</span>,<span class="op">]</span>,</span>
<span>                       <span class="va">groupe_ratios</span><span class="op">[</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">all_types</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">groupe_ratios</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combinaison des deux tableaux</span></span>
<span><span class="va">groupe_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">groupe_ratios</span>, <span class="va">df_class_equip</span>, <span class="va">df_equip_tot_mean</span><span class="op">$</span><span class="va">nb</span>, <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">nb_gp</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il est ensuite possible d’afficher le tableau obtenu pour l’interpréter. Les résultats sont ici rapportés au <a href="#tbl-exampleHclust7">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-exampleHclust7</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="tbl-exampleHclust7" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;13.5: Caractéristiques des groupes obtenus lors de la CAH</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">groupe 1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">groupe 2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">groupe 3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">groupe 4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">groupe 5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">groupe 6</th>
</tr></thead>
<tbody>
<tr class="odd" data-grouplength="3">
<td colspan="7" style="border-bottom: 1px solid"><strong>Équipements pour les 0 à 4 ans (%)</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Aire de jeux</td>
<td style="text-align: right;">69,8</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">83,2</td>
<td style="text-align: right;">71,4</td>
<td style="text-align: right;">88,1</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Jeux d'eau</td>
<td style="text-align: right;">7,8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2,5</td>
<td style="text-align: right;">18,4</td>
<td style="text-align: right;">6,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Pataugeoire</td>
<td style="text-align: right;">36,2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">47,2</td>
<td style="text-align: right;">2,0</td>
<td style="text-align: right;">29,8</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd" data-grouplength="7">
<td colspan="7" style="border-bottom: 1px solid"><strong>Terrains de sport (%)</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Athlétisme</td>
<td style="text-align: right;">12,1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2,0</td>
<td style="text-align: right;">2,0</td>
<td style="text-align: right;">1,2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Baseball</td>
<td style="text-align: right;">62,1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">50,8</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">19,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Basketball</td>
<td style="text-align: right;">37,9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">36,0</td>
<td style="text-align: right;">16,3</td>
<td style="text-align: right;">21,4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Football américain</td>
<td style="text-align: right;">15,5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7,1</td>
<td style="text-align: right;">8,2</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Soccer (football)</td>
<td style="text-align: right;">52,6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">29,9</td>
<td style="text-align: right;">87,8</td>
<td style="text-align: right;">7,1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Tennis</td>
<td style="text-align: right;">38,8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">32,5</td>
<td style="text-align: right;">8,2</td>
<td style="text-align: right;">14,3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Volleyball</td>
<td style="text-align: right;">7,8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4,6</td>
<td style="text-align: right;">12,2</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd" data-grouplength="4">
<td colspan="7" style="border-bottom: 1px solid"><strong>Équipements d'hiver (%)</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Glissade</td>
<td style="text-align: right;">19,8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3,0</td>
<td style="text-align: right;">2,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Patinoire</td>
<td style="text-align: right;">58,6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">59,4</td>
<td style="text-align: right;">34,7</td>
<td style="text-align: right;">46,4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Piste de ski de fond</td>
<td style="text-align: right;">7,8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Raquettes</td>
<td style="text-align: right;">12,1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even" data-grouplength="2">
<td colspan="7" style="border-bottom: 1px solid"><strong>Équipements spécialisés (%)</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Parc de planches à roulettes</td>
<td style="text-align: right;">6,0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0,5</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Patins à roues alignées</td>
<td style="text-align: right;">8,6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4,1</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd" data-grouplength="2">
<td colspan="7" style="border-bottom: 1px solid"><strong>Autres équipements (%)</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Piscine extérieure</td>
<td style="text-align: right;">27,6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">27,4</td>
<td style="text-align: right;">4,1</td>
<td style="text-align: right;">4,8</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Chemin de randonnée</td>
<td style="text-align: right;">12,9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even" data-grouplength="5">
<td colspan="7" style="border-bottom: 1px solid"><strong>Superficie (%)</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Moins d'un hectare</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">100,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">1 à 5 hectares</td>
<td style="text-align: right;">5,2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">98,5</td>
<td style="text-align: right;">100,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">5 à 10 hectares</td>
<td style="text-align: right;">61,2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">10 à 20 hectares</td>
<td style="text-align: right;">17,2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">20 hectares et plus</td>
<td style="text-align: right;">16,4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0,5</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even" data-grouplength="6">
<td colspan="7" style="border-bottom: 1px solid"><strong>Nombre moyen d'équipements selon le type</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Équipements pour les 0 à 4 ans</td>
<td style="text-align: right;">1,1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1,3</td>
<td style="text-align: right;">0,9</td>
<td style="text-align: right;">1,2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Terrains de sport</td>
<td style="text-align: right;">2,3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1,6</td>
<td style="text-align: right;">1,3</td>
<td style="text-align: right;">0,6</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Équipements d'hiver</td>
<td style="text-align: right;">1,0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0,6</td>
<td style="text-align: right;">0,4</td>
<td style="text-align: right;">0,5</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Équipements spécialisés</td>
<td style="text-align: right;">0,1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Autres équipements</td>
<td style="text-align: right;">0,4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0,3</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Tous les équipements</td>
<td style="text-align: right;">4,9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3,9</td>
<td style="text-align: right;">2,7</td>
<td style="text-align: right;">2,4</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd" data-grouplength="1">
<td colspan="7" style="border-bottom: 1px solid"><strong>Nombre d'observations par groupe</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1"></td>
<td style="text-align: right;">116,0</td>
<td style="text-align: right;">212</td>
<td style="text-align: right;">197,0</td>
<td style="text-align: right;">49,0</td>
<td style="text-align: right;">84,0</td>
<td style="text-align: right;">35</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<ul>
<li><p>Le premier groupe correspond à de grands parcs (superficie généralement comprise entre 5 et plus de 20 hectares), il comporte 116 observations. Ces grands parcs sont en moyenne équipés de deux terrains de sport et d’un équipement d’hiver. Il s’agit vraisemblablement des grands parcs identifiés dans l’article original, dans lesquels se retrouvent également les parcs à vocation métropolitaine.</p></li>
<li><p>Le second groupe (212 parcs) correspond à de très petits parcs (moins d’un hectare) comportant uniquement une aire de jeu.</p></li>
<li><p>Le troisième groupe (197 parcs) correspond à de petits parcs (entre 1 et 5 hectares), souvent équipés d’une piscine extérieure (27,4&nbsp;% des cas), et en moyenne de deux terrains de sports (essentiellement des terrains de tennis et de soccer). Ces parcs comprennent en moyenne plus de 4&nbsp;équipements et doivent donc correspondre à la classe D dans l’article original (Petit parc (1&nbsp;à 5&nbsp;ha) avec en moyenne six équipements, dont une patinoire et une piscine).</p></li>
<li><p>Le quatrième groupe (49 parcs) comprend de petits parcs (entre 1 et 5 hectares) qui ressemblent aux parcs du groupe 2 mais tendent à disposer en plus d’un terrain de sport (baseball ou basketball).</p></li>
<li><p>Le quatrième groupe (84 parcs) correspond à de petits parcs, il est caractérisé par une présence plus marquée de pataugeoires (39&nbsp;%).</p></li>
<li><p>Le cinquième groupe (35 parcs) est très similaire au second groupe (uniquement une aire de jeux), excepté sont les parcs qui s’y trouvent sont de taille supérieure (de 1 à 5 hectares).</p></li>
</ul>
<p>Considérant les différences minimes entre certains des groupes que nous avons obtenus, il est clair que retenir seulement trois ou cinq groupes serait préférable. Notez également l’importance du choix de la distance, car nous obtenons des résultats sensiblement différents de ceux de l’article original en ayant opté pour la distance du <span class="math inline">\(\Phi^2\)</span> plutôt que la distance euclidienne au carré.</p>
</section><section id="sec-13344" class="level4" data-number="13.3.4.4"><h4 data-number="13.3.4.4" class="anchored" data-anchor-id="sec-13344">
<span class="header-section-number">13.3.4.4</span> Utilisation de la matrice de distance euclidienne au carré</h4>
<p>Pour obtenir des résultats plus proches de ceux de l’article original, nous pouvons reprendre notre analyse et utiliser cette fois-ci une distance euclidienne au carré.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">X</span><span class="op">$</span><span class="va">groupe</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="co"># calcule de la matrice de distance</span></span>
<span><span class="va">parc_distances_euc</span> <span class="op">&lt;-</span> <span class="fu">dist</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html">as.matrix</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"Euclidean"</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span></span>
<span></span>
<span><span class="co"># Application de la CAH</span></span>
<span><span class="va">dendogramme_parcs_euc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">parc_distances_euc</span>, method <span class="op">=</span> <span class="st">"ward.D"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calcul de l'indice de silhouette</span></span>
<span><span class="va">ks</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">ks</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># découpage du dendrogramme</span></span>
<span>  <span class="va">groupes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">dendogramme_parcs_euc</span>, k <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="co"># calcul des valeurs de silhouette</span></span>
<span>  <span class="va">sil</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/silhouette.html">silhouette</a></span><span class="op">(</span><span class="va">groupes</span>, dist <span class="op">=</span> <span class="va">parc_distances_euc</span><span class="op">)</span></span>
<span>  <span class="co"># extraction de l'indice global (moyenne des moyennes)</span></span>
<span>  <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sil</span><span class="op">)</span><span class="op">$</span><span class="va">clus.avg.widths</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">idx</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># création d'un graphique avec les résultats</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  k <span class="op">=</span> <span class="va">ks</span>,</span>
<span>  silhouette <span class="op">=</span> <span class="va">values</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">silhouette</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">silhouette</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"nombre de groupes"</span>, y <span class="op">=</span> <span class="st">"indice global de silhouette"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-exampleHclust8" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-exampleHclust8-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.17: Valeur de l’indice de silhouette pour différents nombres de groupes (distance euclidienne au carré)</figcaption></figure>
</div>
</div>
</div>
<p>Nous constatons cette fois-ci, que quatre groupes serait probablement le meilleur choix et qu’au-delà de ce nombre, l’indice global de silhouette ne fait que diminuer. Tentons cependant de reproduire les résultats de l’article avec k = 6.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">resk6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">dendogramme_parcs_euc</span>, k <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calcul du nombre de fois ou chaque modalité est observée dans un groupe</span></span>
<span><span class="va">X</span><span class="op">$</span><span class="va">groupe</span> <span class="op">&lt;-</span> <span class="va">resk6</span></span>
<span><span class="va">df_groupes</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">groupe</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarise_all</span><span class="op">(</span>.funs <span class="op">=</span> <span class="va">sum</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calcul du nombre d'observations par groupe</span></span>
<span><span class="va">nb_gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">resk6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">groupe_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html">as.matrix</a></span><span class="op">(</span><span class="va">df_groupes</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df_groupes</span><span class="op">)</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">nb_gp</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">groupe_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">groupe_ratios</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">groupe_ratios</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"groupe "</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">groupe_ratios</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calcul du nombre moyen d'équipements par catégorie par parc</span></span>
<span><span class="va">equip_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AIRE_JEUX"</span>, <span class="st">"JEUX_EAU"</span>, <span class="st">"PATAUGEOIRE"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ATHLETISME"</span>, <span class="st">"BASEBALL_S"</span>, <span class="st">"BASKETBALL"</span>, <span class="st">"FOOTBALL"</span>, <span class="st">"SOCCER"</span>, <span class="st">"TENNIS"</span>, <span class="st">"VOLLEY_BALL"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TOBBOGAN_G"</span>, <span class="st">"PATINOIRE_E"</span>, <span class="st">"RAQUETTES"</span>, <span class="st">"SKI_FOND"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PATIN_ROUE"</span>, <span class="st">"ROULI_ROUL"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PISC_EXT"</span>, <span class="st">"RANDONNEE"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_compte</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">equip_class</span>, <span class="kw">function</span><span class="op">(</span><span class="va">equip</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="va">equip</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">class_compte</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"enfants"</span>, <span class="st">"terrain_sport"</span>, <span class="st">"hiver"</span>, <span class="st">"specialise"</span>, <span class="st">"autre"</span><span class="op">)</span></span>
<span><span class="va">class_compte</span><span class="op">$</span><span class="va">groupe</span> <span class="op">&lt;-</span> <span class="va">resk6</span></span>
<span><span class="va">df_class_equip</span> <span class="op">&lt;-</span> <span class="va">class_compte</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">groupe</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise_all</span><span class="op">(</span><span class="va">mean</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_class_equip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">df_class_equip</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df_class_equip</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df_class_equip</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"groupe "</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df_class_equip</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># comptage du nombre moyen d'équipements</span></span>
<span><span class="va">df_equip_tot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  nb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">18</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  groupe <span class="op">=</span> <span class="va">resk6</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df_equip_tot_mean</span> <span class="op">&lt;-</span> <span class="va">df_equip_tot</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">groupe</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize_all</span><span class="op">(</span><span class="va">mean</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># mise dans l'ordre de la première partie du tableau</span></span>
<span><span class="va">all_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">equip_class</span><span class="op">)</span></span>
<span><span class="va">idxs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">all_types</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">groupe_ratios</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">all_types</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">groupe_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">groupe_ratios</span><span class="op">[</span><span class="va">idxs</span>,<span class="op">]</span>,</span>
<span>                       <span class="va">groupe_ratios</span><span class="op">[</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">all_types</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">groupe_ratios</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combinaison des deux tableaux</span></span>
<span><span class="va">groupe_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">groupe_ratios</span>, <span class="va">df_class_equip</span>, <span class="va">df_equip_tot_mean</span><span class="op">$</span><span class="va">nb</span>, <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">nb_gp</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Recréons le tableau final des résultats au <a href="#tbl-exampleHclust10">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-exampleHclust10</span></a>. Si vous comparez ce tableau avec celui de l’article original, vous verrez que notre groupe 3 correspond exactement à la classe&nbsp;A et que notre groupe&nbsp;5 correspond exactement à la classe F. Pour les autres groupes, nous pouvons observer de légères variations, ce qui correspond vraisemblablement à des divergences d’implémentation des algorithmes entre le logiciel utilisé pour l’article (SAS) et R.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="tbl-exampleHclust10" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;13.6: Caractéristiques des groupes obtenus lors de la CAH (distance euclidienne au carré)</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">groupe 1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">groupe 2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">groupe 3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">groupe 4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">groupe 5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">groupe 6</th>
</tr></thead>
<tbody>
<tr class="odd" data-grouplength="3">
<td colspan="7" style="border-bottom: 1px solid"><strong>Équipements pour les 0 à 4 ans (%)</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Aire de jeux</td>
<td style="text-align: right;">79,6</td>
<td style="text-align: right;">74,2</td>
<td style="text-align: right;">96,6</td>
<td style="text-align: right;">100,0</td>
<td style="text-align: right;">20,0</td>
<td style="text-align: right;">79,3</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Jeux d'eau</td>
<td style="text-align: right;">11,1</td>
<td style="text-align: right;">3,0</td>
<td style="text-align: right;">1,7</td>
<td style="text-align: right;">5,1</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">5,9</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Pataugeoire</td>
<td style="text-align: right;">59,3</td>
<td style="text-align: right;">42,4</td>
<td style="text-align: right;">8,4</td>
<td style="text-align: right;">61,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">19,7</td>
</tr>
<tr class="odd" data-grouplength="7">
<td colspan="7" style="border-bottom: 1px solid"><strong>Terrains de sport (%)</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Athlétisme</td>
<td style="text-align: right;">13,0</td>
<td style="text-align: right;">15,2</td>
<td style="text-align: right;">0,3</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">1,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Baseball</td>
<td style="text-align: right;">88,9</td>
<td style="text-align: right;">63,6</td>
<td style="text-align: right;">5,4</td>
<td style="text-align: right;">89,8</td>
<td style="text-align: right;">6,7</td>
<td style="text-align: right;">13,8</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Basketball</td>
<td style="text-align: right;">83,3</td>
<td style="text-align: right;">30,3</td>
<td style="text-align: right;">6,1</td>
<td style="text-align: right;">35,6</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">18,2</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Football</td>
<td style="text-align: right;">31,5</td>
<td style="text-align: right;">12,1</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">10,2</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">2,5</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Soccer (football)</td>
<td style="text-align: right;">75,9</td>
<td style="text-align: right;">57,6</td>
<td style="text-align: right;">2,0</td>
<td style="text-align: right;">27,1</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">33,5</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Tennis</td>
<td style="text-align: right;">90,7</td>
<td style="text-align: right;">19,7</td>
<td style="text-align: right;">4,1</td>
<td style="text-align: right;">35,6</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">14,8</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Volleyball</td>
<td style="text-align: right;">20,4</td>
<td style="text-align: right;">3,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">1,7</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">4,9</td>
</tr>
<tr class="odd" data-grouplength="4">
<td colspan="7" style="border-bottom: 1px solid"><strong>Équipements d'hiver (%)</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Glissade</td>
<td style="text-align: right;">14,8</td>
<td style="text-align: right;">16,7</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">1,7</td>
<td style="text-align: right;">33,3</td>
<td style="text-align: right;">2,5</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Patinoire</td>
<td style="text-align: right;">87,0</td>
<td style="text-align: right;">57,6</td>
<td style="text-align: right;">13,2</td>
<td style="text-align: right;">86,4</td>
<td style="text-align: right;">26,7</td>
<td style="text-align: right;">30,5</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Piste de ski de fond</td>
<td style="text-align: right;">1,9</td>
<td style="text-align: right;">1,5</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">46,7</td>
<td style="text-align: right;">0,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Raquettes</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">1,5</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">86,7</td>
<td style="text-align: right;">0,0</td>
</tr>
<tr class="even" data-grouplength="2">
<td colspan="7" style="border-bottom: 1px solid"><strong>Équipements spécialisés (%)</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Parc de planches à roulettes</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">1,7</td>
<td style="text-align: right;">46,7</td>
<td style="text-align: right;">0,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Patins à roues alignées</td>
<td style="text-align: right;">16,7</td>
<td style="text-align: right;">7,6</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">5,1</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,5</td>
</tr>
<tr class="odd" data-grouplength="2">
<td colspan="7" style="border-bottom: 1px solid"><strong>Autres équipements (%)</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Piscine extérieure</td>
<td style="text-align: right;">75,9</td>
<td style="text-align: right;">16,7</td>
<td style="text-align: right;">1,4</td>
<td style="text-align: right;">11,9</td>
<td style="text-align: right;">6,7</td>
<td style="text-align: right;">13,8</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Chemin de randonnée</td>
<td style="text-align: right;">1,9</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">93,3</td>
<td style="text-align: right;">0,0</td>
</tr>
<tr class="even" data-grouplength="5">
<td colspan="7" style="border-bottom: 1px solid"><strong>Superficie (%)</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Moins d'un hectare</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">100,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">1 à 5 hectares</td>
<td style="text-align: right;">42,6</td>
<td style="text-align: right;">1,5</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">98,3</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">99,5</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">5 à 10 hectares</td>
<td style="text-align: right;">46,3</td>
<td style="text-align: right;">69,7</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">10 à 20 hectares</td>
<td style="text-align: right;">1,9</td>
<td style="text-align: right;">27,3</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">13,3</td>
<td style="text-align: right;">0,5</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">20 hectares et plus</td>
<td style="text-align: right;">9,3</td>
<td style="text-align: right;">1,5</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">1,7</td>
<td style="text-align: right;">86,7</td>
<td style="text-align: right;">0,0</td>
</tr>
<tr class="even" data-grouplength="6">
<td colspan="7" style="border-bottom: 1px solid"><strong>Nombre moyen d'équipements selon le type</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Équipements pour les 0 à 4 ans</td>
<td style="text-align: right;">1,5</td>
<td style="text-align: right;">1,2</td>
<td style="text-align: right;">1,1</td>
<td style="text-align: right;">1,7</td>
<td style="text-align: right;">0,2</td>
<td style="text-align: right;">1,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Terrains de sport</td>
<td style="text-align: right;">4,0</td>
<td style="text-align: right;">2,0</td>
<td style="text-align: right;">0,2</td>
<td style="text-align: right;">2,0</td>
<td style="text-align: right;">0,1</td>
<td style="text-align: right;">0,9</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Équipements d'hiver</td>
<td style="text-align: right;">1,0</td>
<td style="text-align: right;">0,8</td>
<td style="text-align: right;">0,1</td>
<td style="text-align: right;">0,9</td>
<td style="text-align: right;">1,9</td>
<td style="text-align: right;">0,3</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Équipements spécialisés</td>
<td style="text-align: right;">0,2</td>
<td style="text-align: right;">0,1</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,1</td>
<td style="text-align: right;">0,5</td>
<td style="text-align: right;">0,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Autres équipements</td>
<td style="text-align: right;">0,8</td>
<td style="text-align: right;">0,2</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">0,1</td>
<td style="text-align: right;">1,0</td>
<td style="text-align: right;">0,1</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Tous les équipements</td>
<td style="text-align: right;">7,5</td>
<td style="text-align: right;">4,2</td>
<td style="text-align: right;">1,4</td>
<td style="text-align: right;">4,7</td>
<td style="text-align: right;">3,7</td>
<td style="text-align: right;">2,4</td>
</tr>
<tr class="odd" data-grouplength="1">
<td colspan="7" style="border-bottom: 1px solid"><strong>Nombre d'observations par groupe</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1"></td>
<td style="text-align: right;">54,0</td>
<td style="text-align: right;">66,0</td>
<td style="text-align: right;">296,0</td>
<td style="text-align: right;">59,0</td>
<td style="text-align: right;">15,0</td>
<td style="text-align: right;">203,0</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</section></section></section><section id="sec-134" class="level2" data-number="13.4"><h2 data-number="13.4" class="anchored" data-anchor-id="sec-134">
<span class="header-section-number">13.4</span> Nuées dynamiques</h2>
<p>Les méthodes des nuées dynamiques regroupent plusieurs algorithmes, tous plus ou moins liés avec l’algorithme le plus connu&nbsp;: <em>k-means</em>, originalement proposé par James MacQueen <span class="citation" data-cites="macqueen1967">(<a href="#ref-macqueen1967" role="doc-biblioref">1967</a>)</span>. Nous présentons également ici plusieurs variantes du <em>k-means</em>, soit le <em>k-medians</em>, le <em>k-medioids</em>, le <em>c-means</em> et le <em>c-medians</em>.</p>
<section id="sec-1341" class="level3" data-number="13.4.1"><h3 data-number="13.4.1" class="anchored" data-anchor-id="sec-1341">
<span class="header-section-number">13.4.1</span> <em>K-means</em>
</h3>
<section id="sec-13411" class="level4" data-number="13.4.1.1"><h4 data-number="13.4.1.1" class="anchored" data-anchor-id="sec-13411">
<span class="header-section-number">13.4.1.1</span> Fonctionnement de l’algorithme</h4>
<p>Nous commençons ici par détailler le fonctionnement de cet algorithme afin de mieux le cerner. D’emblée, cet algorithme nécessite que certains éléments soient définis d’avance&nbsp;:</p>
<ul>
<li><p>Une matrice de données <em>X</em> comportant <em>n</em> lignes (nombre d’observations) et <em>p</em> colonnes (nombre de variables). Chaque variable de cette matrice doit être quantitative et continue et de préférence dans une échelle standardisée (par exemple des variables centrées réduites).</p></li>
<li><p>Le nombre de groupes à identifier <em>k</em> doit être choisi par l’utilisateur ou l’utilisatrice.</p></li>
<li><p>La distance <em>d</em> à utiliser entre les observations.</p></li>
</ul>
<p>Le fonctionnement classique du <em>k-means</em> est le suivant&nbsp;:</p>
<ol type="1">
<li><p>Définir <em>k</em> centres de groupes de façon aléatoire.</p></li>
<li><p>Déterminer pour chaque observation le centre de son groupe le plus proche en utilisant la fonction de distance.</p></li>
<li><p>Pour chacun des groupes ainsi formés, recalculer le centre du groupe en calculant le centroïde (moyennes le plus souvent) des observations appartenant à ce groupe.</p></li>
<li><p>Répéter l’opération 2 avec les nouveaux centres.</p></li>
<li><p>Calculer l’inertie expliquée par la nouvelle classification.</p></li>
<li><p>Comparer cette inertie expliquée avec celle obtenue lors de l’itération précédente.</p></li>
<li><p>Si la variation entre les deux valeurs est supérieure à une certaine limite, reprendre à l’étape 2, sinon, l’algorithme prend fin.</p></li>
</ol>
<p>Ainsi, l’algorithme <em>k-means</em> part d’une première classification obtenue aléatoirement et la raffine jusqu’au point où l’amélioration de la classification devient négligeable. Du fait de ce point de départ aléatoire, cet algorithme est dit heuristique, car deux exécutions risquent de ne pas donner exactement le même résultat. Par conséquent, en relaçant l’algorithme, vous pourriez obtenir des résultats légèrement différents, avec par exemple des groupes similaires, mais obtenus dans un autre ordre, le groupe 1 étant devenu le groupe 3 et vice-versa. Il est aussi possible d’obtenir des résultats radicalement différents d’une tentative à l’autre, ce qui signifie que les groupes formés sont très instables et ne sont pas représentatifs de la population étudiée.</p>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>Réplicabilité des résultats dans R</strong></p>
</div>
<div class="bloc_astuce-body">
<p>Lorsqu’une méthode heuristique ou faisant appel au hasard est utilisée dans R, il est nécessaire de s’assurer que les résultats sont reproductibles. Cela permet notamment de relancer le même code et de réobtenir exactement les mêmes résultats : l’idée étant de figer le hasard.</p>
<p>Ultimement, un programme informatique est incapable de générer un résultat véritablement aléatoire, car il ne fait que suivre une suite d’opérations prédéterminées. Pour générer des résultats qui ressemblent au hasard, des algorithmes ont été proposés, partant d’une configuration initiale et appliquant une série d’opérations complexes permettant de générer des nombres semblant se distribuer aléatoirement. Si nous connaissons le point de départ de la suite d’opérations et que nous réappliquons ces dernières, alors nous sommes certains d’obtenir le même résultat. Il est possible, dans R, de définir un <em>état initial de hasard</em> à l’aide de la fonction <code>set.seed</code>. Avec ce point de départ défini, nous sommes certains d’obtenir les mêmes résultats en relançant les mêmes opérations.</p>
<p>Prenons un exemple concret en sélectionnant aléatoire 3 chiffres dans un vecteur allant de 1 à 10.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">vec</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span></span>
<span><span class="co"># prenons un premier échantillon</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">vec</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 9 3</code></pre>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># et un second échantillon </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">vec</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  6 10  8</code></pre>
</div>
</div>
<p>Nous obtenons bien deux échantillons différents. Recommençons en utilisant la fonction <code>set.seed</code> pour obtenir cette fois-ci des résultats identiques.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">vec</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span></span>
<span><span class="co"># prenons un premier échantillon</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">vec</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3 10  2</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># et un second échantillon </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">vec</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3 10  2</code></pre>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># prenons un troisème échantillon</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">4568997</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">vec</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5 6 7</code></pre>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># et un quatrième échantillon </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">4568997</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">vec</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5 6 7</code></pre>
</div>
</div>
<p>Vous constatez que nous utilisons cette fonction plusieurs fois au cours de cette section. Elle nous permet de nous assurer que les résultats obtenus ne changent pas entre le moment où nous écrivons le livre et le moment où nous le formatons. Sinon, le texte pourrait ne plus être en phase avec les images ou les tableaux.</p>
</div>
</div>
<p>Pour mieux comprendre le fonctionnement du <em>k-means</em>, nous proposons ici une visualisation de ses différentes itérations (<a href="#fig-kmeansA">figure&nbsp;<span class="quarto-unresolved-ref">fig-kmeansA</span></a>). Nous pouvons constater que, pour ce jeu de données relativement simple, l’algorithme converge très rapidement et que sa solution varie peu au-delà de la troisième itération. L’amination de la <a href="#fig-kmeansA">figure&nbsp;<span class="quarto-unresolved-ref">fig-kmeansA</span></a> illustre pourquoi le <em>k-means</em> est appelé algorithme de nuées dynamiques.</p>
<div id="fig-kmeansA" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap13/kmeansGif.gif" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.18: Algorithme K-means</figcaption></figure>
</div>
<div class="bloc_notes">
<div class="bloc_notes-header">
<div class="bloc_notes-icon">

</div>
<p><strong>Centre de groupe et <em>k-means</em></strong></p>
</div>
<div class="bloc_notes-body">
<p>À nouveau, puisque chaque itération du <em>k-means</em> nécessite de recalculer les centres des groupes formés, des problèmes peuvent être rencontrés avec certains types de distance. C’est pourquoi il est recommandé d’utiliser la distance euclidienne avec le <em>k-means</em> original. Si des distances plus complexes doivent être utilisées, il est préférable d’utiliser la classification ascendante hiérarchique.</p>
</div>
</div>
</section><section id="sec-13412" class="level4" data-number="13.4.1.2"><h4 data-number="13.4.1.2" class="anchored" data-anchor-id="sec-13412">
<span class="header-section-number">13.4.1.2</span> Choix du nombre optimal de groupes</h4>
<p>Comme pour la CAH, le principal enjeu avec le <em>k-means</em> est de déterminer le nombre idéal de groupes pour effectuer la classification. Si ce nombre n’est pas connu à l’avance et qu’aucune forte justification théorique n’existe, il est possible d’utiliser les mêmes techniques que pour la CAH, soit la méthode du coude, l’indicateur de silhouette ou la méthode GAP.</p>
</section></section><section id="sec-1342" class="level3" data-number="13.4.2"><h3 data-number="13.4.2" class="anchored" data-anchor-id="sec-1342">
<span class="header-section-number">13.4.2</span> K-médianes</h3>
<p>Le <em>k-medians</em> est une variante du <em>k-means</em>. Contrairement au <em>k-means</em> privilégiant la distance euclidienne, le <em>k-medians</em> est à utiliser en priorité avec une distance de Manhattan. En effet, le centre d’un groupe n’est pas déterminé comme la moyenne des variables des observations appartenant à ce groupe (<em>k-means</em>), mais comme la médiane pour chaque variable (<em>k-medians</em>). En dehors de ces deux spécificités, il reprend le fonctionnement décrit plus haut pour le <em>k-means</em>. Il est particulièrement pertinent de l’utiliser quand un jeu de données comprend un très grand nombre de colonnes, car dans ce contexte, la distance euclidienne peine à représenter les différences entre les observations. De plus, l’utilisation de la médiane le rend moins sensible aux valeurs extrêmes.</p>
</section><section id="sec-1343" class="level3" data-number="13.4.3"><h3 data-number="13.4.3" class="anchored" data-anchor-id="sec-1343">
<span class="header-section-number">13.4.3</span> K-médoïds</h3>
<p>Le <em>k-médoïds</em> est également une variante du <em>k-means</em>. Le <em>k-means</em> crée des groupes en cherchant les centres de ces groupes dans l’espace multidimensionnel des données. Ces centres de groupes peuvent très bien ne pas correspondre à un point du jeu de données, au même titre que la moyenne d’une variable ne coïncide que rarement avec une observation réelle de cette variable. Pour le <em>k-médoïds</em>, les groupes sont formés en cherchant les centres de ces groupes <strong>parmi</strong> les observations du jeu de données. Ainsi, chaque groupe est centré sur une observation réelle, la plus similaire à l’ensemble des observations du groupe.</p>
<p>L’algorithme effectue les opérations suivantes&nbsp;:</p>
<ol type="1">
<li><p>Sélectionner aléatoirement <em>k</em> observations du jeu de données, elles constituent les centres des groupes initiaux.</p></li>
<li><p>Attribuer chaque observation au centre du groupe le plus proche.</p></li>
<li><p>Tant que la nouvelle solution est plus efficace, effectuer les opérations suivantes&nbsp;:</p></li>
</ol>
<ul>
<li>pour chaque centre <em>m</em> et pour chaque observation <em>o</em>,
<ul>
<li>considérer l’inversion de <em>m</em> et <em>o</em>
</li>
<li>si cette permutation est meilleure que les précédentes, la conserver en mémoire</li>
</ul>
</li>
<li>effectuer la meilleure permutation retenue si elle améliore la classification, sinon l’algorithme prend fin.</li>
</ul>
<p>Le <em>k-médoïds</em> est moins utilisé que le <em>k-means</em>, mais il est plus performant quand des distances autres que la distance euclidienne sont utilisées ou encore que des valeurs aberrantes/extrêmes sont présentes dans les données.</p>
</section><section id="sec-1344" class="level3" data-number="13.4.4"><h3 data-number="13.4.4" class="anchored" data-anchor-id="sec-1344">
<span class="header-section-number">13.4.4</span> Mise en œuvre dans R</h3>
<p>Pour cet exemple, nous proposons d’utiliser le jeu de données spatiales <code>LyonIris</code> du <em>package</em> <code>geocmeans</code>. Ce jeu de données spatiales pour l’agglomération lyonnaise (France) comprend dix variables, dont quatre environnementales (EN) et six socioéconomiques (SE), pour les îlots regroupés pour l’information statistique (IRIS) de l’agglomération lyonnaise (<a href="#tbl-datageocmeans">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-datageocmeans</span></a> et <a href="#fig-datacartoacp">figure&nbsp;<span class="quarto-unresolved-ref">fig-datacartoacp</span></a>). Nous proposons de réaliser une analyse similaire à celle de l’article de <span class="citation" data-cites="2021_4">Gelb et Apparicio (<a href="#ref-2021_4" role="doc-biblioref">2021</a>)</span>, soit de classer les IRIS de Lyon selon ces caractéristiques pour déterminer si certains groupes d’IRIS combinent des situations désavantageuses sur les plans sociaux et environnementaux, dans une perspective d’équité environnementale.</p>
<p>Notez ici que la fonction <code>st_drop_geometry</code> provenant du package <code>sf</code> permet de retirer l’information géographique du jeu de données <code>LyonIris</code> pour obtenir un simple <code>dataframe</code>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-datageocmeans" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;13.7: Statistiques descriptives du jeu de données LyonIris</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 34%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Nom</th>
<th style="text-align: left;">Intitulé</th>
<th style="text-align: center;">Type</th>
<th style="text-align: right;">Moy.</th>
<th style="text-align: right;">E.-T.</th>
<th style="text-align: right;">Min.</th>
<th style="text-align: right;">Max.</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lden</td>
<td style="text-align: left;">Lden</td>
<td style="text-align: left;">Bruit routier (Lden dB(A))</td>
<td style="text-align: center;">EN</td>
<td style="text-align: right;">55,6</td>
<td style="text-align: right;">4,9</td>
<td style="text-align: right;">33,9</td>
<td style="text-align: right;">71,7</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO2</td>
<td style="text-align: left;">NO2</td>
<td style="text-align: left;">Dioxyde d’azote (ug/m<sup>3</sup>)</td>
<td style="text-align: center;">EN</td>
<td style="text-align: right;">28,7</td>
<td style="text-align: right;">7,9</td>
<td style="text-align: right;">12,0</td>
<td style="text-align: right;">60,2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PM25</td>
<td style="text-align: left;">PM25</td>
<td style="text-align: left;">Particules fines (PM<span class="math inline">\(_{2,5}\)</span>)</td>
<td style="text-align: center;">EN</td>
<td style="text-align: right;">16,8</td>
<td style="text-align: right;">2,1</td>
<td style="text-align: right;">11,3</td>
<td style="text-align: right;">21,9</td>
</tr>
<tr class="even">
<td style="text-align: left;">VegHautPrt</td>
<td style="text-align: left;">VegHautPrt</td>
<td style="text-align: left;">Canopée (%)</td>
<td style="text-align: center;">EN</td>
<td style="text-align: right;">18,7</td>
<td style="text-align: right;">10,1</td>
<td style="text-align: right;">1,7</td>
<td style="text-align: right;">53,8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct0_14</td>
<td style="text-align: left;">Pct0_14</td>
<td style="text-align: left;">Moins de 15 ans (%)</td>
<td style="text-align: center;">SE</td>
<td style="text-align: right;">18,5</td>
<td style="text-align: right;">5,7</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">54,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pct_65</td>
<td style="text-align: left;">Pct_65</td>
<td style="text-align: left;">65 ans et plus (%)</td>
<td style="text-align: center;">SE</td>
<td style="text-align: right;">16,2</td>
<td style="text-align: right;">5,9</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">45,1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_Img</td>
<td style="text-align: left;">Pct_Img</td>
<td style="text-align: left;">Immigrants (%)</td>
<td style="text-align: center;">SE</td>
<td style="text-align: right;">14,5</td>
<td style="text-align: right;">9,1</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">59,8</td>
</tr>
<tr class="even">
<td style="text-align: left;">TxChom1564</td>
<td style="text-align: left;">TxChom1564</td>
<td style="text-align: left;">Taux de chômage</td>
<td style="text-align: center;">SE</td>
<td style="text-align: right;">14,8</td>
<td style="text-align: right;">8,1</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">98,8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pct_brevet</td>
<td style="text-align: left;">Pct_brevet</td>
<td style="text-align: left;">Personnes à faible scolarité (%)</td>
<td style="text-align: center;">SE</td>
<td style="text-align: right;">23,5</td>
<td style="text-align: right;">12,6</td>
<td style="text-align: right;">0,0</td>
<td style="text-align: right;">100,0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NivVieMed</td>
<td style="text-align: left;">NivVieMed</td>
<td style="text-align: left;">Médiane du niveau de vie (Euros)</td>
<td style="text-align: center;">SE</td>
<td style="text-align: right;">21 804,5</td>
<td style="text-align: right;">4 922,5</td>
<td style="text-align: right;">11 324,0</td>
<td style="text-align: right;">38 707,0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="sec-13441" class="level4" data-number="13.4.4.1"><h4 data-number="13.4.4.1" class="anchored" data-anchor-id="sec-13441">
<span class="header-section-number">13.4.4.1</span> Préparation des données</h4>
<p>La première étape consiste donc à charger les données et à les préparer pour l’analyse. Toutes les variables que nous utilisons sont des variables continues. Cependant, elles ne sont pas exprimées dans la même échelle, nous proposons donc de les standardiser ici en les centrant (moyenne = 0) et en les réduisant (écart-type = 1). Cette opération peut être effectuée simplement dans R en utilisant la fonction <code>scale</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Chargement des données</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JeremyGelb/geocmeans">geocmeans</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># NB : LyonIris est un objet spatial, il faut donc extraire uniquement son DataFrame</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Lden"</span> , <span class="st">"NO2"</span> , <span class="st">"PM25"</span> , <span class="st">"VegHautPrt"</span> , <span class="st">"Pct0_14"</span> , <span class="st">"Pct_65"</span> , <span class="st">"Pct_Img"</span>,</span>
<span>                     <span class="st">"TxChom1564"</span> , <span class="st">"Pct_brevet"</span> , <span class="st">"NivVieMed"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Centrage et réduction de chaque colonne du DataFrame</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">col</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">X</span><span class="op">[[</span><span class="va">col</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">X</span><span class="op">[[</span><span class="va">col</span><span class="op">]</span><span class="op">]</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-13442" class="level4" data-number="13.4.4.2"><h4 data-number="13.4.4.2" class="anchored" data-anchor-id="sec-13442">
<span class="header-section-number">13.4.4.2</span> Choix du nombre de groupes optimal</h4>
<p>La seconde étape consiste à déterminer le nombre de groupes optimal. Pour cela, nous comparons les résultats des trois méthodes proposées&nbsp;: la méthode du coude, l’indice de silhouette et la méthode GAP. Pour chaque méthode, nous testons les nombres de groupes de 2 à 10.</p>
<section id="sec-134421" class="level5" data-number="13.4.4.2.1"><h5 data-number="13.4.4.2.1" class="anchored" data-anchor-id="sec-134421">
<span class="header-section-number">13.4.4.2.1</span> Méthode du coude</h5>
<p>Commençons par appliquer la méthode du coude. Nous calculons donc l’inertie expliquée par la classification pour différentes valeurs de <em>k</em> (nombre de groupes) avant de construire la <a href="#fig-kmeansC">figure&nbsp;<span class="quarto-unresolved-ref">fig-kmeansC</span></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ks</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span></span>
<span></span>
<span><span class="co">## ---- Méthode du coude ---- ##</span></span>
<span><span class="va">inertie_exps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">ks</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># calcul du kmeans avec k</span></span>
<span>  <span class="va">resultat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">X</span>, centers <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="co"># calcul de l'inertie expliquée (1 - inertie intragroupe / inertie totale)</span></span>
<span>  <span class="va">inertie_exp</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">resultat</span><span class="op">$</span><span class="va">withinss</span><span class="op">)</span> <span class="op">/</span> <span class="va">resultat</span><span class="op">$</span><span class="va">totss</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">inertie_exp</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  k <span class="op">=</span> <span class="va">ks</span>,</span>
<span>  inertie_exp <span class="op">=</span> <span class="va">inertie_exps</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">inertie_exp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">inertie_exp</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"nombre de groupes"</span>, y <span class="op">=</span> <span class="st">"inertie expliquée (%)"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-kmeansC" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-kmeansC-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.19: Inertie expliquée pour différents nombres de groupes pour le k-means</figcaption></figure>
</div>
</div>
</div>
<p>Dans l’article original, quatre groupes avaient été retenus. Nous pouvons constater ici qu’un coude fort se situe à k = 3 et qu’au-delà de cette limite, l’ajout d’un groupe supplémentaire contribue à expliquer une plus petite partie de l’inertie supplémentaire comparativement au précédent.</p>
</section><section id="sec-134422" class="level5" data-number="13.4.4.2.2"><h5 data-number="13.4.4.2.2" class="anchored" data-anchor-id="sec-134422">
<span class="header-section-number">13.4.4.2.2</span> Indice de silhouette</h5>
<p>Poursuivons avec l’indice de silhouette calculé de nouveau avec des valeurs de <em>k</em> allant de 2 à 10. Notez que nous devons au préalable créer une matrice de distances entre les observations du jeu de données pour construire notre indice de silhouette. Puisque nous utilisons l’algorithme <em>k-means</em>, nous utilisons la distance euclidienne.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ks</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span></span>
<span></span>
<span><span class="co"># calcul d'une matrice de distance euclidienne entre les observations</span></span>
<span><span class="va">dist_mat</span> <span class="op">&lt;-</span> <span class="fu">dist</span><span class="op">(</span><span class="va">X</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ---- indice de silhouette ---- ##</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">ks</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">resultat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">X</span>, centers <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="va">groupes</span> <span class="op">&lt;-</span> <span class="va">resultat</span><span class="op">$</span><span class="va">cluster</span></span>
<span>  <span class="co"># calcul des valeurs de silhouette</span></span>
<span>  <span class="va">sil</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/silhouette.html">silhouette</a></span><span class="op">(</span><span class="va">groupes</span>, dist <span class="op">=</span> <span class="va">dist_mat</span><span class="op">)</span></span>
<span>  <span class="co"># extraction de l'indice global (moyenne des moyennes)</span></span>
<span>  <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sil</span><span class="op">)</span><span class="op">$</span><span class="va">clus.avg.widths</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">idx</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  k <span class="op">=</span> <span class="va">ks</span>,</span>
<span>  silhouette <span class="op">=</span> <span class="va">values</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">silhouette</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">silhouette</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"nombre de groupes"</span>, y <span class="op">=</span> <span class="st">"Indice de silhouette"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-kmeansD" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-kmeansD-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.20: Indice de silhouette pour différents nombres de groupes pour le k-means</figcaption></figure>
</div>
</div>
</div>
<p>À nouveau, la <a href="#fig-kmeansD">figure&nbsp;<span class="quarto-unresolved-ref">fig-kmeansD</span></a> indique que le nombre de groupes optimal est trois selon l’indice de silhouette.</p>
</section><section id="sec-134423" class="level5" data-number="13.4.4.2.3"><h5 data-number="13.4.4.2.3" class="anchored" data-anchor-id="sec-134423">
<span class="header-section-number">13.4.4.2.3</span> Méthode GAP</h5>
<p>Pour appliquer la méthode GAP, nous proposons d’utiliser la fonction <code>clusGap</code> du <em>package</em> <code>NbClust</code>. Pour l’utiliser, il est nécessaire de définir une fonction renvoyant pour le nombre de groupes <em>k</em> et le jeu de données <em>x</em> une liste comprenant un vecteur attribuant chaque observation à chaque groupe. Il est possible de considérer ce type de fonction comme un «&nbsp;adaptateur&nbsp;».</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sites.google.com/site/malikacharrad/research/nbclust-package">NbClust</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># définition de la fonction adaptateur</span></span>
<span><span class="va">adaptor</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">k</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">clust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"cluster"</span> <span class="op">=</span> <span class="va">clust</span><span class="op">$</span><span class="va">cluster</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># calcul de la méthode GAP</span></span>
<span><span class="va">vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/clusGap.html">clusGap</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">adaptor</span>, K.max <span class="op">=</span> <span class="fl">10</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">vals</span><span class="op">$</span><span class="va">Tab</span><span class="op">)</span></span>
<span><span class="va">tab</span><span class="op">$</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># détermination des valeurs de k retenues par la méthode (1ere et 2e)</span></span>
<span><span class="va">is_valid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">tab</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>,<span class="st">"gap"</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="op">(</span><span class="va">tab</span><span class="op">[</span><span class="va">i</span>,<span class="st">"gap"</span><span class="op">]</span> <span class="op">-</span> <span class="va">tab</span><span class="op">[</span><span class="va">i</span>,<span class="st">"SE.sim"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">valids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">tab</span>, <span class="va">is_valid</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">valids2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">tab</span>, <span class="va">is_valid</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># réalisation du graphique</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">tab</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">gap</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_segment</span><span class="op">(</span>x <span class="op">=</span> <span class="va">valids</span><span class="op">$</span><span class="va">k</span>, xend <span class="op">=</span> <span class="va">valids</span><span class="op">$</span><span class="va">k</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">tab</span><span class="op">$</span><span class="va">gap</span><span class="op">)</span>, yend <span class="op">=</span> <span class="va">valids</span><span class="op">$</span><span class="va">gap</span>, </span>
<span>               linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_segment</span><span class="op">(</span>x <span class="op">=</span> <span class="va">valids2</span><span class="op">$</span><span class="va">k</span>, xend <span class="op">=</span> <span class="va">valids2</span><span class="op">$</span><span class="va">k</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">tab</span><span class="op">$</span><span class="va">gap</span><span class="op">)</span>, yend <span class="op">=</span> <span class="va">valids2</span><span class="op">$</span><span class="va">gap</span>, </span>
<span>               linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">gap</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"nombre de groupes"</span>, y <span class="op">=</span> <span class="st">"GAP"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-kmeansE" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-kmeansE-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.21: Méthode GAP pour différents nombres de groupes pour le k-means</figcaption></figure>
</div>
</div>
</div>
<p>La <a href="#fig-kmeansE">figure&nbsp;<span class="quarto-unresolved-ref">fig-kmeansE</span></a> indique également que le nombre de groupes à retenir est trois. Nous retenons cependant quatre groupes pour pouvoir plus facilement comparer nos résultats avec ceux de l’article original.</p>
</section></section><section id="sec-13443" class="level4" data-number="13.4.4.3"><h4 data-number="13.4.4.3" class="anchored" data-anchor-id="sec-13443">
<span class="header-section-number">13.4.4.3</span> Application l’algorithme du <em>k-means</em>
</h4>
<p>Maintenant que nous avons choisi le nombre de groupes à former, nous pouvons simplement appliquer la fonction <code>kmeans</code> présente de base dans R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">145</span><span class="op">)</span></span>
<span><span class="va">resultats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">X</span>, centers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-13444" class="level4" data-number="13.4.4.4"><h4 data-number="13.4.4.4" class="anchored" data-anchor-id="sec-13444">
<span class="header-section-number">13.4.4.4</span> Interprétation des résultats</h4>
<p>Une fois les groupes obtenus, l’étape la plus importante est de parvenir à interpréter ces groupes. Pour cela, il est nécessaire de les explorer en profondeur au travers des variables utilisées pour les constituer. Dans notre cas, le jeu de données <code>LyonIris</code> est spatialisé, nous pouvons donc commencer par cartographier les groupes.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-tmap.github.io/tmap/">tmap</a></span><span class="op">)</span></span>
<span><span class="va">LyonIris</span><span class="op">$</span><span class="va">groupes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"groupe"</span>, <span class="va">resultats</span><span class="op">$</span><span class="va">cluster</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"groupes"</span>, palette <span class="op">=</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#EFBE89"</span>, <span class="st">"#4A6A9F"</span>, <span class="st">"#7DB47C"</span>, <span class="st">"#FAF29C"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-kmeansG" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-kmeansG-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.22: Cartographie des groupes obtenus avec la méthode du k-means</figcaption></figure>
</div>
</div>
</div>
<p>Il est ainsi possible de constater que le groupe 3 forme un ensemble assez compact d’IRIS au centre de Lyon. Le groupe 4 correspond quant à lui à des IRIS situés en périphérie plutôt éloignée, essentiellement à l’ouest. Le groupe 1 correspond à une périphérie proche du groupe 2 et apparaît comme un ensemble d’enclaves dispersées.</p>
<p>Pour distinguer rapidement les profils des différents groupes, il est possible d’utiliser un graphique en radar. La construction d’un tel graphique peut être un peu fastidieuse dans R, cependant le <em>package</em> <code>geocmeans</code> propose une fonction assez pratique&nbsp;: <code>spiderPlots</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JeremyGelb/geocmeans">geocmeans</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># création d'une matrice d'appartenance binaire des groupes</span></span>
<span><span class="va">matrice_gp</span> <span class="op">&lt;-</span> <span class="fu">fastDummies</span><span class="fu">::</span><span class="fu"><a href="https://jacobkap.github.io/fastDummies/reference/dummy_cols.html">dummy_cols</a></span><span class="op">(</span><span class="va">resultats</span><span class="op">$</span><span class="va">cluster</span>, remove_selected_columns <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># réalisation du graphique</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>, mai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geocmeans/man/spiderPlots.html">spiderPlots</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">matrice_gp</span>, </span>
<span>                     chartcolors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#EFBE89"</span>, <span class="st">"#4A6A9F"</span>, <span class="st">"#7DB47C"</span>, <span class="st">"#FAF29C"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-kmeansH" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-kmeansH-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.23: Graphiques en radar pour les groupes issus du k-means</figcaption></figure>
</div>
</div>
</div>
<p>Il est ainsi possible de constater, à la <a href="#fig-kmeansH">figure&nbsp;<span class="quarto-unresolved-ref">fig-kmeansH</span></a>, que le groupe 3 est caractérisé par un niveau de vie élevé, mais par des niveaux de concentration de pollution atmosphérique plus élevés également. Le groupe 4 en revanche est caractérisé par un important couvert végétal, un niveau de vie médian élevé et une plus forte proportion de personnes de plus de 65 ans. Le groupe 1 est quant à lui marqué par des niveaux sonores plus élevés. Enfin, le groupe 2 se caractérise par une plus grande proportion de population ayant obtenu comme diplôme le plus élevé le brevet des collèges, d’immigrants, de jeunes de moins de 15 ans et un taux de chômage plus élevé.</p>
<p>Notez que ces graphiques nous permettent rapidement de nous faire une idée des caractéristiques des groupes, mais uniquement sur une échelle relative. En effet, ils ne nous indiquent à aucun moment la taille des écarts entre les groupes. Pour cela, il est nécessaire de réaliser des graphiques en violon pour chaque variable. Pour ce type de graphique, il est préférable d’utiliser les données originales non transformées pour pouvoir mieux appréhender si les différences entre les groupes sont importantes ou négligeables.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span><span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Lden"</span> , <span class="st">"NO2"</span> , <span class="st">"PM25"</span> , <span class="st">"VegHautPrt"</span> , <span class="st">"Pct0_14"</span>,</span>
<span>                                  <span class="st">"Pct_65"</span> , <span class="st">"Pct_Img"</span> , <span class="st">"TxChom1564"</span> , <span class="st">"Pct_brevet"</span>,</span>
<span>                                  <span class="st">"NivVieMed"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geocmeans/man/violinPlots.html">violinPlots</a></span><span class="op">(</span><span class="va">X2</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">resultats</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">plots</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-kmeansI" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-kmeansI-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.24: Graphiques en violon pour les groupes issus du k-means</figcaption></figure>
</div>
</div>
</div>
<p>Il est également recommandé de calculer des statistiques descriptives par groupe et de les rapporter dans un tableau.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># obtention d'un tableau par groupe</span></span>
<span><span class="va">tableaux</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geocmeans/man/summarizeClusters.html">summarizeClusters</a></span><span class="op">(</span><span class="va">X2</span>, <span class="va">matrice_gp</span>, dec <span class="op">=</span> <span class="fl">1</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># concaténation des tableaux</span></span>
<span><span class="va">tableau_tot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">tableaux</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="tbl-kmeansK" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;13.8: Descriptions des quatre groupes obtenus</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lden</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NO2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PM25</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">VegHautPrt</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pct014</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pct65</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PctImg</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">TxChom1564</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pctbrevet</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NivVieMed</th>
</tr></thead>
<tbody>
<tr class="odd" data-grouplength="9">
<td colspan="11" style="border-bottom: 1px solid"><strong>groupe 1</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q5</td>
<td style="text-align: right;">53,8</td>
<td style="text-align: right;">25,2</td>
<td style="text-align: right;">15,6</td>
<td style="text-align: right;">6,6</td>
<td style="text-align: right;">12,4</td>
<td style="text-align: right;">10,0</td>
<td style="text-align: right;">8,1</td>
<td style="text-align: right;">7,6</td>
<td style="text-align: right;">17,4</td>
<td style="text-align: right;">15 822,7</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q10</td>
<td style="text-align: right;">54,5</td>
<td style="text-align: right;">26,4</td>
<td style="text-align: right;">15,9</td>
<td style="text-align: right;">8,0</td>
<td style="text-align: right;">13,9</td>
<td style="text-align: right;">11,4</td>
<td style="text-align: right;">9,2</td>
<td style="text-align: right;">9,8</td>
<td style="text-align: right;">18,1</td>
<td style="text-align: right;">16 976,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q25</td>
<td style="text-align: right;">56,3</td>
<td style="text-align: right;">29,3</td>
<td style="text-align: right;">17,0</td>
<td style="text-align: right;">11,0</td>
<td style="text-align: right;">16,3</td>
<td style="text-align: right;">13,6</td>
<td style="text-align: right;">11,8</td>
<td style="text-align: right;">11,5</td>
<td style="text-align: right;">20,8</td>
<td style="text-align: right;">18 454,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q50</td>
<td style="text-align: right;">58,9</td>
<td style="text-align: right;">32,3</td>
<td style="text-align: right;">18,2</td>
<td style="text-align: right;">15,3</td>
<td style="text-align: right;">18,3</td>
<td style="text-align: right;">16,6</td>
<td style="text-align: right;">15,9</td>
<td style="text-align: right;">13,7</td>
<td style="text-align: right;">24,1</td>
<td style="text-align: right;">19 559,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q75</td>
<td style="text-align: right;">62,5</td>
<td style="text-align: right;">36,5</td>
<td style="text-align: right;">18,7</td>
<td style="text-align: right;">22,3</td>
<td style="text-align: right;">20,5</td>
<td style="text-align: right;">19,5</td>
<td style="text-align: right;">18,6</td>
<td style="text-align: right;">16,9</td>
<td style="text-align: right;">30,0</td>
<td style="text-align: right;">21 575,2</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q90</td>
<td style="text-align: right;">64,7</td>
<td style="text-align: right;">39,3</td>
<td style="text-align: right;">19,0</td>
<td style="text-align: right;">30,3</td>
<td style="text-align: right;">22,7</td>
<td style="text-align: right;">22,8</td>
<td style="text-align: right;">21,1</td>
<td style="text-align: right;">19,8</td>
<td style="text-align: right;">33,0</td>
<td style="text-align: right;">23 544,7</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q95</td>
<td style="text-align: right;">66,7</td>
<td style="text-align: right;">40,7</td>
<td style="text-align: right;">19,3</td>
<td style="text-align: right;">35,6</td>
<td style="text-align: right;">24,9</td>
<td style="text-align: right;">25,1</td>
<td style="text-align: right;">23,0</td>
<td style="text-align: right;">21,9</td>
<td style="text-align: right;">37,7</td>
<td style="text-align: right;">24 765,7</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Mean</td>
<td style="text-align: right;">59,6</td>
<td style="text-align: right;">32,7</td>
<td style="text-align: right;">17,8</td>
<td style="text-align: right;">17,2</td>
<td style="text-align: right;">18,2</td>
<td style="text-align: right;">16,7</td>
<td style="text-align: right;">15,7</td>
<td style="text-align: right;">14,1</td>
<td style="text-align: right;">25,5</td>
<td style="text-align: right;">19 948,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Std</td>
<td style="text-align: right;">4,2</td>
<td style="text-align: right;">5,2</td>
<td style="text-align: right;">1,2</td>
<td style="text-align: right;">8,5</td>
<td style="text-align: right;">4,0</td>
<td style="text-align: right;">4,7</td>
<td style="text-align: right;">6,5</td>
<td style="text-align: right;">4,3</td>
<td style="text-align: right;">7,6</td>
<td style="text-align: right;">2 637,2</td>
</tr>
<tr class="odd" data-grouplength="9">
<td colspan="11" style="border-bottom: 1px solid"><strong>groupe 2</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q5</td>
<td style="text-align: right;">50,8</td>
<td style="text-align: right;">19,3</td>
<td style="text-align: right;">13,9</td>
<td style="text-align: right;">6,1</td>
<td style="text-align: right;">18,3</td>
<td style="text-align: right;">6,4</td>
<td style="text-align: right;">17,7</td>
<td style="text-align: right;">16,5</td>
<td style="text-align: right;">30,5</td>
<td style="text-align: right;">12 323,5</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q10</td>
<td style="text-align: right;">52,0</td>
<td style="text-align: right;">20,2</td>
<td style="text-align: right;">14,3</td>
<td style="text-align: right;">7,8</td>
<td style="text-align: right;">20,0</td>
<td style="text-align: right;">8,7</td>
<td style="text-align: right;">20,2</td>
<td style="text-align: right;">16,8</td>
<td style="text-align: right;">32,9</td>
<td style="text-align: right;">12 747,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q25</td>
<td style="text-align: right;">53,9</td>
<td style="text-align: right;">23,0</td>
<td style="text-align: right;">15,3</td>
<td style="text-align: right;">11,2</td>
<td style="text-align: right;">22,8</td>
<td style="text-align: right;">10,7</td>
<td style="text-align: right;">23,5</td>
<td style="text-align: right;">19,6</td>
<td style="text-align: right;">36,2</td>
<td style="text-align: right;">13 530,5</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q50</td>
<td style="text-align: right;">56,4</td>
<td style="text-align: right;">25,1</td>
<td style="text-align: right;">16,2</td>
<td style="text-align: right;">14,5</td>
<td style="text-align: right;">25,2</td>
<td style="text-align: right;">13,6</td>
<td style="text-align: right;">28,0</td>
<td style="text-align: right;">24,5</td>
<td style="text-align: right;">39,9</td>
<td style="text-align: right;">15 340,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q75</td>
<td style="text-align: right;">58,4</td>
<td style="text-align: right;">29,4</td>
<td style="text-align: right;">17,0</td>
<td style="text-align: right;">18,1</td>
<td style="text-align: right;">27,8</td>
<td style="text-align: right;">16,9</td>
<td style="text-align: right;">33,5</td>
<td style="text-align: right;">32,5</td>
<td style="text-align: right;">46,0</td>
<td style="text-align: right;">16 342,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q90</td>
<td style="text-align: right;">63,1</td>
<td style="text-align: right;">33,7</td>
<td style="text-align: right;">18,5</td>
<td style="text-align: right;">24,4</td>
<td style="text-align: right;">31,3</td>
<td style="text-align: right;">20,2</td>
<td style="text-align: right;">38,2</td>
<td style="text-align: right;">36,3</td>
<td style="text-align: right;">50,2</td>
<td style="text-align: right;">18 363,9</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q95</td>
<td style="text-align: right;">64,9</td>
<td style="text-align: right;">39,0</td>
<td style="text-align: right;">19,1</td>
<td style="text-align: right;">28,1</td>
<td style="text-align: right;">32,8</td>
<td style="text-align: right;">21,4</td>
<td style="text-align: right;">41,1</td>
<td style="text-align: right;">38,0</td>
<td style="text-align: right;">60,2</td>
<td style="text-align: right;">20 128,6</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Mean</td>
<td style="text-align: right;">56,8</td>
<td style="text-align: right;">26,3</td>
<td style="text-align: right;">16,2</td>
<td style="text-align: right;">15,4</td>
<td style="text-align: right;">25,4</td>
<td style="text-align: right;">13,8</td>
<td style="text-align: right;">28,5</td>
<td style="text-align: right;">26,6</td>
<td style="text-align: right;">42,0</td>
<td style="text-align: right;">15 401,4</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Std</td>
<td style="text-align: right;">4,1</td>
<td style="text-align: right;">6,3</td>
<td style="text-align: right;">1,5</td>
<td style="text-align: right;">6,8</td>
<td style="text-align: right;">6,2</td>
<td style="text-align: right;">4,8</td>
<td style="text-align: right;">8,0</td>
<td style="text-align: right;">10,5</td>
<td style="text-align: right;">11,3</td>
<td style="text-align: right;">2 340,4</td>
</tr>
<tr class="odd" data-grouplength="9">
<td colspan="11" style="border-bottom: 1px solid"><strong>groupe 3</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q5</td>
<td style="text-align: right;">50,2</td>
<td style="text-align: right;">28,3</td>
<td style="text-align: right;">17,0</td>
<td style="text-align: right;">5,0</td>
<td style="text-align: right;">6,8</td>
<td style="text-align: right;">5,2</td>
<td style="text-align: right;">5,8</td>
<td style="text-align: right;">7,7</td>
<td style="text-align: right;">6,7</td>
<td style="text-align: right;">19 029,9</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q10</td>
<td style="text-align: right;">51,2</td>
<td style="text-align: right;">29,5</td>
<td style="text-align: right;">17,6</td>
<td style="text-align: right;">6,6</td>
<td style="text-align: right;">9,5</td>
<td style="text-align: right;">7,2</td>
<td style="text-align: right;">6,7</td>
<td style="text-align: right;">8,5</td>
<td style="text-align: right;">7,7</td>
<td style="text-align: right;">19 546,4</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q25</td>
<td style="text-align: right;">53,2</td>
<td style="text-align: right;">31,3</td>
<td style="text-align: right;">18,6</td>
<td style="text-align: right;">9,2</td>
<td style="text-align: right;">11,4</td>
<td style="text-align: right;">9,5</td>
<td style="text-align: right;">7,9</td>
<td style="text-align: right;">11,0</td>
<td style="text-align: right;">9,5</td>
<td style="text-align: right;">21 652,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q50</td>
<td style="text-align: right;">55,2</td>
<td style="text-align: right;">35,4</td>
<td style="text-align: right;">19,3</td>
<td style="text-align: right;">12,6</td>
<td style="text-align: right;">14,1</td>
<td style="text-align: right;">12,4</td>
<td style="text-align: right;">11,0</td>
<td style="text-align: right;">12,9</td>
<td style="text-align: right;">12,0</td>
<td style="text-align: right;">23 342,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q75</td>
<td style="text-align: right;">58,0</td>
<td style="text-align: right;">39,6</td>
<td style="text-align: right;">19,8</td>
<td style="text-align: right;">16,0</td>
<td style="text-align: right;">16,2</td>
<td style="text-align: right;">16,0</td>
<td style="text-align: right;">13,1</td>
<td style="text-align: right;">15,1</td>
<td style="text-align: right;">14,8</td>
<td style="text-align: right;">25 954,1</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q90</td>
<td style="text-align: right;">60,0</td>
<td style="text-align: right;">43,0</td>
<td style="text-align: right;">20,1</td>
<td style="text-align: right;">21,0</td>
<td style="text-align: right;">18,2</td>
<td style="text-align: right;">18,9</td>
<td style="text-align: right;">16,3</td>
<td style="text-align: right;">18,0</td>
<td style="text-align: right;">16,6</td>
<td style="text-align: right;">28 951,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q95</td>
<td style="text-align: right;">61,2</td>
<td style="text-align: right;">44,4</td>
<td style="text-align: right;">20,4</td>
<td style="text-align: right;">29,3</td>
<td style="text-align: right;">19,5</td>
<td style="text-align: right;">20,9</td>
<td style="text-align: right;">17,7</td>
<td style="text-align: right;">19,3</td>
<td style="text-align: right;">19,1</td>
<td style="text-align: right;">31 922,5</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Mean</td>
<td style="text-align: right;">55,6</td>
<td style="text-align: right;">35,8</td>
<td style="text-align: right;">19,0</td>
<td style="text-align: right;">13,6</td>
<td style="text-align: right;">13,8</td>
<td style="text-align: right;">12,6</td>
<td style="text-align: right;">11,1</td>
<td style="text-align: right;">13,1</td>
<td style="text-align: right;">12,1</td>
<td style="text-align: right;">23 999,7</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Std</td>
<td style="text-align: right;">3,7</td>
<td style="text-align: right;">5,6</td>
<td style="text-align: right;">1,0</td>
<td style="text-align: right;">6,8</td>
<td style="text-align: right;">4,2</td>
<td style="text-align: right;">4,7</td>
<td style="text-align: right;">4,6</td>
<td style="text-align: right;">4,4</td>
<td style="text-align: right;">4,0</td>
<td style="text-align: right;">3 870,3</td>
</tr>
<tr class="odd" data-grouplength="9">
<td colspan="11" style="border-bottom: 1px solid"><strong>groupe 4</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q5</td>
<td style="text-align: right;">44,9</td>
<td style="text-align: right;">14,7</td>
<td style="text-align: right;">12,7</td>
<td style="text-align: right;">8,2</td>
<td style="text-align: right;">13,1</td>
<td style="text-align: right;">12,7</td>
<td style="text-align: right;">3,8</td>
<td style="text-align: right;">6,7</td>
<td style="text-align: right;">10,8</td>
<td style="text-align: right;">19 496,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q10</td>
<td style="text-align: right;">46,6</td>
<td style="text-align: right;">15,7</td>
<td style="text-align: right;">13,0</td>
<td style="text-align: right;">11,8</td>
<td style="text-align: right;">14,9</td>
<td style="text-align: right;">13,5</td>
<td style="text-align: right;">4,4</td>
<td style="text-align: right;">7,0</td>
<td style="text-align: right;">12,4</td>
<td style="text-align: right;">20 257,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q25</td>
<td style="text-align: right;">50,3</td>
<td style="text-align: right;">19,0</td>
<td style="text-align: right;">13,8</td>
<td style="text-align: right;">16,7</td>
<td style="text-align: right;">17,1</td>
<td style="text-align: right;">16,1</td>
<td style="text-align: right;">6,0</td>
<td style="text-align: right;">8,0</td>
<td style="text-align: right;">15,7</td>
<td style="text-align: right;">21 963,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q50</td>
<td style="text-align: right;">52,6</td>
<td style="text-align: right;">22,0</td>
<td style="text-align: right;">14,7</td>
<td style="text-align: right;">24,9</td>
<td style="text-align: right;">18,9</td>
<td style="text-align: right;">19,3</td>
<td style="text-align: right;">8,1</td>
<td style="text-align: right;">9,8</td>
<td style="text-align: right;">20,0</td>
<td style="text-align: right;">24 109,8</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q75</td>
<td style="text-align: right;">54,9</td>
<td style="text-align: right;">25,2</td>
<td style="text-align: right;">15,5</td>
<td style="text-align: right;">32,6</td>
<td style="text-align: right;">20,8</td>
<td style="text-align: right;">22,8</td>
<td style="text-align: right;">10,9</td>
<td style="text-align: right;">12,0</td>
<td style="text-align: right;">25,6</td>
<td style="text-align: right;">26 698,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q90</td>
<td style="text-align: right;">57,7</td>
<td style="text-align: right;">27,5</td>
<td style="text-align: right;">16,3</td>
<td style="text-align: right;">41,2</td>
<td style="text-align: right;">22,3</td>
<td style="text-align: right;">27,4</td>
<td style="text-align: right;">14,5</td>
<td style="text-align: right;">14,7</td>
<td style="text-align: right;">30,6</td>
<td style="text-align: right;">29 947,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Q95</td>
<td style="text-align: right;">59,1</td>
<td style="text-align: right;">28,7</td>
<td style="text-align: right;">16,8</td>
<td style="text-align: right;">43,6</td>
<td style="text-align: right;">22,7</td>
<td style="text-align: right;">29,7</td>
<td style="text-align: right;">18,1</td>
<td style="text-align: right;">16,6</td>
<td style="text-align: right;">33,1</td>
<td style="text-align: right;">32 386,5</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Mean</td>
<td style="text-align: right;">52,3</td>
<td style="text-align: right;">21,8</td>
<td style="text-align: right;">14,7</td>
<td style="text-align: right;">25,5</td>
<td style="text-align: right;">18,6</td>
<td style="text-align: right;">20,1</td>
<td style="text-align: right;">8,8</td>
<td style="text-align: right;">10,4</td>
<td style="text-align: right;">21,1</td>
<td style="text-align: right;">24 761,6</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Std</td>
<td style="text-align: right;">4,3</td>
<td style="text-align: right;">4,4</td>
<td style="text-align: right;">1,2</td>
<td style="text-align: right;">11,0</td>
<td style="text-align: right;">3,1</td>
<td style="text-align: right;">5,6</td>
<td style="text-align: right;">4,2</td>
<td style="text-align: right;">3,4</td>
<td style="text-align: right;">7,6</td>
<td style="text-align: right;">4 008,7</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Les constats que nous avons faits précédemment sont confirmés par la <a href="#fig-kmeansI">figure&nbsp;<span class="quarto-unresolved-ref">fig-kmeansI</span></a> et le <a href="#tbl-kmeansK">tableau&nbsp;<span class="quarto-unresolved-ref">tbl-kmeansK</span></a>. Nous retrouvons ici les groupes originaux décrits dans l’article de <span class="citation" data-cites="2021_4">Gelb et Apparicio (<a href="#ref-2021_4" role="doc-biblioref">2021</a>)</span> :</p>
<ul>
<li><p><strong>Groupe 1</strong>&nbsp;: les espaces interstitiels, formant une périphérie proche du centre et relativement hétérogène sur les variables étudiées, mais caractérisée par des niveaux de bruit importants.</p></li>
<li><p><strong>Groupe 2</strong>&nbsp;: les banlieues jeunes et défavorisées, avec des niveaux d’exposition aux pollutions atmosphérique et sonore relativement élevés comparativement à l’ensemble de la région.</p></li>
<li><p><strong>Groupe 3</strong>&nbsp;: les quartiers centraux aisés, mais marqués par les plus hauts niveaux de pollution atmosphérique.</p></li>
<li><p><strong>Groupe 4</strong>&nbsp;: les communes rurales, aisées et vieillissantes.</p></li>
</ul>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>Interprétation interactive</strong></p>
</div>
<div class="bloc_astuce-body">
<p>Si, comme dans notre exemple, vos données comportent une dimension spatiale, le <em>package</em> <code>geocmeans</code> propose une fonction intéressante appelée <code>sp_clust_explorer</code> démarrant une application permettant d’explorer les résultats de votre classification. Le seul enjeu est de créer un objet de la classe <code>FCMres</code>. Voici un court exemple&nbsp;:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># création d'une matrice binaire d'appartenance</span></span>
<span><span class="va">kmeans_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://jacobkap.github.io/fastDummies/reference/dummy_cols.html">dummy_cols</a></span><span class="op">(</span><span class="va">resultats</span><span class="op">$</span><span class="va">cluster</span>, remove_selected_columns <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extraction des centres de notre classification</span></span>
<span><span class="va">centres</span> <span class="op">&lt;-</span> <span class="va">resultats</span><span class="op">$</span><span class="va">centers</span></span>
<span></span>
<span><span class="co"># création de l'objet FCMres</span></span>
<span><span class="va">kmeansres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geocmeans/man/FCMres.html">FCMres</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Centers"</span> <span class="op">=</span> <span class="va">centres</span>,</span>
<span>  <span class="st">"Belongings"</span> <span class="op">=</span> <span class="va">kmeans_mat</span>,</span>
<span>  <span class="st">"Data"</span> <span class="op">=</span> <span class="va">X2</span>,</span>
<span>  <span class="st">"m"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="st">"algo"</span> <span class="op">=</span> <span class="st">"kmeans"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># démarrage de l'application shiny</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/geocmeans/man/sp_clust_explorer.html">sp_clust_explorer</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">kmeansres</span>, spatial <span class="op">=</span> <span class="va">LyonIris</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section><section id="sec-13455" class="level4" data-number="13.4.4.5"><h4 data-number="13.4.4.5" class="anchored" data-anchor-id="sec-13455">
<span class="header-section-number">13.4.4.5</span> K-médianes et K-médoides</h4>
<p>Nous présentons simplement ici comment effectuer la même analyse en utilisant les variantes du <em>k-means</em>, soit le <em>k-medians</em> et le <em>k-mediods</em>.</p>
<p>Il existe relativement peu d’implémentation du <em>k-medians</em> dans R, nous optons donc ici pour la fonction <code>kGmedian</code> du <em>package</em> <code>Gmedian</code>. Pour le <em>k-mediods</em>, nous avons retenu la fonction <code>pam</code> du <em>package</em> <code>cluster</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">Gmedian</span><span class="op">)</span></span>
<span><span class="va">k_median_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Gmedian/man/kGmedian.html">kGmedian</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/cluster/">cluster</a></span><span class="op">)</span></span>
<span><span class="va">k_mediods_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/pam.html">pam</a></span><span class="op">(</span><span class="va">X</span>,<span class="fl">4</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Juste pour le plaisir des yeux, nous pouvons cartographier les trois classifications obtenues en nous assurant au préalable de faire coïncider les groupes les plus similaires de nos trois classifications.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrice_gp_kmeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://jacobkap.github.io/fastDummies/reference/dummy_cols.html">dummy_cols</a></span><span class="op">(</span><span class="va">resultats</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>                                remove_selected_columns <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">matrice_gp_kmedians</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://jacobkap.github.io/fastDummies/reference/dummy_cols.html">dummy_cols</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">k_median_res</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span>,</span>
<span>                                  remove_selected_columns <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">matrice_gp_kmedioids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://jacobkap.github.io/fastDummies/reference/dummy_cols.html">dummy_cols</a></span><span class="op">(</span><span class="va">k_mediods_res</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>                                   remove_selected_columns <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Appariement des groupes du k-medians avec ceux du kmeans</span></span>
<span><span class="va">matrice_gp_kmedians</span> <span class="op">&lt;-</span> <span class="fu">geocmeans</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geocmeans/man/groups_matching.html">groups_matching</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html">as.matrix</a></span><span class="op">(</span><span class="va">matrice_gp_kmeans</span><span class="op">)</span>,</span>
<span>                                                 <span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html">as.matrix</a></span><span class="op">(</span><span class="va">matrice_gp_kmedians</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Appariement des groupes du k-medioids avec ceux du kmeans</span></span>
<span><span class="va">matrice_gp_kmedioids</span> <span class="op">&lt;-</span> <span class="fu">geocmeans</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geocmeans/man/groups_matching.html">groups_matching</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html">as.matrix</a></span><span class="op">(</span><span class="va">matrice_gp_kmeans</span><span class="op">)</span>,</span>
<span>                                                   <span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html">as.matrix</a></span><span class="op">(</span><span class="va">matrice_gp_kmedioids</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ajouts des colonnes nécessaires à LyonIris</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrice_gp_kmeans</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"groupe_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrice_gp_kmedians</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"groupe_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrice_gp_kmedioids</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"groupe_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">LyonIris</span><span class="op">$</span><span class="va">kmeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrice_gp_kmeans</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/maxCol.html">max.col</a></span><span class="op">(</span><span class="va">matrice_gp_kmeans</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">LyonIris</span><span class="op">$</span><span class="va">kmedians</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrice_gp_kmedians</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/maxCol.html">max.col</a></span><span class="op">(</span><span class="va">matrice_gp_kmedians</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">LyonIris</span><span class="op">$</span><span class="va">kmedioids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrice_gp_kmedioids</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/maxCol.html">max.col</a></span><span class="op">(</span><span class="va">matrice_gp_kmedioids</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># construction de la figure</span></span>
<span><span class="va">couleurs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#EFBE89"</span>, <span class="st">"#4A6A9F"</span>, <span class="st">"#7DB47C"</span>, <span class="st">"#FAF29C"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"kmeans"</span>, palette <span class="op">=</span> <span class="va">couleurs</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">map2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"kmedians"</span>, palette <span class="op">=</span> <span class="va">couleurs</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">map3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"kmedioids"</span>, palette <span class="op">=</span> <span class="va">couleurs</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tmap_arrange.html">tmap_arrange</a></span><span class="op">(</span><span class="va">map1</span>, <span class="va">map2</span>, <span class="va">map3</span>, </span>
<span>             ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-kmeansM" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-kmeansM-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.25: Comparaison géographique des résultats obtenus pour le k-means, le k-medians et le k-medoids</figcaption></figure>
</div>
</div>
</div>
<p>Les trois cartes sont très similaires (<a href="#fig-kmeansM">figure&nbsp;<span class="quarto-unresolved-ref">fig-kmeansM</span></a>), ce qui signifie que les trois algorithmes tendent à attribuer les observations aux mêmes groupes. Cependant, nous observons des différences, notamment au nord avec des observations alternant entre les groupes 2 et 3 selon la méthode employée. Cela peut notamment signifier que ces observations sont «&nbsp;indécises&nbsp;», qu’il est difficile de les attribuer définitivement à une catégorie en particulier. Pour prendre en compte cette forme d’incertitude, il est possible d’opter pour des méthodes de classification en logique floue.</p>
</section></section><section id="sec-1346" class="level3" data-number="13.4.5"><h3 data-number="13.4.5" class="anchored" data-anchor-id="sec-1346">
<span class="header-section-number">13.4.5</span> Extensions en logique floue : <em>c-means</em>, <em>c-medoids</em>
</h3>
<p>Comme nous l’avons mentionné en introduction de cette section, les méthodes de classification floues ont pour objectif d’évaluer le degré d’appartenance de chaque observation à chaque groupe plutôt que d’attribuer chaque observation à un seul groupe. Il est ainsi possible de repérer des observations incertaines, à cheval entre plusieurs groupes. Nous présentons ici deux algorithmes appartenant à cette famille&nbsp;: le <em>c-means</em> et le <em>c-medoids</em>. Il s’agit dans les deux cas d’extensions des <em>k-means</em> et <em>k-medoids</em> vus précédemment.</p>
<p>Pour ces deux méthodes, comme pour le <em>k-means</em>, le nombre de groupes <em>k</em> doit être spécifié. Elles comprennent cependant un paramètre supplémentaire&nbsp;: <em>m</em>, appelé paramètre de floutage qui contrôle à quel point le résultat obtenu sera flou ou strict. Une valeur de 1 produit une classification stricte (chaque observation appartient à un seul groupe) et une valeur plus grande conduit à des classifications de plus en plus floues, jusqu’à ce que chaque observation appartienne à un degré identique à chacun des groupes. Il est recommandé de sélectionner <em>m</em> en même temps que <em>k</em>, car ces deux valeurs influencent simultanément la qualité de la classification. La meilleure approche consiste à tester un ensemble de combinaisons de <em>m</em> et de <em>k</em> et à comparer les valeurs obtenues pour différents indicateurs de qualité de classification floue. Parmi ces indicateurs, il est notamment recommandé d’utiliser le pourcentage de l’inertie expliquée, l’indice de silhouette pour classification floue, l’indice de Xie et Beni <span class="citation" data-cites="xie1991validity">(<a href="#ref-xie1991validity" role="doc-biblioref">1991</a>)</span>, et de Fukuyama et Sugeno <span class="citation" data-cites="fukuyama1989">(<a href="#ref-fukuyama1989" role="doc-biblioref">Fukuyama 1989</a>)</span>.</p>
<section id="sec-13461" class="level4" data-number="13.4.5.1"><h4 data-number="13.4.5.1" class="anchored" data-anchor-id="sec-13461">
<span class="header-section-number">13.4.5.1</span> Mise en œuvre du <em>c-means</em> dans R</h4>
<p>Le <em>package</em> <code>fclust</code> comprend un très grand nombre de méthodes pour effectuer des classifications floues, nous l’utilisons donc en priorité ici en combinaison avec des fonctions d’interprétation du <em>package</em> <code>geocmeans</code>.</p>
<section id="préparation-des-données" class="level5" data-number="13.4.5.1.1"><h5 data-number="13.4.5.1.1" class="anchored" data-anchor-id="préparation-des-données">
<span class="header-section-number">13.4.5.1.1</span> Préparation des données</h5>
<p>Comme pour le <em>k-means</em>, cette méthode nécessite de disposer d’un jeu de données ne comprenant que des variables quantitatives dans la même échelle. Nous commençons donc à nouveau par standardiser nos données. Pour varier les plaisirs, nous optons cette fois-ci pour une transformation des variables dans une échelle allant de 0 à 100.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">fclust</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># NB : LyonIris est un objet spatial, il faut donc extraire uniquement son DataFrame</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Lden"</span> , <span class="st">"NO2"</span> , <span class="st">"PM25"</span> , <span class="st">"VegHautPrt"</span> , <span class="st">"Pct0_14"</span>,</span>
<span>                                 <span class="st">"Pct_65"</span> , <span class="st">"Pct_Img"</span>,</span>
<span>                                 <span class="st">"TxChom1564"</span> , <span class="st">"Pct_brevet"</span> , <span class="st">"NivVieMed"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># changement d'échelle des données (0 à 100)</span></span>
<span><span class="va">to_0_100</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">col</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">X</span><span class="op">[[</span><span class="va">col</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">to_0_100</span><span class="op">(</span><span class="va">X</span><span class="op">[[</span><span class="va">col</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sélection-de-k-et-de-m" class="level5" data-number="13.4.5.1.2"><h5 data-number="13.4.5.1.2" class="anchored" data-anchor-id="sélection-de-k-et-de-m">
<span class="header-section-number">13.4.5.1.2</span> Sélection de <em>k</em> et de <em>m</em>
</h5>
<p>La seconde étape consiste à sélectionner les valeurs optimales pour <em>k</em> et <em>m</em>. Nous testons ici toutes les valeurs de k de 2 à 7, et les valeurs de <em>m</em> de 1,5 à 2,5 (avec des écarts de 0,1).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">ms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">2.5</span>,by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">ks</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">:</span><span class="fl">7</span></span>
<span></span>
<span></span>
<span><span class="co"># calcul de toutes les combinaisons</span></span>
<span><span class="va">combinaisons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="va">ms</span>, <span class="va">ks</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eval_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Explained.inertia"</span>, <span class="st">"Silhouette.index"</span>, <span class="st">"FukuyamaSugeno.index"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">combinaisons</span>, MARGIN <span class="op">=</span> <span class="fl">1</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">m</span> <span class="op">&lt;-</span> <span class="va">row</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">k</span> <span class="op">&lt;-</span> <span class="va">row</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">resultats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fclust/man/FKM.html">FKM</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">k</span>, <span class="va">m</span><span class="op">)</span></span>
<span>  <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu">geocmeans</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geocmeans/man/calcqualityIndexes.html">calcqualityIndexes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html">as.matrix</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,</span>
<span>                                       <span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html">as.matrix</a></span><span class="op">(</span><span class="va">resultats</span><span class="op">$</span><span class="va">U</span><span class="op">)</span>, </span>
<span>                                       m <span class="op">=</span> <span class="va">m</span>,</span>
<span>                                       indices <span class="op">=</span> <span class="va">eval_indices</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">m</span>, <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">idx</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df_scores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"k"</span>, <span class="st">"m"</span>, <span class="st">"inertie"</span>, <span class="st">"silhouette"</span>, <span class="st">"FukuyamaSugeno"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># changer l'échelle de l'indice pour un graphique plus joli</span></span>
<span><span class="va">df_scores</span><span class="op">$</span><span class="va">FukuyamaSugeno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">df_scores</span><span class="op">$</span><span class="va">FukuyamaSugeno</span><span class="op">/</span><span class="fl">10000</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># création de trois figures pour représenter les trois indicateurs</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/">viridis</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_scores</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_raster</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">m</span>, fill <span class="op">=</span> <span class="va">inertie</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html">scale_fill_viridis</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html">guide_colourbar</a></span><span class="op">(</span>barwidth <span class="op">=</span> <span class="fl">5</span>, barheight <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Inertie expliquée"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.box <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span> size<span class="op">=</span><span class="fl">9</span><span class="op">)</span>, legend.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_scores</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_raster</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">m</span>, fill <span class="op">=</span> <span class="va">silhouette</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html">scale_fill_viridis</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html">guide_colourbar</a></span><span class="op">(</span>barwidth <span class="op">=</span> <span class="fl">5</span>, barheight <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Indice de silhouette"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.box <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span> size<span class="op">=</span><span class="fl">9</span><span class="op">)</span>, legend.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_scores</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_raster</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">m</span>, fill <span class="op">=</span> <span class="va">FukuyamaSugeno</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html">scale_fill_viridis</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html">guide_colourbar</a></span><span class="op">(</span>barwidth <span class="op">=</span> <span class="fl">5</span>, barheight <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Indice de Fukuyama et Sugeno"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.box <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span> size<span class="op">=</span><span class="fl">9</span><span class="op">)</span>, legend.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">plot1</span>, <span class="va">plot2</span>, <span class="va">plot3</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-cmeansB" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-cmeansB-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.26: Sélection des paramètres k et m pour l’algorithme c-means</figcaption></figure>
</div>
</div>
</div>
<p>Les trois graphiques à la <a href="#fig-cmeansB">figure&nbsp;<span class="quarto-unresolved-ref">fig-cmeansB</span></a> semblent indiquer des solutions différentes. Sans surprise, augmenter le niveau de flou (<em>m</em>) réduit l’inertie expliquée, alors qu’augmenter le nombre de groupes (<em>k</em>) augmente l’inertie expliquée. L’indice de silhouette indique assez clairement que le nombre de trois groupes serait le meilleur choix, suivi par deux ou quatre groupes, si <em>m</em> est inférieur à 1,8. Cependant, ne retenir que trois groupes ne permet d’expliquer que 30% de l’inertie. Afin de nous rapprocher des résultats de l’article original <span class="citation" data-cites="2021_4">(<a href="#ref-2021_4" role="doc-biblioref">Gelb et Apparicio 2021</a>)</span>, nous retenons <code>m = 1,5</code> et <code>k = 4</code>.</p>
</section><section id="application-lalgorithme-c-means" class="level5" data-number="13.4.5.1.3"><h5 data-number="13.4.5.1.3" class="anchored" data-anchor-id="application-lalgorithme-c-means">
<span class="header-section-number">13.4.5.1.3</span> Application l’algorithme <em>c-means</em>
</h5>
<p>Avec <em>k</em> et <em>m</em> définis, il ne reste plus qu’à appliquer l’algorithme à nos observations.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">cmeans_resultats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fclust/man/FKM.html">FKM</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">4</span>, <span class="fl">1.5</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’objet obtenu <code>cmeans_resultats</code> contient les résultats de la classification. Plus spécifiquement, <code>cmeans_resultats$U</code> est la matrice d’appartenance, soit une matrice de taille <em>n</em> x <em>k</em>, dont chaque case <span class="math inline">\(U_{ij}\)</span> indique la probabilité pour l’observation <em>i</em> d’appartenir au groupe <em>j</em>. <code>cmeans_resultats$H</code> contient le centre des groupes, et <code>cmeans_resultats$Clus</code>, le groupe auquel chaque observation à le plus de chances d’appartenir. Pour comparer plus facilement nos résultats avec ceux du <em>k-means</em>, nous pouvons changer l’ordre des groupes obtenus pour les faire coïncider avec les groupes les plus similaires obtenus avec la méthode <em>k-means</em>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># changeons l'ordre des groupes</span></span>
<span><span class="va">U</span> <span class="op">&lt;-</span> <span class="va">cmeans_resultats</span><span class="op">$</span><span class="va">U</span></span>
<span><span class="va">U2</span> <span class="op">&lt;-</span> <span class="fu">geocmeans</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geocmeans/man/groups_matching.html">groups_matching</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html">as.matrix</a></span><span class="op">(</span><span class="va">matrice_gp_kmeans</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html">as.matrix</a></span><span class="op">(</span><span class="va">U</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># mais aussi du centre des classes</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"Clus "</span> , <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">U2</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">H2</span> <span class="op">&lt;-</span> <span class="va">cmeans_resultats</span><span class="op">$</span><span class="va">H</span><span class="op">[</span><span class="va">idx</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># et recalcul du groupe le plus probable</span></span>
<span><span class="va">Clus2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">"Cluster"</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/maxCol.html">max.col</a></span><span class="op">(</span><span class="va">U2</span>, ties.method<span class="op">=</span><span class="st">"first"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  <span class="st">"Membership degree"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">U2</span>, MARGIN <span class="op">=</span> <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">U2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Clus"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">H2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Clus"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cmeans_resultats</span><span class="op">$</span><span class="va">U</span> <span class="op">&lt;-</span> <span class="va">U2</span></span>
<span><span class="va">cmeans_resultats</span><span class="op">$</span><span class="va">H</span> <span class="op">&lt;-</span> <span class="va">H2</span></span>
<span><span class="va">cmeans_resultats</span><span class="op">$</span><span class="va">Clus</span> <span class="op">&lt;-</span> <span class="va">Clus2</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="interprétation-des-résultats" class="level5" data-number="13.4.5.1.4"><h5 data-number="13.4.5.1.4" class="anchored" data-anchor-id="interprétation-des-résultats">
<span class="header-section-number">13.4.5.1.4</span> Interprétation des résultats</h5>
<p>Globalement, les approches pour interpréter les résultats issus d’une classification obtenue par <em>c-means</em> sont les mêmes que pour une classification obtenue par <em>k-means</em>.</p>
<p>Commençons donc par créer plusieurs cartes des probabilités d’appartenir aux différents groupes.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">maps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geocmeans/man/mapClusters.html">mapClusters</a></span><span class="op">(</span><span class="va">LyonIris</span>, <span class="va">cmeans_resultats</span><span class="op">$</span><span class="va">U</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://r-tmap.github.io/tmap/reference/tmap_arrange.html">tmap_arrange</a></span><span class="op">(</span><span class="va">maps</span><span class="op">$</span><span class="va">ProbaMaps</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-cmeansD" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-cmeansD-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.27: Cartographie des probabilités d’appartenir aux quatre groupes identifiés par l’algorithme c-means</figcaption></figure>
</div>
</div>
</div>
<p>Sur les cartes de la <a href="#fig-cmeansD">figure&nbsp;<span class="quarto-unresolved-ref">fig-cmeansD</span></a>, l’intensité de bleu correspond à la probabilité pour chaque IRIS d’appartenir aux différents groupes. Nous retrouvons les principales structures spatiales que nous avons identifiées avec le <em>k-means</em>; cependant, nous pouvons à présent constater que le groupe 1 est bien plus incertain que les autres. Nous pouvons une fois encore générer un graphique en radar pour comparer les profils des quatre groupes.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>, mai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/geocmeans/man/spiderPlots.html">spiderPlots</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">cmeans_resultats</span><span class="op">$</span><span class="va">U</span>,</span>
<span>            chartcolors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#EFBE89"</span>, <span class="st">"#4A6A9F"</span>, <span class="st">"#7DB47C"</span>, <span class="st">"#FAF29C"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-cmeansE" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-cmeansE-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.28: Graphique en radar pour les résultats du c-means</figcaption></figure>
</div>
</div>
</div>
<p>Sans surprise, nous retrouvons essentiellement les profils que nous avons obtenus avec le <em>k-means</em> dans la <a href="#fig-cmeansE">figure&nbsp;<span class="quarto-unresolved-ref">fig-cmeansE</span></a>. Pour compléter la lecture des résultats, il est nécessaire de se pencher sur le tableau des statistiques descriptives des différents groupes. Une fois encore, nous proposons d’utiliser la fonction <code>summarizeClusters</code> du <em>package</em> <code>geocmeans</code>. Notez que cette fonction calcule les statistiques descriptives pondérées en fonction de l’appartenance des observations aux groupes. Ainsi, une observation ayant une faible chance d’appartenir à un groupe ne contribue que faiblement aux statistiques descriptives de ce groupe.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Lden"</span> , <span class="st">"NO2"</span> , <span class="st">"PM25"</span> , <span class="st">"VegHautPrt"</span> , <span class="st">"Pct0_14"</span>,</span>
<span>                                   <span class="st">"Pct_65"</span> , <span class="st">"Pct_Img"</span>, <span class="st">"TxChom1564"</span>,</span>
<span>                                   <span class="st">"Pct_brevet"</span> , <span class="st">"NivVieMed"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tableaux</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geocmeans/man/summarizeClusters.html">summarizeClusters</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, </span>
<span>                  belongmatrix <span class="op">=</span> <span class="va">cmeans_resultats</span><span class="op">$</span><span class="va">U</span>,</span>
<span>                  weighted <span class="op">=</span> <span class="cn">TRUE</span>, dec <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tableau_tot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">tableaux</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-cmeansG" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Tableau&nbsp;13.9: Description des groupes avec la méthode c-means</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lden</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NO2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PM25</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">VegHautPrt</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pct014</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pct65</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PctImg</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">TxChom1564</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pctbrevet</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NivVieMed</th>
</tr></thead>
<tbody>
<tr class="odd" data-grouplength="9">
<td colspan="11" style="border-bottom: 1px solid"><strong>groupe 1</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q5</td>
<td style="text-align: right;">48,7</td>
<td style="text-align: right;">15,8</td>
<td style="text-align: right;">13,5</td>
<td style="text-align: right;">6,2</td>
<td style="text-align: right;">12,2</td>
<td style="text-align: right;">9,5</td>
<td style="text-align: right;">4,3</td>
<td style="text-align: right;">6,7</td>
<td style="text-align: right;">10,7</td>
<td style="text-align: right;">16 191,5</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q10</td>
<td style="text-align: right;">50,5</td>
<td style="text-align: right;">18,7</td>
<td style="text-align: right;">13,9</td>
<td style="text-align: right;">7,4</td>
<td style="text-align: right;">14,2</td>
<td style="text-align: right;">11,4</td>
<td style="text-align: right;">5,7</td>
<td style="text-align: right;">7,6</td>
<td style="text-align: right;">13,7</td>
<td style="text-align: right;">17 616,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q25</td>
<td style="text-align: right;">52,4</td>
<td style="text-align: right;">20,9</td>
<td style="text-align: right;">14,7</td>
<td style="text-align: right;">11,4</td>
<td style="text-align: right;">16,8</td>
<td style="text-align: right;">14,2</td>
<td style="text-align: right;">7,8</td>
<td style="text-align: right;">9,3</td>
<td style="text-align: right;">18,4</td>
<td style="text-align: right;">19 559,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q50</td>
<td style="text-align: right;">54,7</td>
<td style="text-align: right;">25,0</td>
<td style="text-align: right;">15,6</td>
<td style="text-align: right;">15,8</td>
<td style="text-align: right;">19,0</td>
<td style="text-align: right;">17,7</td>
<td style="text-align: right;">11,2</td>
<td style="text-align: right;">12,1</td>
<td style="text-align: right;">24,0</td>
<td style="text-align: right;">21 947,5</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q75</td>
<td style="text-align: right;">57,6</td>
<td style="text-align: right;">28,6</td>
<td style="text-align: right;">16,8</td>
<td style="text-align: right;">22,3</td>
<td style="text-align: right;">21,3</td>
<td style="text-align: right;">21,1</td>
<td style="text-align: right;">15,6</td>
<td style="text-align: right;">15,1</td>
<td style="text-align: right;">29,8</td>
<td style="text-align: right;">24 069,2</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q90</td>
<td style="text-align: right;">60,7</td>
<td style="text-align: right;">33,0</td>
<td style="text-align: right;">18,5</td>
<td style="text-align: right;">29,8</td>
<td style="text-align: right;">23,2</td>
<td style="text-align: right;">24,4</td>
<td style="text-align: right;">20,3</td>
<td style="text-align: right;">18,5</td>
<td style="text-align: right;">34,7</td>
<td style="text-align: right;">26 164,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q95</td>
<td style="text-align: right;">63,1</td>
<td style="text-align: right;">37,8</td>
<td style="text-align: right;">19,0</td>
<td style="text-align: right;">34,3</td>
<td style="text-align: right;">25,4</td>
<td style="text-align: right;">27,5</td>
<td style="text-align: right;">23,5</td>
<td style="text-align: right;">22,3</td>
<td style="text-align: right;">39,0</td>
<td style="text-align: right;">28 931,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Mean</td>
<td style="text-align: right;">55,1</td>
<td style="text-align: right;">25,4</td>
<td style="text-align: right;">15,8</td>
<td style="text-align: right;">17,5</td>
<td style="text-align: right;">18,9</td>
<td style="text-align: right;">17,9</td>
<td style="text-align: right;">12,4</td>
<td style="text-align: right;">13,0</td>
<td style="text-align: right;">24,7</td>
<td style="text-align: right;">21 951,6</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Std</td>
<td style="text-align: right;">4,4</td>
<td style="text-align: right;">6,3</td>
<td style="text-align: right;">1,7</td>
<td style="text-align: right;">8,6</td>
<td style="text-align: right;">4,5</td>
<td style="text-align: right;">5,7</td>
<td style="text-align: right;">6,8</td>
<td style="text-align: right;">6,8</td>
<td style="text-align: right;">10,3</td>
<td style="text-align: right;">3 744,1</td>
</tr>
<tr class="odd" data-grouplength="9">
<td colspan="11" style="border-bottom: 1px solid"><strong>groupe 2</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q5</td>
<td style="text-align: right;">50,8</td>
<td style="text-align: right;">19,6</td>
<td style="text-align: right;">14,0</td>
<td style="text-align: right;">6,4</td>
<td style="text-align: right;">12,9</td>
<td style="text-align: right;">7,5</td>
<td style="text-align: right;">8,4</td>
<td style="text-align: right;">9,4</td>
<td style="text-align: right;">15,5</td>
<td style="text-align: right;">12 392,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q10</td>
<td style="text-align: right;">52,1</td>
<td style="text-align: right;">21,4</td>
<td style="text-align: right;">14,6</td>
<td style="text-align: right;">7,7</td>
<td style="text-align: right;">16,6</td>
<td style="text-align: right;">8,8</td>
<td style="text-align: right;">12,9</td>
<td style="text-align: right;">13,0</td>
<td style="text-align: right;">22,0</td>
<td style="text-align: right;">12 920,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q25</td>
<td style="text-align: right;">54,5</td>
<td style="text-align: right;">23,2</td>
<td style="text-align: right;">15,8</td>
<td style="text-align: right;">10,8</td>
<td style="text-align: right;">20,1</td>
<td style="text-align: right;">11,1</td>
<td style="text-align: right;">19,6</td>
<td style="text-align: right;">16,8</td>
<td style="text-align: right;">30,5</td>
<td style="text-align: right;">14 078,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q50</td>
<td style="text-align: right;">57,1</td>
<td style="text-align: right;">26,6</td>
<td style="text-align: right;">16,6</td>
<td style="text-align: right;">14,5</td>
<td style="text-align: right;">23,6</td>
<td style="text-align: right;">13,9</td>
<td style="text-align: right;">25,8</td>
<td style="text-align: right;">22,0</td>
<td style="text-align: right;">37,5</td>
<td style="text-align: right;">15 985,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q75</td>
<td style="text-align: right;">59,5</td>
<td style="text-align: right;">31,9</td>
<td style="text-align: right;">17,8</td>
<td style="text-align: right;">19,0</td>
<td style="text-align: right;">27,0</td>
<td style="text-align: right;">17,4</td>
<td style="text-align: right;">32,1</td>
<td style="text-align: right;">30,1</td>
<td style="text-align: right;">44,2</td>
<td style="text-align: right;">18 566,2</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q90</td>
<td style="text-align: right;">63,3</td>
<td style="text-align: right;">37,4</td>
<td style="text-align: right;">18,8</td>
<td style="text-align: right;">25,4</td>
<td style="text-align: right;">29,7</td>
<td style="text-align: right;">20,7</td>
<td style="text-align: right;">37,8</td>
<td style="text-align: right;">33,9</td>
<td style="text-align: right;">48,6</td>
<td style="text-align: right;">21 146,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q95</td>
<td style="text-align: right;">64,7</td>
<td style="text-align: right;">39,6</td>
<td style="text-align: right;">19,3</td>
<td style="text-align: right;">30,7</td>
<td style="text-align: right;">32,3</td>
<td style="text-align: right;">23,3</td>
<td style="text-align: right;">39,4</td>
<td style="text-align: right;">37,7</td>
<td style="text-align: right;">52,9</td>
<td style="text-align: right;">23 712,5</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Mean</td>
<td style="text-align: right;">57,3</td>
<td style="text-align: right;">28,1</td>
<td style="text-align: right;">16,7</td>
<td style="text-align: right;">15,8</td>
<td style="text-align: right;">23,4</td>
<td style="text-align: right;">14,4</td>
<td style="text-align: right;">25,5</td>
<td style="text-align: right;">23,0</td>
<td style="text-align: right;">36,9</td>
<td style="text-align: right;">16 658,7</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Std</td>
<td style="text-align: right;">4,4</td>
<td style="text-align: right;">6,6</td>
<td style="text-align: right;">1,6</td>
<td style="text-align: right;">7,6</td>
<td style="text-align: right;">6,3</td>
<td style="text-align: right;">5,1</td>
<td style="text-align: right;">9,7</td>
<td style="text-align: right;">9,3</td>
<td style="text-align: right;">12,3</td>
<td style="text-align: right;">3 611,9</td>
</tr>
<tr class="odd" data-grouplength="9">
<td colspan="11" style="border-bottom: 1px solid"><strong>groupe 3</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q5</td>
<td style="text-align: right;">50,6</td>
<td style="text-align: right;">27,5</td>
<td style="text-align: right;">16,3</td>
<td style="text-align: right;">6,2</td>
<td style="text-align: right;">8,6</td>
<td style="text-align: right;">6,8</td>
<td style="text-align: right;">6,0</td>
<td style="text-align: right;">7,6</td>
<td style="text-align: right;">7,5</td>
<td style="text-align: right;">16 976,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q10</td>
<td style="text-align: right;">51,9</td>
<td style="text-align: right;">28,8</td>
<td style="text-align: right;">17,1</td>
<td style="text-align: right;">7,7</td>
<td style="text-align: right;">10,4</td>
<td style="text-align: right;">8,4</td>
<td style="text-align: right;">7,0</td>
<td style="text-align: right;">8,6</td>
<td style="text-align: right;">8,7</td>
<td style="text-align: right;">18 434,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q25</td>
<td style="text-align: right;">53,8</td>
<td style="text-align: right;">30,9</td>
<td style="text-align: right;">18,3</td>
<td style="text-align: right;">10,2</td>
<td style="text-align: right;">12,6</td>
<td style="text-align: right;">10,8</td>
<td style="text-align: right;">9,1</td>
<td style="text-align: right;">11,1</td>
<td style="text-align: right;">11,0</td>
<td style="text-align: right;">19 785,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q50</td>
<td style="text-align: right;">56,5</td>
<td style="text-align: right;">35,0</td>
<td style="text-align: right;">18,9</td>
<td style="text-align: right;">13,4</td>
<td style="text-align: right;">15,2</td>
<td style="text-align: right;">14,1</td>
<td style="text-align: right;">12,3</td>
<td style="text-align: right;">13,1</td>
<td style="text-align: right;">14,8</td>
<td style="text-align: right;">22 289,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q75</td>
<td style="text-align: right;">59,4</td>
<td style="text-align: right;">38,7</td>
<td style="text-align: right;">19,6</td>
<td style="text-align: right;">17,6</td>
<td style="text-align: right;">17,9</td>
<td style="text-align: right;">17,5</td>
<td style="text-align: right;">15,9</td>
<td style="text-align: right;">15,5</td>
<td style="text-align: right;">21,5</td>
<td style="text-align: right;">24 522,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q90</td>
<td style="text-align: right;">62,7</td>
<td style="text-align: right;">41,1</td>
<td style="text-align: right;">20,0</td>
<td style="text-align: right;">24,8</td>
<td style="text-align: right;">20,5</td>
<td style="text-align: right;">20,5</td>
<td style="text-align: right;">18,9</td>
<td style="text-align: right;">18,4</td>
<td style="text-align: right;">27,6</td>
<td style="text-align: right;">27 600,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q95</td>
<td style="text-align: right;">64,3</td>
<td style="text-align: right;">44,3</td>
<td style="text-align: right;">20,2</td>
<td style="text-align: right;">30,6</td>
<td style="text-align: right;">21,8</td>
<td style="text-align: right;">23,5</td>
<td style="text-align: right;">21,0</td>
<td style="text-align: right;">20,6</td>
<td style="text-align: right;">32,2</td>
<td style="text-align: right;">29 732,8</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Mean</td>
<td style="text-align: right;">56,8</td>
<td style="text-align: right;">34,9</td>
<td style="text-align: right;">18,7</td>
<td style="text-align: right;">14,8</td>
<td style="text-align: right;">15,3</td>
<td style="text-align: right;">14,2</td>
<td style="text-align: right;">12,8</td>
<td style="text-align: right;">13,7</td>
<td style="text-align: right;">16,9</td>
<td style="text-align: right;">22 595,1</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Std</td>
<td style="text-align: right;">4,4</td>
<td style="text-align: right;">5,9</td>
<td style="text-align: right;">1,3</td>
<td style="text-align: right;">7,2</td>
<td style="text-align: right;">4,6</td>
<td style="text-align: right;">5,2</td>
<td style="text-align: right;">5,8</td>
<td style="text-align: right;">5,5</td>
<td style="text-align: right;">9,1</td>
<td style="text-align: right;">3 969,2</td>
</tr>
<tr class="odd" data-grouplength="9">
<td colspan="11" style="border-bottom: 1px solid"><strong>groupe 4</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q5</td>
<td style="text-align: right;">44,2</td>
<td style="text-align: right;">14,7</td>
<td style="text-align: right;">12,4</td>
<td style="text-align: right;">11,3</td>
<td style="text-align: right;">12,5</td>
<td style="text-align: right;">11,1</td>
<td style="text-align: right;">4,0</td>
<td style="text-align: right;">6,7</td>
<td style="text-align: right;">9,3</td>
<td style="text-align: right;">18 686,5</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q10</td>
<td style="text-align: right;">45,7</td>
<td style="text-align: right;">15,6</td>
<td style="text-align: right;">12,9</td>
<td style="text-align: right;">16,4</td>
<td style="text-align: right;">14,1</td>
<td style="text-align: right;">13,0</td>
<td style="text-align: right;">4,5</td>
<td style="text-align: right;">7,2</td>
<td style="text-align: right;">11,2</td>
<td style="text-align: right;">20 220,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q25</td>
<td style="text-align: right;">49,3</td>
<td style="text-align: right;">18,7</td>
<td style="text-align: right;">13,7</td>
<td style="text-align: right;">24,7</td>
<td style="text-align: right;">16,5</td>
<td style="text-align: right;">15,8</td>
<td style="text-align: right;">5,8</td>
<td style="text-align: right;">7,9</td>
<td style="text-align: right;">14,2</td>
<td style="text-align: right;">22 622,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q50</td>
<td style="text-align: right;">52,3</td>
<td style="text-align: right;">22,0</td>
<td style="text-align: right;">14,6</td>
<td style="text-align: right;">30,4</td>
<td style="text-align: right;">18,6</td>
<td style="text-align: right;">19,0</td>
<td style="text-align: right;">7,5</td>
<td style="text-align: right;">9,7</td>
<td style="text-align: right;">17,9</td>
<td style="text-align: right;">24 843,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q75</td>
<td style="text-align: right;">55,1</td>
<td style="text-align: right;">26,3</td>
<td style="text-align: right;">15,9</td>
<td style="text-align: right;">37,9</td>
<td style="text-align: right;">20,8</td>
<td style="text-align: right;">22,3</td>
<td style="text-align: right;">10,1</td>
<td style="text-align: right;">12,1</td>
<td style="text-align: right;">22,8</td>
<td style="text-align: right;">28 590,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q90</td>
<td style="text-align: right;">58,9</td>
<td style="text-align: right;">30,9</td>
<td style="text-align: right;">17,1</td>
<td style="text-align: right;">42,3</td>
<td style="text-align: right;">22,4</td>
<td style="text-align: right;">27,2</td>
<td style="text-align: right;">14,4</td>
<td style="text-align: right;">15,3</td>
<td style="text-align: right;">30,1</td>
<td style="text-align: right;">31 294,0</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Q95</td>
<td style="text-align: right;">60,8</td>
<td style="text-align: right;">34,5</td>
<td style="text-align: right;">18,3</td>
<td style="text-align: right;">45,7</td>
<td style="text-align: right;">23,2</td>
<td style="text-align: right;">28,9</td>
<td style="text-align: right;">19,3</td>
<td style="text-align: right;">18,6</td>
<td style="text-align: right;">33,2</td>
<td style="text-align: right;">34 574,0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Mean</td>
<td style="text-align: right;">52,3</td>
<td style="text-align: right;">22,8</td>
<td style="text-align: right;">14,9</td>
<td style="text-align: right;">30,3</td>
<td style="text-align: right;">18,4</td>
<td style="text-align: right;">19,4</td>
<td style="text-align: right;">8,8</td>
<td style="text-align: right;">10,9</td>
<td style="text-align: right;">19,5</td>
<td style="text-align: right;">25 547,4</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 0em;" data-indentlevel="1">Std</td>
<td style="text-align: right;">5,1</td>
<td style="text-align: right;">6,3</td>
<td style="text-align: right;">1,7</td>
<td style="text-align: right;">10,0</td>
<td style="text-align: right;">4,1</td>
<td style="text-align: right;">5,9</td>
<td style="text-align: right;">5,5</td>
<td style="text-align: right;">6,2</td>
<td style="text-align: right;">9,2</td>
<td style="text-align: right;">4 603,5</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</section></section><section id="sec-13462" class="level4" data-number="13.4.5.2"><h4 data-number="13.4.5.2" class="anchored" data-anchor-id="sec-13462">
<span class="header-section-number">13.4.5.2</span> Mise en œuvre du <em>c-medoids</em> dans R</h4>
<p>La méthode du <em>c-medoids</em> dans R peut être mise en œuvre avec la fonction <code>FKM.med</code> du <em>package</em> <code>fclust</code>. Le processus d’analyse et de validation est identique à celui présenté ci-dessus pour le <em>c-means</em>. Nous ne donnons donc pas un exemple complet de la méthode.</p>
<div class="bloc_aller_loin">
<div class="bloc_aller_loin-header">
<div class="bloc_aller_loin-icon">

</div>
<p><strong>Stabilité des groupes obtenus par les méthodes de nuées dynamiques</strong></p>
</div>
<div class="bloc_aller_loin-body">
<p>Puisque la méthode <em>k-means</em> et ses variantes reposent sur une initialisation aléatoire de leur algorithme, les résultats peuvent varier en fonction de cet état de départ. Dans certains contextes, il est possible que les résultats obtenus varient significativement, ce qui signifie que les groupes obtenus ne sont pas représentatifs de la population étudiée. Une solution pour vérifier si ce problème se pose est simplement de relancer l’algorithme un grand nombre de fois (généralement 1000) et de comparer les résultats obtenus au cours de ces réplications.</p>
<p>Cette méthode est rarement implémentée directement et requiert d’écrire sa propre fonction. <code>geocmeans</code> dispose d’une fonction déjà existante, mais ne pouvant être appliquée qu’avec l’algorithme <em>c-means</em>. Nous proposons ici une implémentation pour la méthode <em>k-means</em> qui peut facilement être adaptée aux autres méthodes de classifications heuristiques.</p>
<p>La démarche à suivre est la suivante&nbsp;:</p>
<ol type="1">
<li><p>Appliquer l’algorithme une première fois pour obtenir une classification de référence à laquelle nous comparerons toutes les réplications.</p></li>
<li>
<p>Effectuer 1000 itérations au cours desquelles&nbsp;:</p>
<ul>
<li>Une nouvelle classification est calculée.</li>
<li>Les groupes obtenus sont comparés à ceux de la classification de référence.</li>
<li>L’indice de Jacard est calculé entre les groupes des deux classifications.</li>
<li>Les valeurs de l’indice de Jacard sont enregistrées.</li>
<li>Les centres des groupes sont enregistrés.</li>
</ul>
</li>
</ol>
<p>Ainsi, nous obtenons 1000 valeurs de l’indice de Jacard pour chaque groupe. Cet indice permet de mesurer le degré d’accord entre deux variables (ici les probabilités d’appartenance des observations au même groupe pour deux classifications différentes.) Une valeur moyenne en dessous de 0,5 indique qu’un groupe est très instable, car nous obtenons des résultats très différents lors des réplications. Une valeur entre 0,6 et 0,75 indique qu’un groupe semble bien exister dans les données, bien que marqué par une certaine incertitude. Une valeur au-dessus de 0,8 indique un groupe bien identifié et stable.</p>
<p>Nous obtenons également les centres des groupes des 1000 classifications. Il est ainsi possible de représenter leurs histogrammes et de déterminer si les centres des groupes sont stables (unimodalité et faible variance) ou incertains (plusieurs modes et/ou forte variance).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># X sera le jeu de données pour la classification</span></span>
<span><span class="co"># clust_ref sera le vecteur indiquant le groupe de chaque observation obtenu par kmeans</span></span>
<span><span class="co"># nsim sera le nombre de simulations à effectuer</span></span>
<span><span class="va">kmeans_stability</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">clust_ref</span>, <span class="va">nsim</span>, <span class="va">verbose</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># définition de la matrice d'appartenance originale</span></span>
<span>  <span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">clust_ref</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">ref_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://jacobkap.github.io/fastDummies/reference/dummy_cols.html">dummy_cols</a></span><span class="op">(</span><span class="va">clust_ref</span>, remove_selected_columns <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">ref_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"groupe_"</span>,<span class="fl">1</span><span class="op">:</span><span class="va">k</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># lancement des itérations</span></span>
<span>  <span class="va">sim_resultats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nsim</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>    </span>
<span>     <span class="co"># afficher la progression si requis</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">verbose</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"iteration numeros : "</span>, <span class="va">i</span>, <span class="st">"/"</span>, <span class="va">nsim</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="co"># calculer le kmeans</span></span>
<span>    <span class="va">km_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">k</span><span class="op">)</span></span>
<span>    <span class="va">sim_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://jacobkap.github.io/fastDummies/reference/dummy_cols.html">dummy_cols</a></span><span class="op">(</span><span class="va">km_res</span><span class="op">$</span><span class="va">cluster</span>, remove_selected_columns <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># ajustement de l'ordre des groupes avec geocmeans</span></span>
<span>    <span class="va">sim_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geocmeans/man/groups_matching.html">groups_matching</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html">as.matrix</a></span><span class="op">(</span><span class="va">ref_mat</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html">as.matrix</a></span><span class="op">(</span><span class="va">sim_mat</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># calcul des indices de jacard</span></span>
<span>    <span class="va">jac_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">k</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/geocmeans/man/calc_jaccard_idx.html">calc_jaccard_idx</a></span><span class="op">(</span><span class="va">sim_mat</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span>, <span class="va">ref_mat</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># récuperation des centres des groupes</span></span>
<span>    <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">".data_"</span> , <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">sim_mat</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">centers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">km_res</span><span class="op">$</span><span class="va">centers</span><span class="op">)</span></span>
<span>    <span class="va">centers</span> <span class="op">&lt;-</span> <span class="va">centers</span><span class="op">[</span><span class="va">idx</span>,<span class="op">]</span></span>
<span>    <span class="va">centers</span><span class="op">$</span><span class="va">groupe</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">k</span></span>
<span>    </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="st">"jac_idx"</span> <span class="op">=</span> <span class="va">jac_idx</span>,</span>
<span>      <span class="st">"centers"</span> <span class="op">=</span> <span class="va">centers</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># les simulations sont finies, nous pouvons combiner les résultats</span></span>
<span>  <span class="va">all_jac_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">sim_resultats</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">$</span><span class="va">jac_idx</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">all_centers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">sim_resultats</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">$</span><span class="va">centers</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"jacard_values"</span> <span class="op">=</span> <span class="va">all_jac_values</span>,</span>
<span>    <span class="st">"centers"</span> <span class="op">=</span> <span class="va">all_centers</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il ne nous reste plus qu’à utiliser notre nouvelle fonction pour déterminer si les groupes obtenus avec notre <em>k-means</em> sont stables.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># NB : LyonIris est un objet spatial, il faut donc extraire uniquement son DataFrame</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Lden"</span> , <span class="st">"NO2"</span> , <span class="st">"PM25"</span> , <span class="st">"VegHautPrt"</span> , <span class="st">"Pct0_14"</span> , <span class="st">"Pct_65"</span> , <span class="st">"Pct_Img"</span>,</span>
<span>                     <span class="st">"TxChom1564"</span> , <span class="st">"Pct_brevet"</span> , <span class="st">"NivVieMed"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Centrage et réduction de chaque colonne du DataFrame</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">col</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">X</span><span class="op">[[</span><span class="va">col</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">X</span><span class="op">[[</span><span class="va">col</span><span class="op">]</span><span class="op">]</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># calcul du kmeans de référence</span></span>
<span><span class="va">kmeans_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># application de la fonction de stabilité</span></span>
<span><span class="va">stab_results</span> <span class="op">&lt;-</span> <span class="fu">kmeans_stability</span><span class="op">(</span><span class="va">X</span>, <span class="va">kmeans_ref</span><span class="op">$</span><span class="va">cluster</span>, nsim <span class="op">=</span> <span class="fl">1000</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous pouvons à présent vérifier la stabilité de nos quatre groupes.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">jacard_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">stab_results</span><span class="op">$</span><span class="va">jacard_values</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">jacard_values</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"groupe"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">jacard_values</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">groupes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">groupes</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Indice de Jacard"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-kmeansStab3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-kmeansStab3-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.29: Indices de Jacard obtenus sur 1000 réplications du k-means</figcaption></figure>
</div>
</div>
</div>
<p>La <a href="#fig-kmeansStab3">figure&nbsp;<span class="quarto-unresolved-ref">fig-kmeansStab3</span></a> indique clairement que les groupes 1 et 2 sont très stables, car les valeurs de Jacard obtenues sont le plus souvent supérieures à 0,75. Le groupe 3 a le plus souvent des valeurs légèrement inférieures aux deux premiers groupes, mais tout de même bien supérieures à 0,5. En revanche, le groupe 4 a un grand nombre de valeurs inférieures à 0,5 indiquant une tendance du groupe à se dissoudre lors des réplications.</p>
<p>Considérant que le dernier groupe est le plus instable, nous décidons d’observer les valeurs des centres qu’il obtient pour les différentes réplications.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">centers_groupe4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">stab_results</span><span class="op">$</span><span class="va">centers</span>, <span class="va">stab_results</span><span class="op">$</span><span class="va">centers</span><span class="op">$</span><span class="va">groupe</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">centers_groupe4</span><span class="op">$</span><span class="va">groupe</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">centers_groupe4</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">3</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-kmeansStab4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-kmeansStab4-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.30: Distributions des valeurs des centres du groupe 4 sur 1000 itérations</figcaption></figure>
</div>
</div>
</div>
<p>Les différents histogrammes de la <a href="#fig-kmeansStab4">figure&nbsp;<span class="quarto-unresolved-ref">fig-kmeansStab4</span></a> indiquent clairement que pour plusieurs variables (<code>Lden</code>, <code>NO2</code>, <code>PM25</code>, <code>Pct_Img</code>, et <code>NivVieMed</code>) les caractéristiques du groupe 4 varient grandement sur l’ensemble des réplications. Nous pouvons comparer ce graphique à celui du groupe 2 qui est bien plus stable.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">centers_groupe2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">stab_results</span><span class="op">$</span><span class="va">centers</span>, <span class="va">stab_results</span><span class="op">$</span><span class="va">centers</span><span class="op">$</span><span class="va">groupe</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">centers_groupe2</span><span class="op">$</span><span class="va">groupe</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">centers_groupe2</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">3</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-kmeansStab5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="13-MethodeClassification_files/figure-html/fig-kmeansStab5-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.31: Distributions des valeurs des centres du groupe 2 sur 1000 itérations</figcaption></figure>
</div>
</div>
</div>
<p>Nous pouvons constater une plus faible variance des résultats obtenus (en regardant notamment l’axe horizontal) pour les centres des groupes à la <a href="#fig-kmeansStab5">figure&nbsp;<span class="quarto-unresolved-ref">fig-kmeansStab5</span></a>.</p>
</div>
</div>
</section></section></section><section id="sec-135" class="level2" data-number="13.5"><h2 data-number="13.5" class="anchored" data-anchor-id="sec-135">
<span class="header-section-number">13.5</span> Conclusion sur la cinquième partie</h2>
<p>Dans le cadre de cette cinquième partie du livre, nous avons abordé les principales méthodes factorielles et les principales méthodes de classification non supervisée. Les premières sont des méthodes de réduction de données puisqu’elles permettent de résumer l’information d’un tableau en quelques nouvelles variables synthétiques. Les secondes permettent de regrouper les observations d’un tableau en plusieurs groupes homogènes. Il existe donc une complémentarité évidente entre ces deux groupes de méthodes&nbsp;: si le tableau initial comprend un grand nombre de variables, il est possible de lui appliquer une méthode factorielle produisant de nouvelles variables synthétiques qui sont ensuite utilisées pour calculer une méthode de classification non supervisée.</p>
<div id="fig-MFMCComplementarite" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap13/AnalysesFactoClassif.png" class="img-fluid figure-img" style="width:45.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;13.32: Complémentarité entre les méthodes factorielles et les méthodes de classification non supervisée</figcaption></figure>
</div>
</section><section id="sec-136" class="level2" data-number="13.6"><h2 data-number="13.6" class="anchored" data-anchor-id="sec-136">
<span class="header-section-number">13.6</span> Quiz de révision du chapitre</h2>
<div id="quizz_classif" class="card">
<link type="text/javascript" src="libs/quizlib.1.0.1.min.js">
<script>var Quiz=function(a,b){this.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),this.unansweredQuestionText="Question sans réponse !",this.container=document.getElementById(a),this.questions=[],this.result=new QuizResult,this.answers=b;for(var c=0;c<this.container.children.length;c++)this.container.children[c].classList.contains(Quiz.Classes.QUESTION)&&this.questions.push(this.container.children[c]);if(this.answers.length!=this.questions.length)throw new Error("Number of answers does not match number of questions!")};Quiz.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),Quiz.prototype.checkAnswers=function(a){void 0===a&&(a=!0);for(var b=[],c=[],d=0;d<this.questions.length;d++){var e=this.questions[d],f=this.answers[d],g=[];this.clearHighlights(e);for(var h,i=e.getElementsByClassName(Quiz.Classes.QUESTION_ANSWERS)[0].getElementsByTagName("input"),j=0;j<i.length;j++)h=i[j],"checkbox"===h.type||"radio"===h.type?h.checked&&g.push(h.value):""!==h.value&&g.push(h.value);1!=g.length||Array.isArray(f)?0===g.length&&b.push(e):g=g[0],c.push(Utils.compare(g,f))}if(0===b.length||!a)return this.result.setResults(c),!0;for(d=0;d<b.length;d++){var k=document.createElement("span");k.appendChild(document.createTextNode(this.unansweredQuestionText)),k.className=Quiz.Classes.QUESTION_WARNING,b[d].getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].appendChild(k)}return!1},Quiz.prototype.clearHighlights=function(a){for(var b=a.getElementsByClassName(Quiz.Classes.QUESTION_WARNING);b.length>0;)b[0].parentNode.removeChild(b[0]);var c,d=[a.getElementsByClassName(Quiz.Classes.CORRECT),a.getElementsByClassName(this.Classes.INCORRECT)];for(i=0;i<d.length;i++)for(;d[i].length>0;)c=d[i][0],c.classList.remove(Quiz.Classes.CORRECT),c.classList.remove(Quiz.Classes.INCORRECT);for(var e=a.getElementsByClassName(Quiz.Classes.TEMP);e.length>0;)e[0].parentNode.removeChild(e[0])},Quiz.prototype.highlightResults=function(a){for(var b,c=0;c<this.questions.length;c++)b=this.questions[c],b.getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].classList.add(this.result.results[c]?Quiz.Classes.CORRECT:Quiz.Classes.INCORRECT),void 0!==a&&a(this,b,c,this.result.results[c])};var QuizResult=function(){this.results=[],this.totalQuestions=0,this.score=0,this.scorePercent=0,this.scorePercentFormatted=0};QuizResult.prototype.setResults=function(a){this.results=a,this.totalQuestions=this.results.length,this.score=0;for(var b=0;b<this.results.length;b++)this.results[b]&&this.score++;this.scorePercent=this.score/this.totalQuestions,this.scorePercentFormatted=Math.floor(100*this.scorePercent)};var Utils=function(){};Utils.compare=function(a,b){if(a.length!=b.length)return!1;if(Array.isArray(a)&&Array.isArray(b)){for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b};

function showResults(quiz) {
    // Check answers and continue if all questions have been answered
    if (quiz.checkAnswers()) {
        var quizScorePercent = quiz.result.scorePercentFormatted; // The unformatted percentage is a decimal in range 0 - 1
        var quizResultElement = document.getElementById('quiz-result');
        quizResultElement.style.display = 'block';
        document.getElementById('quiz-percent').innerHTML = quizScorePercent.toString();

        // Change background colour of results div according to score percent
        if (quizScorePercent > 75) quizResultElement.style.backgroundColor = '#4caf50';
        else if (quizScorePercent > 50) quizResultElement.style.backgroundColor = '#ffc107';
        else if (quizScorePercent > 25) quizResultElement.style.backgroundColor = '#ff9800';
        else if (quizScorePercent > 0) quizResultElement.style.backgroundColor = '#f44336';

        // Highlight questions according to whether they were correctly answered. The callback allows us to highlight/show the correct answer
        quiz.highlightResults(handleAnswers);
    }
}

/** Callback for Quiz.highlightResults. Highlights the correct answers of incorrectly answered questions
 * Parameters are: the quiz object, the question element, question number, correctly answered flag
 */
function handleAnswers(quiz, question, no, correct) {
    if (!correct) {
        var answers = question.getElementsByTagName('input');
        for (var i = 0; i < answers.length; i++) {
            if (answers[i].type === 'checkbox' || answers[i].type === 'radio'){
                // If the current input element is part of the correct answer, highlight it
                if (quiz.answers[no].indexOf(answers[i].value) > -1) {
                    answers[i].parentNode.classList.add(Quiz.Classes.CORRECT);
                }
            } else {
                // If the input is anything other than a checkbox or radio button, show the correct answer next to the element
                var correctAnswer = document.createElement('span');
                correctAnswer.classList.add(Quiz.Classes.CORRECT);
                correctAnswer.classList.add(Quiz.Classes.TEMP); // quiz.checkAnswers will automatically remove elements with the temp class
                correctAnswer.innerHTML = quiz.answers[no];
                correctAnswer.style.marginLeft = '10px';
                answers[i].parentNode.insertBefore(correctAnswer, answers[i].nextSibling);
            }
        }
    }
}

  var quizz_quizz_classif;
  window.onload = function() {
    quizz_quizz_classif = new Quiz('quizz_classif', ['2','1',['1', '4'],['2', '4'],'c-medoids']);
  };</script><link rel="stylesheet" type="text/css" src="css/quizlib.min.css">
<div class="card quizlib-question">
<div class="quizlib-question-title">
Les méthodes de classification non supervisée sont appelées ainsi puisque :
</div>
<div>
Relisez au besoin la <a href="#sec-131">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-131</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>le nombre de groupes générés par ces méthodes est déterminé automatiquement</label>
</td>
<td>
<input type="radio" name="q1" value="1">
</td>
</tr>
<tr>
<td>
<label>les groupes sont inconnus au préalable et formés automatiquement par ces méthodes</label>
</td>
<td>
<input type="radio" name="q1" value="2">
</td>
</tr>
<tr>
<td>
<label>l’exécution de ces algorithmes ne nécessite pas de supervision</label>
</td>
<td>
<input type="radio" name="q1" value="3">
</td>
</tr>
<tr>
<td>
<label>aucun paramètre n’est à définir pour exécuter ces méthodes</label>
</td>
<td>
<input type="radio" name="q1" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
En quoi se distinguent les méthodes de classifications strictes et floues?
</div>
<div>
Relisez au besoin la <a href="#sec-131">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-131</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Les premières attribuent chaque observation à un seul groupe alors que les secondes évaluent le degré d’appartenance des observations à chaque groupe</label>
</td>
<td>
<input type="radio" name="q2" value="1">
</td>
</tr>
<tr>
<td>
<label>Les méthodes strictes produisent des classifications comportant un moins grand nombre de degrés de liberté</label>
</td>
<td>
<input type="radio" name="q2" value="2">
</td>
</tr>
<tr>
<td>
<label>Les méthodes strictes produisent toujours les mêmes résultats, alors que les méthodes floues reposent sur un état initial aléatoire pouvant conduire à des résultats différents</label>
</td>
<td>
<input type="radio" name="q2" value="3">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quels paramètres doivent être définis pour exécuter l’algorithme c-means?
</div>
<div>
Relisez au besoin la <a href="#sec-1344">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-1344</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>k, soit le nombre de groupes à obtenir</label>
</td>
<td>
<input type="checkbox" name="q3" value="1">
</td>
</tr>
<tr>
<td>
<label>alpha, soit le paramètre contrôlant la vitesse de convergence</label>
</td>
<td>
<input type="checkbox" name="q3" value="2">
</td>
</tr>
<tr>
<td>
<label>lambda, soit la probabilité minimale qu’une observation appartiennent à un groupe</label>
</td>
<td>
<input type="checkbox" name="q3" value="3">
</td>
</tr>
<tr>
<td>
<label>m, soit le paramètre contrôlant le niveau de flou dans une classification floue</label>
</td>
<td>
<input type="checkbox" name="q3" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
La classification ascendante hiérarchique nécessite de calculer :
</div>
<div>
Relisez au besoin la <a href="#sec-133">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-133</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>la distance entre chaque observation et ses k plus proches voisins</label>
</td>
<td>
<input type="checkbox" name="q4" value="1">
</td>
</tr>
<tr>
<td>
<label>la distance entre l’ensemble des paires d’observations</label>
</td>
<td>
<input type="checkbox" name="q4" value="2">
</td>
</tr>
<tr>
<td>
<label>la probabilité pour chaque observation d’appartenir à chaque groupe</label>
</td>
<td>
<input type="checkbox" name="q4" value="3">
</td>
</tr>
<tr>
<td>
<label>un dendrogramme, soit une structure hiérarchique permettant de conserver l’ordre dans lequel les groupes sont formés par l’algorithme</label>
</td>
<td>
<input type="checkbox" name="q4" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Pour effectuer une classification non supervisée floue utilisant comme centres de groupes de réelles observations plutôt que des moyennes fictives, quelle méthode peut-on utiliser?
</div>
<div>
Relisez au besoin la <a href="#sec-1344">section&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-1344</span></a>.
</div>
<div class="quizlib-question-answers">
<p><input type="text" name="q5"></p>
</div>
</div>
<button type="button" onclick="showResults(quizz_quizz_classif);" id="buttonID">
Vérifier votre résultat
</button>
<div id="quiz-result" class="card">
<p><span id="quiz-percent"></span></p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-aggarwal2001surprising" class="csl-entry" role="listitem">
Aggarwal, Charu C, Alexander Hinneburg et Daniel A Keim. 2001. <span>«&nbsp;On the surprising behavior of distance metrics in high dimensional space.&nbsp;»</span> In <em>International conference on database theory</em>, 420‑434. Springer.
</div>
<div id="ref-apparicio2010accessibilite" class="csl-entry" role="listitem">
Apparicio, Philippe, Marie-Soleil Cloutier, Anne-Marie Séguin et Josefina Ades. 2010. <span>«&nbsp;Accessibilit<span>é</span> spatiale aux parcs urbains pour les enfants et injustice environnementale. Exploration du cas montr<span>é</span>alais.&nbsp;»</span> <em>Revue internationale de g<span>é</span>omatique</em> 20 (3): 363‑389. <a href="http://rig.revuesonline.com/article.jsp?articleId=15208">http://rig.revuesonline.com/article.jsp?articleId=15208</a>.
</div>
<div id="ref-bair2013semi" class="csl-entry" role="listitem">
Bair, Eric. 2013. <span>«&nbsp;Semi-supervised clustering methods.&nbsp;»</span> <em>Wiley Interdisciplinary Reviews: Computational Statistics</em> 5 (5): 349‑361. <a href="https://dx.doi.org/10.1002%2Fwics.1270">https://dx.doi.org/10.1002%2Fwics.1270</a>.
</div>
<div id="ref-chandra1936generalised" class="csl-entry" role="listitem">
Chandra, Mahalanobis Prasanta. 1936. <span>«&nbsp;On the generalised distance in statistics.&nbsp;»</span> In <em>Proceedings of the National Institute of Sciences of India</em>, 2:49‑55. 1. s.n.
</div>
<div id="ref-fukuyama1989" class="csl-entry" role="listitem">
Fukuyama, Yoshiki. 1989. <span>«&nbsp;A new method of choosing the number of clusters for the fuzzy c-mean method.&nbsp;»</span> In <em>Proc. 5th Fuzzy Syst. Symp., 1989</em>, 247‑250. s.n.
</div>
<div id="ref-2021_4" class="csl-entry" role="listitem">
Gelb, Jérémy et Philippe Apparicio. 2021. <span>«&nbsp;Apport de la classification floue c-means spatiale en g<span>é</span>ographie: essai de taxinomie socio-r<span>é</span>sidentielle et environnementale <span>à</span> Lyon.&nbsp;»</span> <em>Cybergeo: European Journal of Geography</em>. <a href="https://doi.org/10.4000/cybergeo.36414">https://doi.org/10.4000/cybergeo.36414</a>.
</div>
<div id="ref-gower1971general" class="csl-entry" role="listitem">
Gower, John C. 1971. <span>«&nbsp;A general coefficient of similarity and some of its properties.&nbsp;»</span> <em>Biometrics</em>: 857‑871. <a href="https://doi.org/10.2307/2528823">https://doi.org/10.2307/2528823</a>.
</div>
<div id="ref-macqueen1967" class="csl-entry" role="listitem">
MacQueen, James. 1967. <span>«&nbsp;Some methods for classification and analysis of multivariate observations.&nbsp;»</span> In <em>Proceedings of the fifth Berkeley symposium on mathematical statistics and probability</em>, 1:281‑297. 14. Oakland, CA, USA.
</div>
<div id="ref-tibshirani2001estimating" class="csl-entry" role="listitem">
Tibshirani, Robert, Guenther Walther et Trevor Hastie. 2001. <span>«&nbsp;Estimating the number of clusters in a data set via the gap statistic.&nbsp;»</span> <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 63 (2): 411‑423. <a href="https://doi.org/10.1111/1467-9868.00293">https://doi.org/10.1111/1467-9868.00293</a>.
</div>
<div id="ref-ward1963hierarchical" class="csl-entry" role="listitem">
Ward, Joe H. 1963. <span>«&nbsp;Hierarchical grouping to optimize an objective function.&nbsp;»</span> <em>Journal of the American statistical association</em> 58 (301): 236‑244. <a href="https://doi.org/10.1080/01621459.1963.10500845">https://doi.org/10.1080/01621459.1963.10500845</a>.
</div>
<div id="ref-xie1991validity" class="csl-entry" role="listitem">
Xie, Xuanli Lisa et Gerardo Beni. 1991. <span>«&nbsp;A validity measure for fuzzy clustering.&nbsp;»</span> <em>IEEE Transactions on pattern analysis and machine intelligence</em> 13 (8): 841‑847. <a href="https://doi.org/10.1109/34.85677">https://doi.org/10.1109/34.85677</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./12-AnalysesFactorielles.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Méthodes factorielles</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./14-Annexes.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Annexes</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Méthodes quantitatives en sciences sociales : un grand bol d’R.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Ce livre a été réalisé avec <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>