{
  "hash": "354cbb2690bca74b987a0c84eb2ee3c0",
  "result": {
    "markdown": "# Méthodes factorielles {#sec-chap12}\n\nDans le cadre de ce chapitre, nous présentons les trois méthodes factorielles les plus utilisées en sciences sociales : l'analyse en composantes principales (ACP, [section @sec-122]), l'analyse factorielle des correspondances (AFC, [section @sec-123]) et l'analyse factorielle des correspondances multiples (ACM, [section @sec-124]). Ces méthodes, qui permettent d'explorer et de synthétiser l'information de différents tableaux de données, relèvent de la statistique exploratoire multidimensionnelle.\n\n::: bloc_package\n::: bloc_package-header\n::: bloc_package-icon\n:::\n**Liste des *packages* utilisés dans ce chapitre**\n:::\n::: bloc_package-body\n\n* Pour créer des graphiques :\n  - `ggplot2`, le seul, l'unique!\n  - `ggpubr` pour combiner des graphiques.\n* Pour les analyses factorielles :\n  - `FactoMineR` pour réaliser une ACP, une AFC et une ACM.\n  - `factoextra` pour réaliser des graphiques à partir des résultats d'une analyse factorielle.\n  - `explor` pour les résultats d'une ACP, d'une AFC ou d'une ACM avec une interface Web interactive.\n* Autres *packages* :\n  - `geocmeans` pour un jeu de données utilisé pour calculer une ACP.\n  - `ggplot2`, `ggpubr`, `stringr` et `corrplot` pour réaliser des graphiques personnalisés sur les résultats d'une analyse factorielle.\n  - `tmap` et `RColorBrewer` pour cartographier les coordonnées factorielles.\n  - `Hmisc` pour l'obtention d'une matrice de corrélation.\n:::\n:::\n\n::: bloc_objectif\n::: bloc_objectif-header\n::: bloc_objectif-icon\n:::\n**Réduction de données et identification de variables latentes**\n:::\n::: bloc_objectif-body\nLes méthodes factorielles sont souvent dénommées des **méthodes de réduction de données**, en raison de leur objectif principal : résumer l'information d'un tableau en quelques nouvelles variables synthétiques (@fig-AnalysesFactoriellesFig). Ainsi, elles permettent de réduire l'information d'un tableau volumineux — comprenant par exemple 1000 observations et 100 variables — en *p* nouvelles variables (par exemple cinq avec toujours 1000 observations) résumant *X* % de l'information contenue dans le tableau initial. Lebart et al. [-@lebart1995statistique, p.13] proposent une formulation plus mathématique : ils signalent qu'avec les méthodes factorielles, « on cherche à réduire les dimensions du tableau de données en représentant les associations entre individus et entre variables dans des espaces de faibles dimensions ».\n\n![Principe de base des analyses factorielles](images/Chap12/AnalysesFactorielles.png){#fig-AnalysesFactoriellesFig width=\"40%\" fig-align=\"center\"}\n\n\nCes nouvelles variables synthétiques peuvent être considérées comme des **variables latentes** puisqu’elles ne sont pas directement observées; elles sont plutôt produites par la méthode factorielle utilisée afin de résumer les relations/associations entre plusieurs variables mesurées initialement.\n:::\n:::\n\n## Aperçu des méthodes factorielles {#sec-121}\n\n### Méthodes factorielles et types de données {#sec-1211}\n\nEn analyse factorielle, la nature même des données du tableau à traiter détermine la méthode à employer : l’analyse en composantes principales (ACP) est adaptée aux tableaux avec des variables continues (idéalement normalement distribuées), l’analyse factorielle des correspondances (AFC) s’applique à des tableaux de contingence tandis que l’analyse des correspondances multiples (ACM) permet de résumer des tableaux avec des données qualitatives (issues d'un sondage par exemple) (@tbl-typesanalysesfactorielles). Sachez toutefois qu'il existe d'autres méthodes factorielles qui ne sont pas abordées dans ce chapitre, notamment : l'analyse factorielle de données mixtes (AFDM) permettant d'explorer des tableaux avec à la fois des variables continues et des variables qualitatives et l'analyse factorielle multiple hiérarchique (AFMH) permettant de traiter des tableaux avec une structure hiérarchique. Pour s'initier à ces deux autres méthodes factorielles plus récentes, consultez notamment l'excellent ouvrage de Jérôme Pagès [-@pages2013analyse].\n\n\n::: {#tbl-typesanalysesfactorielles .cell tbl-cap='Trois principales méthodes factorielles'}\n::: {.cell-output-display}\n|Méthode factorielle                               |Abr. |Type de données        |Type de distance     |\n|:-------------------------------------------------|:----|:----------------------|:--------------------|\n|Analyse en composantes principales                |ACP  |Variables continues    |Distance euclidienne |\n|Analyse factorielle des correspondances           |AFC  |Tableau de contingence |Distance du khi-deux |\n|Analyse factorielle des correspondances multiples |ACM  |Variables qualitatives |Distance du khi-deux |\n:::\n:::\n\n\n### Bref historique des méthodes factorielles {#sec-1212}\n\nIl existe une longue tradition de l'utilisation des méthodes factorielles dans le monde universitaire francophone puisque plusieurs d'entre elles ont été proposées par des statisticiens et des statisticiennes francophones à partir des années 1960. L’analyse en composantes principales (ACP) a été proposée dès les années 1930 par le statisticien américain Harold Hotelling [-@hotelling1933analysis]. En revanche, l’analyse des correspondances (AFC) et son extension, l’analyse des correspondances multiples (ACM), ont été proposées par le statisticien français Jean-Paul Benzécri [-@benzecri1973analyse], tandis que l’analyse factorielle de données mixtes (AFDM) a été proposée par Brigitte Escofier et Jérôme Pagès [@escofier1979traitement; @pages2002analyse].\n\nAinsi, plusieurs ouvrages de statistique  sur les méthodes factorielles, désormais classiques, ont été publiés en français [@benzecri1973analyse; @escofier1998analyses; @lebart1995statistique; @pages2013analyse]. Ils méritent grandement d'être consultés, notamment pour mieux comprendre les formulations mathématiques (matricielles et géométriques) de ces méthodes. À cela s'ajoutent plusieurs ouvrages visant à « vulgariser ces méthodes » en sciences sociales; c'est notamment le cas de l'excellent ouvrage de Léna Sanders [-@sanders1989analyse] en géographie.\n\n\n## Analyses en composantes principales (ACP) {#sec-122}\n\nD'emblée, notez qu'il existe deux types d'analyse en composantes principales (ACP) (*Principal Component Analysis, PCA* en anglais) : \n\n- **l'ACP non normée** dans laquelle les variables quantitatives du tableau sont uniquement centrées (moyenne = 0).\n\n- **l'ACP normée** dans laquelle les variables quantitatives du tableau sont préalablement centrées réduites (moyenne = 0 et variance = 1; [section @sec-02552]).\n\nPuisque les variables d'un tableau sont souvent exprimées dans des unités de mesure différentes ou avec des ordres de grandeur différents (intervalles et écarts-types bien différents), l'utilisation de l'ACP normée est bien plus courante. Elle est d'ailleurs l'option par défaut dans les fonctions R permettant de calculer une ACP. Par conséquent, nous détaillons dans cette section uniquement l'ACP normée.\n\nAutrement dit, le recours à une ACP non normée est plus rare et s'applique uniquement à la situation suivante : toutes les variables du tableau sont mesurées dans la même unité (par exemple, en pourcentage); il pourrait être ainsi judicieux de conserver leurs variances respectives.\n\n### Recherche d'une simplification {#sec-1221}\n\nL’ACP permet d'explorer et de résumer un tableau constitué uniquement de variables quantitatives (@fig-AnalysesFactoriellesTabACPFig), et ce, de trois façons : 1) en montrant les ressemblances entre les individus (observations), 2) en révélant les liaisons entre les variables quantitatives et 3) en résumant l’ensemble des variables du tableau par des variables synthétiques nommées composantes principales.\n\n\n![Tableau pour une ACP](images/Chap12/AnalysesFactoriellesTabACP.png){#fig-AnalysesFactoriellesTabACPFig width=\"60%\" fig-align=\"center\"}\n\n**Ressemblance entre les individus**. Concrètement, deux individus se ressemblent si leurs valeurs respectives pour les *p* variables du tableau sont similaires. Cette proximité/ressemblance est évaluée à partir de la distance euclidienne (@eq-ACPdistEuc). La notion de distance fait l'objet d'une section à part entière ([section @sec-1321]) que vous pouvez consulter dès à présent si elle ne vous est pas familière.\n\n$$\nd^2(a,b) = \\sum_{j=1}^p(x_{aj}-x_{bj})^2\n$$ {#eq-ACPdistEuc}\n\n\nPrenons un exemple fictif avec trois individus (*i*, *j* et *k*) ayant des valeurs pour trois variables préalablement centrées réduites (V1 à V3) (@tbl-distanceACPindi). La proximité entre les paires de points est évaluée comme suit : \n\n$$d^2(i,j)=(-\\mbox{1,15}-\\mbox{0,49})^2+(-\\mbox{1,15}-\\mbox{0,58})^2+(\\mbox{0,83}+\\mbox{1,11})^2=\\mbox{9,44}$$\n$$d^2(i,k)=(-\\mbox{1,15}+\\mbox{0,66})^2+(-\\mbox{1,15}-\\mbox{0,58})^2+(\\mbox{0,83}-\\mbox{0,28})^2=\\mbox{5,98}$$\n\n$$d^2(j,k)= (\\mbox{0,49}+\\mbox{0,66})^2+(\\mbox{0,58}-\\mbox{0,58})^2+(-\\mbox{1,11}-\\mbox{0,28})^2=\\mbox{1,97}$$\n\nNous pouvons en conclure que *i* est plus proche de *k* que de *j*, mais aussi que la paire de points les plus proches est (*i*,*k*). En d'autres termes, les deux observations *i* et *k* sont les plus similaires du jeu de données selon la distance euclidienne.\n\n\n::: {#tbl-distanceACPindi .cell tbl-cap='Données fictives'}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Variables centrées réduites</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:center;\"> Individu </th>\n   <th style=\"text-align:center;\"> V1 </th>\n   <th style=\"text-align:center;\"> V2 </th>\n   <th style=\"text-align:center;\"> V3 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> i </td>\n   <td style=\"text-align:center;\"> -1,15 </td>\n   <td style=\"text-align:center;\"> -1,15 </td>\n   <td style=\"text-align:center;\"> 0,83 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> j </td>\n   <td style=\"text-align:center;\"> 0,49 </td>\n   <td style=\"text-align:center;\"> 0,58 </td>\n   <td style=\"text-align:center;\"> -1,11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> k </td>\n   <td style=\"text-align:center;\"> 0,66 </td>\n   <td style=\"text-align:center;\"> 0,58 </td>\n   <td style=\"text-align:center;\"> 0,28 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n**Liaisons entre les variables**. Dans une ACP normée, les liaisons entre les variables deux à deux sont évaluées avec le coefficient de corrélation ([section @sec-0431]), soit la moyenne du produit des deux variables centrées réduites (@eq-ACPcor). Notez que dans une ACP non normée, plus rarement utilisée, les liaisons sont évaluées avec la covariance puisque les variables sont uniquement centrées (@eq-ACPcov).\n\n\n$$\nr_{xy} = \\frac{\\sum_{i=1}^n (x_{i}-\\bar{x})(y_{i}-\\bar{y})}{n\\sqrt{\\sum_{i=1}^n(x_i - \\bar{x})^2(y_i - \\bar{y})^2}}=\\sum_{i=1}^n\\frac{Zx_iZy_i}{n}\n$$ {#eq-ACPcor}\n\n\n$$\ncov(x,y) = \\frac{\\sum_{i=1}^n (x_{i}-\\bar{x})(y_{i}-\\bar{y})}{n}\n$$ {#eq-ACPcov}\n\n\n**Composantes principales**. Au [chapitre @sec-chap04], nous avons abordé deux méthodes pour identifier des relations linéaires entre des variables continues normalement distribuées : \n\n* la corrélation de Pearson ([section @sec-043]), qu'il est possible d'illustrer graphiquement à partir d'un nuage de points;\n\n* la régression linéaire simple ([section @sec-044]), permettant de résumer la relation linéaire entre deux variables avec une droite de régression de type $Y=a+bX$. \n\nBrièvement, plus deux variables sont corrélées (positivement ou négativement), plus le nuage de points qu'elles forment est allongé et plus les points sont proches de la droite de régression (@fig-liaisons2Vars, partie **a**). À l'inverse, plus la liaison entre les deux variables normalement distribuées est faible, plus le nuage prend la forme d'un cercle et plus les points du nuage sont éloignés de la droite de régression (@fig-liaisons2Vars, partie **b**). Puisqu'en ACP normée, les variables sont centrées réduites, le centre de gravité du nuage de points est (*x* = 0, *y* = 0) et il est toujours traversé par la droite de régression. Finalement, nous avons vu que la méthode des moindres carrés ordinaires (MCO) permet de déterminer cette droite en minimisant les distances entre les valeurs observées et celles projetées orthogonalement sur cette droite (valeurs prédites). Dans le cas de deux variables uniquement, l'axe factoriel principal/la composante principale est donc la droite qui résume le mieux la liaison entre les deux variables (en rouge). L'axe 2 représente la seconde plus importante composante (axe, dimension) et il est orthogonal (perpendiculaire) au premier axe (en bleu).\n\n\n![Corrélation, allongement du nuage de points et axes factoriels](images/Chap12/bivariePlanFacto.png){#fig-liaisons2Vars width=\"100%\" fig-align=\"center\"}\n\n\n\n\n::: {.cell}\n\n:::\n\n\nImaginez maintenant trois variables pour lesquelles vous désirez identifier un axe, une droite qui résume le mieux les liaisons entre elles. Visuellement, vous passez d'un nuage de points en deux dimensions (2D) à un nuage en dimensions (3D). Si les corrélations entre les trois variables sont très faibles, alors le nuage prend la forme d'un ballon de soccer (football en Europe). Par contre, plus ces liaisons sont fortes, plus la forme est allongée comme un ballon de rugby et plus les points sont proches de l'axe traversant le ballon.\n\nAjouter une autre variable revient alors à ajouter une quatrième dimension qu'il est impossible de visualiser, même pour les plus fervents adaptes de science-fiction. Pourtant, le problème reste le même : identifier, dans un plan en *p* dimensions (variables), les axes factoriels – les composantes principales – qui concourent le plus à résumer les liaisons entre les variables continues préalablement centrées réduites, et ce, en utilisant la méthode des moindres carrés ordinaires.\n\n\n::: bloc_attention\n::: bloc_attention-header\n::: bloc_attention-icon\n:::\n**Composantes principales et axes factoriels**\n:::\n::: bloc_attention-body\nLes termes **composantes principales** et **axes factoriels** sont des synonymes employés pour référer aux nouvelles variables synthétiques produites par l'ACP et résumant l'information du tableau initial.\n:::\n:::\n\n### Aides à l'interprétation {#sec-1222}\n\nPour illustrer les aides à l'interprétation de l'ACP, nous utilisons un jeu de données spatiales tiré d'un article sur l'agglomération lyonnaise en France [@2021_4]. Ce jeu de données comprend dix variables, dont quatre environnementales (EN) et six socioéconomiques (SE),  pour les îlots regroupés pour l'information statistique (IRIS) de l'agglomération lyonnaise (@tbl-dataacp et @fig-datacartoacp). Sur ces dix variables, nous calculons une **ACP normée**.\n\n\n::: {#tbl-dataacp .cell tbl-cap='Statistiques descriptives pour le jeu de données utilisé pour l\\'ACP'}\n::: {.cell-output-display}\n|           |Nom        |Intitulé                         | Type |     Moy.|   E.-T.|     Min.|     Max.|\n|:----------|:----------|:--------------------------------|:----:|--------:|-------:|--------:|--------:|\n|Lden       |Lden       |Bruit routier (Lden dB(A))       |  EN  |     55,6|     4,9|     33,9|     71,7|\n|NO2        |NO2        |Dioxyde d'azote (ug/m^3^)        |  EN  |     28,7|     7,9|     12,0|     60,2|\n|PM25       |PM25       |Particules fines (PM$_{2,5}$)    |  EN  |     16,8|     2,1|     11,3|     21,9|\n|VegHautPrt |VegHautPrt |Canopée (%)                      |  EN  |     18,7|    10,1|      1,7|     53,8|\n|Pct0_14    |Pct0_14    |Moins de 15 ans (%)              |  SE  |     18,5|     5,7|      0,0|     54,0|\n|Pct_65     |Pct_65     |65 ans et plus (%)               |  SE  |     16,2|     5,9|      0,0|     45,1|\n|Pct_Img    |Pct_Img    |Immigrants (%)                   |  SE  |     14,5|     9,1|      0,0|     59,8|\n|TxChom1564 |TxChom1564 |Taux de chômage                  |  SE  |     14,8|     8,1|      0,0|     98,8|\n|Pct_brevet |Pct_brevet |Personnes à faible scolarité (%) |  SE  |     23,5|    12,6|      0,0|    100,0|\n|NivVieMed  |NivVieMed  |Médiane du niveau de vie (Euros) |  SE  | 21 804,5| 4 922,5| 11 324,0| 38 707,0|\n:::\n:::\n\n\n\n![Cartographie des dix variables utilisées pour l'ACP](images/Chap12/Figure3Data.png){#fig-datacartoacp width=\"100%\" fig-align=\"center\"}\n\n::: bloc_objectif\n::: bloc_objectif-header\n::: bloc_objectif-icon\n:::\n**Trois étapes pour bien analyser une ACP et comprendre la signification des axes factoriels**\n:::\n::: bloc_objectif-body\n1. Interprétation des résultats des valeurs propres pour identifier le nombre d'axes (de composantes principales) à retenir. L'enjeu est de garder un nombre d'axes limité qui résume le mieux le tableau initial (réduction des données).\n\n2. Analyse des résultats pour les variables (coordonnées factorielles, cosinus carrés et contributions sur les axes retenus).\n\n3. Analyse des résultats pour les individus (coordonnées factorielles, cosinus carrés et contributions sur les axes retenus).\n\nLes deux dernières étapes permettent de comprendre la signification des axes retenus et de les qualifier. Cette étape d'interprétation est essentielle en sciences sociales. En effet, nous avons vu dans l'introduction du chapitre que les méthodes factorielles permettent de résumer l'information d'un tableau en quelques nouvelles variables synthétiques, souvent considérées comme des variables latentes dans le jeu de données. Il convient alors de bien comprendre ces variables synthétiques (latentes), si nous souhaitons les utiliser dans une autre analyse subséquente (par exemple, les introduire dans une régression).\n:::\n:::\n\n#### Résultats de l'ACP pour les valeurs propres {#sec-12221}\n\nÀ titre de rappel, une ACP normée est réalisée sur des variables préalablement centrées réduites (@eq-scorezacpnormee), ce qui signifie que pour chaque variable :\n\n- Nous soustrayons à chaque valeur la moyenne de la variable correspondante (centrage); la moyenne est donc égale à 0.\n- Nous divisons cette différence par l’écart-type de la variable correspondante (réduction); la variance est égale à 1.\n\t\n$$\nz= \\frac{x_i-\\mu}{\\sigma}\n$$ {#eq-scorezacpnormee}\n\n\t\nPar conséquent, la variance totale (ou inertie totale) d’un tableau sur lequel est calculée une ACP normée est égale au nombre de variables qu'il comprend. Puisque nous l'appliquons ici à dix variables, la variance totale du tableau à réduire – c'est-à-dire à résumer en *K* nouvelles variables synthétiques, composantes principales, axes factoriels – est donc égale à 10. Trois mesures reportées au @tbl-dataacpValeurPropres permettent d'analyser les valeurs propres : \n\n- $\\mbox{VP}_k$, la valeur propre (*eigenvalue* en anglais) de l'axe *k*, c'est-à-dire la quantité de variance du tableau initial résumé par l'axe.\n\n- $\\mbox{VP}_k / \\mbox{P}$ avec *P* étant le nombre de variables que comprend le tableau initial. Cette mesure représente ainsi le pourcentage de la variance totale du tableau résumé par l’axe *k*; autrement dit, la quantité d’informations du tableau initial résumée par l’axe, la composante principale *k*. Cela nous permet ainsi d’évaluer le pouvoir explicatif de l’axe.\n\n- Le pourcentage cumulé pour les axes.\n\n\n::: {#tbl-dataacpValeurPropres .cell tbl-cap='Résultats de l\\'ACP pour les valeurs propres'}\n::: {.cell-output-display}\n|        | Composante| Valeur propre| Pourcentage| Pourc. cumulé|\n|:-------|----------:|-------------:|-----------:|-------------:|\n|comp 1  |          1|         3,543|      35,425|        35,425|\n|comp 2  |          2|         2,760|      27,596|        63,021|\n|comp 3  |          3|         1,042|      10,422|        73,443|\n|comp 4  |          4|         0,751|       7,511|        80,954|\n|comp 5  |          5|         0,606|       6,059|        87,013|\n|comp 6  |          6|         0,388|       3,880|        90,893|\n|comp 7  |          7|         0,379|       3,788|        94,681|\n|comp 8  |          8|         0,244|       2,441|        97,122|\n|comp 9  |          9|         0,217|       2,167|        99,289|\n|comp 10 |         10|         0,071|       0,711|       100,000|\n:::\n:::\n\n\nAvant d'analyser en détail le @tbl-dataacpValeurPropres, notez que la somme des valeurs propres de toutes les composantes de l'ACP est toujours  égale au nombre de variables du tableau initial. Aussi, la quantité de variance expliquée (les valeurs propres) décroît de la composante 1 à la composante *K*.\n\n**Combien d'axes d'une ACP faut-il retenir?** Pour répondre à cette question, deux approches sont possibles :\n\n- **Approche statistique** (avec le critère de Kaiser [-@kaiser1960application]). Nous retenons uniquement les composantes qui présentent une valeur propre supérieure à 1. Rappelez-vous qu'en ACP normée, les variables sont préalablement centrées réduites, et donc que leur variance respective est égale à 1. Par conséquent, une composante ayant une valeur propre inférieure à 1 a un pouvoir explicatif inférieur à celui d'une variable. À la lecture du tableau, nous retenons les trois premières composantes si nous appliquons ce critère.\n\n- **Approche empirique** basée sur la lecture des pourcentages et des pourcentages cumulés. Nous pouvons retenir uniquement les deux premières composantes. En effet, ces deux premiers facteurs résument près des deux tiers de la variance totale du tableau (63,02 %). Cela démontre bien que l'ACP, comme les autres méthodes factorielles, est bien une méthode de réduction de données puisque nous résumons dix variables avec deux nouvelles variables synthétiques (axes, composantes principales). Pour faciliter le choix du nombre d'axes, il est fortement conseillé de construire des histogrammes à partir des valeurs propres, des pourcentages et des pourcentages cumulés (@fig-acpgraphvp). Or, à la lecture de ces graphiques, nous constatons que la variance expliquée chute drastiquement après les deux premières composantes. Par conséquent, nous pouvons retenir uniquement les deux premiers axes.\n\n::: bloc_astuce\n::: bloc_astuce-header\n::: bloc_astuce-icon\n:::\n**Lecture du diagramme des valeurs propres** \n:::\n::: bloc_astuce-body\nPlus les variables incluses dans l'ACP sont corrélées entre elles, plus l'ACP est intéressante : plus les valeurs propres des premiers axes sont fortes et plus il y a des sauts importants dans le diagramme des valeurs propres. À l'inverse, lorsque les variables incluses dans l'ACP sont peu corrélées entre elles, il n'y a pas de sauts importants dans l'histogramme, autrement dit les valeurs propres sont uniformément décroissantes.\n:::\n:::\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Graphiques personnalisés pour les valeurs propres pour l'ACP](12-AnalysesFactorielles_files/figure-html/fig-acpgraphvp-1.png){#fig-acpgraphvp fig-align='center' width=75%}\n:::\n:::\n\n\n#### Résultats de l'ACP pour les variables {#sec-12222}\n\nPour qualifier les axes, quatre mesures sont disponibles pour les variables :\n\n- **Les coordonnées factorielles des variables**  sont simplement les coefficients de corrélation de Pearson des variables sur l’axe *k* et varient ainsi de -1 à 1 (relire au besoin la [section @sec-043]). Pour qualifier un axe, il convient alors de repérer les variables les plus corrélées positivement et négativement sur l’axe, autrement dit, de repérer les variables situées aux extrémités l'axe. \n\n- **Les cosinus carrés des variables** (Cos^2^) (appelés aussi les qualités de représentation des variables sur un axe) permettent de repérer le ou les axes qui concourent le plus à donner un sens à la variable. Ils sont en fait les coordonnées des variables mises au carré. La somme des cosinus carrés d’une variable sur tous les axes de l’ACP est donc égale à 1 (sommation en ligne).\n\n- **La qualité de représentation d'une variable sur les _n_ premiers axes** est simplement la somme des cosinus carrés d'une variable sur les axes retenus. Par exemple, pour la variable `Lden`, la qualité de représentation de la variable  sur le premier axe est égale : $\\mbox{0,42}^2=\\mbox{0,17}$. Pour cette même variable, la qualité de la `Lden` sur les trois premiers axes est égale à : $\\mbox{0,17}+\\mbox{0,32}+\\mbox{0,26}=\\mbox{0,75}$.\n\n- **Les contributions des variables** permettent de repérer celles qui participent le plus à la formation d’un axe. Elles s'obtiennent en divisant les cosinus carrés par la valeur propre de l’axe multiplié par 100. La somme des contributions des variables pour un axe donné est donc égale à 100 (sommation en colonne). Par exemple, pour la variable `Lden`, la contribution sur le premier axe est égale : $\\mbox{0,174} / \\mbox{3,543} \\times \\mbox{100}= \\mbox{4,920 }%$.\n\nLes résultats de l'ACP pour les variables sont présentés au @tbl-dataacpCoordVars.\n\n\n::: {#tbl-dataacpCoordVars .cell tbl-cap='Résultats de l\\'ACP pour les variables'}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Coordonnées</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"4\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Cosinus carrés</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Contributions</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Variable </th>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n   <th style=\"text-align:right;\"> 3 </th>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n   <th style=\"text-align:right;\"> 3 </th>\n   <th style=\"text-align:right;\"> Qualité </th>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n   <th style=\"text-align:right;\"> 3 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Lden </td>\n   <td style=\"text-align:right;\"> 0,42 </td>\n   <td style=\"text-align:right;\"> 0,57 </td>\n   <td style=\"text-align:right;\"> 0,51 </td>\n   <td style=\"text-align:right;\"> 0,17 </td>\n   <td style=\"text-align:right;\"> 0,32 </td>\n   <td style=\"text-align:right;\"> 0,26 </td>\n   <td style=\"text-align:right;\"> 0,75 </td>\n   <td style=\"text-align:right;\"> 4,92 </td>\n   <td style=\"text-align:right;\"> 11,64 </td>\n   <td style=\"text-align:right;\"> 24,80 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NO2 </td>\n   <td style=\"text-align:right;\"> 0,15 </td>\n   <td style=\"text-align:right;\"> 0,93 </td>\n   <td style=\"text-align:right;\"> 0,19 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n   <td style=\"text-align:right;\"> 0,86 </td>\n   <td style=\"text-align:right;\"> 0,04 </td>\n   <td style=\"text-align:right;\"> 0,92 </td>\n   <td style=\"text-align:right;\"> 0,66 </td>\n   <td style=\"text-align:right;\"> 31,07 </td>\n   <td style=\"text-align:right;\"> 3,54 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PM25 </td>\n   <td style=\"text-align:right;\"> 0,19 </td>\n   <td style=\"text-align:right;\"> 0,92 </td>\n   <td style=\"text-align:right;\"> 0,03 </td>\n   <td style=\"text-align:right;\"> 0,04 </td>\n   <td style=\"text-align:right;\"> 0,84 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,87 </td>\n   <td style=\"text-align:right;\"> 1,01 </td>\n   <td style=\"text-align:right;\"> 30,36 </td>\n   <td style=\"text-align:right;\"> 0,12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> VegHautPrt </td>\n   <td style=\"text-align:right;\"> -0,40 </td>\n   <td style=\"text-align:right;\"> -0,42 </td>\n   <td style=\"text-align:right;\"> 0,40 </td>\n   <td style=\"text-align:right;\"> 0,16 </td>\n   <td style=\"text-align:right;\"> 0,18 </td>\n   <td style=\"text-align:right;\"> 0,16 </td>\n   <td style=\"text-align:right;\"> 0,50 </td>\n   <td style=\"text-align:right;\"> 4,63 </td>\n   <td style=\"text-align:right;\"> 6,35 </td>\n   <td style=\"text-align:right;\"> 15,46 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Pct0_14 </td>\n   <td style=\"text-align:right;\"> 0,55 </td>\n   <td style=\"text-align:right;\"> -0,53 </td>\n   <td style=\"text-align:right;\"> 0,08 </td>\n   <td style=\"text-align:right;\"> 0,30 </td>\n   <td style=\"text-align:right;\"> 0,28 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,59 </td>\n   <td style=\"text-align:right;\"> 8,61 </td>\n   <td style=\"text-align:right;\"> 10,28 </td>\n   <td style=\"text-align:right;\"> 0,55 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Pct_65 </td>\n   <td style=\"text-align:right;\"> -0,41 </td>\n   <td style=\"text-align:right;\"> -0,27 </td>\n   <td style=\"text-align:right;\"> 0,72 </td>\n   <td style=\"text-align:right;\"> 0,17 </td>\n   <td style=\"text-align:right;\"> 0,07 </td>\n   <td style=\"text-align:right;\"> 0,51 </td>\n   <td style=\"text-align:right;\"> 0,75 </td>\n   <td style=\"text-align:right;\"> 4,73 </td>\n   <td style=\"text-align:right;\"> 2,66 </td>\n   <td style=\"text-align:right;\"> 49,26 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Pct_Img </td>\n   <td style=\"text-align:right;\"> 0,87 </td>\n   <td style=\"text-align:right;\"> -0,09 </td>\n   <td style=\"text-align:right;\"> 0,11 </td>\n   <td style=\"text-align:right;\"> 0,76 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,78 </td>\n   <td style=\"text-align:right;\"> 21,56 </td>\n   <td style=\"text-align:right;\"> 0,29 </td>\n   <td style=\"text-align:right;\"> 1,08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TxChom1564 </td>\n   <td style=\"text-align:right;\"> 0,77 </td>\n   <td style=\"text-align:right;\"> -0,09 </td>\n   <td style=\"text-align:right;\"> -0,07 </td>\n   <td style=\"text-align:right;\"> 0,60 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,61 </td>\n   <td style=\"text-align:right;\"> 16,89 </td>\n   <td style=\"text-align:right;\"> 0,27 </td>\n   <td style=\"text-align:right;\"> 0,45 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Pct_brevet </td>\n   <td style=\"text-align:right;\"> 0,73 </td>\n   <td style=\"text-align:right;\"> -0,43 </td>\n   <td style=\"text-align:right;\"> 0,22 </td>\n   <td style=\"text-align:right;\"> 0,53 </td>\n   <td style=\"text-align:right;\"> 0,19 </td>\n   <td style=\"text-align:right;\"> 0,05 </td>\n   <td style=\"text-align:right;\"> 0,77 </td>\n   <td style=\"text-align:right;\"> 14,94 </td>\n   <td style=\"text-align:right;\"> 6,81 </td>\n   <td style=\"text-align:right;\"> 4,61 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NivVieMed </td>\n   <td style=\"text-align:right;\"> -0,88 </td>\n   <td style=\"text-align:right;\"> 0,09 </td>\n   <td style=\"text-align:right;\"> 0,04 </td>\n   <td style=\"text-align:right;\"> 0,78 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,79 </td>\n   <td style=\"text-align:right;\"> 22,06 </td>\n   <td style=\"text-align:right;\"> 0,28 </td>\n   <td style=\"text-align:right;\"> 0,14 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n**Analyse de la première composante principale (valeur propre de 3,54, 35,43 %)**\n\n- À la lecture des contributions, il est clair que quatre variables contribuent grandement à la formation de l'axe 1 : `NivVieMed` (22,06 %), \n`Pct_Img` (21,56 %), `TxChom1564` (16,89 %) et `Pct_brevet` (14,94 %). Il convient alors d'analyser en détail leurs coordonnées factorielles et leurs cosinus carrés.\n\n- À la lecture des coordonnées factorielles, nous constatons que trois variables socioéconomiques sont fortement corrélées positivement avec l’axe 1, soit le *pourcentage d’immigrants* (0,87), le *taux de chômage* (0,77) et le *pourcentage de personnes avec une faible scolarité* (0,73). À l’autre extrémité, la *médiane du niveau de vie* (en euros) est négativement corrélée avec l’axe 1. Comment interpréter ce résultat? Premièrement, cela signifie que plus la valeur de l’axe 1 est positive et élevée, plus celles des trois variables (`Pct_Img`,`TxChom1564` et `Pct_brevet`) sont aussi élevées (corrélations positives) et plus la valeur de `NivVieMed` est faible (corrélation négative). Inversement, plus la valeur de l’axe 1 est négative et faible, les valeurs de `Pct_Img`, `TxChom1564` et `Pct_brevet` sont faibles et plus celle de `NivVieMed` est forte. Deuxièmement, cela signifie que les trois variables (`Pct_Img`,`TxChom1564` et `Pct_brevet`) sont fortement corrélées positivement entre elles puisqu’elles se situent sur la même extrémité de l’axe et qu’elles sont toutes trois négativement corrélées avec la variable `NivVieMed`. Cela peut être rapidement confirmé avec la matrice de corrélation entre les dix variables (@tbl-dataacpMatriceCorr). \n\n- À la lecture des cosinus carrés de l'axe 1, nous constatons que plus des trois quarts de la dispersion/de l'information des variables `NivVieMed` (0,78) et `Pct_Img` (0,76) est concentrée sur l'axe 1.\n\n\n\n::: {#tbl-dataacpMatriceCorr .cell tbl-cap='Matrice de corrélation de Pearson entre les variables utilisées pour l\\'ACP'}\n::: {.cell-output-display}\n|           |Variable      |     A|     B|     C|     D|     E|     F|     G|     H|     I|     J|\n|:----------|:-------------|-----:|-----:|-----:|-----:|-----:|-----:|-----:|-----:|-----:|-----:|\n|Lden       |A. Lden       |      |  0,62|  0,49| -0,23|  0,04| -0,09|  0,28|  0,19|  0,14| -0,26|\n|NO2        |B. NO2        |  0,62|      |  0,90| -0,28| -0,34| -0,21|  0,07|  0,04| -0,25| -0,04|\n|PM25       |C. PM25       |  0,49|  0,90|      | -0,39| -0,34| -0,26|  0,12|  0,07| -0,25| -0,10|\n|VegHautPrt |D. VegHautPrt | -0,23| -0,28| -0,39|      |  0,04|  0,32| -0,22| -0,18| -0,14|  0,32|\n|Pct0_14    |E. Pct0_14    |  0,04| -0,34| -0,34|  0,04|      | -0,12|  0,46|  0,36|  0,54| -0,45|\n|Pct_65     |F. Pct_65     | -0,09| -0,21| -0,26|  0,32| -0,12|      | -0,24| -0,30|  0,00|  0,32|\n|Pct_Img    |G. Pct_Img    |  0,28|  0,07|  0,12| -0,22|  0,46| -0,24|      |  0,66|  0,64| -0,73|\n|TxChom1564 |H. TxChom1564 |  0,19|  0,04|  0,07| -0,18|  0,36| -0,30|  0,66|      |  0,47| -0,62|\n|Pct_brevet |I. Pct_brevet |  0,14| -0,25| -0,25| -0,14|  0,54|  0,00|  0,64|  0,47|      | -0,67|\n|NivVieMed  |J. NivVieMed  | -0,26| -0,04| -0,10|  0,32| -0,45|  0,32| -0,73| -0,62| -0,67|      |\n:::\n:::\n\n\n**Analyse de la deuxième composante principale (valeur propre de 2,76, 27,60 %)**\n\n- À la lecture des contributions, trois variables environnementales contribuent à la formation de l'axe 2 : principalement, celles sur la pollution de l'air (`NO2` = 31,07 % et `PM25` = 30,36 %) et secondairement, celle sur le bruit routier (`Lden` = 11,64 %).\n\n- À la lecture des coordonnées factorielles, ces trois variables sont fortement corrélées positivement avec l'axe 2 : `NO2` (0,93), `PM25` (0,92) et `Lden` (0,57). À l'autre extrémité de l'axe, la variable `Pct0_14` est négativement, mais pas fortement, corrélée (-0,53). La lecture de la matrice de corrélation au @tbl-dataacpMatriceCorr confirme que ces trois variables environnementales sont fortement corrélées positivement entre elles (par exemple, un coefficient de corrélation de Pearson de 0,90 entre `NO2` et `PM25`).\n\n- À la lecture des cosinus carrés de l'axe 2, nous constatons que près de 90 % de la dispersion/de l'information des variables `NO2` (0,86) et `PM25` (0,84) est concentrée sur l'axe 2.\n\n\n**Analyse de la troisième composante principale (valeur propre de 1,042, 10,42 %)**\n\n- Le *pourcentage de personnes âgées* (`Pct_65`) contribue principalement à la formation de l'axe 3 avec lequel il est corrélé positivement (contribution de 49,26 % et coordonnée factorielle de 0,72). S'en suit la variable `Lden`, qui joue un rôle beaucoup moins important (contribution de 24,80 % et coordonnée factorielle de 0,51).\n\n::: bloc_astuce\n::: bloc_astuce-header\n::: bloc_astuce-icon\n:::\n**Lien entre la valeur propre d'un axe et le nombre de variables contribuant à sa formation**\n:::\n::: bloc_astuce-body\nVous auvez compris que plus la valeur propre d'un axe est forte, plus il y a potentiellement de variables qui concourent à sa formation. Cela explique que pour la troisième composante, qui a une faible valeur propre (1,042), seule une variable contribue significativement à sa formation. \n:::\n:::\n\n**Analyse de la qualité de représentation des variables sur les premiers axes de l'ACP**\n\nÀ titre de rappel, la qualité est simplement la somme des cosinus carrés d’une variable sur les axes retenus. Si nous retenons trois axes, les six variables qui sont le mieux résumées – et qui ont donc le plus d'influence sur les résultats de l'ACP – sont  : `NO2` (0,92), `PM25` (0,87), `NivVieMed` (0,79), `Pct_Img` (0,78), `Pct_brevet` (0,77) et `Lden` (0,75).\n\n**Qualification, dénomination d'axes factoriels**\n\nL'analyse des coordonnées, des contributions et des cosinus carrés doit vous permettre de formuler un intitulé pour chacun des axes retenus. Nous vous proposons les intitulés suivants : \n\n- *Niveau de défavorisation socioéconomique* (axe 1). Plus la valeur de l'axe est élevée, plus le niveau de défavorisation de l'entité spatiale (IRIS) est élevé.\n\n- *Qualité environnementale* (axe 2). Plus la valeur de l'axe est forte, plus les niveaux de pollution atmosphérique (dioxyde d'azote et particules fines) et de bruit (Lden) sont élevés.\n\n**Recours à des graphiques pour analyser les résultats de l'ACP pour des variables**\n\nPlus le nombre de variables utilisées pour calculer l'ACP est important, plus l'analyse des coordonnées factorielles, des cosinus carrés et des contributions reportés dans un tableau devient fastidieuse. Puisque l’ACP a été calculée sur dix variables, l’analyse des valeurs du @tbl-dataacpCoordVars a été assez facile et rapide. Imaginez maintenant que nous réalisons une ACP sur une centaine de variables, la taille du tableau des résultats pour les variables sera considérable... Par conséquent, il est recommandé de construire plusieurs graphiques qui facilitent l’analyse des résultats pour les variables. \n\nPar exemple, à la @fig-acpgraphvarscoords, nous avons construit des graphiques avec les coordonnées factorielles sur les trois premiers axes de l’ACP. En un coup d’œil, il est facile de repérer les variables les plus corrélées positivement ou négativement avec chacun d’entre eux.\nAussi, il est fréquent de construire un nuage de points avec les coordonnées des variables sur les deux premiers axes factoriels, soit un graphique communément appelé **nuage de points des variables sur le premier plan factoriel** sur lequel est représenté le cercle des corrélations (@fig-acp1erplanfactVars). Bien entendu, cet exercice peut être fait avec d’autres axes factoriels (les axes 3 et 4 par exemple).\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Coordonnées factorielles des variables](12-AnalysesFactorielles_files/figure-html/fig-acpgraphvarscoords-1.png){#fig-acpgraphvarscoords fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\" quietly='true'}\n::: {.cell-output-display}\n![Premier plan factoriel de l'ACP pour les variables](12-AnalysesFactorielles_files/figure-html/fig-acp1erplanfactVars-1.png){#fig-acp1erplanfactVars fig-align='center' width=75%}\n:::\n:::\n\n\n#### Résultats de l'ACP pour les individus {#sec-12223}\n\nComme pour les variables, nous retrouvons les mêmes mesures pour les individus : les coordonnées factorielles, les cosinus carrés et les contributions. Les coordonnées factorielles des individus sont les projections orthogonales des observations sur l'axe. Puisqu'en ACP normée, les variables utilisées pour l'ACP sont centrées réduites, la moyenne des coordonnées factorielles des individus pour un axe est toujours égale à zéro. En revanche, contrairement aux coordonnées factorielles pour les variables, les coordonnées pour les individus ne varient pas de -1 à 1! Les cosinus carrés quantifient à quel point chaque axe représente chaque individu. Enfin, les contributions quantifient l'apport de chaque individu à la formation d'un axe.\n\nSi le jeu de données comprend peu d'observations, il est toujours possible de créer un **nuage de points des individus sur le premier plan factoriel** sur lequel vous pouvez ajouter les étiquettes permettant d'identifier les observations (@fig-acp1erplanfactIndiv). Ce graphique est rapidement illisible lorsque le nombre d'observations est important. Il peut rester utile si certaines des observations du jeu de données doivent faire l'objet d'une analyse spécifique.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Premier plan factoriel pour les individus](12-AnalysesFactorielles_files/figure-html/fig-acp1erplanfactIndiv-1.png){#fig-acp1erplanfactIndiv fig-align='center' width=75%}\n:::\n:::\n\n\nLorsque les observations sont des unités spatiales, il est très intéressant de cartographier les coordonnées factorielles des individus (@fig-acp1erplanfactIndiv). À la lecture de la carte choroplèthe de gauche (axe 1), nous pouvons constater que le niveau de défavorisation socioéconomique est élevé dans l'est (IRIS en vert), et inversement, très faible à l'ouest de l'agglomération (IRIS en rouge). À la lecture de la carte de droite (axe 2), sans surprise, la partie centrale de l'agglomération est caractérisée par des niveaux de pollution atmosphérique et de bruit routier bien plus élevés qu'en périphérie.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Cartographie des coordonnées factorielles des individus](12-AnalysesFactorielles_files/figure-html/fig-acpcartoindiv-1.png){#fig-acpcartoindiv fig-align='center' width=80%}\n:::\n:::\n\n\n\n::: bloc_aller_loin\n::: bloc_aller_loin-header\n::: bloc_aller_loin-icon\n:::\n**Autres éléments intéressants de l'ACP**\n:::\n::: bloc_aller_loin-body\n**Ajout de variables ou d'individus supplémentaires** \n\nPremièrement, il est possible d'ajouter des variables continues ou des individus supplémentaires qui n'ont pas été pris en compte dans le calcul de l'ACP (@fig-acpvarindcorrsuppl). Concernant les variables continues supplémentaires, il s'agit simplement de calculer leurs corrélations avec les axes retenus de l'ACP. Concernant les individus, il s'agit de les projeter sur les axes factoriels. Pour plus d'informations sur le sujet, consultez les excellents ouvrages de Ludovic Lebart, Alain Morineau et Marie Piron [-@lebart1995statistique, p.42-45] ou encore de Jérôme Pagès [-@pages2013analyse, p.22-24].\n\n\n![Variables et individus supplémentaires pour l'ACP](images/Chap12/AcpIndVarSuppl.png){#fig-acpvarindcorrsuppl width=\"28%\" fig-align=\"center\"}\n\n\n**Pondération des individus et des variables**\n\nDeuxièmement, il est possible de pondérer à la fois les individus et, plus rarement, les variables lors du calcul de l'ACP.\n\n**Analyse en composantes principales non paramétrique**\n\nTroisièmement, il est possible de calculer une ACP sur des variables préalablement transformées en rang ([section @sec-02552]). Cela peut être justifié lorsque les variables sont très anormalement distribuées en raison de valeurs extrêmes. Les coordonnées factorielles pour les variables sont alors le coefficient de Spearman ([section @sec-0433]) et non de Pearson. Aussi, les variables sont centrées non pas sur leurs moyennes respectives, mais sur leurs médianes. Pour plus d'informations sur cette approche, consultez de nouveau Lebart et al. [-@lebart1995statistique, p.51-52].\n\n**Analyse en composantes principales robuste**\n\nFinalement, d'autres méthodes plus avancées qu'une ACP non paramétrique peuvent être utilisées afin d'obtenir des composantes principales qui ne sont pas influencées par des valeurs extrêmes : les ACP robustes [@rivest1988analyse; @hubert2005robpca] qui peuvent être mises en œuvre, entre autres avec le *package* `roscpca`.\n:::\n:::\n\n\n### Mise en œuvre dans R {#sec-1223}\n\nPlusieurs *packages* permettent de calculer une ACP dans R, notamment `psych` avec la fonction `principal`, `ade4` avec la fonction `dudi.pca` et `FactoMineR`[@FactoMineR] avec la fonction `PCA`. Ce dernier est certainement le plus abouti. De plus, il permet également de calculer une analyse des correspondances (AFC), une analyse des correspondances multiples (ACM) et une analyse factorielle de données mixtes (AFDM). Nous utilisons donc `FactoMineR` pour mettre en œuvre les trois types de méthodes factorielles abordées dans ce chapitre (ACP, AFC et ACM). Pour l'ACP, nous exploitons un jeu de données issu du *package* `geocmeans` qu'il faut préalablement charger à l'aide des lignes de code suivantes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(geocmeans)\ndata(LyonIris)\nData <- st_drop_geometry(LyonIris[c(\"CODE_IRIS\" , \"Lden\" , \"NO2\" , \"PM25\" , \"VegHautPrt\",\n                        \"Pct0_14\" , \"Pct_65\" , \"Pct_Img\",\n                        \"TxChom1564\" , \"Pct_brevet\" , \"NivVieMed\")])\n```\n:::\n\n\n#### Calcul et exploration d'une ACP avec `FactoMineR` {#sec-12231}\n\nPour calculer l'ACP, il suffit d'utiliser la fonction `PCA` de `FactoMineR`, puis la fonction `summary(MonACP)` qui renvoie les résultats de l'ACP pour : \n\n- Les valeurs propres (section `Eigenvalues`) pour les composantes principales (`Dim.1` à `Dim.n`) avec leur variance expliquée brute (`Variance`) en pourcentage (`% of var.`) et en pourcentage cumulé (`Cumulative % of var.`).\n\n- Les dix premières observations (section `Individuals`) avec les coordonnées factorielles (`Dim.1` à `Dim.n`), les contributions (`ctr`) et les cosinus carrés (`cos2`). Pour accéder aux résultats pour toutes les observations, utilisez les fonctions `res.acp$ind` ou encore `res.acp$ind$coord` (uniquement les coordonnées factorielles), `res.acp$ind$contrib` (uniquement les contributions) et `res.acp$ind$cos2` (uniquement les cosinus carrés).\n\n- Les variables (section `Variables`) avec les coordonnées factorielles (`Dim.1` à `Dim.n`), les contributions (`ctr`) et les cosinus carrés (`cos2`).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(FactoMineR)\n# Version classique avec FactoMineR\n# Construction d'une ACP sur les colonnes 2 à 11 du DataFrame Data\nres.acp <- PCA(Data[,2:11], scale.unit = TRUE, graph = FALSE)\n# Affichage des résultats de la fonction PCA\nprint(res.acp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n**Results for the Principal Component Analysis (PCA)**\nThe analysis was performed on 506 individuals, described by 10 variables\n*The results are available in the following objects:\n\n   name               description                          \n1  \"$eig\"             \"eigenvalues\"                        \n2  \"$var\"             \"results for the variables\"          \n3  \"$var$coord\"       \"coord. for the variables\"           \n4  \"$var$cor\"         \"correlations variables - dimensions\"\n5  \"$var$cos2\"        \"cos2 for the variables\"             \n6  \"$var$contrib\"     \"contributions of the variables\"     \n7  \"$ind\"             \"results for the individuals\"        \n8  \"$ind$coord\"       \"coord. for the individuals\"         \n9  \"$ind$cos2\"        \"cos2 for the individuals\"           \n10 \"$ind$contrib\"     \"contributions of the individuals\"   \n11 \"$call\"            \"summary statistics\"                 \n12 \"$call$centre\"     \"mean of the variables\"              \n13 \"$call$ecart.type\" \"standard error of the variables\"    \n14 \"$call$row.w\"      \"weights for the individuals\"        \n15 \"$call$col.w\"      \"weights for the variables\"          \n```\n:::\n\n```{.r .cell-code}\n# Résumé des résultats (valeurs propres, individus, variables)\nsummary(res.acp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nPCA(X = Data[, 2:11], scale.unit = TRUE, graph = FALSE) \n\n\nEigenvalues\n                       Dim.1   Dim.2   Dim.3   Dim.4   Dim.5   Dim.6   Dim.7\nVariance               3.543   2.760   1.042   0.751   0.606   0.388   0.379\n% of var.             35.425  27.596  10.422   7.511   6.059   3.880   3.788\nCumulative % of var.  35.425  63.021  73.443  80.954  87.013  90.893  94.681\n                       Dim.8   Dim.9  Dim.10\nVariance               0.244   0.217   0.071\n% of var.              2.441   2.167   0.711\nCumulative % of var.  97.122  99.289 100.000\n\nIndividuals (the 10 first)\n               Dist    Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3\n1          |  3.054 |  1.315  0.096  0.185 | -2.515  0.453  0.678 |  0.221\n2          |  1.882 |  0.193  0.002  0.011 | -1.744  0.218  0.859 |  0.082\n3          |  2.820 |  2.338  0.305  0.687 | -0.860  0.053  0.093 | -0.765\n4          |  2.816 | -0.740  0.031  0.069 |  2.265  0.367  0.647 |  1.293\n5          |  3.210 | -2.208  0.272  0.473 | -1.597  0.183  0.248 |  1.471\n6          |  3.016 |  2.287  0.292  0.575 | -1.515  0.164  0.252 |  0.390\n7          |  3.022 | -1.540  0.132  0.260 | -1.803  0.233  0.356 |  0.465\n8          |  3.122 | -1.536  0.132  0.242 | -2.038  0.298  0.426 | -0.120\n9          |  4.743 | -3.930  0.862  0.687 | -1.806  0.234  0.145 |  0.993\n10         |  3.055 |  2.713  0.411  0.789 |  0.368  0.010  0.014 | -0.391\n              ctr   cos2  \n1           0.009  0.005 |\n2           0.001  0.002 |\n3           0.111  0.074 |\n4           0.317  0.211 |\n5           0.411  0.210 |\n6           0.029  0.017 |\n7           0.041  0.024 |\n8           0.003  0.001 |\n9           0.187  0.044 |\n10          0.029  0.016 |\n\nVariables\n              Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3    ctr   cos2\nLden       |  0.417  4.920  0.174 |  0.567 11.640  0.321 |  0.508 24.799  0.258\nNO2        |  0.153  0.657  0.023 |  0.926 31.068  0.857 |  0.192  3.540  0.037\nPM25       |  0.189  1.007  0.036 |  0.915 30.355  0.838 |  0.035  0.117  0.001\nVegHautPrt | -0.405  4.630  0.164 | -0.419  6.353  0.175 |  0.401 15.459  0.161\nPct0_14    |  0.552  8.605  0.305 | -0.533 10.281  0.284 |  0.076  0.553  0.006\nPct_65     | -0.409  4.730  0.168 | -0.271  2.658  0.073 |  0.716 49.258  0.513\nPct_Img    |  0.874 21.559  0.764 | -0.089  0.288  0.008 |  0.106  1.077  0.011\nTxChom1564 |  0.774 16.893  0.598 | -0.086  0.267  0.007 | -0.068  0.450  0.005\nPct_brevet |  0.727 14.936  0.529 | -0.434  6.813  0.188 |  0.219  4.612  0.048\nNivVieMed  | -0.884 22.062  0.782 |  0.088  0.278  0.008 |  0.038  0.136  0.001\n            \nLden       |\nNO2        |\nPM25       |\nVegHautPrt |\nPct0_14    |\nPct_65     |\nPct_Img    |\nTxChom1564 |\nPct_brevet |\nNivVieMed  |\n```\n:::\n:::\n\n\nAvec les fonctions de base `barplot` et `plot`, il est possible de construire rapidement des graphiques pour explorer les résultats de l'ACP pour les valeurs propres, les variables et les individus.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Graphiques pour les valeurs propres\nbarplot(res.acp$eig[,1], main=\"Valeurs propres\", names.arg=1:nrow(res.acp$eig))\n```\n\n::: {.cell-output-display}\n![](12-AnalysesFactorielles_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\nbarplot(res.acp$eig[,2], main=\"Variance expliquée (%)\", names.arg=1:nrow(res.acp$eig))\n```\n\n::: {.cell-output-display}\n![](12-AnalysesFactorielles_files/figure-html/unnamed-chunk-15-2.png){width=672}\n:::\n\n```{.r .cell-code}\nbarplot(res.acp$eig[,3], main=\"Variance expliquée cumulée (%)\",\n        names.arg=1:nrow(res.acp$eig))\n```\n\n::: {.cell-output-display}\n![](12-AnalysesFactorielles_files/figure-html/unnamed-chunk-15-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# Nuage du points du premier plan factoriel pour les variables et les individus\nplot(res.acp, graph.type = \"classic\", choix = \"var\", axes = 1:2, \n     title = \"Premier plan factoriel (variables)\")\n```\n\n::: {.cell-output-display}\n![](12-AnalysesFactorielles_files/figure-html/unnamed-chunk-15-4.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(res.acp, graph.type = \"classic\", choix = \"ind\", axes = 1:2, \n     title = \"Premier plan factoriel (individus)\")\n```\n\n::: {.cell-output-display}\n![](12-AnalysesFactorielles_files/figure-html/unnamed-chunk-15-5.png){width=672}\n:::\n:::\n\n\n\n\n::: bloc_aller_loin\n::: bloc_aller_loin-header\n::: bloc_aller_loin-icon\n:::\n**Pondérations pour les individus et les variables**\n:::\n::: bloc_aller_loin-body\nNous avons vu, dans un encadré ci-dessus, qu'il est possible d'ajouter des variables et des individus supplémentaires dans une ACP, ce que permet la fonction `PCA` de `FactoMineR` avec les paramètres `ind.sup` et `quanti.sup`. Aussi, pour ajouter des pondérations aux individus ou aux variables, utilisez les paramètres `row.w` et `col.w`. Pour plus d'informations sur ces paramètres, consulter l'aide de la fonction en tapant `?PCA` dans la console de RStudio.\n:::\n:::\n\n#### Exploration graphique des résultats de l'ACP avec `factoextra` {#sec-12232}\n\nVisuellement, vous avez pu constater que les graphiques ci-dessus (pour les valeurs propres et pour le premier plan factoriel pour les variables et les individus), réalisés avec les fonctions de base `barplot` et `plot`, sont peu attrayants. Avec le *package* `factoextra`, quelques lignes de code suffissent pour construire des graphiques bien plus esthétiques. \n\nPremièrement, la syntaxe ci-dessous renvoie deux graphiques pour analyser les résultats des valeurs propres (@fig-factoextra1).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(factoextra)\nlibrary(ggplot2)\nlibrary(ggpubr)\n\n# Graphiques pour les variables propres avec factoextra\nG1 <- fviz_screeplot(res.acp, choice =\"eigenvalue\", addlabels = TRUE,\n                     x = \"Composantes\",\n                     y = \"Valeur propre\",\n                    title = \"\")\nG2 <- fviz_screeplot(res.acp, choice =\"variance\", addlabels = TRUE,\n                     x = \"Composantes\",\n                     y = \"Pourcentage de la variance expliquée\",\n                     title = \"\")\nggarrange(G1, G2)\n```\n\n::: {.cell-output-display}\n![Graphiques pour les valeurs propres de l'ACP avec factoextra](12-AnalysesFactorielles_files/figure-html/fig-factoextra1-1.png){#fig-factoextra1 fig-align='center' width=75%}\n:::\n:::\n\n\nDeuxièmement, la syntaxe ci-dessous renvoie trois graphiques pour analyser les contributions de chaque variable aux deux premiers axes de l'ACP (figures [-@fig-factoextra2] et [-@fig-factoextra3]) et la qualité de représentation des variables sur les trois premiers axes (@fig-factoextra4), c'est-à-dire la somme des cosinus carrés sur les trois axes retenus.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Contributions des variables aux deux premières composantes avec factoextra\nfviz_contrib(res.acp, choice = \"var\", axes = 1, top = 10,\n             title = \"Contributions des variables à la première composante\")\nfviz_contrib(res.acp, choice = \"var\", axes = 2, top = 10,\n             title = \"Contributions des variables à la première composante\")\nfviz_cos2(res.acp, choice = \"var\", axes = 1:3)+\n  labs(x = \"\", y = \"Somme des cosinus carrés sur les 3 axes retenus\",\n       title = \"Qualité de représentation des variables sur les axes retenus de l'ACP\")\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Contributions des variables à la première composante avec factoextra](12-AnalysesFactorielles_files/figure-html/fig-factoextra2-1.png){#fig-factoextra2 fig-align='center' width=85%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Contributions des variables à la deuxième composante avec factoextra](12-AnalysesFactorielles_files/figure-html/fig-factoextra3-1.png){#fig-factoextra3 fig-align='center' width=85%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Qualité des variables sur les trois premières composantes avec factoextra](12-AnalysesFactorielles_files/figure-html/fig-factoextra4-1.png){#fig-factoextra4 fig-align='center' width=85%}\n:::\n:::\n\n\n\nTroisièmement, le code ci-dessous renvoie un nuage de points pour le premier plan factoriel de l'ACP (axes 1 et 2) pour les variables (@fig-factoextra5) et les individus (@fig-factoextra6).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Premier plan factoriel pour les variables avec factoextra\nfviz_pca_var(res.acp, col.var=\"contrib\",\n             title = \"Premier plan factoriel pour les variables\")+\n  scale_color_gradient2(low=\"#313695\", mid=\"#ffffbf\", high=\"#a50026\",\n                        midpoint=mean(res.acp$var$contrib[,1]))\n# Premier plan factoriel pour les individus avec factoextra\nfviz_pca_ind(res.acp, label = \"none\", title = \"ACP. Individus\")\nfviz_pca_ind(res.acp, col.ind=\"cos2\", title = \"ACP. Individus\") +\n  scale_color_gradient2(low=\"blue\", mid=\"white\", high=\"red\", midpoint=0.50)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Premier plan factoriel de l'ACP pour les variables avec factoextra](12-AnalysesFactorielles_files/figure-html/fig-factoextra5-1.png){#fig-factoextra5 fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Premier plan factoriel de l'ACP pour les individus avec factoextra](12-AnalysesFactorielles_files/figure-html/fig-factoextra6-1.png){#fig-factoextra6 fig-align='center' width=75%}\n:::\n:::\n\n\n#### Personnalisation des graphiques avec les résultats de l'ACP {#sec-12233}\n\nAvec un peu plus de lignes de code et l'utilisation d'autres *packages* (`ggplot2`, `ggpubr`, `stringr`, `corrplot`), vous pouvez aussi construire des graphiques personnalisés.\n\nPremièrement, la syntaxe ci-dessous permet de réaliser trois graphiques pour analyser les valeurs propres (@fig-acpmesgraphs1). Notez que, d'un coup d'œil, nous pouvons identifier les composantes principales avec une valeur propre égale ou supérieure à 1. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(ggpubr)\nlibrary(stringr)\nlibrary(corrplot)\n\n# Calcul de l'ACP\nres.acp <- PCA(Data[,2:11], ncp=5, scale.unit = TRUE, graph = FALSE)\nprint(res.acp)\n\n# Construction d'un DataFrame pour les valeurs propres\ndfACPvp <- data.frame(res.acp$eig)\nnames(dfACPvp) <- c(\"VP\" , \"VP_pct\" , \"VP_cumupct\")\ndfACPvp$Composante <- factor(1:nrow(dfACPvp), levels = rev(1:nrow(dfACPvp)))\ncouleursAxes <- c(\"steelblue\" , \"skyblue2\")\nvpsup1 <- round(sum(subset(dfACPvp, VP >= 1)$VP),2)\nvpsup1cumul <- round(sum(subset(dfACPvp, VP >= 1)$VP_pct),2)\n\nplotVP1 <- ggplot(dfACPvp, aes(x = VP, y = Composante, fill = VP<1))+\n  geom_bar(stat = \"identity\", width = .6, alpha = .8, color = \"black\")+\n  geom_vline(xintercept = 1, linetype = \"dashed\", color = \"azure4\", linewidth = 1)+\n  scale_fill_manual(name = \"Valeur\\npropre\" , values = couleursAxes, labels = c(\">= 1\" , \"< 1\"))+\n  labs(x = \"Valeur propre\", y = \"Composante principale\")\nplotVP2 <- ggplot(dfACPvp, aes(x = VP_pct, y = Composante, fill = VP<1))+\n  geom_bar(stat = \"identity\", width = .6, alpha = .8, color = \"black\")+\n  scale_fill_manual(name = \"Valeur\\npropre\" , values = couleursAxes, labels = c(\">= 1\" , \"< 1\"))+\n  theme(legend.position = \"none\")+\n  labs(x = \"Pourcentage de la variance expliquée\", y = \"\")\nplotVP3 <- ggplot(dfACPvp, aes(x = VP_cumupct, y = Composante, fill = VP<1, group=1))+\n  geom_bar(stat = \"identity\", width = .6, alpha = .8, color = \"black\")+\n  scale_fill_manual(name = \"Valeur\\npropre\" , values = couleursAxes, labels = c(\">= 1\" , \"< 1\"))+\n  geom_line(colour = \"brown\", linetype = \"solid\", size=.8) +\n  geom_point(size=3, shape=21, color = \"brown\", fill = \"brown\")+\n  theme(legend.position = \"none\")+\n  labs(x = \"Pourcentage cumulé de la variance expliquée\", y = \"\")\n\ntext1 <- paste0(\"Somme des valeurs propres supérieures à 1 : \",\n                vpsup1,\n                \".\\nPourcentage cumulé des valeurs propres supérieures à 1 : \",\n                vpsup1cumul, \"%.\")\nannotate_figure(ggarrange(plotVP1, plotVP2, plotVP3, ncol = 2, nrow = 2),\n                text_grob(\"Analyse des valeurs propres\", \n                         color = \"black\", face = \"bold\", size = 12),\n                bottom = text_grob(text1,\n                           color = \"black\", hjust = 1, x = 1, size = 10))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Graphiques personnalisés pour les valeurs propres](12-AnalysesFactorielles_files/figure-html/fig-acpmesgraphs1-1.png){#fig-acpmesgraphs1 fig-align='center' width=75%}\n:::\n:::\n\n\nDeuxièmement, la syntaxe ci-dessous permet de : \n\n- Construire un *DataFrame* avec les résultats des variables.\n\n- Construire des histogrammes avec les coordonnées des variables sur les axes factoriels (@fig-acpmesgraphs2). Notez que les coordonnées négatives sont indiquées avec des barres bleues et celles positives, avec des barres de couleur saumon.\n\n- Un graphique avec les contributions des variables sur les axes retenus (@fig-acpmesgraphs3).\n\n- Un graphique avec les cosinus carrés des variables sur les axes retenus (@fig-acpmesgraphs4). \n\n- Un histogramme avec la qualité des variables sur les axes retenus (@fig-acpmesgraphs5), soit la sommation de leurs cosinus carrés sur les axes retenus.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Analyse des résultats de L'ACP pour les variables\nlibrary(corrplot)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(ggpubr)\n\n# Indiquer le nombre d'axes à conserver suite à l'analyse des valeurs propres\nnComp <- 3\n# Variance expliquée par les axes retenus\nvppct <- round(dfACPvp[1:nComp,\"VP_pct\"],1)\n# Dataframe des résultats pour les variables\nCoordsVar <- res.acp$var$coord[, 1:nComp]\nCos2Var   <- res.acp$var$cos2[, 1:nComp]\nCtrVar   <- res.acp$var$contrib[, 1:nComp]\ndfACPVars <- data.frame(Variable =  row.names(res.acp$var$coord[, 1:nComp]),\n                        Coord = CoordsVar,\n                        Cos2 = Cos2Var,\n                        Qualite = rowSums(Cos2Var),\n                        Ctr = CtrVar)\nrow.names(dfACPVars) <- NULL\nnames(dfACPVars) <- str_replace(names(dfACPVars), \".Dim.\", \"Comp\")\ndfACPVars\n\n# Histogrammes pour les coordonnées\ncouleursCoords <- c(\"lightsalmon\" , \"steelblue\")\nplotCoordF1 <- ggplot(dfACPVars,\n                      aes(y = reorder(Variable, CoordComp1),\n                          x = CoordComp1, fill = CoordComp1<0))+\n  geom_bar(stat = \"identity\", width = .6, alpha = .8, color = \"black\")+\n  geom_vline(xintercept = 0, color = \"black\", linewidth = 1)+\n  scale_fill_manual(name = \"Coordonnée\" , values = couleursCoords,\n                    labels = c(\"Positive\" , \"Négative\"))+\n  labs(x = paste0(\"Axe 1 (\", vppct[1],\"%)\"), y = \"Variable\")+\n  theme(legend.position = \"none\")\nplotCoordF2 <- ggplot(dfACPVars,\n                      aes(y = reorder(Variable, CoordComp2),\n                          x = CoordComp2, fill = CoordComp2<0))+\n  geom_bar(stat = \"identity\", width = .6, alpha = .8, color = \"black\")+\n  geom_vline(xintercept = 0, color = \"black\", linewidth = 1)+\n  scale_fill_manual(name = \"Coordonnée\" , values = couleursCoords,\n                    labels = c(\"Positive\" , \"Négative\"))+\n  labs(x = paste0(\"Axe 2 (\", vppct[2],\"%)\"), y = \"Variable\")+\n  theme(legend.position = \"none\")\nplotCoordF3 <- ggplot(dfACPVars,\n                      aes(y = reorder(Variable, CoordComp3),\n                          x = CoordComp3, fill = CoordComp3<0))+\n  geom_bar(stat = \"identity\", width = .6, alpha = .8, color = \"black\")+\n  geom_vline(xintercept = 0, color = \"black\", linewidth = 1)+\n  scale_fill_manual(name = \"Coordonnée\", values = couleursCoords,\n                    labels = c(\"Positive\" , \"Négative\"))+\n  labs(x = paste0(\"Axe 3 (\", vppct[3],\"%)\"), y = \"Variable\")\n\nannotate_figure(ggarrange(plotCoordF1, plotCoordF2, plotCoordF3, nrow = nComp),\n                text_grob(\"Coordonnées des variables sur les axes factoriels\",\n                          color = \"black\", face = \"bold\", size = 12))\n\n# Contributions des variables à la formation des axes\ncorrplot(CtrVar, is.corr = FALSE, method =\"square\",\n         addCoef.col = 1, cl.pos = FALSE)\n\n# La qualité des variables sur les composantes retenues : cosinus carrés\ncorrplot(Cos2Var, is.corr = FALSE, method =\"square\",\n         addCoef.col = 1, cl.pos = FALSE)\n\nggplot(dfACPVars)+\n  geom_bar(aes(y = reorder(Variable, Qualite), x=Qualite),\n            stat = \"identity\", width = .6, alpha = .8, fill = \"steelblue\")+\n  labs(x = \"\", y = \"Somme des cosinus carrés sur les axes retenus\",\n       title = \"Qualité de représentation des variables sur les axes retenus de l'ACP\",\n       subtitle = paste0(\"Variance expliquée par les \", nComp, \n                         \" composantes : \", sum(vppct), \"%\"))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Histogrammes personnalisés avec les coordonnées factorielles pour les variables](12-AnalysesFactorielles_files/figure-html/fig-acpmesgraphs2-1.png){#fig-acpmesgraphs2 fig-align='center' width=75%}\n:::\n:::\n\n\n![Graphiques personnalisés avec les contributions des variables](images/Chap12/corrplotacpmesgraph3.png){#fig-acpmesgraphs3 width=\"30%\" fig-align=\"center\"}\n\n![Graphiques personnalisés avec les cosinus carrés des variables](images/Chap12/corrplotacpmesgraph4.png){#fig-acpmesgraphs4 width=\"30%\" fig-align=\"center\"}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Graphique personnalisé avec la qualité des variables sur les axes retenus de l'ACP](12-AnalysesFactorielles_files/figure-html/fig-acpmesgraphs5-1.png){#fig-acpmesgraphs5 fig-align='center' width=75%}\n:::\n:::\n\n\nTroisièmement, lorsque les observations sont des unités spatiales, il convient de cartographier les coordonnées factorielles des individus. Dans le jeu de données utilisé, les observations sont des polygones délimitant les îlots regroupés pour l'information statistique (IRIS) pour l'agglomération de Lyon (France). Nous utilisons les *packages* `tmap` et `RColorBrewer` pour réaliser des cartes choroplèthes avec les coordonnées des deux premières composantes (@fig-acpmesgraphs6).\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(\"tmap\")\nlibrary(\"RColorBrewer\")\n# Analyse des résultats de l'ACP pour les individus\n# Dataframe des résultats pour les individus\nCoordsInd <- res.acp$ind$coord[, 1:nComp]\nCos2Ind   <- res.acp$ind$cos2[, 1:nComp]\nCtrInd    <- res.acp$ind$contrib[, 1:nComp]\ndfACPInd <- data.frame(Coord = CoordsInd, Cos2 = Cos2Ind, Ctr = CtrInd)\nnames(dfACPInd) <- str_replace(names(dfACPInd), \".Dim.\", \"Comp\")\n# Fusion du tableau original avec les résultats de l'ACP pour les individus\nCartoACP <- cbind(LyonIris, dfACPInd)\n# Cartographie des coordonnées factorielles pour les individus pour les\n# deux premières composantes\nCarte1 <- tm_shape(CartoACP) +\n          tm_polygons(col = \"CoordComp1\", style = \"cont\",\n                      midpoint = 0, title = \"Coordonnées\")+\n          tm_layout(main.title = paste0(\"Axe 1 (\", vppct[1],\"%)\"),\n             attr.outside = TRUE, frame = FALSE, main.title.size = 1)\nCarte2 <- tm_shape(CartoACP) +\n          tm_polygons(col = \"CoordComp2\", style = \"cont\",\n                      midpoint = 0, title = \"Coordonnées\")+\n  tm_layout(main.title = paste0(\"Axe 2 (\", vppct[2],\"%)\"),\n             attr.outside = TRUE, frame = FALSE, main.title.size = 1)\ntmap_arrange(Carte1, Carte2)\n```\n\n::: {.cell-output-display}\n![Cartographie des coordonnées factorielles des individus](12-AnalysesFactorielles_files/figure-html/fig-acpmesgraphs6-1.png){#fig-acpmesgraphs6 fig-align='center' width=75%}\n:::\n:::\n\n\n\n::: bloc_aller_loin\n::: bloc_aller_loin-header\n::: bloc_aller_loin-icon\n:::\n**Exploration interactive des résultats d'une ACP avec le _package_ `explor`**. \n:::\n::: bloc_aller_loin-body\nVous avez compris qu'il ne suffit pas de calculer une ACP, il faut retenir les *n* premiers axes de l'ACP qui nous semblent les plus pertinents, puis les interpréter à la lecture des coordonnées factorielles, des cosinus carrés et des contributions des variables et des individus sur les axes. Il faut donc bien explorer les résultats à l’aide de tableaux et de graphiques! Cela explique que nous avons mobilisé de nombreux graphiques dans les deux sections précédentes ([-@sec-12232] et [-@sec-12233]). \nL’exploration des données d’une ACP peut aussi être réalisée avec des graphiques interactifs. Or, un superbe *package* dénommé [`explor`](https://juba.github.io/explor/), reposant sur [`Shiny`](https://shiny.rstudio.com/), permet d’explorer de manière interactive les résultats de plusieurs méthodes factorielles calculés avec `FactorMinerR`. Pour cela, il vous suffit de lancer les deux lignes de code suivantes :\n\n`library(explor)`\n\n`explor(res.acp)`\n\nFinalement, `explor` permet également d'explorer les résultats d'une analyse des correspondances (AFC) et d'une analyse des correspondances multiples (ACM).\n:::\n:::\n\n## Analyse factorielle des correspondances (AFC) {#sec-123}\n\n\n::: bloc_notes\n::: bloc_notes-header\n::: bloc_notes-icon\n:::\n**AFC et tableau de contingence**\n:::\n::: bloc_notes-body\nPour bien comprendre l'AFC, il est essentiel de bien maîtriser les notions de tableau de contingence (marges du tableau, fréquences observées et théoriques, pourcentages en ligne et en colonne, contributions au khi-deux) et de distance du khi-deux. Si ce n'est pas le cas, il est conseillé de (re)lire le [chapitre @sec-chap05]. \n:::\n:::\n\nDans le [chapitre @sec-chap05], nous avons vu comment construire un tableau de contingence (@fig-AnalysesFactoriellesTabAFCFig) à partir de deux variables qualitatives comprenant plusieurs modalités, puis comment vérifier s’il y a dépendance entre les deux variables qualitatives avec le test du khi-deux. Or, s’il y a bien dépendance, il est peut-être judicieux de résumer l’information que contient le tableau de contingence en quelques nouvelles variables synthétiques, objectif auquel répond l’analyse factorielle des correspondances (AFC).\n\n\n![Tableau de contingence pour une AFC](images/Chap12/AnalysesFactoriellesTabAFC.png){#fig-AnalysesFactoriellesTabAFCFig width=\"70%\" fig-align=\"center\"}\n\nÀ titre de rappel ([section @sec-1212]), l’AFC a été développée par le statisticien français Jean-Paul Benzécri [-@benzecri1973analyse]. Cela explique qu’elle est souvent enseignée et utilisée en sciences sociales dans les universités francophones, mais plus rarement dans les universités anglophones. Pourtant, les applications de l’AFC sont nombreuses dans différentes disciplines des sciences sociales comme illustrées avec les exemples suivants :\n\n-\tEn géographie, les modalités de la première variable du tableau de contingence sont souvent des entités spatiales (régions, municipalités, quartiers, etc.) croisées avec les modalités d'une autre variable qualitative (catégories socioprofessionnelles, modes de transport, tranches de revenu des ménages ou des individus, etc.).\n\n- En économie régionale, nous pourrions vouloir explorer un tableau de contingence croisant des entités spatiales (par exemple, MRC au Québec, départements en France) et les effectifs d'emplois pour différents secteurs d’activité.\n\n- En sciences politiques, le recours à l’AFC peut être intéressant pour explorer les résultats d’une élection. Les deux variables qualitatives pourraient être les *circonscriptions électorales* et les *partis politiques*. Le croisement des lignes et des colonnes du tableau de contingence représenterait le nombre de votes obtenus par un parti politique *j* dans la circonscription électorale *i*. Appliquer une AFC sur un tel tableau de contingence permettrait de révéler les ressemblances entre les différents partis politiques et celles entre les circonscriptions électorales. \n\n::: bloc_attention\n::: bloc_attention-header\n::: bloc_attention-icon\n:::\n**Appliquer une ACP sur un tableau de contingence : un bien mauvais calcul...**\n:::\n::: bloc_attention-body\n\nIl pourrait être tentant de transformer le tableau de contingence initial (@tbl-encadreAFCACP1) en un tableau avec les pourcentages en ligne (@tbl-encadreAFCACP2) afin de lui appliquer une analyse en composantes principales. Une telle démarche a deux inconvénients majeurs : chacune des modalités de la première variable qualitative (*I*) aurait alors le même poids; chacune des modalités de la deuxième variable (*J*) aurait aussi le même poids. Or, à la lecture des marges en ligne et en colonne au @tbl-encadreAFCACP1), il est clair que les modalités `j1` et `i1` comprennent bien plus d'individus que les autres modalités respectives.\n\nSi nous reprenons le dernier exemple applicatif, cela signifierait que le même poids est accordé à chaque parti puisque les variables sont centrées réduites en ACP (moyenne = 0 et variance = 1). Autrement dit, les grands partis traditionnels seraient ainsi sur le pied d’égalité que les autres partis. Aussi, chaque circonscription électorale aurait le même poids bien que certaines comprennent bien plus d’électeurs et d’électrices que d’autres.\n\n\n::: {#tbl-encadreAFCACP1 .cell tbl-cap='Exemple de tableau de contingence pour l\\'AFC'}\n::: {.cell-output-display}\nTable: Exemple de tableau de contingence pour l'AFC\n\n|                |        j1|     j2|      j3|      j4|     j5| Marge (ligne)|\n|:---------------|---------:|------:|-------:|-------:|------:|-------------:|\n|i1              |   357 060| 22 010| 276 625|  65 000| 29 415|       750 110|\n|i2              |   427 530| 26 400| 295 860|  69 410| 30 645|       849 845|\n|i3              |   147 500|  6 545|  34 545|   4 415|  1 040|       194 045|\n|i4              |   128 520|  6 405|  42 925|   6 565|  2 670|       187 085|\n|Marge (colonne) | 1 060 610| 61 360| 649 955| 145 390| 63 770|     1 981 085|\n:::\n:::\n\n::: {#tbl-encadreAFCACP2 .cell tbl-cap='Exemple d\\'un tableau de contingence transformé (pourcentage en ligne) pour l\\'ACP'}\n::: {.cell-output-display}\n|   |   V1|  V2|   V3|  V4|  V5|\n|:--|----:|---:|----:|---:|---:|\n|i1 | 47,6| 2,9| 36,9| 8,7| 3,9|\n|i2 | 50,3| 3,1| 34,8| 8,2| 3,6|\n|i3 | 76,0| 3,4| 17,8| 2,3| 0,5|\n|i4 | 68,7| 3,4| 22,9| 3,5| 1,4|\n:::\n:::\n\n:::\n:::\n\n\n### Recherche d'une simplification basée sur la distance du khi-deux {#sec-1231}\n\nSur le plan mathématique et des objectifs visés, l'AFC est similaire à l'ACP puisqu'elle permet d'explorer un tableau de trois façons : 1) en montrant les ressemblances entre un ensemble d'individus (*I*), 2) en révélant les liaisons entre les variables (*J*) et 3) en résumant le tout avec des variables synthétiques. Toutefois, avec l'AFC, les ensembles *I* et *J* sont les modalités de deux variables qualitatives (dont le croisement forme un tableau de contingence) et elle est basée sur la distance du khi-deux (et non sur la distance euclidienne comme en ACP).\n\nAinsi, avec la distance du khi-deux, la proximité (ressemblance) entre deux lignes (*i* et *l*) et deux colonnes (*j* et *k*) est mesurée comme suit :\n\n$$\nd_{\\chi_{il}^2} = \\sum_j \\frac{1}{f_{.j}}(\\frac{f_{ij}}{f_{i.}}-\\frac{f_{lj}}{f_{l.}})^2\n$$ {#eq-khideuxlignes}\n\n$$\nd_{\\chi_{jk}^2} = \\sum_i \\frac{1}{f_{i.}}(\\frac{f_{ij}}{f_{.j}}-\\frac{f_{ik}}{f_{.k}})^2\n$$ {#eq-khideuxcolonnes}\n\nPrenons un exemple fictif pour calculer ces deux distances. Le @tbl-afcdataex1 comprend trois modalités en ligne (*I*) et trois autres en colonne (*J*). Le total des effectifs de ce tableau de contingence est égal à 1 665.\n\nÀ partir des données brutes, il est facile de construire deux tableaux : le profil des lignes et le profil des colonnes (@tbl-afcProfilsLignesCols, c'est-à-dire les proportions en ligne et en colonne.\n\n\n::: {#tbl-afcdataex1 .cell tbl-cap='Données brutes du tableau de contingence'}\n::: {.cell-output-display}\n|                | j1  | j2  | j3  | Total (ligne) |\n|:---------------|:---:|:---:|:---:|:-------------:|\n|i1              | 360 | 65  | 275 |      700      |\n|i2              | 420 | 70  | 290 |      780      |\n|i3              | 145 |  5  | 35  |      185      |\n|Total (colonne) | 925 | 140 | 600 |     1 665     |\n:::\n:::\n\n::: {#tbl-afcProfilsLignesCols .cell tbl-cap='Profils des lignes et des colonnes'}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:center;\">  </th>\n   <th style=\"text-align:center;\"> j1 </th>\n   <th style=\"text-align:center;\"> j2 </th>\n   <th style=\"text-align:center;\"> j3 </th>\n   <th style=\"text-align:center;\"> Total </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"3\"><td colspan=\"5\" style=\"border-bottom: 1px solid;\"><strong>Profil des lignes</strong></td></tr>\n<tr>\n   <td style=\"text-align:center;padding-left: 2em;\" indentlevel=\"1\"> i1 </td>\n   <td style=\"text-align:center;\"> 0,514 </td>\n   <td style=\"text-align:center;\"> 0,093 </td>\n   <td style=\"text-align:center;\"> 0,393 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;padding-left: 2em;\" indentlevel=\"1\"> i2 </td>\n   <td style=\"text-align:center;\"> 0,538 </td>\n   <td style=\"text-align:center;\"> 0,090 </td>\n   <td style=\"text-align:center;\"> 0,372 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;padding-left: 2em;\" indentlevel=\"1\"> i3 </td>\n   <td style=\"text-align:center;\"> 0,784 </td>\n   <td style=\"text-align:center;\"> 0,027 </td>\n   <td style=\"text-align:center;\"> 0,189 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n  </tr>\n  <tr grouplength=\"4\"><td colspan=\"5\" style=\"border-bottom: 1px solid;\"><strong>Profils des colonnes</strong></td></tr>\n<tr>\n   <td style=\"text-align:center;padding-left: 2em;\" indentlevel=\"1\"> i1 </td>\n   <td style=\"text-align:center;\"> 0,389 </td>\n   <td style=\"text-align:center;\"> 0,464 </td>\n   <td style=\"text-align:center;\"> 0,458 </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;padding-left: 2em;\" indentlevel=\"1\"> i2 </td>\n   <td style=\"text-align:center;\"> 0,454 </td>\n   <td style=\"text-align:center;\"> 0,500 </td>\n   <td style=\"text-align:center;\"> 0,483 </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;padding-left: 2em;\" indentlevel=\"1\"> i3 </td>\n   <td style=\"text-align:center;\"> 0,157 </td>\n   <td style=\"text-align:center;\"> 0,036 </td>\n   <td style=\"text-align:center;\"> 0,058 </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;padding-left: 2em;\" indentlevel=\"1\"> Total </td>\n   <td style=\"text-align:center;\"> 1,000 </td>\n   <td style=\"text-align:center;\"> 1,000 </td>\n   <td style=\"text-align:center;\"> 1,000 </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nEn divisant les valeurs du @tbl-afcdataex1 par le grand total (1 665), nous obtenons tous les termes utilisés dans les équations [-@eq-khideuxlignes] et [-@eq-khideuxcolonnes] au @tbl-afcdataex2 :\n\n- Les fréquences relatives dénommées $f_{ij}$. \n- La marge $fi.$ est égale à la somme des fréquences relatives en ligne.\n- La marge $f.j$ est égale à la somme des fréquences relatives en colonne.\n- La somme de toutes les fréquences relatives est donc égale à 1, soit $\\sum{f_{i.}}$ ou $\\sum{f_{.j}}$.\n\n\n\n::: {#tbl-afcdataex2 .cell tbl-cap='Données relatives du tableau de contingence (fij)'}\n::: {.cell-output-display}\n|            |    j1|    j2|    j3| Total (fi.)|\n|:-----------|-----:|-----:|-----:|-----------:|\n|i1          | 0,216| 0,039| 0,165|       0,420|\n|i2          | 0,252| 0,042| 0,174|       0,468|\n|i3          | 0,087| 0,003| 0,021|       0,111|\n|Total (f.j) | 0,556| 0,084| 0,360|       1,000|\n:::\n:::\n\n\nIl est possible de calculer les distances entre les différentes modalités  de *I* en appliquant l'@eq-khideuxlignes; par exemple, la distance entre les observations `i1` et `i2` est égale à :\n\n$$d_{(i1,i2)}=\\frac{\\mbox{1}}{\\mbox{0,556}}(\\mbox{0,216}-\\mbox{0,252})^2+\\frac{\\mbox{1}}{\\mbox{0,084}}(\\mbox{0,039}-\\mbox{0,042})^2+\n\\frac{\\mbox{1}}{\\mbox{0,360}}(\\mbox{0,165}-\\mbox{0,174})^2=\\mbox{0,003}$$\n\nAvec l'@eq-khideuxcolonnes, la distance entre les modalités `j1` et `j2` de *J* est égale à :\n\n$$d_{(j1,j2)}=\\frac{\\mbox{1}}{\\mbox{0,420}}(\\mbox{0,216}-\\mbox{0,039})^2+ \\frac{\\mbox{1}}{\\mbox{0,468}}(\\mbox{0,252}-\\mbox{0,042})^2 + \\frac{\\mbox{1}}{\\mbox{0,111}}(\\mbox{0,087}-\\mbox{0,003})^2=\\mbox{0,233}$$\n\n\nÀ la lecture du @tbl-MatriceDistKhi, les modalités les plus semblables sont \n`i1` et `i2` (0,003) pour *I* et `j1` et `j3` (0,058) pour *J*.\n\n\n::: {#tbl-MatriceDistKhi .cell tbl-cap='Distances du khi-deux entre les modalités I et les modalités J'}\n::: {.cell-output-display}\n| Ind. |  i1   |  i2   |  i3   | Col. |  j1   |  j2   |  j3   |\n|:----:|:-----:|:-----:|:-----:|:----:|:-----:|:-----:|:-----:|\n|  i1  | 0,000 | 0,003 | 0,103 |  j1  | 0,000 | 0,233 | 0,058 |\n|  i2  | 0,003 | 0,000 | 0,132 |  j2  | 0,233 | 0,000 | 0,078 |\n|  i3  | 0,103 | 0,132 | 0,000 |  j3  | 0,058 | 0,078 | 0,000 |\n:::\n:::\n\n\nFinalement, l'approche pour déterminer les axes factoriels de l'AFC est similaire à celle de l'ACP : les axes factoriels sont les droites orthogonales qui minimisent les distances aux points du profil des lignes, excepté que la métrique pour mesurer ces distances est celle du khi-deux (et non celle la distance euclidienne comme pour l'ACP). Pour plus détails sur le calcul de ces axes (notamment les formulations matricielles), consultez notamment Benzécri [-@benzecri1973analyse], Escofier et Pagès [-@escofier1998analyses] et Lebart et al. [-@lebart1995statistique].\n\n\n### Aides à l'interprétation {#sec-1232}\n\nPour illustrer les aides à l’interprétation de l’AFC, nous utilisons un jeu de données spatiales extrait du [profil du recensement de 2016 de Statistique Canada](https://www12.statcan.gc.ca/census-recensement/2016/dp-pd/prof/index.cfm?Lang=F){target='_blank'} pour les secteurs de recensement de l'île de Montréal. La liste des modalités des variables qu'il comprend est reportée au @tbl-dataAfc. L'AFC est calculée sur un tableau de contingence croisant les secteurs de recensement (lignes) et les modalités d'une variable relative au mode de transport utilisé pour les déplacements domicile-travail (colonnes). Ces modalités sont cartographiées à la @fig-cartovarAFC).\n\n\n::: {#tbl-dataAfc .cell tbl-cap='Jeu de données utilisé pour l\\'analyse factorielle des correspondances'}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">  </th>\n   <th style=\"text-align:left;\"> Nom </th>\n   <th style=\"text-align:left;\"> Intitulé </th>\n   <th style=\"text-align:right;\"> Somme </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"6\"><td colspan=\"4\" style=\"border-bottom: 1px solid;\"><strong>Modalités de la variable utilisée dans l'AFC (mode de transport)</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> VehCond </td>\n   <td style=\"text-align:left;\"> VehCond </td>\n   <td style=\"text-align:left;\"> Véhicule motorisé (conducteur·trice) </td>\n   <td style=\"text-align:right;\"> 427 560 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> VehPass </td>\n   <td style=\"text-align:left;\"> VehPass </td>\n   <td style=\"text-align:left;\"> Véhicule motorisé (passager·ère) </td>\n   <td style=\"text-align:right;\"> 26 490 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> TranspC </td>\n   <td style=\"text-align:left;\"> TranspC </td>\n   <td style=\"text-align:left;\"> Transport en commun </td>\n   <td style=\"text-align:right;\"> 295 800 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Apied </td>\n   <td style=\"text-align:left;\"> Apied </td>\n   <td style=\"text-align:left;\"> À pied </td>\n   <td style=\"text-align:right;\"> 69 330 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Velo </td>\n   <td style=\"text-align:left;\"> Velo </td>\n   <td style=\"text-align:left;\"> Bicyclette </td>\n   <td style=\"text-align:right;\"> 30 615 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> AutreMoyen </td>\n   <td style=\"text-align:left;\"> AutreMoyen </td>\n   <td style=\"text-align:left;\"> Autre moyen </td>\n   <td style=\"text-align:right;\"> 7 750 </td>\n  </tr>\n  <tr grouplength=\"5\"><td colspan=\"4\" style=\"border-bottom: 1px solid;\"><strong>Modalités de la variable supplémentaire (durée du trajet)</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> T15min </td>\n   <td style=\"text-align:left;\"> T15min </td>\n   <td style=\"text-align:left;\"> Moins de 15 minutes </td>\n   <td style=\"text-align:right;\"> 130 435 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> T1529min </td>\n   <td style=\"text-align:left;\"> T1529min </td>\n   <td style=\"text-align:left;\"> 15 à 29 minutes </td>\n   <td style=\"text-align:right;\"> 287 500 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> T3044min </td>\n   <td style=\"text-align:left;\"> T3044min </td>\n   <td style=\"text-align:left;\"> 30 à 44 minutes </td>\n   <td style=\"text-align:right;\"> 244 425 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> T4559min </td>\n   <td style=\"text-align:left;\"> T4559min </td>\n   <td style=\"text-align:left;\"> 45 à 59 minutes </td>\n   <td style=\"text-align:right;\"> 107 065 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> T60plus </td>\n   <td style=\"text-align:left;\"> T60plus </td>\n   <td style=\"text-align:left;\"> 60 minutes et plus </td>\n   <td style=\"text-align:right;\"> 88 050 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Cartographie des modalités de la variable mode de transport utilisée pour l'AFC](12-AnalysesFactorielles_files/figure-html/fig-cartovarAFC-1.png){#fig-cartovarAFC fig-align='center' width=100%}\n:::\n:::\n\n\n#### Résultats de l'AFC pour les valeurs propres {#sec-12321}\n\nAvant de calculer l'AFC, il convient de vérifier s'il y a bien une dépendance entre les modalités des deux variables qualitatives. En effet, si les deux variables sont indépendantes, il n'est pas nécessaire de résumer le tableau de contingence avec une AFC. Pour ce faire, nous utilisons le test du khi-deux largement décrit à la [section @sec-052]. Les résultats de ce test signalent qu’il existe des associations entre les modalités des deux variables ($\\chi$ = 203 971, *p* < 0,001, @tbl-dataafckhi2). Nous pouvons donc appliquer une AFC sur ce tableau de contingence.\n\n\n::: {#tbl-dataafckhi2 .cell tbl-cap='Résultats du test du khi-deux sur le tableau de contingence'}\n::: {.cell-output-display}\n|Mesure                                              |     Valeur|\n|:---------------------------------------------------|----------:|\n|Modalités *I* (secteurs de recensement)             |     521,00|\n|Modalités *J* (variable mode de transport)          |       6,00|\n|Somme des données brutes ($n_{ij}$)                 | 857 545,00|\n|Khi-deux ($\\chi^2$)                                 | 207 129,27|\n|Degrés de liberté, soit $(c-1)\\times(l-1)$          |   2 600,00|\n|Valeur de *p*                                       |       0,00|\n|Coefficient Phi au carré ($\\phi^2=\\chi^2 / n_{ij})$ |       0,24|\n:::\n:::\n\n\nNous avons vu qu'en ACP normée ([section @sec-12221]), la somme des valeurs propres est égale au nombre de variables puisqu'elles sont centrées réduites. Par contre, en AFC, cette somme est égale à l'inertie totale du tableau de contingence, c'est-à-dire à la valeur du khi-deux divisée par le nombre total des effectifs bruts (soit le coefficient phi au carré, $\\phi^2$) ([section @sec-052]). Le @tbl-dataafcValeurPropres permet de vérifier que la somme des valeurs propres est bien égale au coefficient phi au carré : \n\n$$\\mbox{0,156}+\\mbox{0,046}+\\mbox{0,031}+\\mbox{0,004}+\\mbox{0,004} = \\mbox{0,24}$$\n\n$$\\phi^2 = \\chi^2 / n_{ij}=\\mbox{203 971}/ \\mbox{849 795} = \\mbox{0,24}$$\n\n::: {#tbl-dataafcValeurPropres .cell tbl-cap='Résultats de l\\'AFC pour les valeurs propres'}\n::: {.cell-output-display}\n|      | Axe factoriel| Valeur propre| Pourcentage| Pourc. cumulé|\n|:-----|-------------:|-------------:|-----------:|-------------:|\n|dim 1 |             1|         0,156|      64,590|        64,590|\n|dim 2 |             2|         0,046|      19,250|        83,840|\n|dim 3 |             3|         0,031|      12,995|        96,835|\n|dim 4 |             4|         0,004|       1,683|        98,518|\n|dim 5 |             5|         0,004|       1,482|       100,000|\n:::\n:::\n\n\n**Combien d'axes d'une AFC faut-il retenir?**\n\n- **Approche statistique**. Mike Bendixen [-@bendixen1995compositional], cité dans l'excellent site [STHDA](http://www.sthda.com/){target='_blank'}, propose deux critères pour sélectionner les premiers axes d'une AFC : $c_1= 1 / (l-1) \\times 100$ et $c_2= 1 / (c-1) \\times 100$ avec *l* et *c* étant respectivement les nombres de modalités en ligne et en colonne. Autrement dit, lorsque les données sont distribuées aléatoirement, la valeur propre en pourcentage devrait être égale à $c_1$ et celle de l'axe factoriel moyen à $c_2$. Par conséquent, nous pourrions retenir uniquement les axes dont les valeurs propres en pourcentage excèdent : $c_1 = \\mbox{1}/(\\mbox{521}-\\mbox{1})\\times \\mbox{100}=\\mbox{0,19 }%$ et $c_2=\\mbox{1}/(\\mbox{6}-\\mbox{1})\\times \\mbox{100}=\\mbox{20 }%$. En appliquant ces deux critères, seul le premier axe factoriel qui résume 65,6 % mérite d'être retenu.\n\n- **Approche empirique** basée sur la lecture des pourcentages et des pourcentages cumulés. Nous retenons uniquement les deux premières composantes qui résument 85 % de la variance totale. Pour faciliter le choix du nombre d'axes avec cette approche empirique, il est fortement conseillé de construire un histogramme à partir des valeurs propres, soit brutes, soit en pourcentage, soit en pourcentage cumulé (@fig-afcGraphVP).\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Histogramme des valeurs propres de l'AFC](12-AnalysesFactorielles_files/figure-html/fig-afcGraphVP-1.png){#fig-afcGraphVP fig-align='center' width=80%}\n:::\n:::\n\n\n#### Résultats de l'AFC pour les variables et les individus {#sec-12322}\nComme pour l'ACP, nous retrouvons les trois mêmes mesures pour les variables et les individus : 1) les coordonnées factorielles, 2) les contributions et 3) les cosinus carrés. \n\n::: bloc_objectif\n::: bloc_objectif-header\n::: bloc_objectif-icon\n:::\n**Compréhension des axes factoriels de l'AFC : une étape essentielle, incontournable...**\n:::\n::: bloc_objectif-body\nComme en ACP, l'analyse des trois mesures (coordonnées, contributions et cosinus carrés) pour les variables et les individus doit vous permettre de comprendre la signification des axes factoriels retenus de l'AFC. Cette étape d'interprétation est essentielle afin de qualifier les variables latentes (axes factoriels, variables synthétiques) produites par l'AFC.\n:::\n:::\n\n\n- **Les coordonnées factorielles** sont simplement les projections des points-lignes et des points-colonnes sur les axes de l'AFC. Tant pour les lignes que pour les colonnes, ces coordonnées bénéficient de deux propriétés intéressantes. Premièrement, pour chaque axe factoriel *k*, la somme du produit des marges des variables ($f.j$, colonnes) ou des individus ($fi.$, lignes) avec leurs coordonnées respectives ($C^k_j$ et $C^k_i$) est égale à 0 (@eq-CoordPropr1). Deuxièmement, pour chaque axe factoriel *k*, la somme des produits entre les marges (en ligne et en colonne) et les coordonnées au carré (en ligne et en colonne) est égale à la valeur propre de l'axe (@eq-CoordPropr2).\n\n$$\n\\sum{f.j (C^k_j)}= 0 \\text{ et} \\sum{fi. (C^k_i)}= 0\n$$ {#eq-CoordPropr1}\n\n$$\n\\sum{fi. (C^k_i)^2}= \\mu_k \\text{ et} \\sum{f.j (C^k_j)^2}= \\mu_k\n$$ {#eq-CoordPropr2}\n\nEn guise d'exemple, le @tbl-dataafcCoordVars2 permet de vérifier les deux propriétés des coordonnées pour les variables. Les sommes de ${f.j (C^k_j)}$ pour les axes 1 et 2 sont bien égales à 0; et les sommes de ${f.j (C^k_j)^2}$ pour les axes 1 et 2 sont bien égales aux valeurs propres de ces deux axes, soit 0,156 et 0,046 (comparez ces valeurs avec celles reportées au @tbl-dataafcValeurPropres plus haut).\n\n\n::: {#tbl-dataafcCoordVars2 .cell tbl-cap='Vérification des deux propriétés des coordonnées factorielles pour les variables'}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"2\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Coord.</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">f.j x Coord.</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">f.j x Coord2</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Modalité </th>\n   <th style=\"text-align:right;\"> f.j </th>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> VehCond </td>\n   <td style=\"text-align:right;\"> 0,499 </td>\n   <td style=\"text-align:right;\"> -0,329 </td>\n   <td style=\"text-align:right;\"> 0,077 </td>\n   <td style=\"text-align:right;\"> -0,164 </td>\n   <td style=\"text-align:right;\"> 0,038 </td>\n   <td style=\"text-align:right;\"> 0,054 </td>\n   <td style=\"text-align:right;\"> 0,003 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> VehPass </td>\n   <td style=\"text-align:right;\"> 0,031 </td>\n   <td style=\"text-align:right;\"> -0,255 </td>\n   <td style=\"text-align:right;\"> 0,081 </td>\n   <td style=\"text-align:right;\"> -0,008 </td>\n   <td style=\"text-align:right;\"> 0,003 </td>\n   <td style=\"text-align:right;\"> 0,002 </td>\n   <td style=\"text-align:right;\"> 0,000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TranspC </td>\n   <td style=\"text-align:right;\"> 0,345 </td>\n   <td style=\"text-align:right;\"> 0,208 </td>\n   <td style=\"text-align:right;\"> -0,229 </td>\n   <td style=\"text-align:right;\"> 0,072 </td>\n   <td style=\"text-align:right;\"> -0,079 </td>\n   <td style=\"text-align:right;\"> 0,015 </td>\n   <td style=\"text-align:right;\"> 0,018 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Apied </td>\n   <td style=\"text-align:right;\"> 0,081 </td>\n   <td style=\"text-align:right;\"> 0,813 </td>\n   <td style=\"text-align:right;\"> 0,545 </td>\n   <td style=\"text-align:right;\"> 0,066 </td>\n   <td style=\"text-align:right;\"> 0,044 </td>\n   <td style=\"text-align:right;\"> 0,053 </td>\n   <td style=\"text-align:right;\"> 0,024 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Velo </td>\n   <td style=\"text-align:right;\"> 0,036 </td>\n   <td style=\"text-align:right;\"> 0,938 </td>\n   <td style=\"text-align:right;\"> -0,187 </td>\n   <td style=\"text-align:right;\"> 0,033 </td>\n   <td style=\"text-align:right;\"> -0,007 </td>\n   <td style=\"text-align:right;\"> 0,031 </td>\n   <td style=\"text-align:right;\"> 0,001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> AutreMoyen </td>\n   <td style=\"text-align:right;\"> 0,009 </td>\n   <td style=\"text-align:right;\"> 0,142 </td>\n   <td style=\"text-align:right;\"> 0,078 </td>\n   <td style=\"text-align:right;\"> 0,001 </td>\n   <td style=\"text-align:right;\"> 0,001 </td>\n   <td style=\"text-align:right;\"> 0,000 </td>\n   <td style=\"text-align:right;\"> 0,000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Somme </td>\n   <td style=\"text-align:right;\"> 1,000 </td>\n   <td style=\"text-align:right;\">  </td>\n   <td style=\"text-align:right;\">  </td>\n   <td style=\"text-align:right;\"> 0,000 </td>\n   <td style=\"text-align:right;\"> 0,000 </td>\n   <td style=\"text-align:right;\"> 0,156 </td>\n   <td style=\"text-align:right;\"> 0,046 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: bloc_attention\n::: bloc_attention-header\n::: bloc_attention-icon\n:::\n**Particularité de l'AFC**\n:::\n::: bloc_attention-body\nContrairement à l'ACP, les coordonnées factorielles pour les variables en AFC ne sont pas les coefficients de corrélation de Pearson des variables sur les axes!\n:::\n:::\n\n- **Les contributions** des colonnes ou des lignes en AFC permettent de repérer celles qui contribuent le plus à la formation des axes factoriels (de manière analogue à l'ACP). Pour un axe donné, leur sommation est égale à 100 %. Elles s'obtiennent en multipliant la coordonnée au carré avec la marge et en divisant le tout par la valeur propre de l'axe (équations [-@eq-CtrAFCVar] et [-@eq-CtrAFCInd]).\n\n$$\n\\mbox{Ctr}_j^k =\\frac{f.j(C^k_j)^2}{\\mu_{k}}\\times 100\n$$ {#eq-CtrAFCVar}\n\n$$\n\\mbox{Ctr}_i^k =\\frac{fi.(C^k_i)^2}{\\mu_{k}}\\times 100\n$$ {#eq-CtrAFCInd}\n\n- **Les cosinus carrés** (Cos^2^) (appelés aussi les qualités de représentation sur un axe) permettent de repérer le ou les axes qui concourent le plus à donner un sens aux colonnes (variables) et aux lignes (individus), de manière analogue à l'ACP. Pour une variable ou un individu, la sommation des Cos^2^ pour tous les axes de l'AFC est aussi égale à 1.\n\n**Interprétation des résultats pour les colonnes (variables)**\n\nMaintenant, analysons ces trois statistiques pour les variables pour les deux premiers axes de l'AFC (@tbl-dataafcCoordVars et @fig-afc1erplanfactVars).\n\nPour l'axe 1, résumant 65 % de la variance, trois modalités concourent à sa formation : `VehCond` (34,69 %), `Apied` (34,25 %) et `Velo` (20,13 %). À la lecture des coordonnées factorielles sur cet axe, les modes de transport relatifs aux véhicules motorisés (`VehCond` = -0,33 et `VehPass` = -0,25) s'opposent clairement aux modes actifs (`Apied` = 0,81 et `Velo` = 0,94), constat qu'il est possible de confirmer visuellement avec la @fig-afc1erplanfactVars. La modalité `VehCond` a d'ailleurs la plus forte valeur de Cos^2^ sur cet axe (0,92), ce qui signale, sans l'ombre d'un doute, que l'axe 1 est celui qui donne le plus de sens à cette modalité. \n\nPuisque l'axe 2 résume une partie beaucoup plus limitée de la variance du tableau (19,25 %), il n'est pas étonnant qu'un nombre plus limité de modalités concourent à sa formation : seules les contributions de la modalité `Apied` (51,68 %) et secondairement de `TranspC` (38,81 %) sont importantes. Leurs coordonnées factorielles s'opposent d'ailleurs sur cet axe (respectivement 0,81 et 0,21).\n\n\n\n::: {#tbl-dataafcCoordVars .cell tbl-cap='Résultats de l\\'AFC pour les variables'}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Coordonnées</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Cosinus carrés</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Contributions (%)</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Modalité </th>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> VehCond </td>\n   <td style=\"text-align:right;\"> -0,33 </td>\n   <td style=\"text-align:right;\"> 0,08 </td>\n   <td style=\"text-align:right;\"> 0,92 </td>\n   <td style=\"text-align:right;\"> 0,05 </td>\n   <td style=\"text-align:right;\"> 34,69 </td>\n   <td style=\"text-align:right;\"> 6,33 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> VehPass </td>\n   <td style=\"text-align:right;\"> -0,25 </td>\n   <td style=\"text-align:right;\"> 0,08 </td>\n   <td style=\"text-align:right;\"> 0,34 </td>\n   <td style=\"text-align:right;\"> 0,03 </td>\n   <td style=\"text-align:right;\"> 1,28 </td>\n   <td style=\"text-align:right;\"> 0,44 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TranspC </td>\n   <td style=\"text-align:right;\"> 0,21 </td>\n   <td style=\"text-align:right;\"> -0,23 </td>\n   <td style=\"text-align:right;\"> 0,39 </td>\n   <td style=\"text-align:right;\"> 0,47 </td>\n   <td style=\"text-align:right;\"> 9,53 </td>\n   <td style=\"text-align:right;\"> 38,81 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Apied </td>\n   <td style=\"text-align:right;\"> 0,81 </td>\n   <td style=\"text-align:right;\"> 0,54 </td>\n   <td style=\"text-align:right;\"> 0,67 </td>\n   <td style=\"text-align:right;\"> 0,30 </td>\n   <td style=\"text-align:right;\"> 34,25 </td>\n   <td style=\"text-align:right;\"> 51,61 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Velo </td>\n   <td style=\"text-align:right;\"> 0,94 </td>\n   <td style=\"text-align:right;\"> -0,19 </td>\n   <td style=\"text-align:right;\"> 0,56 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n   <td style=\"text-align:right;\"> 20,13 </td>\n   <td style=\"text-align:right;\"> 2,69 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> AutreMoyen </td>\n   <td style=\"text-align:right;\"> 0,14 </td>\n   <td style=\"text-align:right;\"> 0,08 </td>\n   <td style=\"text-align:right;\"> 0,05 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,12 </td>\n   <td style=\"text-align:right;\"> 0,12 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Premier plan factoriel de l'AFC pour les variables](12-AnalysesFactorielles_files/figure-html/fig-afc1erplanfactVars-1.png){#fig-afc1erplanfactVars fig-align='center' width=75%}\n:::\n:::\n\n            \n            \n**Interprétation des résultats pour les individus**\n\n::: bloc_notes\n::: bloc_notes-header\n::: bloc_notes-icon\n:::\n**Premier plan factoriel pour les variables et les individus**\n:::\n::: bloc_notes-body\nLorsque le jeu de données comprend à la fois peu de modalités en ligne et en colonne, il est judicieux de les représenter simultanément sur le premier plan factoriel (axes 1 et 2). Pour ce faire, vous pouvez utiliser la fonction `fviz_ca_biplot` du *package* `factoextra`.\n:::\n:::\n\nÉtant donné que notre jeu de données comprend 521 secteurs de recensement, nous proposons ici de cartographier les coordonnées factorielles des individus pour les deux premiers axes de l'AFC (@fig-afc1erplanfactInds2). Pour l'axe 1, les secteurs de recensement à l'est et l'ouest de l'île de Montréal présentent les coordonnées les plus fortement négatives (en rouge); dans ces zones, l'usage des véhicules motorisés pour des déplacements domicile-travail est certainement surreprésenté, comparativement aux modes actifs. À l'inverse, dans les secteurs de recensement du centre de l'île présentant de fortes valeurs positives (en rouge), le recours aux modes de transports actifs (marche et vélo) est bien plus important, toutes proportions gardées. Quant à la cartographie des coordonnées pour l'axe 2, elle permet surtout de repérer quelques secteurs de recensement autour du centre-ville (très fortes valeurs positives en vert foncé) où les déplacements domicile-travail à pied sont plus fréquents, toutes proportions gardées.\n\nEn résumé, suite à l'analyse des coordonnées factorielles des variables et des individus, nous pouvons conclure que le premier axe est certainement le plus intéressant puisqu’il permet d'opposer l’usage des modes de transports motorisés versus les modes de transports actifs pour les déplacements domicile-travail sur l'île de Montréal. Cette nouvelle variable synthétique (variable latente) pourrait ainsi être introduite dans des analyses subséquentes (par exemple, dans un modèle de régression). Cela démontre qu’au même titre que l’ACP, l’AFC est une méthode de réduction de données puisque nous sommes passés d’un tableau comprenant 512 secteurs de recensement et six modalités à un tableau comprenant une seule variable synthétique (axe 1).\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Cartographie de coordonnées factorielles des individus pour l'AFC](12-AnalysesFactorielles_files/figure-html/fig-afc1erplanfactInds2-1.png){#fig-afc1erplanfactInds2 fig-align='center' width=672}\n:::\n:::\n\n\n\n\n::: bloc_aller_loin\n::: bloc_aller_loin-header\n::: bloc_aller_loin-icon\n:::\n**Ajout de modalités supplémentaires dans une analyse des correspondances (AFC)**\n:::\n::: bloc_aller_loin-body\nComme pour l'ACP, il est possible d'ajouter des variables et des individus supplémentaires une fois l'AFC calculée. En guise d'illustration, nous avons ajouté à l'AFC précédemment analysée des modalités relatives à la durée des temps de déplacements :\tmoins de 15 minutes, 15 à 29, 30 à 44, 45 à 59, 60 minutes et plus. Sans surprise, sur le premier plan factoriel à la @fig-afc1erplanfactInds2, cette dernière modalité, représentant les trajets les plus longs, est la plus proche des modalités relatives à l'usage des véhicules motorisés (`VehCond` et `VehPass`).\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Ajout de modalités supplémentaires sur le premier plan factoriel de l'AFC](12-AnalysesFactorielles_files/figure-html/fig-afcAjoutModalites-1.png){#fig-afcAjoutModalites fig-align='center' width=75%}\n:::\n:::\n\n:::\n:::\n\n### Mise en œuvre dans R {#sec-1233}\n\n#### Calcul d’une AFC avec `FactoMineR` {#sec-12331}\n\nPlusieurs *packages* permettent de calculer une AFC dans R, notamment `ca` (fonction `ca`), `MASS` (fonction `corresp`), `ade4` (fonction `dudi.coa`) et `FactoMineR` (fonction `CA`). De nouveau, nous utilisons `FactoMineR` couplé au *package* `factoextra` pour réaliser rapidement des graphiques avec les résultats pour les variables et les coordonnées.\n\nPour calculer l'AFC, il suffit d'utiliser la fonction `CA` de `FactoMineR`, puis la fonction `summary(res.afc)`, qui renvoie les résultats de l'AFC pour : \n\n- Les valeurs propres (section `Eigenvalues`) pour les axes factoriels (`Dim.1` à `Dim.n`) avec leur variance expliquée brute (`Variance`), en pourcentage (`% of var.`) et en pourcentage cumulé (`Cumulative % of var.`).\n\n- Les dix premières observations (section `Rows`) avec les coordonnées factorielles (`Dim.1` à `Dim.n`), les contributions (`ctr`) et les cosinus carrés (`cos2`). Pour accéder aux résultats pour toutes les observations, utilisez les fonctions `res.afc$row` ou encore `res.afc$row$coord` (uniquement les coordonnées factorielles), `res.afc$row$contrib` (uniquement les contributions) et `res.afc$row$cos2` (uniquement les cosinus carrés).\n\n- Les colonnes (section `Columns`) avec les coordonnées factorielles (D`im.1` à `Dim.n`), les contributions (`ctr`) et les cosinus carrés (`cos2`).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Chargement des packages\nlibrary(FactoMineR)\nlibrary(factoextra)\n# Chargement des données\nload(\"data/analysesfactorielles/DonneesAFC.Rdata\")\n# Avant de calculer l'AFC, il convient de vérifier si les deux variables\n# qualitatives sont dépendantes avec le test du khi-deux\nkhideux <- chisq.test(dfDonneesAFC[,1:6])\nprint(khideux)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's Chi-squared test\n\ndata:  dfDonneesAFC[, 1:6]\nX-squared = 207129, df = 2600, p-value < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nif(khideux$p.value <=0.05){\n  cat(\"La valeur de p < 0,05. Les variables sont dépendantes. Calculez l'AFC.\")\n}else {\n    cat(\"La valeur de p > 0,05. Les variables sont indépendantes. Inutile de calculer l'AFC\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLa valeur de p < 0,05. Les variables sont dépendantes. Calculez l'AFC.\n```\n:::\n\n```{.r .cell-code}\n# Calcul de l'analyse des correspondances sur les six premières variables\nres.afc <- CA(dfDonneesAFC[,1:6], graph = FALSE)\n# Affichage des résultats de la fonction CA\nprint(res.afc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n**Results of the Correspondence Analysis (CA)**\nThe row variable has  521  categories; the column variable has 6 categories\nThe chi square of independence between the two variables is equal to 207129.3 (p-value =  0 ).\n*The results are available in the following objects:\n\n   name              description                   \n1  \"$eig\"            \"eigenvalues\"                 \n2  \"$col\"            \"results for the columns\"     \n3  \"$col$coord\"      \"coord. for the columns\"      \n4  \"$col$cos2\"       \"cos2 for the columns\"        \n5  \"$col$contrib\"    \"contributions of the columns\"\n6  \"$row\"            \"results for the rows\"        \n7  \"$row$coord\"      \"coord. for the rows\"         \n8  \"$row$cos2\"       \"cos2 for the rows\"           \n9  \"$row$contrib\"    \"contributions of the rows\"   \n10 \"$call\"           \"summary called parameters\"   \n11 \"$call$marge.col\" \"weights of the columns\"      \n12 \"$call$marge.row\" \"weights of the rows\"         \n```\n:::\n\n```{.r .cell-code}\n# Visualisation des marges en colonne\nround(res.afc$call$marge.col,4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   VehCond    VehPass    TranspC      Apied       Velo AutreMoyen \n    0.4986     0.0309     0.3449     0.0808     0.0357     0.0090 \n```\n:::\n\n```{.r .cell-code}\n# Visualisation des marges en ligne. Étant donné que nous avons 521 individus, \n# la ligne ci-dessous est en commentaire\n# round(res.afc$call$marge.row,4)\n\n# Sommaire des résultats de l'AFC\n# Remarquez que la première ligne de ce sommaire est le résultat du khi-deux\nsummary(res.afc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nCA(X = dfDonneesAFC[, 1:6], graph = FALSE) \n\nThe chi square of independence between the two variables is equal to 207129.3 (p-value =  0 ).\n\nEigenvalues\n                       Dim.1   Dim.2   Dim.3   Dim.4   Dim.5\nVariance               0.156   0.046   0.031   0.004   0.004\n% of var.             64.590  19.250  12.995   1.683   1.482\nCumulative % of var.  64.590  83.840  96.835  98.518 100.000\n\nRows (the 10 first)\n             Iner*1000    Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3\n1          |     0.155 | -0.304  0.095  0.961 | -0.023  0.002  0.006 |  0.048\n2          |     0.123 | -0.232  0.067  0.850 |  0.028  0.003  0.012 | -0.021\n3          |     0.268 | -0.246  0.127  0.737 | -0.002  0.000  0.000 | -0.046\n4          |     0.102 | -0.168  0.034  0.513 | -0.111  0.049  0.222 | -0.117\n5          |     0.118 | -0.251  0.067  0.883 |  0.004  0.000  0.000 | -0.007\n6          |     0.120 | -0.130  0.024  0.313 | -0.103  0.051  0.196 | -0.144\n7          |     0.124 | -0.029  0.002  0.022 | -0.158  0.167  0.626 | -0.079\n8          |     0.073 | -0.157  0.028  0.598 | -0.090  0.031  0.195 | -0.006\n9          |     0.014 | -0.060  0.005  0.506 | -0.033  0.005  0.150 | -0.018\n10         |     0.040 |  0.004  0.000  0.000 | -0.204  0.073  0.838 |  0.053\n              ctr   cos2  \n1           0.012  0.024 |\n2           0.003  0.007 |\n3           0.022  0.026 |\n4           0.080  0.246 |\n5           0.000  0.001 |\n6           0.146  0.380 |\n7           0.061  0.155 |\n8           0.000  0.001 |\n9           0.002  0.048 |\n10          0.007  0.056 |\n\nColumns\n             Iner*1000    Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3\nVehCond    |    58.559 | -0.329 34.687  0.924 |  0.077  6.331  0.050 |  0.051\nVehPass    |     5.923 | -0.255  1.283  0.338 |  0.081  0.440  0.035 |  0.001\nTranspC    |    38.261 |  0.208  9.534  0.389 | -0.229 38.812  0.472 | -0.124\nApied      |    79.193 |  0.813 34.252  0.675 |  0.545 51.610  0.303 | -0.147\nVelo       |    55.633 |  0.938 20.126  0.564 | -0.187  2.688  0.022 |  0.802\nAutreMoyen |     3.969 |  0.142  0.117  0.046 |  0.078  0.119  0.014 |  0.070\n              ctr   cos2  \nVehCond     4.141  0.022 |\nVehPass     0.000  0.000 |\nTranspC    16.995  0.139 |\nApied       5.543  0.022 |\nVelo       73.180  0.413 |\nAutreMoyen  0.140  0.011 |\n```\n:::\n:::\n\n\n#### Exploration graphique des résultats de l'AFC avec `factoextra` {#sec-12332}\n\nComme pour l'ACP, `factoextra` dispose de plusieurs fonctions très intéressantes pour construire rapidement des graphiques avec les résultats de l'AFC. Premièrement, la syntaxe ci-dessous (avec la fonction `fviz_screeplot`) renvoie deux graphiques pour analyser les résultats des valeurs propres de l'AFC (@fig-factoextraAFC1).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(factoextra)\nlibrary(ggplot2)\nlibrary(ggpubr)\n\n# Nombre de modalités en ligne et en colonne\nModalitesLig <- nrow(dfDonneesAFC)\nModalitesCol <- ncol(dfDonneesAFC[,1:6])\n# Critère statistique du profil moyen\ncritere2 <- round(1/(ModalitesCol-1)*100,2)\ntexte <- paste0(\"Critère pour le profil moyen : \", as.character(critere2), \" %\")\n# Graphique avec les valeurs propres\nG1 <- fviz_screeplot(res.afc, choice = \"eigenvalue\",\n               ylab = \"Valeurs propres\",\n               xlab = \"Axes factoriels\",\n               main=\"Valeurs propres\")\nG2 <- fviz_screeplot(res.afc, choice = \"variance\", addlabels = TRUE, ylim = c(0, 70),\n                     ylab = \"Variance expliquée (%)\",\n                     xlab = \"Axes factoriels\",\n                     main=\"Valeurs propres (%)\")+\n  geom_hline(yintercept=c2, linetype=1, color = \"red\", linewidth = 1)+\n  annotate(geom = \"text\", x = ModalitesCol-.5,\n          y = critere2+3, label=texte, \n          color = \"red\", hjust=1, linewidth = 4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in annotate(geom = \"text\", x = ModalitesCol - 0.5, y = critere2 + :\nIgnoring unknown parameters: `linewidth`\n```\n:::\n\n```{.r .cell-code}\nggarrange(G1, G2)\n```\n\n::: {.cell-output-display}\n![Graphiques pour les valeurs propres de l'AFC avec factoextra](12-AnalysesFactorielles_files/figure-html/fig-factoextraAFC1-1.png){#fig-factoextraAFC1 fig-align='center' width=65%}\n:::\n:::\n\n\nAvec les fonctions `fviz_contrib` et `fviz_cos2`, il est très facile de réaliser des histogrammes pour les contributions et les cosinus carrés pour les variables (colonnes) ou les individus (lignes), et ce, avec le paramètre `choice = c(\"row\", \"col\")` (@fig-acp1erplanfactVars2a).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(factoextra)\nlibrary(ggplot2)\nlibrary(ggpubr)\nVP1pct <- round(res.afc$eig[1,2],2)\nVP2pct <- round(res.afc$eig[2,2],2)\nG1 <- fviz_contrib (res.afc, choice = \"col\", axes = 1, title = \"Axe 1\")\nG2 <- fviz_contrib (res.afc, choice = \"col\", axes = 2, title = \"Axe 2\")\nggarrange(G1, G2, ncol = 2, nrow = 1)\n```\n\n::: {.cell-output-display}\n![Contributions des variables avec factoextra](12-AnalysesFactorielles_files/figure-html/fig-acp1erplanfactVars2a-1.png){#fig-acp1erplanfactVars2a fig-align='center' width=65%}\n:::\n:::\n\n\nQuant aux fonctions `fviz_ca_col` et `fviz_ca_row`, elles permettent rapidement de construire le premier plan factoriel pour les colonnes (variables) et les lignes (individus) (@fig-afc1erplanfactVars2b). Aussi, la fonction `fviz_ca_biplot` permet de construire un plan factoriel, mais avec les lignes et les colonnes simultanément.\n \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nG3 <- fviz_ca_col(res.afc,\n            repel = TRUE,\n            geom = c(\"text\" , \"point\"),\n            col.col = \"steelblue\",\n            title = \"Mode de transport\",\n            xlab = paste0(\"Axe 1 (\", VP1pct, \" %)\"),\n            ylab = paste0(\"Axe 2 (\", VP2pct, \" %)\"))\nG4 <- fviz_ca_row(res.afc,\n            repel = TRUE,\n            geom = c(\"point\"),\n            col.row = \"steelblue\",\n            title = \"Secteurs de recensement\",\n            xlab = paste0(\"Axe 1 (\", VP1pct, \" %)\"),\n            ylab = paste0(\"Axe 2 (\", VP2pct, \" %)\"))\nggarrange(G3, G4, ncol = 2, nrow = 1)\n```\n\n::: {.cell-output-display}\n![Premier plan factoriel de l'AFC pour les variables et les individus avec factoextra](12-AnalysesFactorielles_files/figure-html/fig-afc1erplanfactVars2b-1.png){#fig-afc1erplanfactVars2b fig-align='center' width=65%}\n:::\n:::\n\n\n\nLa syntaxe ci-dessous permet d'ajouter des modalités supplémentaires dans l'AFC et de constuire le graphique du premier plan factoriel (@fig-afcAjoutModalites2).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Les colonnes 7 à 11 sont mises comme des variables supplémentaires dans l'AFC\nres.afc2 <- CA(dfDonneesAFC, col.sup = 7:11, graph = FALSE)\nVP1pct <- round(res.afc2$eig[1,2],2)\nVP2pct <- round(res.afc2$eig[2,2],2)\nfviz_ca_col(res.afc2,\n            repel = TRUE,\n            geom= c(\"text\" , \"point\"),\n            col.col = \"steelblue\",\n            title = \"\",\n            xlab=paste0(\"Axe 1 (\", VP1pct, \" %)\"),\n            ylab=paste0(\"Axe 2 (\", VP2pct, \" %)\"))\n```\n\n::: {.cell-output-display}\n![Ajout de modalités supplémentaires sur le premier plan factoriel l'AFC avec factoextra](12-AnalysesFactorielles_files/figure-html/fig-afcAjoutModalites2-1.png){#fig-afcAjoutModalites2 fig-align='center' width=65%}\n:::\n:::\n\n\nFinalement, la syntaxe ci-dessous permet de cartographier les coordonnées factorielles des individus de l’AFC avec le *package* `tmap` (@fig-afc1erplanfactInds2B).\n \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tmap)\nlibrary(stringr)\ndfAFCInd <- data.frame(Coord = res.afc$row$coord, \n                       Cos2 = res.afc$row$cos2, \n                       Ctr = res.afc$row$contrib)\nnames(dfAFCInd) <- str_replace(names(dfAFCInd), \".Dim.\", \"Comp\")\nCartoAFC <- cbind(sfDonneesAFC, dfAFCInd)\nVP1pct <- tofr(round(res.afc$eig[1,2],2))\nVP2pct <- tofr(round(res.afc$eig[2,2],2))\nCarte1 <- tm_shape(CartoAFC) +\n  tm_fill(col = \"CoordComp1\", style = \"cont\", midpoint = 0, title = \"Coordonnées\")+\n  tm_layout(title = paste0(\"Axe 1 (\", VP1pct,\"%)\"), attr.outside = TRUE, frame = FALSE)\nCarte2 <- tm_shape(CartoAFC) +\n  tm_fill(col = \"CoordComp2\", style = \"cont\", midpoint = 0, title = \"Coordonnées\")+\n  tm_layout(title = paste0(\"Axe 2 (\", VP2pct,\"%)\"), attr.outside = TRUE, frame = FALSE)\ntmap_arrange(Carte1, Carte2, nrow = 1)\n```\n\n::: {.cell-output-display}\n![Cartographie de coordonnées factorielles des individus pour l'AFC](12-AnalysesFactorielles_files/figure-html/fig-afc1erplanfactInds2B-1.png){#fig-afc1erplanfactInds2B fig-align='center' width=85%}\n:::\n:::\n\n\n\n## Analyse de correspondances multiples (ACM) {#sec-124}\n\nL'analyse des correspondances multiples (ACM) est particulièrement adaptée à l'exploration de données issues d'une enquête par sondage, puisqu'elle permet de résumer/synthétiser l'information d'un tableau comprenant uniquement des variables qualitatives (@fig-AnalysesFactoriellesTabACM). \n\n\n![Lieu de pèlerinage de R](images/Chap12/AnalysesFactoriellesTabACM.png){#fig-AnalysesFactoriellesTabACM width=\"60%\" fig-align=\"center\"}\n\nPar exemple, une enquête sur la mobilité d'une population donnée pourrait comprendre plusieurs variables qualitatives, dont celles reportées au @tbl-ACM1.\n\n\n::: {#tbl-ACM1 .cell tbl-cap='Exemple de variables qualitatives issues d\\'une enquête'}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Modalités des variables </th>\n   <th style=\"text-align:center;\"> Codage </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"2\"><td colspan=\"2\" style=\"border-bottom: 1px solid;\"><strong>Sexe</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Homme </td>\n   <td style=\"text-align:center;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Femme </td>\n   <td style=\"text-align:center;\"> 2 </td>\n  </tr>\n  <tr grouplength=\"4\"><td colspan=\"2\" style=\"border-bottom: 1px solid;\"><strong>Groupe d'âge</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Moins de 20 ans </td>\n   <td style=\"text-align:center;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> 20 à 39 ans </td>\n   <td style=\"text-align:center;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> 40 à 59 ans </td>\n   <td style=\"text-align:center;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> 60 ans et plus </td>\n   <td style=\"text-align:center;\"> 4 </td>\n  </tr>\n  <tr grouplength=\"4\"><td colspan=\"2\" style=\"border-bottom: 1px solid;\"><strong>Mode de transport</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Automobile </td>\n   <td style=\"text-align:center;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Transport en commun </td>\n   <td style=\"text-align:center;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Marche </td>\n   <td style=\"text-align:center;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Vélo </td>\n   <td style=\"text-align:center;\"> 4 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nPour analyser de telles données, il suffit de transformer le tableau condensé (de données brutes) en un tableau disjonctif complet dans lequel chaque modalité des variables qualitatives devient une variable binaire prenant les valeurs de 0 ou 1 (tableaux [-@tbl-ACM2] et [-@tbl-ACM3]). Notez que la somme de chaque ligne est alors égale au nombre de variables qualitatives.\n\n\n::: {#tbl-ACM2 .cell tbl-cap='Tableau condensé (données brutes)'}\n::: {.cell-output-display}\n|       | Sexe | Groupe d'âge | Mode de transport |\n|:------|:----:|:------------:|:-----------------:|\n|Ind. 1 |  1   |      1       |         2         |\n|Ind. 2 |  1   |      2       |         3         |\n|Ind. 3 |  2   |      3       |         1         |\n|Ind. 4 |  1   |      2       |         1         |\n|Ind. 5 |  2   |      4       |         2         |\n|Ind. 6 |  1   |      4       |         4         |\n:::\n:::\n\n::: {#tbl-ACM3 .cell tbl-cap='Tableau disjonctif complet'}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Sexe</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"4\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Groupe d'âge</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"4\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Mode de transport</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:center;\"> Individu </th>\n   <th style=\"text-align:center;\"> Homme </th>\n   <th style=\"text-align:center;\"> Femme </th>\n   <th style=\"text-align:center;\"> Moins de 20 ans </th>\n   <th style=\"text-align:center;\"> 20 à 39 ans </th>\n   <th style=\"text-align:center;\"> 40 à 59 ans </th>\n   <th style=\"text-align:center;\"> 60 ans et plus </th>\n   <th style=\"text-align:center;\"> Auto. </th>\n   <th style=\"text-align:center;\"> T.C. </th>\n   <th style=\"text-align:center;\"> Marche </th>\n   <th style=\"text-align:center;\"> Vélo </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> Ind. 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Ind. 2 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Ind. 3 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Ind. 4 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Ind. 5 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Ind. 6 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: bloc_astuce\n::: bloc_astuce-header\n::: bloc_astuce-icon\n:::\n**ACM versus AFC**\n:::\n::: bloc_astuce-body\nNous avons vu que l'AFC permet d'analyser un tableau de contingence avec deux variables qualitatives. En ACM, les colonnes sont les différentes modalités des variables qualitatives et les lignes sont les observations (par exemple, les individus ayant répondu à une enquête). En résumé, l'analyse des correspondances multiples (ACM) est simplement **une analyse des correspondances (AFC) appliquée sur un tableau disjonctif complet**. \n\nL'ACM permet ainsi de révéler les ressemblances entre les différentes modalités des variables qualitatives et les ressemblances entre les différents individus. Par conséquent, elle produit également des variables synthétiques (axes factoriels) résumant l'information contenue dans le tableau initial. L'évaluation de ces ressemblances et la détermination des axes factoriels sont aussi basées sur la **distance du khi-deux**.\n:::\n:::\n\n\n### Aides à l'interprétation {#sec-1241}\n\nPuisque l'ACM est une extension de l'AFC, nous retrouvons les mêmes aides à l'interprétation : les valeurs propres pour les axes, les coordonnées factorielles, les contributions et les cosinus carrés pour les variables et les individus. \n\nPour présenter l'ACM, nous utilisons des données ouvertes de la Ville de Montréal et, plus particulièrement, celles d'un [sondage auprès de la population de l’île de Montréal sur l'agriculture urbaine](https://www.donneesquebec.ca/recherche/dataset/vmtl-agriculture-urbaine-sondage){target='_blank'}. Pour ce faire, nous avons conservé uniquement les personnes pratiquant l'agriculture urbaine (n = 352). Les variables qualitatives extraites pour l'ACM sont reportées au @tbl-dataACM) avec la description des questions, leurs modalités respectives avec les effectifs bruts et en pourcentage. Au final, l'ACM est calculée de la manière suivante :\n\n- Neuf variables qualitatives relatives à la pratique de l'agriculture urbaine sont retenues (`q3`, `q4`, `q5`, `q8`, `q9`, `q10`, `q11`, `q12` et `q13`).\n\n- Quatre variables relatives au profil socioéconomique des personnes répondantes sont introduites comme variables supplémentaires (`q15`, `q16`, `q17` et `q21`).\n\n- Chaque ligne est pondérée avec la variable `pond`.\n\nL'objectif de cette ACM est double : \n\n1. Montrer les ressemblances entre les différentes modalités relatives à la pratique de l'agriculture urbaine. L'analyse des axes factoriels devrait nous permettre d'identifier différents profils des personnes pratiquant l'agriculture urbaine.\n\n2. Projeter les modalités des variables socioéconomiques afin de vérifier si elles sont ou non associées aux axes factoriels, c'est-à-dire aux différents profils révélés par les axes.\n\n::: bloc_attention\n::: bloc_attention-header\n::: bloc_attention-icon\n:::\n**Bloc attention**\n:::\n::: bloc_attention-body\nL'analyse du sondage sur l'agriculture urbaine réalisée ici est purement exploratoire : elle vise uniquement à démontrer que l'ACM est un outil particulièrement intéressant pour analyser les données d'un sondage. Par contre, cette analyse n'a aucune prétention scientifique puisque nous ne sommes pas des spécialistes de l'agriculture urbaine. Dans ce champ de recherche très fertile qu'est l'agriculture urbaine (surement pas la meilleure blague du livre...), vous pourrez consulter plusieurs études montréalaises [@mcclintock2018urban; @audate2021motivations; @bhatt2016cultivating].\n:::\n:::\n\n\n::: {#tbl-dataACM .cell tbl-cap='Variables qualitatives extraites du sondage sur l\\'agriculture urbaine de la Ville de Montréal'}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Modalité </th>\n   <th style=\"text-align:right;\"> N </th>\n   <th style=\"text-align:right;\"> % </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"4\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Q3.  Depuis combien de temps cultivez-vous des fruits, des fines herbes ou des légumes?</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q3. Moins de 1 an </td>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:right;\"> 9,9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q3. De 1 à 4 ans </td>\n   <td style=\"text-align:right;\"> 101 </td>\n   <td style=\"text-align:right;\"> 28,7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q3. De 5 à 9 ans </td>\n   <td style=\"text-align:right;\"> 66 </td>\n   <td style=\"text-align:right;\"> 18,8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q3. 10 ans ou plus </td>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:right;\"> 42,6 </td>\n  </tr>\n  <tr grouplength=\"4\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Q4.  Selon vous, quelle proportion des fruits, des fines herbes et des légumes que vous consommez durant l'été provient de votre propre production?</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q4. Moins de 10% </td>\n   <td style=\"text-align:right;\"> 192 </td>\n   <td style=\"text-align:right;\"> 54,5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q4. 10 à 25% </td>\n   <td style=\"text-align:right;\"> 70 </td>\n   <td style=\"text-align:right;\"> 19,9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q4. 26 à 50% </td>\n   <td style=\"text-align:right;\"> 47 </td>\n   <td style=\"text-align:right;\"> 13,4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q4. Plus de 50% </td>\n   <td style=\"text-align:right;\"> 43 </td>\n   <td style=\"text-align:right;\"> 12,2 </td>\n  </tr>\n  <tr grouplength=\"2\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Q5.  Utilisez-vous du compost provenant de vos déchets verts ou alimentaires pour faire pousser des fruits, des fines herbes ou des légumes?</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q5. Oui </td>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 25,6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q5. Non </td>\n   <td style=\"text-align:right;\"> 262 </td>\n   <td style=\"text-align:right;\"> 74,4 </td>\n  </tr>\n  <tr grouplength=\"2\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Q8.  Récupérez-vous l'eau de pluie pour irriguer vos cultures de fruits, de fines herbes ou des légumes ou encore votre jardin?</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q8. Oui </td>\n   <td style=\"text-align:right;\"> 72 </td>\n   <td style=\"text-align:right;\"> 20,5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q8. Non </td>\n   <td style=\"text-align:right;\"> 280 </td>\n   <td style=\"text-align:right;\"> 79,5 </td>\n  </tr>\n  <tr grouplength=\"4\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Q9.  Combien de sortes de fruits, de fines herbes ou de légumes cultivez-vous?</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q9. Moins de 5 sortes </td>\n   <td style=\"text-align:right;\"> 170 </td>\n   <td style=\"text-align:right;\"> 48,3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q9. 5 à 9 sortes </td>\n   <td style=\"text-align:right;\"> 124 </td>\n   <td style=\"text-align:right;\"> 35,2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q9. 10 à 14 sortes </td>\n   <td style=\"text-align:right;\"> 42 </td>\n   <td style=\"text-align:right;\"> 11,9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q9. 15 sortes ou plus </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 4,5 </td>\n  </tr>\n  <tr grouplength=\"2\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Q10. Cultivez-vous suffisamment de fruits, de fines herbes ou de légumes pour partager avec d'autres personnes?</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q10. Oui </td>\n   <td style=\"text-align:right;\"> 143 </td>\n   <td style=\"text-align:right;\"> 40,6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q10. Non </td>\n   <td style=\"text-align:right;\"> 209 </td>\n   <td style=\"text-align:right;\"> 59,4 </td>\n  </tr>\n  <tr grouplength=\"2\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Q11. Échangez-vous vos semis ou vos récoltes de fruits, de fines herbes ou de légumes avec d'autres personnes?</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q11. Oui </td>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 25,6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q11. Non </td>\n   <td style=\"text-align:right;\"> 262 </td>\n   <td style=\"text-align:right;\"> 74,4 </td>\n  </tr>\n  <tr grouplength=\"3\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Q12. Selon vous, l'agriculture urbaine contribue-t-elle à améliorer les rapports entre les gens?</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q12. Oui </td>\n   <td style=\"text-align:right;\"> 283 </td>\n   <td style=\"text-align:right;\"> 80,4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q12. Non </td>\n   <td style=\"text-align:right;\"> 46 </td>\n   <td style=\"text-align:right;\"> 13,1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q12. NSP/NRP </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> 6,5 </td>\n  </tr>\n  <tr grouplength=\"2\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Q13. Saviez-vous que la Ville de Montréal encourage et soutient l'agriculture urbaine sur l'île de Montréal?</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q13. Oui </td>\n   <td style=\"text-align:right;\"> 203 </td>\n   <td style=\"text-align:right;\"> 57,7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q13. Non </td>\n   <td style=\"text-align:right;\"> 149 </td>\n   <td style=\"text-align:right;\"> 42,3 </td>\n  </tr>\n  <tr grouplength=\"4\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Q15. À quel groupe d'âge appartenez-vous?</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q15. 18 à 34 ans </td>\n   <td style=\"text-align:right;\"> 54 </td>\n   <td style=\"text-align:right;\"> 15,3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q15. 35 à 49 ans </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 31,2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q15. 50 à 64 ans </td>\n   <td style=\"text-align:right;\"> 101 </td>\n   <td style=\"text-align:right;\"> 28,7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q15. 65 ans et plus </td>\n   <td style=\"text-align:right;\"> 87 </td>\n   <td style=\"text-align:right;\"> 24,7 </td>\n  </tr>\n  <tr grouplength=\"6\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Q16. Quelle est votre occupation principale?</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q16. Travail temps plein </td>\n   <td style=\"text-align:right;\"> 177 </td>\n   <td style=\"text-align:right;\"> 50,3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q16. Travail. temps partiel </td>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:right;\"> 7,4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q16. Étudiant </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 4,0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q16. Retraité </td>\n   <td style=\"text-align:right;\"> 101 </td>\n   <td style=\"text-align:right;\"> 28,7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q16. Sans emploi </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 2,8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q16. À la maison </td>\n   <td style=\"text-align:right;\"> 24 </td>\n   <td style=\"text-align:right;\"> 6,8 </td>\n  </tr>\n  <tr grouplength=\"4\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Q17. Quel est le plus haut niveau de scolarité que vous avez complété?</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q17. Aucun certificat ou dipl. </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 7,1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q17. Dipl. secondaires </td>\n   <td style=\"text-align:right;\"> 80 </td>\n   <td style=\"text-align:right;\"> 22,7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q17. Dipl. collégiales </td>\n   <td style=\"text-align:right;\"> 75 </td>\n   <td style=\"text-align:right;\"> 21,3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q17. Études universitaires </td>\n   <td style=\"text-align:right;\"> 172 </td>\n   <td style=\"text-align:right;\"> 48,9 </td>\n  </tr>\n  <tr grouplength=\"2\"><td colspan=\"3\" style=\"border-bottom: 1px solid;\"><strong>Q21. Êtes-vous propriétaire ou locataire de votre résidence ?</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q21. Propriétaire </td>\n   <td style=\"text-align:right;\"> 250 </td>\n   <td style=\"text-align:right;\"> 71,0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;\" indentlevel=\"1\"> Q22. Locataire </td>\n   <td style=\"text-align:right;\"> 102 </td>\n   <td style=\"text-align:right;\"> 29,0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n  \n  \n#### Résultats de l'ACM pour les valeurs propres {#sec-12411}\n\nLes résultats pour les valeurs propres sont reportés au @tbl-ACMValeursPropresTab et à la @fig-ACMValeursPropresFig.\nEn ACM, l'inertie totale du tableau des variables qualitatives est égale au nombre moyen de modalités par variable moins un, soit $\\frac{K}{J}-1$ avec *K* et *J* étant respectivement les nombres de modalités et de variables. Aussi, le nombre d'axes produits par l'ACM est égal à $K - J$. Pour notre tableau, l'inertie est donc égale à $\\mbox{25} / \\mbox{9} = \\mbox{1,77}$ avec $\\mbox{25}-\\mbox{9} = \\mbox{16}$ axes. Le nombre d'axes à retenir est souvent plus difficile à déterminer puisque, tel que signalé judicieusement par Jérôme Pagès [-@pages2002analyse, p.53] : « en pratique, comparée à l'ACP, l'ACM conduit, dans l'ensemble à : des pourcentages d'inertie plus petits; une décroissance de ces pourcentages plus douce ».\n\nL'histogramme des valeurs propres (@fig-ACMValeursPropresFig) révèle plusieurs sauts importants dans les valeurs propres qui pourraient justifier le choix du nombre d'axes factoriels, soit aux axes 1, 2, 3 et 6. Pour l'exercice, nous retenons les trois premiers axes qui résument 30 % de l'inertie du tableau initial.\n\n\n::: {#tbl-ACMValeursPropresTab .cell tbl-cap='Résultats de l\\'ACM pour les valeurs propres'}\n::: {.cell-output-display}\n|       | Axe factoriel| Valeur propre| Pourcentage| Pourc. cumulé|\n|:------|-------------:|-------------:|-----------:|-------------:|\n|dim 1  |             1|         0,248|      13,940|        13,940|\n|dim 2  |             2|         0,156|       8,792|        22,732|\n|dim 3  |             3|         0,135|       7,620|        30,352|\n|dim 4  |             4|         0,127|       7,161|        37,513|\n|dim 5  |             5|         0,126|       7,065|        44,579|\n|dim 6  |             6|         0,123|       6,916|        51,494|\n|dim 7  |             7|         0,114|       6,385|        57,879|\n|dim 8  |             8|         0,107|       6,003|        63,882|\n|dim 9  |             9|         0,101|       5,671|        69,553|\n|dim 10 |            10|         0,095|       5,327|        74,880|\n|dim 11 |            11|         0,093|       5,234|        80,115|\n|dim 12 |            12|         0,086|       4,822|        84,937|\n|dim 13 |            13|         0,077|       4,340|        89,277|\n|dim 14 |            14|         0,071|       4,011|        93,288|\n|dim 15 |            15|         0,064|       3,619|        96,906|\n|dim 16 |            16|         0,055|       3,094|       100,000|\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output-display}\n![Graphiques pour les valeurs propres pour l'ACM](12-AnalysesFactorielles_files/figure-html/fig-ACMValeursPropresFig-1.png){#fig-ACMValeursPropresFig fig-align='center' width=672}\n:::\n:::\n\n\n#### Résultats de l'ACM pour les modalités des variables {#sec-12412}\n\nÀ titre de rappel, comme pour l’ACP et l'AFC, nous retrouvons les trois mêmes mesures pour les variables et les individus (coordonnées factorielles, contributions et cosinus carrés). Plus les variables qualitatives du jeu de données comprennent de modalités, plus la taille du tableau des résultats des modalités est importante et plus il est fastidieux de l'analyser. Il est donc recommandé de construire des histogrammes avec les coordonnées factorielles et les contributions des modalités, mais aussi un nuage de points avec les coordonnées des modalités des variables qualitatives sur le premier, voire le deuxième plan factoriel.\n\n::: bloc_objectif\n::: bloc_objectif-header\n::: bloc_objectif-icon\n:::\n**Compréhension des axes factoriels de l'ACM : une étape essentielle, incontournable...**\n:::\n::: bloc_objectif-body\nComme en ACP et en AFC, l'analyse des trois mesures (coordonnées, contributions et cosinus carrés) pour les variables et les individus doit vous permettre de comprendre la signification des axes factoriels retenus de l'ACM. Prenez le temps de bien réaliser cette étape d'interprétation souvent plus fastidieuse qu'en ACP et ACM, en raison du nombre élevé de modalités. Cette étape est en effet essentielle afin de qualifier les variables latentes (axes factoriels, variables synthétiques) produites par l'ACM.\n:::\n:::\n\nLes résultats pour les variables sont reportés 1) au @tbl-ACMValeursCoordTab, 2) aux figures [-@fig-ACMValeursCoordFig1], [-@fig-ACMValeursCoordFig2] et [-@fig-ACMValeursCoordFig3] pour les coordonnées et les contributions et à la [-@fig-ACMValeursPlanFacto1] pour le premier plan factoriel.\n\n\n**Interprétation des résultats de l'axe 1 pour les variables**\n\nSept modalités concourent le plus à la formation de l'axe 1 résumant 13,9 % de la variance : `Q9. 10 à 14 sortes` (10,35 %), `Q10. Oui`\t(9,99 %), `Q9. Moins de 5 sortes` (9,71 %), `Q5. Oui`\t(9,19 %), `Q11. Oui` (8,20 %), `Q4. Moins de 10%`\t(7,87 %) et `Q10. Non` (7,10 %). Aussi, les modalités suivantes sont aux deux extrémités de cet axe :\n\n* **Coordonnées négatives** :  `Q12. Non` (-0,84), `Q3. Moins de 1 an`  (-0,73), `Q9. Moins de 5 sortes` (-0,67), `Q4. Moins de 10%` (-0,56), `Q10. Non` (-0,521). Cela signifie que lorsque les coordonnées des individus sont fortement négatives sur cet axe, les personnes pratiquant l'agriculture urbaine : \n    + *ne pensent pas que l'agriculture urbaine contribue à améliorer les rapports entre les gens* (`Q12`);\n    + *cultivent des fruits, des fines herbes ou de légumes depuis moins d'un an* (`Q3`);\n    + *cultivent moins de cinq sortes de fruits, de fines herbes ou de légumes* (`Q9`);\n    + *moins de 10 % de la proportion des fruits, des fines herbes et des légumes consommés durant l’été provient de leur propre production *(`Q4`);\n    + *ne cultivent pas suffisamment pour partager avec d'autres personnes* (`Q10`).\n    \n* **Coordonnées positives** : `Q9. 15 sortes ou plus` (1,36), `Q9. 10 à 14 sortes` (1,28), `Q5. Oui` (0,95) et `Q11. Oui` (0,85). Cela signifie que lorsque les coordonnées des individus sont fortement positives sur cet axe, les personnes pratiquant l'agriculture urbaine :\n    + *cultivent plus de dix sortes de fruits, de fines herbes ou de légumes* (`Q9`);\n    + *utilisent du compost provenant de leurs déchets verts ou de leurs déchets alimentaires pour faire pousser des fruits, des fines herbes ou de légumes* (`Q5`);\n    + *échangent leurs semis ou leurs récoltes de fruits, de fines herbes ou des légumes avec d’autres personnes* (`Q11`).\n\nEn résumé, l'axe 1 oppose clairement les **néophytes en agriculture** versus les **personnes expérimentées** cultivant des fruits et de légumes variés avec leur propre compost et échangeant leurs semis ou leurs récoltes.\n\n\n\n::: {#tbl-ACMValeursCoordTab .cell tbl-cap='Résultats de l\\'ACM pour les modalités des variables'}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Coordonnées</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Cosinus carrés</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Contributions (%)</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Modalité </th>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n   <th style=\"text-align:right;\"> 3 </th>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n   <th style=\"text-align:right;\"> 3 </th>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n   <th style=\"text-align:right;\"> 3 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Q3. Moins de 1 an </td>\n   <td style=\"text-align:right;\"> -0,73 </td>\n   <td style=\"text-align:right;\"> 0,68 </td>\n   <td style=\"text-align:right;\"> 0,63 </td>\n   <td style=\"text-align:right;\"> 2,70 </td>\n   <td style=\"text-align:right;\"> 3,68 </td>\n   <td style=\"text-align:right;\"> 3,64 </td>\n   <td style=\"text-align:right;\"> 0,07 </td>\n   <td style=\"text-align:right;\"> 0,06 </td>\n   <td style=\"text-align:right;\"> 0,05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q3. De 1 à 4 ans </td>\n   <td style=\"text-align:right;\"> -0,29 </td>\n   <td style=\"text-align:right;\"> -0,79 </td>\n   <td style=\"text-align:right;\"> 0,39 </td>\n   <td style=\"text-align:right;\"> 1,26 </td>\n   <td style=\"text-align:right;\"> 15,30 </td>\n   <td style=\"text-align:right;\"> 4,30 </td>\n   <td style=\"text-align:right;\"> 0,04 </td>\n   <td style=\"text-align:right;\"> 0,33 </td>\n   <td style=\"text-align:right;\"> 0,08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q3. De 5 à 9 ans </td>\n   <td style=\"text-align:right;\"> 0,12 </td>\n   <td style=\"text-align:right;\"> 0,38 </td>\n   <td style=\"text-align:right;\"> -1,11 </td>\n   <td style=\"text-align:right;\"> 0,12 </td>\n   <td style=\"text-align:right;\"> 2,02 </td>\n   <td style=\"text-align:right;\"> 19,43 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,04 </td>\n   <td style=\"text-align:right;\"> 0,29 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q3. 10 ans ou plus </td>\n   <td style=\"text-align:right;\"> 0,45 </td>\n   <td style=\"text-align:right;\"> 0,35 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n   <td style=\"text-align:right;\"> 3,19 </td>\n   <td style=\"text-align:right;\"> 3,01 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n   <td style=\"text-align:right;\"> 0,11 </td>\n   <td style=\"text-align:right;\"> 0,07 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q4. Moins de 10% </td>\n   <td style=\"text-align:right;\"> -0,56 </td>\n   <td style=\"text-align:right;\"> 0,03 </td>\n   <td style=\"text-align:right;\"> 0,07 </td>\n   <td style=\"text-align:right;\"> 7,87 </td>\n   <td style=\"text-align:right;\"> 0,04 </td>\n   <td style=\"text-align:right;\"> 0,22 </td>\n   <td style=\"text-align:right;\"> 0,40 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q4. 10 à 25% </td>\n   <td style=\"text-align:right;\"> 0,74 </td>\n   <td style=\"text-align:right;\"> -0,76 </td>\n   <td style=\"text-align:right;\"> -0,11 </td>\n   <td style=\"text-align:right;\"> 4,92 </td>\n   <td style=\"text-align:right;\"> 8,22 </td>\n   <td style=\"text-align:right;\"> 0,19 </td>\n   <td style=\"text-align:right;\"> 0,14 </td>\n   <td style=\"text-align:right;\"> 0,14 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q4. 26 à 50% </td>\n   <td style=\"text-align:right;\"> 0,78 </td>\n   <td style=\"text-align:right;\"> 0,64 </td>\n   <td style=\"text-align:right;\"> 0,15 </td>\n   <td style=\"text-align:right;\"> 3,82 </td>\n   <td style=\"text-align:right;\"> 4,18 </td>\n   <td style=\"text-align:right;\"> 0,28 </td>\n   <td style=\"text-align:right;\"> 0,10 </td>\n   <td style=\"text-align:right;\"> 0,07 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q4. Plus de 50% </td>\n   <td style=\"text-align:right;\"> 0,53 </td>\n   <td style=\"text-align:right;\"> 0,40 </td>\n   <td style=\"text-align:right;\"> -0,37 </td>\n   <td style=\"text-align:right;\"> 1,31 </td>\n   <td style=\"text-align:right;\"> 1,17 </td>\n   <td style=\"text-align:right;\"> 1,19 </td>\n   <td style=\"text-align:right;\"> 0,03 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q5. Oui </td>\n   <td style=\"text-align:right;\"> 0,95 </td>\n   <td style=\"text-align:right;\"> 0,56 </td>\n   <td style=\"text-align:right;\"> -0,13 </td>\n   <td style=\"text-align:right;\"> 9,19 </td>\n   <td style=\"text-align:right;\"> 5,01 </td>\n   <td style=\"text-align:right;\"> 0,29 </td>\n   <td style=\"text-align:right;\"> 0,27 </td>\n   <td style=\"text-align:right;\"> 0,09 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q5. Non </td>\n   <td style=\"text-align:right;\"> -0,28 </td>\n   <td style=\"text-align:right;\"> -0,16 </td>\n   <td style=\"text-align:right;\"> 0,04 </td>\n   <td style=\"text-align:right;\"> 2,70 </td>\n   <td style=\"text-align:right;\"> 1,47 </td>\n   <td style=\"text-align:right;\"> 0,09 </td>\n   <td style=\"text-align:right;\"> 0,27 </td>\n   <td style=\"text-align:right;\"> 0,09 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q8. Oui </td>\n   <td style=\"text-align:right;\"> 0,55 </td>\n   <td style=\"text-align:right;\"> 0,37 </td>\n   <td style=\"text-align:right;\"> 1,21 </td>\n   <td style=\"text-align:right;\"> 2,58 </td>\n   <td style=\"text-align:right;\"> 1,86 </td>\n   <td style=\"text-align:right;\"> 23,31 </td>\n   <td style=\"text-align:right;\"> 0,07 </td>\n   <td style=\"text-align:right;\"> 0,03 </td>\n   <td style=\"text-align:right;\"> 0,35 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q8. Non </td>\n   <td style=\"text-align:right;\"> -0,13 </td>\n   <td style=\"text-align:right;\"> -0,09 </td>\n   <td style=\"text-align:right;\"> -0,29 </td>\n   <td style=\"text-align:right;\"> 0,62 </td>\n   <td style=\"text-align:right;\"> 0,45 </td>\n   <td style=\"text-align:right;\"> 5,60 </td>\n   <td style=\"text-align:right;\"> 0,07 </td>\n   <td style=\"text-align:right;\"> 0,03 </td>\n   <td style=\"text-align:right;\"> 0,35 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q9. Moins de 5 sortes </td>\n   <td style=\"text-align:right;\"> -0,67 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,47 </td>\n   <td style=\"text-align:right;\"> 9,71 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 8,83 </td>\n   <td style=\"text-align:right;\"> 0,42 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,21 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q9. 5 à 9 sortes </td>\n   <td style=\"text-align:right;\"> 0,24 </td>\n   <td style=\"text-align:right;\"> 0,11 </td>\n   <td style=\"text-align:right;\"> -0,79 </td>\n   <td style=\"text-align:right;\"> 0,89 </td>\n   <td style=\"text-align:right;\"> 0,30 </td>\n   <td style=\"text-align:right;\"> 17,31 </td>\n   <td style=\"text-align:right;\"> 0,03 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,32 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q9. 10 à 14 sortes </td>\n   <td style=\"text-align:right;\"> 1,28 </td>\n   <td style=\"text-align:right;\"> -0,97 </td>\n   <td style=\"text-align:right;\"> 0,07 </td>\n   <td style=\"text-align:right;\"> 10,35 </td>\n   <td style=\"text-align:right;\"> 9,42 </td>\n   <td style=\"text-align:right;\"> 0,06 </td>\n   <td style=\"text-align:right;\"> 0,27 </td>\n   <td style=\"text-align:right;\"> 0,15 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q9. 15 sortes ou plus </td>\n   <td style=\"text-align:right;\"> 1,36 </td>\n   <td style=\"text-align:right;\"> 2,15 </td>\n   <td style=\"text-align:right;\"> 0,65 </td>\n   <td style=\"text-align:right;\"> 3,62 </td>\n   <td style=\"text-align:right;\"> 14,42 </td>\n   <td style=\"text-align:right;\"> 1,50 </td>\n   <td style=\"text-align:right;\"> 0,08 </td>\n   <td style=\"text-align:right;\"> 0,21 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q10. Oui </td>\n   <td style=\"text-align:right;\"> 0,73 </td>\n   <td style=\"text-align:right;\"> -0,15 </td>\n   <td style=\"text-align:right;\"> 0,07 </td>\n   <td style=\"text-align:right;\"> 9,99 </td>\n   <td style=\"text-align:right;\"> 0,63 </td>\n   <td style=\"text-align:right;\"> 0,18 </td>\n   <td style=\"text-align:right;\"> 0,38 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q10. Non </td>\n   <td style=\"text-align:right;\"> -0,52 </td>\n   <td style=\"text-align:right;\"> 0,10 </td>\n   <td style=\"text-align:right;\"> -0,05 </td>\n   <td style=\"text-align:right;\"> 7,10 </td>\n   <td style=\"text-align:right;\"> 0,45 </td>\n   <td style=\"text-align:right;\"> 0,13 </td>\n   <td style=\"text-align:right;\"> 0,38 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q11. Oui </td>\n   <td style=\"text-align:right;\"> 0,85 </td>\n   <td style=\"text-align:right;\"> -0,83 </td>\n   <td style=\"text-align:right;\"> 0,32 </td>\n   <td style=\"text-align:right;\"> 8,20 </td>\n   <td style=\"text-align:right;\"> 12,45 </td>\n   <td style=\"text-align:right;\"> 2,11 </td>\n   <td style=\"text-align:right;\"> 0,25 </td>\n   <td style=\"text-align:right;\"> 0,23 </td>\n   <td style=\"text-align:right;\"> 0,03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q11. Non </td>\n   <td style=\"text-align:right;\"> -0,29 </td>\n   <td style=\"text-align:right;\"> 0,28 </td>\n   <td style=\"text-align:right;\"> -0,11 </td>\n   <td style=\"text-align:right;\"> 2,79 </td>\n   <td style=\"text-align:right;\"> 4,24 </td>\n   <td style=\"text-align:right;\"> 0,72 </td>\n   <td style=\"text-align:right;\"> 0,25 </td>\n   <td style=\"text-align:right;\"> 0,23 </td>\n   <td style=\"text-align:right;\"> 0,03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q12. Oui </td>\n   <td style=\"text-align:right;\"> 0,16 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,97 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,11 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q12. Non </td>\n   <td style=\"text-align:right;\"> -0,84 </td>\n   <td style=\"text-align:right;\"> -0,38 </td>\n   <td style=\"text-align:right;\"> 0,09 </td>\n   <td style=\"text-align:right;\"> 4,12 </td>\n   <td style=\"text-align:right;\"> 1,32 </td>\n   <td style=\"text-align:right;\"> 0,08 </td>\n   <td style=\"text-align:right;\"> 0,11 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q12. NSP/NRP </td>\n   <td style=\"text-align:right;\"> -0,36 </td>\n   <td style=\"text-align:right;\"> 0,56 </td>\n   <td style=\"text-align:right;\"> -0,31 </td>\n   <td style=\"text-align:right;\"> 0,36 </td>\n   <td style=\"text-align:right;\"> 1,39 </td>\n   <td style=\"text-align:right;\"> 0,48 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q13. Oui </td>\n   <td style=\"text-align:right;\"> 0,17 </td>\n   <td style=\"text-align:right;\"> 0,31 </td>\n   <td style=\"text-align:right;\"> 0,31 </td>\n   <td style=\"text-align:right;\"> 0,70 </td>\n   <td style=\"text-align:right;\"> 3,91 </td>\n   <td style=\"text-align:right;\"> 4,37 </td>\n   <td style=\"text-align:right;\"> 0,04 </td>\n   <td style=\"text-align:right;\"> 0,13 </td>\n   <td style=\"text-align:right;\"> 0,12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q13. Non </td>\n   <td style=\"text-align:right;\"> -0,22 </td>\n   <td style=\"text-align:right;\"> -0,40 </td>\n   <td style=\"text-align:right;\"> -0,40 </td>\n   <td style=\"text-align:right;\"> 0,91 </td>\n   <td style=\"text-align:right;\"> 5,05 </td>\n   <td style=\"text-align:right;\"> 5,66 </td>\n   <td style=\"text-align:right;\"> 0,04 </td>\n   <td style=\"text-align:right;\"> 0,13 </td>\n   <td style=\"text-align:right;\"> 0,12 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Graphiques pour les résultats des modalités de l'axe 1 de l'ACM](12-AnalysesFactorielles_files/figure-html/fig-ACMValeursCoordFig1-1.png){#fig-ACMValeursCoordFig1 fig-align='center' width=90%}\n:::\n:::\n\n\n\n**Interprétation des résultats de l'axe 2 pour les variables**\n\nQuatre modalités concourent le plus à la formation de l'axe 2 résumant 8,8 % de la variance : `Q3. De 1 à 4 ans` (15,30 %), `Q9. 15 sortes ou plus`\t(14,42 %), `Q11. Oui`\t(12,45 %) et `Q9. 10 à 14 sortes`\t(9,42 %). Les modalités suivantes sont présentes aux deux extrémités de l'axe 2 :\n\n- **Coordonnées négatives** :  `Q9. 10 à 14 sortes` (-0,97), `Q11. Oui` (-0,83), `Q3. De 1 à 4 ans` (-0,79), `Q4. 10 à 25%` (-0,76). Cela signifie que lorsque les coordonnées des individus sont fortement négatives sur cet axe, les personnes pratiquant l'agriculture urbaine :  \n    + *cultivent de 10 à 14 sortes de fruits, de fines herbes ou de légumes* (`Q9`); \n    + *échangent leurs semis ou leurs récoltes de fruits, de fines herbes ou de légumes avec d’autres personnes* (`Q11`);\n    + *cultivent des fruits, des fines herbes ou des légumes depuis 1 à 4 ans* (`Q3`);\n    + *de 10 à 25 % de la proportion des fruits, des fines herbes et des légumes consommés durant l’été provient de leur propre production *(`Q4`).\n\n- **Coordonnées positives** : seule la modalité `Q9. 15 sortes ou plus` (2,15) présente une forte coordonnée positive.\n\n**En résumé, l'axe 2** permet surtout d'identifier des personnes pratiquant l'agriculture urbaine depuis quelques années (de 1 à 4 ans), mais cultivant déjà de nombreuses sortes de fruits et légumes et partageant aussi leurs semis ou récoltes.\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Graphiques pour les résultats des modalités de l'axe 2 de l'ACM](12-AnalysesFactorielles_files/figure-html/fig-ACMValeursCoordFig2-1.png){#fig-ACMValeursCoordFig2 fig-align='center' width=90%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Premier plan factoriel de l'ACM pour les modalités](12-AnalysesFactorielles_files/figure-html/fig-ACMValeursPlanFacto1-1.png){#fig-ACMValeursPlanFacto1 fig-align='center' width=75%}\n:::\n:::\n\n\n**Interprétation des résultats de l'axe 3 pour les variables**\n\nTrois modalités concourent le plus à la formation de l'axe 3 résumant 7,6 % de la variance : `Q8. Oui`  (23,31), `Q3. De 5 à 9 ans`  (19,43) et `Q9. 5 à 9 sortes`  (17,31). Les modalités suivantes sont présentes aux deux extrémités de l'axe 3 :\n\n- **Coordonnées négatives** : `Q3. De 5 à 9 ans` (-1,11), `Q9. 5 à 9 sortes` (-0,79). \n- **Coordonnées positives** : seule la modalité `Q8. Oui` présente une coordonnée fortement positive (1,21).\n\nPar conséquent, cet axe semble plus complexe à analyser et surtout moins intéressant que les deux premiers.\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Graphiques pour les résultats des modalités de l'axe 3 de l'ACM](12-AnalysesFactorielles_files/figure-html/fig-ACMValeursCoordFig3-1.png){#fig-ACMValeursCoordFig3 fig-align='center' width=100%}\n:::\n:::\n\n\n\n**Analyse des variables supplémentaires dans l'ACM**\n\nIl est ensuite possible de projeter les modalités supplémentaires sur les axes de l'ACM retenus (@tbl-ACMValeursCoordSuppl et @fig-ACMValeursPlanFactoSupp1). Les faibles valeurs des coordonnées factorielles des modalités supplémentaires sur les deux axes semblent indiquer que le profil socioéconomique des personnes pratiquant l'agriculture urbaine ne semble pas (ou peu) relié aux profils identifiés par les axes factoriels.\n\n\n::: {#tbl-ACMValeursCoordSuppl .cell tbl-cap='Résultats de l\\'ACM pour les modalités des variables supplémentaires'}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Coordonnées</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Cosinus carrés</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Modalité </th>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n   <th style=\"text-align:right;\"> 1 </th>\n   <th style=\"text-align:right;\"> 2 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Q15. 18 à 34 ans </td>\n   <td style=\"text-align:right;\"> -0,09 </td>\n   <td style=\"text-align:right;\"> -0,27 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,04 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q15. 35 à 49 ans </td>\n   <td style=\"text-align:right;\"> -0,06 </td>\n   <td style=\"text-align:right;\"> -0,01 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q15. 50 à 64 ans </td>\n   <td style=\"text-align:right;\"> 0,14 </td>\n   <td style=\"text-align:right;\"> 0,25 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q15. 65 ans et plus </td>\n   <td style=\"text-align:right;\"> 0,11 </td>\n   <td style=\"text-align:right;\"> 0,25 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q16. Travail temps plein </td>\n   <td style=\"text-align:right;\"> -0,10 </td>\n   <td style=\"text-align:right;\"> -0,06 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q16. Travail. temps partiel </td>\n   <td style=\"text-align:right;\"> 0,36 </td>\n   <td style=\"text-align:right;\"> -0,15 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q16. Étudiant </td>\n   <td style=\"text-align:right;\"> -0,14 </td>\n   <td style=\"text-align:right;\"> -0,11 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q16. Retraité </td>\n   <td style=\"text-align:right;\"> 0,17 </td>\n   <td style=\"text-align:right;\"> 0,25 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q16. Sans emploi </td>\n   <td style=\"text-align:right;\"> 0,44 </td>\n   <td style=\"text-align:right;\"> -0,14 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q16. À la maison </td>\n   <td style=\"text-align:right;\"> -0,06 </td>\n   <td style=\"text-align:right;\"> 0,18 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q17. Aucun certificat ou dipl. </td>\n   <td style=\"text-align:right;\"> 0,28 </td>\n   <td style=\"text-align:right;\"> 0,16 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q17. Dipl. secondaires </td>\n   <td style=\"text-align:right;\"> -0,09 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q17. Dipl. collégiales </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n   <td style=\"text-align:right;\"> 0,19 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q17. Études universitaires </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> -0,10 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q21. Propriétaire </td>\n   <td style=\"text-align:right;\"> 0,03 </td>\n   <td style=\"text-align:right;\"> 0,02 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Q22. Locataire </td>\n   <td style=\"text-align:right;\"> -0,06 </td>\n   <td style=\"text-align:right;\"> -0,03 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n   <td style=\"text-align:right;\"> 0,00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Premier plan factoriel de l'ACM avec toutes les modalités incluant celles supplémentaires](12-AnalysesFactorielles_files/figure-html/fig-ACMValeursPlanFactoSupp1-1.png){#fig-ACMValeursPlanFactoSupp1 fig-align='center' width=672}\n:::\n:::\n\n\n::: bloc_astuce\n::: bloc_astuce-header\n::: bloc_astuce-icon\n:::\n**Visualisation de variables qualitatives ordinales sur un plan factoriel**\n:::\n::: bloc_astuce-body\nLorsque les variables qualitatives sont ordinales et non nominales, il peut être intéressant de relier les différentes modalités avec une ligne. Cela permet de comprendre en un coup d'œil la trajectoire que suivent les modalités sur les deux axes factoriels. En guise d'exemple, nous réalisons cet exercice pour les variables `Q3` et `Q9` (@fig-ACMordinaleTrajectoire).\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Trajectoires des variables ordinales sur le premier plan factoriel de l'ACM](12-AnalysesFactorielles_files/figure-html/fig-ACMordinaleTrajectoire-1.png){#fig-ACMordinaleTrajectoire fig-align='center' width=70%}\n:::\n:::\n\n:::\n:::\n\n#### Résultats de l'ACM pour les individus {#sec-12413}\n\nComme toute méthode factorielle, les coordonnées factorielles, les cosinus carrés et les contributions sont aussi disponibles pour les individus en ACM. Nous proposons ici simplement de réaliser le premier plan factoriel pour les individus en attribuant un dégradé de couleurs avec les cosinus carrés (@fig-ACMPlanFacto12Ind1). Il est aussi possible d'attribuer des couleurs aux différentes modalités d'une variable. Par exemple, sur le premier plan factoriel, nous avons utilisé la variable `Q12. Selon vous, l’agriculture urbaine contribue-t-elle à améliorer les rapports entre les gens?`. Cela permet de repérer visuellement que les personnes ayant répondu négativement à cette question ont surtout des coordonnées négatives sur l'axe 1.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Premier plan factoriel de l'ACM pour les individus](12-AnalysesFactorielles_files/figure-html/fig-ACMPlanFacto12Ind1-1.png){#fig-ACMPlanFacto12Ind1 fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Premier plan factoriel de l'ACM pour les individus avec coloration d'une variable](12-AnalysesFactorielles_files/figure-html/fig-ACMPlanFacto12Ind2-1.png){#fig-ACMPlanFacto12Ind2 fig-align='center' width=100%}\n:::\n:::\n\n\n### Mise en œuvre dans R {#sec-1242}\n\n#### Calcul d’une ACM avec `FactoMineR` {#sec-12421}\n\nPlusieurs *packages* permettent de calculer une ACM dans R, notamment `ExPosition` (fonction `epMCA`), `ade4` (fonction `dudi.mca`) et `FactoMineR` (fonction `MCA`). De nouveau, nous utilisons `FactoMineR` couplé au *package* `factoextra` pour réaliser rapidement des graphiques.\n\nPour calculer l'ACM, il suffit d'utiliser la fonction `MCA` de `FactoMineR`, puis la fonction `summary(res.acm)` qui renvoie les résultats de l'ACM pour : \n\n- Les valeurs propres (section `Eigenvalues`) pour les axes factoriels (`Dim.1` à `Dim.n`) avec leur variance expliquée brute (`Variance`), en pourcentage (`% of var.`) et en pourcentage cumulé (`Cumulative % of var.`).\n\n- Les dix premières observations (section `Individuals`) avec les coordonnées factorielles (`Dim.1` à `Dim.n`), les contributions (`ctr`) et les cosinus carrés (`cos2`). Pour accéder aux résultats pour toutes les observations, utilisez les fonctions `res.acm$ind` ou encore `res.acm$ind$coord` (uniquement les coordonnées factorielles), `res.acm$ind$contrib` (uniquement les contributions) et `res.acm$ind$cos2` (uniquement les cosinus carrés).\n\n- Les dix premières modalités des variables (section `Categories`) avec les coordonnées factorielles (D`im.1` à `Dim.n`), les contributions (`ctr`) et les cosinus carrés (`cos2`).\n\nLa syntaxe ci-dessous permet, dans un premier temps, de calculer l'ACM, puis de créer un *DataFrame* pour les résultats des valeurs propres.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(FactoMineR)\n# Calcul de l'AFC\nres.acm <-  MCA(dfACM,            # Nom du DataFrame\n                ncp = 3,          # Nombre d'axes retenus\n                quali.sup=10:13,  # Variables supplémentaires\n                graph = FALSE, \n                row.w = dfenquete$pond) # Variables pour la pondération des lignes\n# Affichage des résultats\nprint(res.acm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n**Results of the Multiple Correspondence Analysis (MCA)**\nThe analysis was performed on 352 individuals, described by 13 variables\n*The results are available in the following objects:\n\n   name                description                                          \n1  \"$eig\"              \"eigenvalues\"                                        \n2  \"$var\"              \"results for the variables\"                          \n3  \"$var$coord\"        \"coord. of the categories\"                           \n4  \"$var$cos2\"         \"cos2 for the categories\"                            \n5  \"$var$contrib\"      \"contributions of the categories\"                    \n6  \"$var$v.test\"       \"v-test for the categories\"                          \n7  \"$var$eta2\"         \"coord. of variables\"                                \n8  \"$ind\"              \"results for the individuals\"                        \n9  \"$ind$coord\"        \"coord. for the individuals\"                         \n10 \"$ind$cos2\"         \"cos2 for the individuals\"                           \n11 \"$ind$contrib\"      \"contributions of the individuals\"                   \n12 \"$quali.sup\"        \"results for the supplementary categorical variables\"\n13 \"$quali.sup$coord\"  \"coord. for the supplementary categories\"            \n14 \"$quali.sup$cos2\"   \"cos2 for the supplementary categories\"              \n15 \"$quali.sup$v.test\" \"v-test for the supplementary categories\"            \n16 \"$call\"             \"intermediate results\"                               \n17 \"$call$marge.col\"   \"weights of columns\"                                 \n18 \"$call$marge.li\"    \"weights of rows\"                                    \n```\n:::\n\n```{.r .cell-code}\nsummary(res.acm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nMCA(X = dfACM, ncp = 3, quali.sup = 10:13, graph = FALSE, row.w = dfenquete$pond) \n\n\nEigenvalues\n                       Dim.1   Dim.2   Dim.3   Dim.4   Dim.5   Dim.6   Dim.7\nVariance               0.248   0.156   0.135   0.127   0.126   0.123   0.114\n% of var.             13.940   8.792   7.620   7.161   7.065   6.916   6.385\nCumulative % of var.  13.940  22.732  30.352  37.513  44.579  51.494  57.879\n                       Dim.8   Dim.9  Dim.10  Dim.11  Dim.12  Dim.13  Dim.14\nVariance               0.107   0.101   0.095   0.093   0.086   0.077   0.071\n% of var.              6.003   5.671   5.327   5.234   4.822   4.340   4.011\nCumulative % of var.  63.882  69.553  74.880  80.115  84.937  89.277  93.288\n                      Dim.15  Dim.16\nVariance               0.064   0.055\n% of var.              3.619   3.094\nCumulative % of var.  96.906 100.000\n\nIndividuals (the 10 first)\n                               Dim.1    ctr   cos2    Dim.2    ctr   cos2  \n4                           |  0.261  0.063  0.052 |  0.327  0.155  0.081 |\n10                          | -0.533  0.688  0.278 |  0.050  0.010  0.002 |\n11                          |  0.135  0.020  0.014 | -0.120  0.025  0.011 |\n15                          |  0.020  0.000  0.000 |  0.271  0.073  0.061 |\n17                          | -0.133  0.014  0.012 | -0.264  0.088  0.049 |\n18                          |  0.196  0.024  0.018 |  0.279  0.078  0.037 |\n19                          | -0.193  0.041  0.014 | -0.063  0.007  0.002 |\n21                          |  0.845  0.731  0.369 | -0.337  0.184  0.059 |\n23                          | -0.253  0.155  0.058 | -0.020  0.002  0.000 |\n26                          |  0.802  0.552  0.170 |  0.460  0.288  0.056 |\n                             Dim.3    ctr   cos2  \n4                            0.251  0.105  0.048 |\n10                          -0.413  0.757  0.167 |\n11                          -0.354  0.252  0.097 |\n15                          -0.503  0.291  0.209 |\n17                           0.835  1.019  0.486 |\n18                           0.104  0.012  0.005 |\n19                           0.159  0.051  0.010 |\n21                          -0.390  0.285  0.079 |\n23                          -0.375  0.624  0.128 |\n26                           0.098  0.015  0.003 |\n\nCategories (the 10 first)\n                                Dim.1     ctr    cos2  v.test     Dim.2     ctr\nQ3. Moins de 1 an           |  -0.731   2.704   0.068  -4.940 |   0.677   3.681\nQ3. De 1 à 4 ans            |  -0.286   1.259   0.043  -3.921 |  -0.791  15.299\nQ3. De 5 à 9 ans            |   0.119   0.122   0.003   1.102 |   0.385   2.023\nQ3. 10 ans ou plus          |   0.450   3.189   0.110   6.271 |   0.347   3.006\nQ4. Moins de 10%            |  -0.562   7.874   0.395 -11.913 |   0.033   0.044\nQ4. 10 à 25%                |   0.745   4.918   0.137   7.006 |  -0.765   8.220\nQ4. 26 à 50%                |   0.775   3.815   0.099   5.966 |   0.644   4.176\nQ4. Plus de 50%             |   0.527   1.310   0.033   3.424 |   0.395   1.167\nQ5. Oui                     |   0.950   9.194   0.265   9.760 |   0.557   5.008\nQ5. Non                     |  -0.279   2.701   0.265  -9.760 |  -0.164   1.471\n                               cos2  v.test     Dim.3     ctr    cos2  v.test  \nQ3. Moins de 1 an             0.058   4.578 |   0.627   3.636   0.050   4.236 |\nQ3. De 1 à 4 ans              0.328 -10.855 |   0.390   4.304   0.080   5.360 |\nQ3. De 5 à 9 ans              0.035   3.556 |  -1.110  19.427   0.293 -10.261 |\nQ3. 10 ans ou plus            0.065   4.835 |   0.023   0.016   0.000   0.327 |\nQ4. Moins de 10%              0.001   0.704 |   0.070   0.221   0.006   1.477 |\nQ4. 10 à 25%                  0.144  -7.194 |  -0.109   0.191   0.003  -1.021 |\nQ4. 26 à 50%                  0.068   4.957 |   0.154   0.276   0.004   1.187 |\nQ4. Plus de 50%               0.018   2.566 |  -0.372   1.195   0.016  -2.417 |\nQ5. Oui                       0.091   5.720 |  -0.126   0.294   0.005  -1.290 |\nQ5. Non                       0.091  -5.720 |   0.037   0.086   0.005   1.290 |\n\nCategorical variables (eta2)\n                              Dim.1 Dim.2 Dim.3  \nq3                          | 0.162 0.338 0.334 |\nq4                          | 0.400 0.191 0.023 |\nq5                          | 0.265 0.091 0.005 |\nq8                          | 0.071 0.032 0.352 |\nq9                          | 0.548 0.340 0.338 |\nq10                         | 0.381 0.015 0.004 |\nq11                         | 0.245 0.235 0.034 |\nq12                         | 0.121 0.038 0.007 |\nq13                         | 0.036 0.126 0.122 |\n\nSupplementary categories (the 10 first)\n                               Dim.1   cos2 v.test    Dim.2   cos2 v.test  \nQ15. 18 à 34 ans            | -0.091  0.004 -1.221 | -0.271  0.037 -3.630 |\nQ15. 35 à 49 ans            | -0.060  0.001 -0.731 | -0.014  0.000 -0.175 |\nQ15. 50 à 64 ans            |  0.140  0.006  1.419 |  0.251  0.018  2.543 |\nQ15. 65 ans et plus         |  0.107  0.002  0.874 |  0.248  0.011  2.020 |\nQ16. Travail temps plein    | -0.096  0.012 -2.084 | -0.065  0.005 -1.404 |\nQ16. Travail. temps partiel |  0.364  0.010  1.875 | -0.147  0.002 -0.757 |\nQ16. Étudiant               | -0.139  0.002 -0.774 | -0.111  0.001 -0.617 |\nQ16. Retraité               |  0.166  0.006  1.521 |  0.254  0.015  2.331 |\nQ16. Sans emploi            |  0.440  0.006  1.433 | -0.142  0.001 -0.464 |\nQ16. À la maison            | -0.056  0.000 -0.279 |  0.175  0.002  0.878 |\n                             Dim.3   cos2 v.test  \nQ15. 18 à 34 ans             0.092  0.004  1.232 |\nQ15. 35 à 49 ans            -0.112  0.005 -1.360 |\nQ15. 50 à 64 ans            -0.002  0.000 -0.020 |\nQ15. 65 ans et plus          0.015  0.000  0.122 |\nQ16. Travail temps plein    -0.025  0.001 -0.540 |\nQ16. Travail. temps partiel  0.291  0.006  1.497 |\nQ16. Étudiant               -0.088  0.001 -0.488 |\nQ16. Retraité                0.031  0.000  0.284 |\nQ16. Sans emploi            -0.495  0.007 -1.611 |\nQ16. À la maison             0.144  0.001  0.720 |\n\nSupplementary categorical variables (eta2)\n                              Dim.1 Dim.2 Dim.3  \nq15                         | 0.010 0.048 0.007 |\nq16                         | 0.027 0.020 0.015 |\nq17                         | 0.006 0.014 0.014 |\nq21                         | 0.002 0.001 0.007 |\n```\n:::\n\n```{.r .cell-code}\n# Construction d'un DataFrame pour les valeurs propres\ndfACMvp <- data.frame(res.acm$eig)\nnames(dfACMvp) <- c(\"VP\" , \"VP_pct\" , \"VP_pctCumul\")\ndfACMvp$Axe <- factor(1:nrow(dfACMvp), levels = rev(1:nrow(dfACMvp)))\ndfACMvp <- dfACMvp[, c(4,1:3)]\n```\n:::\n\n\n#### Exploration graphique des résultats de l'ACM pour les valeurs propres {#sec-124212}\n\nPour créer un histogramme des valeurs propres de l'ACM, vous pouvez utiliser la fonction `fviz_screeplot` de `factoextra`.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(factoextra)\nlibrary(ggplot2)\n\nfviz_screeplot(res.acm, addlabels = TRUE,\n               x = \"Composantes\", y = \"Valeur propre\", title = \"\")\n```\n\n::: {.cell-output-display}\n![Graphique pour les valeurs propres de l'ACM avec factoextra](12-AnalysesFactorielles_files/figure-html/fig-ACMCodePartie1VPb-1.png){#fig-ACMCodePartie1VPb fig-align='center' width=75%}\n:::\n:::\n\n\nAvec un peu plus de lignes de code, il est relativement facile d'exploiter le *DataFrame* des valeurs propres créé précédemment (`dfACMvp`) pour construire des graphiques plus personnalisés.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(factoextra)\nlibrary(ggplot2)\n\ncouleursAxes <- c(\"steelblue\" , \"skyblue2\")\ng1 <- ggplot(dfACMvp, aes(x = VP, y = Axe))+\n  geom_bar(stat = \"identity\", width = .6, alpha = .8, color = \"black\", fill = \"skyblue2\")+\n  labs(x = \"Valeur propre\", y = \"Axe factoriel\")\ng2 <- ggplot(dfACMvp, aes(x = VP_pct, y = Axe))+\n  geom_bar(stat = \"identity\", width = .6, alpha = .8, color = \"black\", fill = \"skyblue2\")+\n  theme(legend.position = \"none\")+\n  labs(x = \"Variance expliquée (%)\", y = \"Axe factoriel\")\ng3 <- ggplot(dfACMvp, aes(x = VP_pctCumul, y = Axe, group=1))+\n  geom_bar(stat = \"identity\", width = .6, alpha = .8, color = \"black\", fill = \"skyblue2\")+\n  geom_line(colour = \"brown\", linetype = \"solid\", size=.8) +\n  geom_point(size=3, shape=21, color = \"brown\", fill = \"brown\")+\n  theme(legend.position = \"none\")+\n  labs(x = \"Variance expliquée (% cumulé)\", y = \"Axe factoriel\")\nggarrange(g2, g3,  nrow = 2)\n```\n\n::: {.cell-output-display}\n![Graphiques pour les valeurs propres de l'ACM avec factoextra](12-AnalysesFactorielles_files/figure-html/fig-ACMCodePartie1VPc-1.png){#fig-ACMCodePartie1VPc fig-align='center' width=75%}\n:::\n:::\n\n\nLa syntaxe ci-dessous permet de construire un tableau avec les coordonnées factorielles, les cosinus carrés et les contributions pour les modalités des variables qualitatives.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(stringr)\nnAxes <- 3\ndfmodalites <- data.frame(Modalite =rownames(res.acm$var$coord),\n                           Coord = round(res.acm$var$coord[, 1:nAxes],3),\n                           Cos2 = round(res.acm$var$cos2[, 1:nAxes],3),\n                           ctr = round(res.acm$var$contrib[, 1:nAxes],3))\nrownames(dfmodalites) <- 1:nrow(dfmodalites)\nnames(dfmodalites) <- str_replace(names(dfmodalites), \".Dim.\", \"F\")\n```\n:::\n\n\n\n#### Exploration graphique des résultats de l'ACM pour les modalités {#sec-124213}\n\nAvant d'explorer graphiquement les résultats pour les modalités, il est judicieux de construire un *DataFrame* avec les coordonnées factorielles, les contributions et les cosinus carrés des modalités (voir la syntaxe ci-dessous).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(kableExtra)\nlibrary(stringr)\nnAxes <- 3\ndfmodalites <- data.frame(Modalite =rownames(res.acm$var$coord),\n                           Coord = round(res.acm$var$coord[, 1:nAxes],2),\n                           ctr = round(res.acm$var$contrib[, 1:nAxes],2),\n                           Cos2 = round(res.acm$var$cos2[, 1:nAxes],2))\nrownames(dfmodalites) <- 1:nrow(dfmodalites)\nnames(dfmodalites) <- str_replace(names(dfmodalites), \".Dim.\", \"F\")\n```\n:::\n\n\nPlusieurs fonctions très faciles à utiliser de `factoextra` permettent de construire rapidement des graphiques : `fviz_mca_var` pour un nuage de points d'un plan factoriel, `fviz_cos2` et `fviz_contrib` (en utilisant le paramètre `choice=var.cat`) pour des histogrammes avec les cosinus carrés et les contributions des modalités.\n\nIl est aussi possible de créer vos propres graphiques avec `ggplot2` en utilisant le *DataFrame* créé précédemment avec les modalités. Par exemple, la syntaxe ci-dessous renvoie deux histogrammes pour l'axe 1 : l'un avec les coordonnées, l'autre avec les contributions. Dans la syntaxe, repérez le terme `CoordF1`. Dupliquez la syntaxe et changez ce terme pour `CoordF2` et `CoordF3` pour réaliser les graphiques des axes 2 et 3.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Histogrammes pour les coordonnées des modalités\ncouleursCoords <- c(\"lightsalmon\" , \"steelblue\")\nplotCoordF1 <- ggplot(dfmodalites,\n                      aes(y = reorder(Modalite, CoordF1),\n                          x = CoordF1, fill = CoordF1<0))+\n  geom_bar(stat = \"identity\", width = .6, alpha = .8, color = \"black\")+\n  geom_vline(xintercept = 0, color = \"black\", linewidth = 1)+\n  scale_fill_manual(name = \"Coordonnée\" , values = couleursCoords,\n                    labels = c(\"Positive\" , \"Négative\"))+\n  labs(x = \"Coordonnées sur l'axe 1\", y = \"Modalité\")+\n  theme(legend.position = \"none\", axis.text.y = element_text(size = 7))\n\nplotCtrF1 <- ggplot(dfmodalites, aes(y = reorder(Modalite, ctrF1), x = ctrF1))+\n  geom_bar(stat = \"identity\", width = .6, alpha = .8, color = \"black\", fill = \"steelblue\")+\n  labs(x = \"Contributions sur l'axe 1\", y = \"Modalité\")+\n  theme(legend.position = \"none\", axis.text.y = element_text(size = 7))\n\nggarrange(plotCoordF1, plotCtrF1, ncol = 1, nrow = 2)\n```\n\n::: {.cell-output-display}\n![Exemple de graphiques pour les résultats des modalités](12-AnalysesFactorielles_files/figure-html/fig-ACMMiseEnOeuvreVars1-1.png){#fig-ACMMiseEnOeuvreVars1 fig-align='center' width=100%}\n:::\n:::\n\n\nLa syntaxe suivante permet de construire le premier plan factoriel pour les modalités avec la fonction `fviz_mca_var` de `factoextra` (@fig-ACMMiseEnOeuvreVars2).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nres.acm2 <-  MCA(dfACM[1:9], ncp = 3, graph = FALSE, row.w = dfenquete$pond)\nfviz_mca_var(res.acm2, repel = TRUE,\n             choice = \"var.cat\",\n             axes = c(1, 2),\n             # col.var = \"black\",\n             title = \"\", xlab = \"Axe 1\", ylab = \"Axe 2\",\n             ggtheme = theme_minimal ())\n```\n\n::: {.cell-output-display}\n![Premier plan factoriel de l'ACM pour les modalités](12-AnalysesFactorielles_files/figure-html/fig-ACMMiseEnOeuvreVars2-1.png){#fig-ACMMiseEnOeuvreVars2 fig-align='center' width=75%}\n:::\n:::\n\n\nLa syntaxe suivante permet de construire le premier plan factoriel pour les modalités supplémentaires avec la fonction `fviz_mca_var` de `factoextra` (@fig-ACMMiseEnOeuvreVars3).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_mca_var(res.acm, repel = TRUE,\n             choice = \"var.cat\",\n             axes = c(1, 2),\n             col.var = \"gray23\",\n             col.quali.sup = \"darkred\",\n             labelsize = 3,\n             title = \"\", xlab = \"Axe 1\", ylab = \"Axe 2\", \n             ggtheme = theme_minimal ())\n```\n\n::: {.cell-output-display}\n![Premier plan factoriel de l'ACM pour les modalités supplémentaires](12-AnalysesFactorielles_files/figure-html/fig-ACMMiseEnOeuvreVars3-1.png){#fig-ACMMiseEnOeuvreVars3 fig-align='center' width=75%}\n:::\n:::\n\n\nFinalement, la syntaxe ci-dessous renvoie un graphique avec la trajectoire de la variable `Q3` (@fig-ACMMiseEnOeuvreVars4).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(ggpubr)\nQ3 <- dfmodalites[1:4, 1:3]\nggplot(Q3, aes(x = CoordF1, y = CoordF2, label=Modalite))+\n  xlim(-1, .75)+ylim(-1, 1)+\n  labs(title = \"Q3. Depuis combien de temps cultivez-vous \\n\n        des fruits, des fines herbes ou des légumes?\",\n       x = \"Axe 1\", y = \"Axe 2\")+\n  geom_label(nudge_x=0, nudge_y = 0.07) +\n  geom_line( color = \"black\", linewidth = .2)+\n  geom_point(shape=21, color = \"black\", fill = \"steelblue\", size=4)\n```\n\n::: {.cell-output-display}\n![Trajectoires des variables ordinales sur le premier plan factoriel de l'ACM](12-AnalysesFactorielles_files/figure-html/fig-ACMMiseEnOeuvreVars4-1.png){#fig-ACMMiseEnOeuvreVars4 fig-align='center' width=70%}\n:::\n:::\n\n\n#### Exploration graphique des résultats de l'ACM pour les individus {#sec-124214}\n\nD'autres fonctions de `factoextra` produisent rapidement des graphiques pour les individus :\n\n- `fviz_cos2` et `fviz_contrib` (en utilisant le paramètre `choice=ind`) pour construire des histogrammes pour les cosinus carrés et les contributions des individus.\n- `fviz_mca_ind` pour un nuage de points d'un plan factoriel (axes 1 et 2 habituellement).\n\nLa syntaxe ci-dessous produit le premier axe factoriel pour les individus (@fig-ACMPlanFactoInd1Facto).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_mca_ind(res.acm, col.ind = \"cos2\",\n             gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n             repel = TRUE,\n             xlab = \"Axe 1\", ylab = \"Axe 2\", title = \"\",\n             ggtheme = theme_minimal())\n```\n\n::: {.cell-output-display}\n![Premier plan factoriel de l'ACM pour les individus avec factoextra](12-AnalysesFactorielles_files/figure-html/fig-ACMPlanFactoInd1Facto-1.png){#fig-ACMPlanFactoInd1Facto fig-align='center' width=70%}\n:::\n:::\n\n\nLa syntaxe ci-dessous produit aussi le premier plan factoriel pour les individus, mais en attribuant une couleur différente aux modalités de la variable `q12` (@fig-ACMPlanFactoInd2Facto).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_mca_ind (res.acm,\n              label = \"none\",\n              habillage = \"q12\", # colorer par groupes\n             xlab = \"Axe 1\", ylab = \"Axe 2\", title = \"\",\n              palette = c (\"darkred\", \"steelblue\", \"gray23\"),\n              ggtheme = theme_minimal ())\n```\n\n::: {.cell-output-display}\n![Premier plan factoriel de l'ACM pour les individus avec coloration d'une variable avec factoextra](12-AnalysesFactorielles_files/figure-html/fig-ACMPlanFactoInd2Facto-1.png){#fig-ACMPlanFactoInd2Facto fig-align='center' width=70%}\n:::\n:::\n\n\n## Quiz de révision du chapitre {#sec-125}\n\n\n<div id=\"Chapitre12_AnalysesFacto\" class=\"card\">\n<link type=\"text/javascript\" src=\"libs/quizlib.1.0.1.min.js\"/>\n<script>var Quiz=function(a,b){this.Classes=Object.freeze({QUESTION:\"quizlib-question\",QUESTION_TITLE:\"quizlib-question-title\",QUESTION_ANSWERS:\"quizlib-question-answers\",QUESTION_WARNING:\"quizlib-question-warning\",CORRECT:\"quizlib-correct\",INCORRECT:\"quizlib-incorrect\",TEMP:\"quizlib-temp\"}),this.unansweredQuestionText=\"Question sans réponse !\",this.container=document.getElementById(a),this.questions=[],this.result=new QuizResult,this.answers=b;for(var c=0;c<this.container.children.length;c++)this.container.children[c].classList.contains(Quiz.Classes.QUESTION)&&this.questions.push(this.container.children[c]);if(this.answers.length!=this.questions.length)throw new Error(\"Number of answers does not match number of questions!\")};Quiz.Classes=Object.freeze({QUESTION:\"quizlib-question\",QUESTION_TITLE:\"quizlib-question-title\",QUESTION_ANSWERS:\"quizlib-question-answers\",QUESTION_WARNING:\"quizlib-question-warning\",CORRECT:\"quizlib-correct\",INCORRECT:\"quizlib-incorrect\",TEMP:\"quizlib-temp\"}),Quiz.prototype.checkAnswers=function(a){void 0===a&&(a=!0);for(var b=[],c=[],d=0;d<this.questions.length;d++){var e=this.questions[d],f=this.answers[d],g=[];this.clearHighlights(e);for(var h,i=e.getElementsByClassName(Quiz.Classes.QUESTION_ANSWERS)[0].getElementsByTagName(\"input\"),j=0;j<i.length;j++)h=i[j],\"checkbox\"===h.type||\"radio\"===h.type?h.checked&&g.push(h.value):\"\"!==h.value&&g.push(h.value);1!=g.length||Array.isArray(f)?0===g.length&&b.push(e):g=g[0],c.push(Utils.compare(g,f))}if(0===b.length||!a)return this.result.setResults(c),!0;for(d=0;d<b.length;d++){var k=document.createElement(\"span\");k.appendChild(document.createTextNode(this.unansweredQuestionText)),k.className=Quiz.Classes.QUESTION_WARNING,b[d].getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].appendChild(k)}return!1},Quiz.prototype.clearHighlights=function(a){for(var b=a.getElementsByClassName(Quiz.Classes.QUESTION_WARNING);b.length>0;)b[0].parentNode.removeChild(b[0]);var c,d=[a.getElementsByClassName(Quiz.Classes.CORRECT),a.getElementsByClassName(this.Classes.INCORRECT)];for(i=0;i<d.length;i++)for(;d[i].length>0;)c=d[i][0],c.classList.remove(Quiz.Classes.CORRECT),c.classList.remove(Quiz.Classes.INCORRECT);for(var e=a.getElementsByClassName(Quiz.Classes.TEMP);e.length>0;)e[0].parentNode.removeChild(e[0])},Quiz.prototype.highlightResults=function(a){for(var b,c=0;c<this.questions.length;c++)b=this.questions[c],b.getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].classList.add(this.result.results[c]?Quiz.Classes.CORRECT:Quiz.Classes.INCORRECT),void 0!==a&&a(this,b,c,this.result.results[c])};var QuizResult=function(){this.results=[],this.totalQuestions=0,this.score=0,this.scorePercent=0,this.scorePercentFormatted=0};QuizResult.prototype.setResults=function(a){this.results=a,this.totalQuestions=this.results.length,this.score=0;for(var b=0;b<this.results.length;b++)this.results[b]&&this.score++;this.scorePercent=this.score/this.totalQuestions,this.scorePercentFormatted=Math.floor(100*this.scorePercent)};var Utils=function(){};Utils.compare=function(a,b){if(a.length!=b.length)return!1;if(Array.isArray(a)&&Array.isArray(b)){for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b};\n\nfunction showResults(quiz) {\n    // Check answers and continue if all questions have been answered\n    if (quiz.checkAnswers()) {\n        var quizScorePercent = quiz.result.scorePercentFormatted; // The unformatted percentage is a decimal in range 0 - 1\n        var quizResultElement = document.getElementById('quiz-result');\n        quizResultElement.style.display = 'block';\n        document.getElementById('quiz-percent').innerHTML = quizScorePercent.toString();\n\n        // Change background colour of results div according to score percent\n        if (quizScorePercent > 75) quizResultElement.style.backgroundColor = '#4caf50';\n        else if (quizScorePercent > 50) quizResultElement.style.backgroundColor = '#ffc107';\n        else if (quizScorePercent > 25) quizResultElement.style.backgroundColor = '#ff9800';\n        else if (quizScorePercent > 0) quizResultElement.style.backgroundColor = '#f44336';\n\n        // Highlight questions according to whether they were correctly answered. The callback allows us to highlight/show the correct answer\n        quiz.highlightResults(handleAnswers);\n    }\n}\n\n/** Callback for Quiz.highlightResults. Highlights the correct answers of incorrectly answered questions\n * Parameters are: the quiz object, the question element, question number, correctly answered flag\n */\nfunction handleAnswers(quiz, question, no, correct) {\n    if (!correct) {\n        var answers = question.getElementsByTagName('input');\n        for (var i = 0; i < answers.length; i++) {\n            if (answers[i].type === 'checkbox' || answers[i].type === 'radio'){\n                // If the current input element is part of the correct answer, highlight it\n                if (quiz.answers[no].indexOf(answers[i].value) > -1) {\n                    answers[i].parentNode.classList.add(Quiz.Classes.CORRECT);\n                }\n            } else {\n                // If the input is anything other than a checkbox or radio button, show the correct answer next to the element\n                var correctAnswer = document.createElement('span');\n                correctAnswer.classList.add(Quiz.Classes.CORRECT);\n                correctAnswer.classList.add(Quiz.Classes.TEMP); // quiz.checkAnswers will automatically remove elements with the temp class\n                correctAnswer.innerHTML = quiz.answers[no];\n                correctAnswer.style.marginLeft = '10px';\n                answers[i].parentNode.insertBefore(correctAnswer, answers[i].nextSibling);\n            }\n        }\n    }\n}\n\n  var quizz_Chapitre12_AnalysesFacto;\n  window.onload = function() {\n    quizz_Chapitre12_AnalysesFacto = new Quiz('Chapitre12_AnalysesFacto', ['1','1','1','2',['1', '2', '3'],'1','2',['1', '2', '3', '4']]);\n  };</script>\n<link rel=\"stylesheet\" type=\"text/css\" src=\"css/quizlib.min.css\"/>\n<div class=\"card quizlib-question\">\n<div class=\"quizlib-question-title\">Des variables latentes ne sont pas directement observées, mais plutôt produites par la méthode factorielle afin de résumer les relations/associations entre plusieurs variables mesurées initialement.</div>\n<div>Relisez au besoin l'introduction du [chapitre @sec-chap12].</div>\n<div class=\"quizlib-question-answers\">\n<table class=\"table table-sm table-striped small\">\n<tr>\n<td>\n<label>Vrai</label>\n</td>\n<td>\n<input type=\"radio\" name=\"q1\" value=\"1\"/>\n</td>\n</tr>\n<tr>\n<td>\n<label>Faux</label>\n</td>\n<td>\n<input type=\"radio\" name=\"q1\" value=\"2\"/>\n</td>\n</tr>\n</table>\n</div>\n</div>\n<div class=\"card quizlib-question\">\n<div class=\"quizlib-question-title\">Quelles sont les métriques utilisées pour les trois principales méthodes factorielles?</div>\n<div>Relisez au besoin la [section @sec-1211].</div>\n<div class=\"quizlib-question-answers\">\n<table class=\"table table-sm table-striped small\">\n<tr>\n<td>\n<label>ACP (distance euclidienne), AFC (distance du khi-deux), ACM (distance du khi-deux)</label>\n</td>\n<td>\n<input type=\"radio\" name=\"q2\" value=\"1\"/>\n</td>\n</tr>\n<tr>\n<td>\n<label>ACP (distance du khi-deux), AFC (distance du khi-deux), ACM (distance euclidienne)</label>\n</td>\n<td>\n<input type=\"radio\" name=\"q2\" value=\"2\"/>\n</td>\n</tr>\n<tr>\n<td>\n<label>ACP (distance euclidienne), AFC (distance euclidienne), ACM (distance du khi-deux)</label>\n</td>\n<td>\n<input type=\"radio\" name=\"q2\" value=\"3\"/>\n</td>\n</tr>\n</table>\n</div>\n</div>\n<div class=\"card quizlib-question\">\n<div class=\"quizlib-question-title\">En ACP normée, la somme des valeurs propres (inertie totale) est égale au :</div>\n<div>Relisez au besoin le début de la [section @sec-12221].</div>\n<div class=\"quizlib-question-answers\">\n<table class=\"table table-sm table-striped small\">\n<tr>\n<td>\n<label>nombre de variables quantitatives du tableau initial</label>\n</td>\n<td>\n<input type=\"radio\" name=\"q3\" value=\"1\"/>\n</td>\n</tr>\n<tr>\n<td>\n<label>nombre d'observations moins le nombre de variables</label>\n</td>\n<td>\n<input type=\"radio\" name=\"q3\" value=\"2\"/>\n</td>\n</tr>\n</table>\n</div>\n</div>\n<div class=\"card quizlib-question\">\n<div class=\"quizlib-question-title\">En ACP normée, la coordonnée factorielle d'une variable sur un axe est : </div>\n<div>Relisez au besoin la [section @sec-12222].</div>\n<div class=\"quizlib-question-answers\">\n<table class=\"table table-sm table-striped small\">\n<tr>\n<td>\n<label>le covariance de la variable avec la composante principale (axe factoriel)</label>\n</td>\n<td>\n<input type=\"radio\" name=\"q4\" value=\"1\"/>\n</td>\n</tr>\n<tr>\n<td>\n<label>le coefficient de corrélation de la variable avec la composante principale (axe factoriel)</label>\n</td>\n<td>\n<input type=\"radio\" name=\"q4\" value=\"2\"/>\n</td>\n</tr>\n<tr>\n<td>\n<label>la variance de la variable</label>\n</td>\n<td>\n<input type=\"radio\" name=\"q4\" value=\"3\"/>\n</td>\n</tr>\n</table>\n</div>\n</div>\n<div class=\"card quizlib-question\">\n<div class=\"quizlib-question-title\">Quelles affirmations sont exactes pour toutes les méthodes factorielles?</div>\n<div>Relisez au besoin chacune des sections intitulées aides à l'interprétation pour les trois méthodes factorielles.</div>\n<div class=\"quizlib-question-answers\">\n<table class=\"table table-sm table-striped small\">\n<tr>\n<td>\n<label>La somme des cosinus carrés en ligne est toujours égale à 1</label>\n</td>\n<td>\n<input type=\"checkbox\" name=\"q5\" value=\"1\"/>\n</td>\n</tr>\n<tr>\n<td>\n<label>La somme des valeurs propres est toujours égale à l'inertie totale du tableau</label>\n</td>\n<td>\n<input type=\"checkbox\" name=\"q5\" value=\"2\"/>\n</td>\n</tr>\n<tr>\n<td>\n<label>La somme des contributions en colonne pour un axe est égale à 100 %</label>\n</td>\n<td>\n<input type=\"checkbox\" name=\"q5\" value=\"3\"/>\n</td>\n</tr>\n<tr>\n<td>\n<label>Les coordonnées factorielles sont toujours le coefficient de corrélation de la variable avec l'axe</label>\n</td>\n<td>\n<input type=\"checkbox\" name=\"q5\" value=\"4\"/>\n</td>\n</tr>\n</table>\n</div>\n</div>\n<div class=\"card quizlib-question\">\n<div class=\"quizlib-question-title\">L'analyse des correspondances multiples (ACM) est simplement une analyse des correspondances (AFC) sur un tableau disjonctif complet?</div>\n<div>Relisez au besoin la [section @sec-124].</div>\n<div class=\"quizlib-question-answers\">\n<table class=\"table table-sm table-striped small\">\n<tr>\n<td>\n<label>Vrai</label>\n</td>\n<td>\n<input type=\"radio\" name=\"q6\" value=\"1\"/>\n</td>\n</tr>\n<tr>\n<td>\n<label>Faux</label>\n</td>\n<td>\n<input type=\"radio\" name=\"q6\" value=\"2\"/>\n</td>\n</tr>\n</table>\n</div>\n</div>\n<div class=\"card quizlib-question\">\n<div class=\"quizlib-question-title\">Dans une ACM, les variables du tableau disjonctif complet sont :</div>\n<div>Relisez au besoin la [section @sec-124].</div>\n<div class=\"quizlib-question-answers\">\n<table class=\"table table-sm table-striped small\">\n<tr>\n<td>\n<label>les fréquences des modalités des variables qualitatives</label>\n</td>\n<td>\n<input type=\"radio\" name=\"q7\" value=\"1\"/>\n</td>\n</tr>\n<tr>\n<td>\n<label>les modalités des variables qualitatives transformées en variables binaires</label>\n</td>\n<td>\n<input type=\"radio\" name=\"q7\" value=\"2\"/>\n</td>\n</tr>\n</table>\n</div>\n</div>\n<div class=\"card quizlib-question\">\n<div class=\"quizlib-question-title\">Quelles sont les étapes essentielles pour bien interpréter une analyse factorielle (ACP, AFC ou ACM)?</div>\n<div>Relisez le deuxième encadré à la [section @sec-1221].</div>\n<div class=\"quizlib-question-answers\">\n<table class=\"table table-sm table-striped small\">\n<tr>\n<td>\n<label>Interprétation des résultats des valeurs propres pour identifier le nombre d’axes à retenir</label>\n</td>\n<td>\n<input type=\"checkbox\" name=\"q8\" value=\"1\"/>\n</td>\n</tr>\n<tr>\n<td>\n<label>Analyse des résultats pour les variables (coordonnées, cosinus carrés et contributions)</label>\n</td>\n<td>\n<input type=\"checkbox\" name=\"q8\" value=\"2\"/>\n</td>\n</tr>\n<tr>\n<td>\n<label>Analyse des résultats pour les individus (coordonnées, cosinus carrés et contributions)</label>\n</td>\n<td>\n<input type=\"checkbox\" name=\"q8\" value=\"3\"/>\n</td>\n</tr>\n<tr>\n<td>\n<label>Dénommer, qualifier chacun des axes suite à l'analyse des résultats pour les variables et les individus</label>\n</td>\n<td>\n<input type=\"checkbox\" name=\"q8\" value=\"4\"/>\n</td>\n</tr>\n</table>\n</div>\n</div>\n<button type=\"button\" onclick=\"showResults(quizz_Chapitre12_AnalysesFacto);\" id=\"buttonID\">Vérifier votre résultat</button>\n<div id=\"quiz-result\" class=\"card\">\n<span id=\"quiz-percent\"></span>\n</div>\n</div>\n",
    "supporting": [
      "12-AnalysesFactorielles_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}